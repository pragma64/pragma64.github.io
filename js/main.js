var shadow$provide = {};
(function(){
shadow$provide[0]=function(ac,qb,nc,r){function pa(){const a=4294967295*Math.random()|0,b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(oc[a&255]+oc[a>>8&255]+oc[a>>16&255]+oc[a>>24&255]+"-"+oc[b&255]+oc[b>>8&255]+"-"+oc[b>>16&15|64]+oc[b>>24&255]+"-"+oc[c&63|128]+oc[c>>8&255]+"-"+oc[c>>16&255]+oc[c>>24&255]+oc[d&255]+oc[d>>8&255]+oc[d>>16&255]+oc[d>>24&255]).toLowerCase()}function ib(a,b,c){return Math.max(b,Math.min(c,a))}function Ma(a,b){return(a%b+
b)%b}function ua(a,b,c){return(1-c)*a+c*b}function Ua(a){return 0===(a&a-1)&&0!==a}function wa(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function qa(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.");}}function Qa(a,
b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return Math.round(4294967295*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(2147483647*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw Error("Invalid component type.");}}function Tb(a){for(let b=a.length-1;0<=b;--b)if(65535<=a[b])return!0;return!1}function Wb(a){return document.createElementNS("http://www.w3.org/1999/xhtml",
a)}function Y(){const a=Wb("canvas");a.style.display="block";return a}function Wa(a){a in Wh||(Wh[a]=!0,console.warn(a))}function Na(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function ma(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}function Q(a){if("undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap)return kg.getDataURL(a);
if(a.data)return{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name};console.warn("THREE.Texture: Unable to serialize Texture.");return{}}function S(a,b,c,d,e){for(let f=0,g=a.length-3;f<=g;f+=3){Cd.fromArray(a,f);const k=e.x*Math.abs(Cd.x)+e.y*Math.abs(Cd.y)+e.z*Math.abs(Cd.z),h=b.dot(Cd),l=c.dot(Cd),n=d.dot(Cd);if(Math.max(-Math.max(h,l,n),Math.min(h,l,n))>k)return!1}return!0}function Z(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+6*(b-a)*(2/
3-c):a}function P(a){65504<Math.abs(a)&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range.");a=ib(a,-65504,65504);cd.floatView[0]=a;a=cd.uint32View[0];const b=a>>23&511;return cd.baseTable[b]+((a&8388607)>>cd.shiftTable[b])}function V(a){const b=a>>10;cd.uint32View[0]=cd.mantissaTable[cd.offsetTable[b]+(a&1023)]+cd.exponentTable[b];return cd.floatView[0]}function ha(a,b,c,d,e,f,g,k,h,l){a.getVertexPosition(k,Dd);a.getVertexPosition(h,Ed);a.getVertexPosition(l,Fd);null===(1===b.side?
d.intersectTriangle(Fd,Ed,Dd,!0,$d):d.intersectTriangle(Dd,Ed,Fd,0===b.side,$d))?a=null:(ff.copy($d),ff.applyMatrix4(a.matrixWorld),b=c.ray.origin.distanceTo(ff),a=b<c.near||b>c.far?null:{distance:b,point:ff.clone(),object:a});a&&(e&&(gf.fromBufferAttribute(e,k),hf.fromBufferAttribute(e,h),jf.fromBufferAttribute(e,l),a.uv=Gc.getInterpolation($d,Dd,Ed,Fd,gf,hf,jf,new xa)),f&&(gf.fromBufferAttribute(f,k),hf.fromBufferAttribute(f,h),jf.fromBufferAttribute(f,l),a.uv1=Gc.getInterpolation($d,Dd,Ed,Fd,gf,
hf,jf,new xa)),g&&(Xh.fromBufferAttribute(g,k),Yh.fromBufferAttribute(g,h),Zh.fromBufferAttribute(g,l),a.normal=Gc.getInterpolation($d,Dd,Ed,Fd,Xh,Yh,Zh,new I),0<a.normal.dot(d.direction)&&a.normal.multiplyScalar(-1)),d={a:k,b:h,c:l,normal:new I,materialIndex:0},Gc.getNormal(Dd,Ed,Fd,d.normal),a.face=d);return a}function Aa(a){const b={};for(const c in a){b[c]={};for(const d in a[c]){const e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture||e.isQuaternion)?
e.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),b[c][d]=null):b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}function Ca(a){const b={};for(let c=0;c<a.length;c++){const d=Aa(a[c]);for(const e in d)b[e]=d[e]}return b}function ya(a){return null===a.getRenderTarget()?a.outputColorSpace:Kb.workingColorSpace}function La(){function a(f,g){d(f,g);e=b.requestAnimationFrame(a)}let b=null,c=
!1,d=null,e=null;return{start:function(){!0!==c&&null!==d&&(e=b.requestAnimationFrame(a),c=!0)},stop:function(){b.cancelAnimationFrame(e);c=!1},setAnimationLoop:function(f){d=f},setContext:function(f){b=f}}}function Za(a,b){const c=b.isWebGL2,d=new WeakMap;return{get:function(e){e.isInterleavedBufferAttribute&&(e=e.data);return d.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const f=d.get(e);f&&(a.deleteBuffer(f.buffer),d.delete(e))},update:function(e,f){if(e.isGLBufferAttribute)f=
d.get(e),(!f||f.version<e.version)&&d.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version});else{e.isInterleavedBufferAttribute&&(e=e.data);var g=d.get(e);if(void 0===g){g=d.set;var k=e,h=e.array,l=e.usage,n=h.byteLength,m=a.createBuffer();a.bindBuffer(f,m);a.bufferData(f,h,l);e.onUploadCallback();if(h instanceof Float32Array)f=a.FLOAT;else if(h instanceof Uint16Array)if(e.isFloat16BufferAttribute)if(c)f=a.HALF_FLOAT;else throw Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");
else f=a.UNSIGNED_SHORT;else if(h instanceof Int16Array)f=a.SHORT;else if(h instanceof Uint32Array)f=a.UNSIGNED_INT;else if(h instanceof Int32Array)f=a.INT;else if(h instanceof Int8Array)f=a.BYTE;else if(h instanceof Uint8Array)f=a.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)f=a.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);g.call(d,k,{buffer:m,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:e.version,size:n})}else if(g.version<e.version){if(g.size!==
e.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");k=e;h=k.array;n=k._updateRange;m=k.updateRanges;a.bindBuffer(f,g.buffer);-1===n.count&&0===m.length&&a.bufferSubData(f,0,h);if(0!==m.length){for(let p=0,v=m.length;p<v;p++)l=m[p],c?a.bufferSubData(f,l.start*h.BYTES_PER_ELEMENT,h,l.start,l.count):a.bufferSubData(f,l.start*h.BYTES_PER_ELEMENT,h.subarray(l.start,l.start+
l.count));k.clearUpdateRanges()}-1!==n.count&&(c?a.bufferSubData(f,n.offset*h.BYTES_PER_ELEMENT,h,n.offset,n.count):a.bufferSubData(f,n.offset*h.BYTES_PER_ELEMENT,h.subarray(n.offset,n.offset+n.count)),n.count=-1);k.onUploadCallback();g.version=e.version}}}}}function Ja(a,b,c,d,e,f,g){function k(x,C){x.getRGB(kf,ya(a));d.buffers.color.setClear(kf.r,kf.g,kf.b,C,g)}const h=new Ya(0);let l=!0===f?0:1,n,m,p=null,v=0,t=null;return{getClearColor:function(){return h},setClearColor:function(x,C=1){h.set(x);
l=C;k(h,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x;k(h,l)},render:function(x,C){let u=!1,D=!0===C.isScene?C.background:null;D&&D.isTexture&&(D=(0<C.backgroundBlurriness?c:b).get(D));null===D?k(h,l):D&&D.isColor&&(k(D,1),u=!0);const aa=a.xr.getEnvironmentBlendMode();"additive"===aa?d.buffers.color.setClear(0,0,0,1,g):"alpha-blend"===aa&&d.buffers.color.setClear(0,0,0,0,g);(a.autoClear||u)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);if(D&&(D.isCubeTexture||
306===D.mapping)){void 0===m&&(m=new dc(new ae(1,1,1),new Mc({name:"BackgroundCubeMaterial",uniforms:Aa(Nc.backgroundCube.uniforms),vertexShader:Nc.backgroundCube.vertexShader,fragmentShader:Nc.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(J,K,U){this.matrixWorld.copyPosition(U.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),
e.update(m));Hc.copy(C.backgroundRotation);Hc.x*=-1;Hc.y*=-1;Hc.z*=-1;D.isCubeTexture&&!1===D.isRenderTargetTexture&&(Hc.y*=-1,Hc.z*=-1);m.material.uniforms.envMap.value=D;m.material.uniforms.flipEnvMap.value=D.isCubeTexture&&!1===D.isRenderTargetTexture?-1:1;m.material.uniforms.backgroundBlurriness.value=C.backgroundBlurriness;m.material.uniforms.backgroundIntensity.value=C.backgroundIntensity;m.material.uniforms.backgroundRotation.value.setFromMatrix4(Ok.makeRotationFromEuler(Hc));m.material.toneMapped=
"srgb"!==Kb.getTransfer(D.colorSpace);if(p!==D||v!==D.version||t!==a.toneMapping)m.material.needsUpdate=!0,p=D,v=D.version,t=a.toneMapping;m.layers.enableAll();x.unshift(m,m.geometry,m.material,0,0,null)}else if(D&&D.isTexture){void 0===n&&(n=new dc(new De(2,2),new Mc({name:"BackgroundMaterial",uniforms:Aa(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),n.geometry.deleteAttribute("normal"),Object.defineProperty(n.material,
"map",{get:function(){return this.uniforms.t2D.value}}),e.update(n));n.material.uniforms.t2D.value=D;n.material.uniforms.backgroundIntensity.value=C.backgroundIntensity;n.material.toneMapped="srgb"!==Kb.getTransfer(D.colorSpace);!0===D.matrixAutoUpdate&&D.updateMatrix();n.material.uniforms.uvTransform.value.copy(D.matrix);if(p!==D||v!==D.version||t!==a.toneMapping)n.material.needsUpdate=!0,p=D,v=D.version,t=a.toneMapping;n.layers.enableAll();x.unshift(n,n.geometry,n.material,0,0,null)}}}}function va(a,
b,c,d){function e(J){return d.isWebGL2?a.bindVertexArray(J):t.bindVertexArrayOES(J)}function f(J){return d.isWebGL2?a.deleteVertexArray(J):t.deleteVertexArrayOES(J)}function g(J){const K=[],U=[],W=[];for(let R=0;R<v;R++)K[R]=0,U[R]=0,W[R]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:K,enabledAttributes:U,attributeDivisors:W,object:J,attributes:{},index:null}}function k(){const J=D.newAttributes;for(let K=0,U=J.length;K<U;K++)J[K]=0}function h(J){l(J,0)}function l(J,K){const U=D.enabledAttributes,
W=D.attributeDivisors;D.newAttributes[J]=1;0===U[J]&&(a.enableVertexAttribArray(J),U[J]=1);W[J]!==K&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](J,K),W[J]=K)}function n(){const J=D.newAttributes,K=D.enabledAttributes;for(let U=0,W=K.length;U<W;U++)K[U]!==J[U]&&(a.disableVertexAttribArray(U),K[U]=0)}function m(){p();aa=!0;D!==u&&(D=u,e(D.object))}function p(){u.geometry=null;u.program=null;u.wireframe=!1}const v=a.getParameter(a.MAX_VERTEX_ATTRIBS),
t=d.isWebGL2?null:b.get("OES_vertex_array_object"),x=d.isWebGL2||null!==t,C={},u=g(null);let D=u,aa=!1;return{setup:function(J,K,U,W,R){var fa=!1;if(x){fa=!0===K.wireframe;var ea=C[W.id];void 0===ea&&(ea={},C[W.id]=ea);var na=ea[U.id];void 0===na&&(na={},ea[U.id]=na);ea=na[fa];void 0===ea&&(ea=g(d.isWebGL2?a.createVertexArray():t.createVertexArrayOES()),na[fa]=ea);fa=ea;D!==fa&&(D=fa,e(D.object));a:{fa=D.attributes;na=W.attributes;ea=0;var Ea=U.getAttributes();for(var ca in Ea)if(0<=Ea[ca].location){var Ga=
fa[ca],ta=na[ca];void 0===ta&&("instanceMatrix"===ca&&J.instanceMatrix&&(ta=J.instanceMatrix),"instanceColor"===ca&&J.instanceColor&&(ta=J.instanceColor));if(void 0===Ga||Ga.attribute!==ta||ta&&Ga.data!==ta.data){fa=!0;break a}ea++}fa=D.attributesNum!==ea||D.index!==R?!0:!1}if(fa){ca={};na=W.attributes;ea=0;Ea=U.getAttributes();for(var Sa in Ea)0<=Ea[Sa].location&&(Ga=na[Sa],void 0===Ga&&("instanceMatrix"===Sa&&J.instanceMatrix&&(Ga=J.instanceMatrix),"instanceColor"===Sa&&J.instanceColor&&(Ga=J.instanceColor)),
ta={},(ta.attribute=Ga)&&Ga.data&&(ta.data=Ga.data),ca[Sa]=ta,ea++);D.attributes=ca;D.attributesNum=ea;D.index=R}}else if(Sa=!0===K.wireframe,D.geometry!==W.id||D.program!==U.id||D.wireframe!==Sa)D.geometry=W.id,D.program=U.id,D.wireframe=Sa,fa=!0;null!==R&&c.update(R,a.ELEMENT_ARRAY_BUFFER);if(fa||aa){aa=!1;if(!1!==d.isWebGL2||!J.isInstancedMesh&&!W.isInstancedBufferGeometry||null!==b.get("ANGLE_instanced_arrays")){k();Sa=W.attributes;U=U.getAttributes();K=K.defaultAttributeValues;for(const A in U)if(ca=
U[A],0<=ca.location){var cb=Sa[A];void 0===cb&&("instanceMatrix"===A&&J.instanceMatrix&&(cb=J.instanceMatrix),"instanceColor"===A&&J.instanceColor&&(cb=J.instanceColor));if(void 0!==cb){if(fa=cb.normalized,na=cb.itemSize,Ea=c.get(cb),void 0!==Ea){var $a=Ea.buffer;ea=Ea.type;Ea=Ea.bytesPerElement;Ga=!0===d.isWebGL2&&(ea===a.INT||ea===a.UNSIGNED_INT||1013===cb.gpuType);if(cb.isInterleavedBufferAttribute){var Ha=cb.data;ta=Ha.stride;cb=cb.offset;if(Ha.isInstancedInterleavedBuffer){for(var Ba=0;Ba<ca.locationSize;Ba++)l(ca.location+
Ba,Ha.meshPerAttribute);!0!==J.isInstancedMesh&&void 0===W._maxInstanceCount&&(W._maxInstanceCount=Ha.meshPerAttribute*Ha.count)}else for(Ha=0;Ha<ca.locationSize;Ha++)h(ca.location+Ha);a.bindBuffer(a.ARRAY_BUFFER,$a);for(let E=0;E<ca.locationSize;E++){$a=ca.location+E;Ha=na/ca.locationSize;Ba=ea;var Ia=fa,Xa=ta*Ea,z=(cb+na/ca.locationSize*E)*Ea;!0===Ga?a.vertexAttribIPointer($a,Ha,Ba,Xa,z):a.vertexAttribPointer($a,Ha,Ba,Ia,Xa,z)}}else{if(cb.isInstancedBufferAttribute){for(ta=0;ta<ca.locationSize;ta++)l(ca.location+
ta,cb.meshPerAttribute);!0!==J.isInstancedMesh&&void 0===W._maxInstanceCount&&(W._maxInstanceCount=cb.meshPerAttribute*cb.count)}else for(ta=0;ta<ca.locationSize;ta++)h(ca.location+ta);a.bindBuffer(a.ARRAY_BUFFER,$a);for(Xa=0;Xa<ca.locationSize;Xa++)ta=ca.location+Xa,cb=na/ca.locationSize,$a=ea,Ha=fa,Ba=na*Ea,Ia=na/ca.locationSize*Xa*Ea,!0===Ga?a.vertexAttribIPointer(ta,cb,$a,Ba,Ia):a.vertexAttribPointer(ta,cb,$a,Ha,Ba,Ia)}}}else if(void 0!==K&&(fa=K[A],void 0!==fa))switch(fa.length){case 2:a.vertexAttrib2fv(ca.location,
fa);break;case 3:a.vertexAttrib3fv(ca.location,fa);break;case 4:a.vertexAttrib4fv(ca.location,fa);break;default:a.vertexAttrib1fv(ca.location,fa)}}n()}null!==R&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c.get(R).buffer)}},reset:m,resetDefaultState:p,dispose:function(){m();for(const J in C){const K=C[J];for(const U in K){const W=K[U];for(const R in W)f(W[R].object),delete W[R];delete K[U]}delete C[J]}},releaseStatesOfGeometry:function(J){if(void 0!==C[J.id]){var K=C[J.id];for(const U in K){const W=K[U];
for(const R in W)f(W[R].object),delete W[R];delete K[U]}delete C[J.id]}},releaseStatesOfProgram:function(J){for(const K in C){const U=C[K];if(void 0===U[J.id])continue;const W=U[J.id];for(const R in W)f(W[R].object),delete W[R];delete U[J.id]}},initAttributes:k,enableAttribute:h,disableUnusedAttributes:n}}function za(a,b,c,d){const e=d.isWebGL2;let f;this.setMode=function(g){f=g};this.render=function(g,k){a.drawArrays(f,g,k);c.update(k,f,1)};this.renderInstances=function(g,k,h){if(0!==h){if(e){var l=
a;var n="drawArraysInstanced"}else if(l=b.get("ANGLE_instanced_arrays"),n="drawArraysInstancedANGLE",null===l){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}l[n](f,g,k,h);c.update(k,f,h)}};this.renderMultiDraw=function(g,k,h){if(0!==h){var l=b.get("WEBGL_multi_draw");if(null===l)for(l=0;l<h;l++)this.render(g[l],k[l]);else{l.multiDrawArraysWEBGL(f,g,0,k,0,h);g=0;for(l=0;l<h;l++)g+=k[l];c.update(g,
f,1)}}}}function Va(a,b,c){function d(J){if("highp"===J){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";J="mediump"}return"mediump"===J&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}let e;const f="undefined"!==typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===a.constructor.name;
let g=void 0!==c.precision?c.precision:"highp";var k=d(g);k!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",k,"instead."),g=k);k=f||b.has("WEBGL_draw_buffers");c=!0===c.logarithmicDepthBuffer;const h=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),l=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),n=a.getParameter(a.MAX_TEXTURE_SIZE),m=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),p=a.getParameter(a.MAX_VERTEX_ATTRIBS),v=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),t=a.getParameter(a.MAX_VARYING_VECTORS),
x=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),C=0<l,u=f||b.has("OES_texture_float"),D=C&&u,aa=f?a.getParameter(a.MAX_SAMPLES):0;return{isWebGL2:f,drawBuffers:k,getMaxAnisotropy:function(){if(void 0!==e)return e;if(!0===b.has("EXT_texture_filter_anisotropic")){const J=b.get("EXT_texture_filter_anisotropic");e=a.getParameter(J.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else e=0;return e},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:l,maxTextureSize:n,maxCubemapSize:m,
maxAttributes:p,maxVertexUniforms:v,maxVaryings:t,maxFragmentUniforms:x,vertexTextures:C,floatFragmentTextures:u,floatVertexTextures:D,maxSamples:aa}}function jb(a){function b(n,m,p,v){const t=null!==n?n.length:0;let x=null;if(0!==t){x=l.value;if(!0!==v||null===x){v=p+4*t;m=m.matrixWorldInverse;h.getNormalMatrix(m);if(null===x||x.length<v)x=new Float32Array(v);for(let C=0,u=p;C!==t;++C,u+=4)k.copy(n[C]).applyMatrix4(m,h),k.normal.toArray(x,u),x[u+3]=k.constant}l.value=x;l.needsUpdate=!0}c.numPlanes=
t;c.numIntersection=0;return x}const c=this;let d=null,e=0,f=!1,g=!1;const k=new od,h=new ob,l={value:null,needsUpdate:!1};this.uniform=l;this.numIntersection=this.numPlanes=0;this.init=function(n,m){const p=0!==n.length||m||0!==e||f;f=m;e=n.length;return p};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1};this.setGlobalState=function(n,m){d=b(n,m,0)};this.setState=function(n,m,p){const v=n.clippingPlanes,t=n.clipIntersection;var x=n.clipShadows;n=a.get(n);if(!f||null===
v||0===v.length||g&&!x)g?b(null):(l.value!==d&&(l.value=d,l.needsUpdate=0<e),c.numPlanes=e,c.numIntersection=0);else{x=g?0:e;const C=4*x;let u=n.clippingState||null;l.value=u;u=b(v,m,C,p);for(m=0;m!==C;++m)u[m]=d[m];n.clippingState=u;this.numIntersection=t?this.numPlanes:0;this.numPlanes+=x}}}function kb(a){function b(e,f){303===f?e.mapping=301:304===f&&(e.mapping=302);return e}function c(e){e=e.target;e.removeEventListener("dispose",c);const f=d.get(e);void 0!==f&&(d.delete(e),f.dispose())}let d=
new WeakMap;return{get:function(e){if(e&&e.isTexture){var f=e.mapping;if(303===f||304===f)return d.has(e)?(f=d.get(e).texture,b(f,e.mapping)):(f=e.image)&&0<f.height?(f=new $h(f.height),f.fromEquirectangularTexture(a,e),d.set(e,f),e.addEventListener("dispose",c),b(f.texture,e.mapping)):null}return e},dispose:function(){d=new WeakMap}}}function wb(a,b,c){a=new Oc(a,b,c);a.texture.mapping=306;a.texture.name="PMREM.cubeUv";a.scissorTest=!0;return a}function fb(a,b,c,d,e){a.viewport.set(b,c,d,e);a.scissor.set(b,
c,d,e)}function ub(){return new Mc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Zb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include \x3ccommon\x3e\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection \x3d normalize( vOutputDirection );\n\t\t\t\tvec2 uv \x3d equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor \x3d vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function vb(){return new Mc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Zb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor \x3d textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function Zb(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv \x3d 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction \x3d vec3( uv, 1.0 );\n\n\t\t\tif ( face \x3d\x3d 0.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face \x3d\x3d 1.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face \x3d\x3d 2.0 ) {\n\n\t\t\t\tdirection.x *\x3d -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face \x3d\x3d 3.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face \x3d\x3d 4.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xy *\x3d -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face \x3d\x3d 5.0 ) {\n\n\t\t\t\tdirection.z *\x3d -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection \x3d getDirection( uv, faceIndex );\n\t\t\tgl_Position \x3d vec4( position, 1.0 );\n\n\t\t}\n\t"}
function Ob(a){function b(e){e=e.target;e.removeEventListener("dispose",b);const f=c.get(e);void 0!==f&&(c.delete(e),f.dispose())}let c=new WeakMap,d=null;return{get:function(e){if(e&&e.isTexture){var f=e.mapping,g=303===f||304===f,k=301===f||302===f;if(g||k){if(e.isRenderTargetTexture&&!0===e.needsPMREMUpdate)return e.needsPMREMUpdate=!1,f=c.get(e),null===d&&(d=new lg(a)),f=g?d.fromEquirectangular(e,f):d.fromCubemap(e,f),c.set(e,f),f.texture;if(c.has(e))return c.get(e).texture;f=e.image;var h;if(!(h=
g&&f&&0<f.height)&&(h=k&&f)){h=0;for(k=0;6>k;k++)void 0!==f[k]&&h++;h=6===h}return h?(null===d&&(d=new lg(a)),g=g?d.fromEquirectangular(e):d.fromCubemap(e),c.set(e,g),e.addEventListener("dispose",b),g.texture):null}}return e},dispose:function(){c=new WeakMap;null!==d&&(d.dispose(),d=null)}}}function Hb(a){function b(d){if(void 0!==c[d])return c[d];let e;switch(d){case "WEBGL_depth_texture":e=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");
break;case "EXT_texture_filter_anisotropic":e=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":e=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":e=a.getExtension("WEBGL_compressed_texture_pvrtc")||
a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=a.getExtension(d)}return c[d]=e}const c={};return{has:function(d){return null!==b(d)},init:function(d){d.isWebGL2?(b("EXT_color_buffer_float"),b("WEBGL_clip_cull_distance")):(b("WEBGL_depth_texture"),b("OES_texture_float"),b("OES_texture_half_float"),b("OES_texture_half_float_linear"),b("OES_standard_derivatives"),b("OES_element_index_uint"),b("OES_vertex_array_object"),b("ANGLE_instanced_arrays"));b("OES_texture_float_linear");
b("EXT_color_buffer_half_float");b("WEBGL_multisampled_render_to_texture")},get:function(d){const e=b(d);null===e&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported.");return e}}}function Sb(a,b,c,d){function e(h){h=h.target;null!==h.index&&b.remove(h.index);for(var l in h.attributes)b.remove(h.attributes[l]);for(var n in h.morphAttributes){l=h.morphAttributes[n];for(let m=0,p=l.length;m<p;m++)b.remove(l[m])}h.removeEventListener("dispose",e);delete g[h.id];if(n=k.get(h))b.remove(n),
k.delete(h);d.releaseStatesOfGeometry(h);!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount;c.memory.geometries--}function f(h){var l=[],n=h.index,m=h.attributes.position;if(null!==n){m=n.array;n=n.version;for(let t=0,x=m.length;t<x;t+=3){var p=m[t+0],v=m[t+1];const C=m[t+2];l.push(p,v,v,C,C,p)}}else if(void 0!==m){p=m.array;n=m.version;for(let t=0,x=p.length/3-1;t<x;t+=3)m=t+0,p=t+1,v=t+2,l.push(m,p,p,v,v,m)}else return;l=new (Tb(l)?mg:ng)(l,1);l.version=n;(n=k.get(h))&&b.remove(n);k.set(h,
l)}const g={},k=new WeakMap;return{get:function(h,l){if(!0===g[l.id])return l;l.addEventListener("dispose",e);g[l.id]=!0;c.memory.geometries++;return l},update:function(h){var l=h.attributes;for(const n in l)b.update(l[n],a.ARRAY_BUFFER);h=h.morphAttributes;for(const n in h){l=h[n];for(let m=0,p=l.length;m<p;m++)b.update(l[m],a.ARRAY_BUFFER)}},getWireframeAttribute:function(h){const l=k.get(h);if(l){const n=h.index;null!==n&&l.version<n.version&&f(h)}else f(h);return k.get(h)}}}function ec(a,b,c,
d){const e=d.isWebGL2;let f,g,k;this.setMode=function(h){f=h};this.setIndex=function(h){g=h.type;k=h.bytesPerElement};this.render=function(h,l){a.drawElements(f,l,g,h*k);c.update(l,f,1)};this.renderInstances=function(h,l,n){if(0!==n){if(e){var m=a;var p="drawElementsInstanced"}else if(m=b.get("ANGLE_instanced_arrays"),p="drawElementsInstancedANGLE",null===m){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}m[p](f,l,g,h*k,n);c.update(l,f,n)}};this.renderMultiDraw=function(h,l,n){if(0!==n){var m=b.get("WEBGL_multi_draw");if(null===m)for(m=0;m<n;m++)this.render(h[m]/k,l[m]);else{m.multiDrawElementsWEBGL(f,l,0,g,h,0,n);h=0;for(m=0;m<n;m++)h+=l[m];c.update(h,f,1)}}}}function rb(a){const b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(c,d,e){b.calls++;
switch(d){case a.TRIANGLES:b.triangles+=c/3*e;break;case a.LINES:b.lines+=c/2*e;break;case a.LINE_STRIP:b.lines+=e*(c-1);break;case a.LINE_LOOP:b.lines+=e*c;break;case a.POINTS:b.points+=e*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Rb(a,b){return a[0]-b[0]}function vc(a,b){return Math.abs(b[1])-Math.abs(a[1])}function pc(a,b,c){const d={},e=new Float32Array(8),f=new WeakMap,g=new Mb,k=[];for(let h=0;8>h;h++)k[h]=[h,0];return{update:function(h,l,n){var m=h.morphTargetInfluences;
if(!0===b.isWebGL2){var p=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color;p=void 0!==p?p.length:0;var v=f.get(l);if(void 0===v||v.count!==p){void 0!==v&&v.texture.dispose();v=void 0!==l.morphAttributes.position;var t=void 0!==l.morphAttributes.normal,x=void 0!==l.morphAttributes.color;const u=l.morphAttributes.position||[],D=l.morphAttributes.normal||[],aa=l.morphAttributes.color||[];var C=0;!0===v&&(C=1);!0===t&&(C=2);!0===x&&(C=3);let J=l.attributes.position.count*
C,K=1;J>b.maxTextureSize&&(K=Math.ceil(J/b.maxTextureSize),J=b.maxTextureSize);const U=new Float32Array(J*K*4*p),W=new lf(U,J,K,p);W.type=1015;W.needsUpdate=!0;C*=4;for(let fa=0;fa<p;fa++){const ea=u[fa],na=D[fa],Ea=aa[fa],ca=J*K*4*fa;for(let Ga=0;Ga<ea.count;Ga++){const ta=Ga*C;!0===v&&(g.fromBufferAttribute(ea,Ga),U[ca+ta+0]=g.x,U[ca+ta+1]=g.y,U[ca+ta+2]=g.z,U[ca+ta+3]=0);!0===t&&(g.fromBufferAttribute(na,Ga),U[ca+ta+4]=g.x,U[ca+ta+5]=g.y,U[ca+ta+6]=g.z,U[ca+ta+7]=0);!0===x&&(g.fromBufferAttribute(Ea,
Ga),U[ca+ta+8]=g.x,U[ca+ta+9]=g.y,U[ca+ta+10]=g.z,U[ca+ta+11]=4===Ea.itemSize?g.w:1)}}v={count:p,texture:W,size:new xa(J,K)};f.set(l,v);function R(){W.dispose();f.delete(l);l.removeEventListener("dispose",R)}l.addEventListener("dispose",R)}if(!0===h.isInstancedMesh&&null!==h.morphTexture)n.getUniforms().setValue(a,"morphTexture",h.morphTexture,c);else{h=0;for(p=0;p<m.length;p++)h+=m[p];h=l.morphTargetsRelative?1:1-h;n.getUniforms().setValue(a,"morphTargetBaseInfluence",h);n.getUniforms().setValue(a,
"morphTargetInfluences",m)}n.getUniforms().setValue(a,"morphTargetsTexture",v.texture,c);n.getUniforms().setValue(a,"morphTargetsTextureSize",v.size)}else{h=void 0===m?0:m.length;p=d[l.id];if(void 0===p||p.length!==h){p=[];for(v=0;v<h;v++)p[v]=[v,0];d[l.id]=p}for(v=0;v<h;v++)t=p[v],t[0]=v,t[1]=m[v];p.sort(vc);for(m=0;8>m;m++)m<h&&p[m][1]?(k[m][0]=p[m][0],k[m][1]=p[m][1]):(k[m][0]=Number.MAX_SAFE_INTEGER,k[m][1]=0);k.sort(Rb);m=l.morphAttributes.position;h=l.morphAttributes.normal;p=0;for(v=0;8>v;v++)x=
k[v],t=x[0],x=x[1],t!==Number.MAX_SAFE_INTEGER&&x?(m&&l.getAttribute("morphTarget"+v)!==m[t]&&l.setAttribute("morphTarget"+v,m[t]),h&&l.getAttribute("morphNormal"+v)!==h[t]&&l.setAttribute("morphNormal"+v,h[t]),e[v]=x,p+=x):(m&&!0===l.hasAttribute("morphTarget"+v)&&l.deleteAttribute("morphTarget"+v),h&&!0===l.hasAttribute("morphNormal"+v)&&l.deleteAttribute("morphNormal"+v),e[v]=0);m=l.morphTargetsRelative?1:1-p;n.getUniforms().setValue(a,"morphTargetBaseInfluence",m);n.getUniforms().setValue(a,"morphTargetInfluences",
e)}}}}function ic(a,b,c,d){function e(g){g=g.target;g.removeEventListener("dispose",e);c.remove(g.instanceMatrix);null!==g.instanceColor&&c.remove(g.instanceColor)}let f=new WeakMap;return{update:function(g){const k=d.render.frame,h=b.get(g,g.geometry);f.get(h)!==k&&(b.update(h),f.set(h,k));g.isInstancedMesh&&(!1===g.hasEventListener("dispose",e)&&g.addEventListener("dispose",e),f.get(g)!==k&&(c.update(g.instanceMatrix,a.ARRAY_BUFFER),null!==g.instanceColor&&c.update(g.instanceColor,a.ARRAY_BUFFER),
f.set(g,k)));g.isSkinnedMesh&&(g=g.skeleton,f.get(g)!==k&&(g.update(),f.set(g,k)));return h},dispose:function(){f=new WeakMap}}}function Bc(a,b,c){const d=a[0];if(0>=d||0<d)return a;const e=b*c;let f=ai[e];void 0===f&&(f=new Float32Array(e),ai[e]=f);if(0!==b){d.toArray(f,0);for(let g=1,k=0;g!==b;++g)k+=c,a[g].toArray(f,k)}return f}function Bb(a,b){if(a.length!==b.length)return!1;for(let c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function Cb(a,b){for(let c=0,d=b.length;c<d;c++)a[c]=b[c]}
function q(a,b){let c=bi[b];void 0===c&&(c=new Int32Array(b),bi[b]=c);for(let d=0;d!==b;++d)c[d]=a.allocateTextureUnit();return c}function y(a,b){const c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function F(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else Bb(c,b)||(a.uniform2fv(this.addr,b),Cb(c,b))}function w(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)a.uniform3f(this.addr,b.x,
b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else if(void 0!==b.r){if(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b}else Bb(c,b)||(a.uniform3fv(this.addr,b),Cb(c,b))}function G(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else Bb(c,b)||(a.uniform4fv(this.addr,b),Cb(c,b))}function N(a,b){const c=this.cache,d=b.elements;void 0===d?Bb(c,b)||
(a.uniformMatrix2fv(this.addr,!1,b),Cb(c,b)):Bb(c,d)||(ci.set(d),a.uniformMatrix2fv(this.addr,!1,ci),Cb(c,d))}function L(a,b){const c=this.cache,d=b.elements;void 0===d?Bb(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),Cb(c,b)):Bb(c,d)||(di.set(d),a.uniformMatrix3fv(this.addr,!1,di),Cb(c,d))}function ba(a,b){const c=this.cache,d=b.elements;void 0===d?Bb(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),Cb(c,b)):Bb(c,d)||(ei.set(d),a.uniformMatrix4fv(this.addr,!1,ei),Cb(c,d))}function da(a,b){const c=this.cache;
c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function Da(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2i(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else Bb(c,b)||(a.uniform2iv(this.addr,b),Cb(c,b))}function Oa(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)a.uniform3i(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else Bb(c,b)||(a.uniform3iv(this.addr,b),Cb(c,b))}function hb(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||
c[2]!==b.z||c[3]!==b.w)a.uniform4i(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else Bb(c,b)||(a.uniform4iv(this.addr,b),Cb(c,b))}function zb(a,b){const c=this.cache;c[0]!==b&&(a.uniform1ui(this.addr,b),c[0]=b)}function xb(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2ui(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else Bb(c,b)||(a.uniform2uiv(this.addr,b),Cb(c,b))}function sb(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)a.uniform3ui(this.addr,
b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else Bb(c,b)||(a.uniform3uiv(this.addr,b),Cb(c,b))}function hc(a,b){const c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4ui(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else Bb(c,b)||(a.uniform4uiv(this.addr,b),Cb(c,b))}function Pc(a,b,c){const d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);a=this.type===a.SAMPLER_2D_SHADOW?fi:gi;c.setTexture2D(b||a,e)}function Ic(a,
b,c){const d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture3D(b||hi,e)}function og(a,b,c){const d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTextureCube(b||ii,e)}function pg(a,b,c){const d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2DArray(b||ji,e)}function qg(a){switch(a){case 5126:return y;case 35664:return F;case 35665:return w;case 35666:return G;case 35674:return N;
case 35675:return L;case 35676:return ba;case 5124:case 35670:return da;case 35667:case 35671:return Da;case 35668:case 35672:return Oa;case 35669:case 35673:return hb;case 5125:return zb;case 36294:return xb;case 36295:return sb;case 36296:return hc;case 35678:case 36198:case 36298:case 36306:case 35682:return Pc;case 35679:case 36299:case 36307:return Ic;case 35680:case 36300:case 36308:case 36293:return og;case 36289:case 36303:case 36311:case 36292:return pg}}function rg(a,b){a.uniform1fv(this.addr,
b)}function Pk(a,b){b=Bc(b,this.size,2);a.uniform2fv(this.addr,b)}function Qk(a,b){b=Bc(b,this.size,3);a.uniform3fv(this.addr,b)}function Rk(a,b){b=Bc(b,this.size,4);a.uniform4fv(this.addr,b)}function Sk(a,b){b=Bc(b,this.size,4);a.uniformMatrix2fv(this.addr,!1,b)}function Tk(a,b){b=Bc(b,this.size,9);a.uniformMatrix3fv(this.addr,!1,b)}function Uk(a,b){b=Bc(b,this.size,16);a.uniformMatrix4fv(this.addr,!1,b)}function Vk(a,b){a.uniform1iv(this.addr,b)}function Wk(a,b){a.uniform2iv(this.addr,b)}function Xk(a,
b){a.uniform3iv(this.addr,b)}function Yk(a,b){a.uniform4iv(this.addr,b)}function Zk(a,b){a.uniform1uiv(this.addr,b)}function $k(a,b){a.uniform2uiv(this.addr,b)}function al(a,b){a.uniform3uiv(this.addr,b)}function bl(a,b){a.uniform4uiv(this.addr,b)}function cl(a,b,c){const d=this.cache,e=b.length,f=q(c,e);Bb(d,f)||(a.uniform1iv(this.addr,f),Cb(d,f));for(a=0;a!==e;++a)c.setTexture2D(b[a]||gi,f[a])}function dl(a,b,c){const d=this.cache,e=b.length,f=q(c,e);Bb(d,f)||(a.uniform1iv(this.addr,f),Cb(d,f));
for(a=0;a!==e;++a)c.setTexture3D(b[a]||hi,f[a])}function el(a,b,c){const d=this.cache,e=b.length,f=q(c,e);Bb(d,f)||(a.uniform1iv(this.addr,f),Cb(d,f));for(a=0;a!==e;++a)c.setTextureCube(b[a]||ii,f[a])}function fl(a,b,c){const d=this.cache,e=b.length,f=q(c,e);Bb(d,f)||(a.uniform1iv(this.addr,f),Cb(d,f));for(a=0;a!==e;++a)c.setTexture2DArray(b[a]||ji,f[a])}function gl(a){switch(a){case 5126:return rg;case 35664:return Pk;case 35665:return Qk;case 35666:return Rk;case 35674:return Sk;case 35675:return Tk;
case 35676:return Uk;case 5124:case 35670:return Vk;case 35667:case 35671:return Wk;case 35668:case 35672:return Xk;case 35669:case 35673:return Yk;case 5125:return Zk;case 36294:return $k;case 36295:return al;case 36296:return bl;case 35678:case 36198:case 36298:case 36306:case 35682:return cl;case 35679:case 36299:case 36307:return dl;case 35680:case 36300:case 36308:case 36293:return el;case 36289:case 36303:case 36311:case 36292:return fl}}function ki(a,b,c){b=a.createShader(b);a.shaderSource(b,
c);a.compileShader(b);return b}function li(a,b,c){var d=a.getShaderParameter(b,a.COMPILE_STATUS),e=a.getShaderInfoLog(b).trim();if(d&&""===e)return"";if(d=/ERROR: 0:(\d+)/.exec(e)){d=parseInt(d[1]);c=c.toUpperCase()+"\n\n"+e+"\n\n";a=a.getShaderSource(b).split("\n");b=[];var f=Math.max(d-6,0);for(e=Math.min(d+6,a.length);f<e;f++){const g=f+1;b.push(`${g===d?"\x3e":" "} ${g}: ${a[f]}`)}d=b.join("\n");return c+d}return e}function hl(a,b){a:{const c=Kb.getPrimaries(Kb.workingColorSpace),d=Kb.getPrimaries(b);
let e;c===d?e="":"p3"===c&&"rec709"===d?e="LinearDisplayP3ToLinearSRGB":"rec709"===c&&"p3"===d&&(e="LinearSRGBToLinearDisplayP3");switch(b){case "srgb-linear":case "display-p3-linear":b=[e,"LinearTransferOETF"];break a;case "srgb":case "display-p3":b=[e,"sRGBTransferOETF"];break a;default:console.warn("THREE.WebGLProgram: Unsupported color space:",b),b=[e,"LinearTransferOETF"]}}return`vec4 ${a}( vec4 value ) { return ${b[0]}( ${b[1]}( value ) ); }`}function il(a,b){switch(b){case 1:b="Linear";break;
case 2:b="Reinhard";break;case 3:b="OptimizedCineon";break;case 4:b="ACESFilmic";break;case 6:b="AgX";break;case 7:b="Neutral";break;case 5:b="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",b),b="Linear"}return"vec3 "+a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function jl(a){const b=[];for(const c in a){const d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function be(a){return""!==a}function mi(a,b){const c=b.numSpotLightShadows+b.numSpotLightMaps-
b.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,b.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,c).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,b.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,b.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,
b.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,b.numPointLightShadows)}function ni(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function sg(a,b){a=pb[b];if(void 0===a){const c=kl.get(b);if(void 0!==c)a=pb[c],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',b,c);else throw Error("Can not resolve #include \x3c"+b+"\x3e");}return a.replace(tg,sg)}function oi(a,
b,c,d){a="";for(b=parseInt(b);b<parseInt(c);b++)a+=d.replace(/\[\s*i\s*\]/g,"[ "+b+" ]").replace(/UNROLLED_LOOP_INDEX/g,b);return a}function pi(a){let b=`precision ${a.precision} float;
	precision ${a.precision} int;
	precision ${a.precision} sampler2D;
	precision ${a.precision} samplerCube;
	`;a.isWebGL2&&(b+=`precision ${a.precision} sampler3D;
		precision ${a.precision} sampler2DArray;
		precision ${a.precision} sampler2DShadow;
		precision ${a.precision} samplerCubeShadow;
		precision ${a.precision} sampler2DArrayShadow;
		precision ${a.precision} isampler2D;
		precision ${a.precision} isampler3D;
		precision ${a.precision} isamplerCube;
		precision ${a.precision} isampler2DArray;
		precision ${a.precision} usampler2D;
		precision ${a.precision} usampler3D;
		precision ${a.precision} usamplerCube;
		precision ${a.precision} usampler2DArray;
		`);"highp"===a.precision?b+="\n#define HIGH_PRECISION":"mediump"===a.precision?b+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(b+="\n#define LOW_PRECISION");return b}function ll(a){let b="SHADOWMAP_TYPE_BASIC";1===a.shadowMapType?b="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?b="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(b="SHADOWMAP_TYPE_VSM");return b}function ml(a){let b="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:b="ENVMAP_TYPE_CUBE";break;case 306:b="ENVMAP_TYPE_CUBE_UV"}return b}
function nl(a){let b="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:b="ENVMAP_MODE_REFRACTION"}return b}function ol(a){let b="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:b="ENVMAP_BLENDING_MULTIPLY";break;case 1:b="ENVMAP_BLENDING_MIX";break;case 2:b="ENVMAP_BLENDING_ADD"}return b}function pl(a){a=a.envMapCubeUVHeight;if(null===a)return null;const b=Math.log2(a)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,b),112)),texelHeight:1/a,maxMip:b}}function ql(a,b,c,d){function e(fa){if(a.debug.checkShaderErrors){var ea=
f.getProgramInfoLog(u).trim(),na=f.getShaderInfoLog(J).trim(),Ea=f.getShaderInfoLog(K).trim(),ca=!0,Ga=!0;if(!1===f.getProgramParameter(u,f.LINK_STATUS))if(ca=!1,"function"===typeof a.debug.onShaderError)a.debug.onShaderError(f,u,J,K);else{const ta=li(f,J,"vertex"),Sa=li(f,K,"fragment");console.error("THREE.WebGLProgram: Shader Error "+f.getError()+" - VALIDATE_STATUS "+f.getProgramParameter(u,f.VALIDATE_STATUS)+"\n\nMaterial Name: "+fa.name+"\nMaterial Type: "+fa.type+"\n\nProgram Info Log: "+ea+
"\n"+ta+"\n"+Sa)}else if(""!==ea)console.warn("THREE.WebGLProgram: Program Info Log:",ea);else if(""===na||""===Ea)Ga=!1;Ga&&(fa.diagnostics={runnable:ca,programLog:ea,vertexShader:{log:na,prefix:D},fragmentShader:{log:Ea,prefix:aa}})}f.deleteShader(J);f.deleteShader(K);U=new mf(f,u);fa={};ea=f.getProgramParameter(u,f.ACTIVE_ATTRIBUTES);for(na=0;na<ea;na++)Ea=f.getActiveAttrib(u,na),ca=Ea.name,Ga=1,Ea.type===f.FLOAT_MAT2&&(Ga=2),Ea.type===f.FLOAT_MAT3&&(Ga=3),Ea.type===f.FLOAT_MAT4&&(Ga=4),fa[ca]=
{type:Ea.type,location:f.getAttribLocation(u,ca),locationSize:Ga};W=fa}const f=a.getContext();var g=c.defines;let k=c.vertexShader;var h=c.fragmentShader;const l=ll(c),n=ml(c),m=nl(c),p=ol(c),v=pl(c),t=c.isWebGL2?"":[c.extensionDerivatives||c.envMapCubeUVHeight||c.bumpMap||c.normalMapTangentSpace||c.clearcoatNormalMap||c.flatShading||c.alphaToCoverage||"physical"===c.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(c.extensionFragDepth||c.logarithmicDepthBuffer)&&c.rendererExtensionFragDepth?
"#extension GL_EXT_frag_depth : enable":"",c.extensionDrawBuffers&&c.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(c.extensionShaderTextureLOD||c.envMap||c.transmission)&&c.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(be).join("\n"),x=[c.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",c.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(be).join("\n"),C=jl(g),u=f.createProgram();
let D,aa;g=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(D=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,C].filter(be).join("\n"),0<D.length&&(D+="\n"),aa=[t,"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,C].filter(be).join("\n"),0<aa.length&&(aa+="\n")):(D=[pi(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,C,c.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",c.batching?"#define USE_BATCHING":
"",c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.instancingMorph?"#define USE_INSTANCING_MORPH":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+m:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":
"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.displacementMap?"#define USE_DISPLACEMENTMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":
"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":
"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.mapUv?"#define MAP_UV "+c.mapUv:"",c.alphaMapUv?"#define ALPHAMAP_UV "+c.alphaMapUv:"",c.lightMapUv?"#define LIGHTMAP_UV "+c.lightMapUv:"",c.aoMapUv?"#define AOMAP_UV "+c.aoMapUv:"",c.emissiveMapUv?"#define EMISSIVEMAP_UV "+c.emissiveMapUv:"",c.bumpMapUv?"#define BUMPMAP_UV "+c.bumpMapUv:"",c.normalMapUv?"#define NORMALMAP_UV "+c.normalMapUv:"",c.displacementMapUv?"#define DISPLACEMENTMAP_UV "+c.displacementMapUv:"",c.metalnessMapUv?"#define METALNESSMAP_UV "+
c.metalnessMapUv:"",c.roughnessMapUv?"#define ROUGHNESSMAP_UV "+c.roughnessMapUv:"",c.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+c.anisotropyMapUv:"",c.clearcoatMapUv?"#define CLEARCOATMAP_UV "+c.clearcoatMapUv:"",c.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+c.clearcoatNormalMapUv:"",c.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+c.clearcoatRoughnessMapUv:"",c.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+c.iridescenceMapUv:"",c.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+
c.iridescenceThicknessMapUv:"",c.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+c.sheenColorMapUv:"",c.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+c.sheenRoughnessMapUv:"",c.specularMapUv?"#define SPECULARMAP_UV "+c.specularMapUv:"",c.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+c.specularColorMapUv:"",c.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+c.specularIntensityMapUv:"",c.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+c.transmissionMapUv:"",c.thicknessMapUv?"#define THICKNESSMAP_UV "+
c.thicknessMapUv:"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphColors&&
c.isWebGL2?"#define USE_MORPHCOLORS":"",0<c.morphTargetsCount&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",0<c.morphTargetsCount&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+c.morphTextureStride:"",0<c.morphTargetsCount&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+l:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",0<
c.numLightProbes?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;",
"#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )",
"\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) \x26\x26 ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;",
"\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(be).join("\n"),aa=[t,pi(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,C,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+
n:"",c.envMap?"#define "+m:"",c.envMap?"#define "+p:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.emissiveMap?"#define USE_EMISSIVEMAP":
"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescence?"#define USE_IRIDESCENCE":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?
"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":
"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":
"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+l:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",0<c.numLightProbes?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",
0!==c.toneMapping?"#define TONE_MAPPING":"",0!==c.toneMapping?pb.tonemapping_pars_fragment:"",0!==c.toneMapping?il("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.opaque?"#define OPAQUE":"",pb.colorspace_pars_fragment,hl("linearToOutputTexel",c.outputColorSpace),c.useDepthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(be).join("\n"));k=k.replace(tg,sg);k=mi(k,c);k=ni(k,c);h=h.replace(tg,sg);h=mi(h,c);h=ni(h,c);k=k.replace(qi,oi);h=h.replace(qi,oi);c.isWebGL2&&
!0!==c.isRawShaderMaterial&&(g="#version 300 es\n",D=[x,"precision mediump sampler2DArray;\n#define attribute in\n#define varying out\n#define texture2D texture"].join("\n")+"\n"+D,aa=["precision mediump sampler2DArray;\n#define varying in","300 es"===c.glslVersion?"":"layout(location \x3d 0) out highp vec4 pc_fragColor;","300 es"===c.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+aa);h=g+aa+h;const J=ki(f,f.VERTEX_SHADER,g+D+k),K=ki(f,f.FRAGMENT_SHADER,h);f.attachShader(u,J);f.attachShader(u,K);void 0!==c.index0AttributeName?f.bindAttribLocation(u,0,c.index0AttributeName):!0===c.morphTargets&&f.bindAttribLocation(u,0,"position");f.linkProgram(u);let U;this.getUniforms=function(){void 0===U&&e(this);return U};let W;this.getAttributes=function(){void 0===W&&e(this);return W};let R=!1===c.rendererExtensionParallelShaderCompile;this.isReady=function(){!1===R&&(R=f.getProgramParameter(u,
37297));return R};this.destroy=function(){d.releaseStatesOfProgram(this);f.deleteProgram(u);this.program=void 0};this.type=c.shaderType;this.name=c.shaderName;this.id=rl++;this.cacheKey=b;this.usedTimes=1;this.program=u;this.vertexShader=J;this.fragmentShader=K;return this}function sl(a,b,c,d,e,f,g){function k(u){n.add(u);return 0===u?"uv":`uv${u}`}const h=new nf,l=new tl,n=new Set,m=[],p=e.isWebGL2,v=e.logarithmicDepthBuffer,t=e.vertexTextures;let x=e.precision;const C={MeshDepthMaterial:"depth",
MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(u,D,aa,J,K){const U=J.fog,W=K.geometry;J=u.isMeshStandardMaterial?J.environment:null;
const R=(J=(u.isMeshStandardMaterial?c:b).get(u.envMap||J))&&306===J.mapping?J.image.height:null,fa=C[u.type];null!==u.precision&&(x=e.getMaxPrecision(u.precision),x!==u.precision&&console.warn("THREE.WebGLProgram.getParameters:",u.precision,"not supported, using",x,"instead."));var ea=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color;ea=void 0!==ea?ea.length:0;let na=0;void 0!==W.morphAttributes.position&&(na=1);void 0!==W.morphAttributes.normal&&(na=2);void 0!==W.morphAttributes.color&&
(na=3);let Ea;let ca,Ga;if(fa){var ta=Nc[fa];Ea=ta.vertexShader;ta=ta.fragmentShader}else Ea=u.vertexShader,ta=u.fragmentShader,l.update(u),ca=l.getVertexShaderID(u),Ga=l.getFragmentShaderID(u);const Sa=a.getRenderTarget(),cb=!0===K.isInstancedMesh,$a=!0===K.isBatchedMesh,Ha=!!u.map,Ba=!!u.matcap,Ia=!!J,Xa=!!u.aoMap,z=!!u.lightMap,A=!!u.bumpMap,E=!!u.normalMap,O=!!u.displacementMap,M=!!u.emissiveMap,ra=!!u.metalnessMap,Pa=!!u.roughnessMap,Fa=0<u.anisotropy,oa=0<u.clearcoat,H=0<u.iridescence,sa=0<
u.sheen,ia=0<u.transmission,Ka=Fa&&!!u.anisotropyMap,Ta=oa&&!!u.clearcoatMap,mb=oa&&!!u.clearcoatNormalMap,db=oa&&!!u.clearcoatRoughnessMap,Ib=H&&!!u.iridescenceMap,jc=H&&!!u.iridescenceThicknessMap,Jb=sa&&!!u.sheenColorMap,Ub=sa&&!!u.sheenRoughnessMap,wc=!!u.specularMap,pd=!!u.specularColorMap,Qc=!!u.specularIntensityMap,ce=ia&&!!u.transmissionMap,ka=ia&&!!u.thicknessMap,Xb=!!u.gradientMap,Lb=!!u.alphaMap,Db=0<u.alphaTest,Ec=!!u.alphaHash,Eb=!!u.extensions;let Pb=0;!u.toneMapped||null!==Sa&&!0!==
Sa.isXRRenderTarget||(Pb=a.toneMapping);u={isWebGL2:p,shaderID:fa,shaderType:u.type,shaderName:u.name,vertexShader:Ea,fragmentShader:ta,defines:u.defines,customVertexShaderID:ca,customFragmentShaderID:Ga,isRawShaderMaterial:!0===u.isRawShaderMaterial,glslVersion:u.glslVersion,precision:x,batching:$a,instancing:cb,instancingColor:cb&&null!==K.instanceColor,instancingMorph:cb&&null!==K.morphTexture,supportsVertexTextures:t,outputColorSpace:null===Sa?a.outputColorSpace:!0===Sa.isXRRenderTarget?Sa.texture.colorSpace:
"srgb-linear",alphaToCoverage:!!u.alphaToCoverage,map:Ha,matcap:Ba,envMap:Ia,envMapMode:Ia&&J.mapping,envMapCubeUVHeight:R,aoMap:Xa,lightMap:z,bumpMap:A,normalMap:E,displacementMap:t&&O,emissiveMap:M,normalMapObjectSpace:E&&1===u.normalMapType,normalMapTangentSpace:E&&0===u.normalMapType,metalnessMap:ra,roughnessMap:Pa,anisotropy:Fa,anisotropyMap:Ka,clearcoat:oa,clearcoatMap:Ta,clearcoatNormalMap:mb,clearcoatRoughnessMap:db,iridescence:H,iridescenceMap:Ib,iridescenceThicknessMap:jc,sheen:sa,sheenColorMap:Jb,
sheenRoughnessMap:Ub,specularMap:wc,specularColorMap:pd,specularIntensityMap:Qc,transmission:ia,transmissionMap:ce,thicknessMap:ka,gradientMap:Xb,opaque:!1===u.transparent&&1===u.blending&&!1===u.alphaToCoverage,alphaMap:Lb,alphaTest:Db,alphaHash:Ec,combine:u.combine,mapUv:Ha&&k(u.map.channel),aoMapUv:Xa&&k(u.aoMap.channel),lightMapUv:z&&k(u.lightMap.channel),bumpMapUv:A&&k(u.bumpMap.channel),normalMapUv:E&&k(u.normalMap.channel),displacementMapUv:O&&k(u.displacementMap.channel),emissiveMapUv:M&&
k(u.emissiveMap.channel),metalnessMapUv:ra&&k(u.metalnessMap.channel),roughnessMapUv:Pa&&k(u.roughnessMap.channel),anisotropyMapUv:Ka&&k(u.anisotropyMap.channel),clearcoatMapUv:Ta&&k(u.clearcoatMap.channel),clearcoatNormalMapUv:mb&&k(u.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:db&&k(u.clearcoatRoughnessMap.channel),iridescenceMapUv:Ib&&k(u.iridescenceMap.channel),iridescenceThicknessMapUv:jc&&k(u.iridescenceThicknessMap.channel),sheenColorMapUv:Jb&&k(u.sheenColorMap.channel),sheenRoughnessMapUv:Ub&&
k(u.sheenRoughnessMap.channel),specularMapUv:wc&&k(u.specularMap.channel),specularColorMapUv:pd&&k(u.specularColorMap.channel),specularIntensityMapUv:Qc&&k(u.specularIntensityMap.channel),transmissionMapUv:ce&&k(u.transmissionMap.channel),thicknessMapUv:ka&&k(u.thicknessMap.channel),alphaMapUv:Lb&&k(u.alphaMap.channel),vertexTangents:!!W.attributes.tangent&&(E||Fa),vertexColors:u.vertexColors,vertexAlphas:!0===u.vertexColors&&!!W.attributes.color&&4===W.attributes.color.itemSize,pointsUvs:!0===K.isPoints&&
!!W.attributes.uv&&(Ha||Lb),fog:!!U,useFog:!0===u.fog,fogExp2:!!U&&U.isFogExp2,flatShading:!0===u.flatShading,sizeAttenuation:!0===u.sizeAttenuation,logarithmicDepthBuffer:v,skinning:!0===K.isSkinnedMesh,morphTargets:void 0!==W.morphAttributes.position,morphNormals:void 0!==W.morphAttributes.normal,morphColors:void 0!==W.morphAttributes.color,morphTargetsCount:ea,morphTextureStride:na,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numSpotLightMaps:D.spotLightMap.length,
numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numSpotLightShadowsWithMaps:D.numSpotLightShadowsWithMaps,numLightProbes:D.numLightProbes,numClippingPlanes:g.numPlanes,numClipIntersection:g.numIntersection,dithering:u.dithering,shadowMapEnabled:a.shadowMap.enabled&&0<aa.length,shadowMapType:a.shadowMap.type,toneMapping:Pb,useLegacyLights:a._useLegacyLights,
decodeVideoTexture:Ha&&!0===u.map.isVideoTexture&&"srgb"===Kb.getTransfer(u.map.colorSpace),premultipliedAlpha:u.premultipliedAlpha,doubleSided:2===u.side,flipSided:1===u.side,useDepthPacking:0<=u.depthPacking,depthPacking:u.depthPacking||0,index0AttributeName:u.index0AttributeName,extensionDerivatives:Eb&&!0===u.extensions.derivatives,extensionFragDepth:Eb&&!0===u.extensions.fragDepth,extensionDrawBuffers:Eb&&!0===u.extensions.drawBuffers,extensionShaderTextureLOD:Eb&&!0===u.extensions.shaderTextureLOD,
extensionClipCullDistance:Eb&&!0===u.extensions.clipCullDistance&&d.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Eb&&!0===u.extensions.multiDraw&&d.has("WEBGL_multi_draw"),rendererExtensionFragDepth:p||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||d.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:d.has("KHR_parallel_shader_compile"),customProgramCacheKey:u.customProgramCacheKey()};u.vertexUv1s=n.has(1);
u.vertexUv2s=n.has(2);u.vertexUv3s=n.has(3);n.clear();return u},getProgramCacheKey:function(u){const D=[];u.shaderID?D.push(u.shaderID):(D.push(u.customVertexShaderID),D.push(u.customFragmentShaderID));if(void 0!==u.defines)for(const aa in u.defines)D.push(aa),D.push(u.defines[aa]);!1===u.isRawShaderMaterial&&(D.push(u.precision),D.push(u.outputColorSpace),D.push(u.envMapMode),D.push(u.envMapCubeUVHeight),D.push(u.mapUv),D.push(u.alphaMapUv),D.push(u.lightMapUv),D.push(u.aoMapUv),D.push(u.bumpMapUv),
D.push(u.normalMapUv),D.push(u.displacementMapUv),D.push(u.emissiveMapUv),D.push(u.metalnessMapUv),D.push(u.roughnessMapUv),D.push(u.anisotropyMapUv),D.push(u.clearcoatMapUv),D.push(u.clearcoatNormalMapUv),D.push(u.clearcoatRoughnessMapUv),D.push(u.iridescenceMapUv),D.push(u.iridescenceThicknessMapUv),D.push(u.sheenColorMapUv),D.push(u.sheenRoughnessMapUv),D.push(u.specularMapUv),D.push(u.specularColorMapUv),D.push(u.specularIntensityMapUv),D.push(u.transmissionMapUv),D.push(u.thicknessMapUv),D.push(u.combine),
D.push(u.fogExp2),D.push(u.sizeAttenuation),D.push(u.morphTargetsCount),D.push(u.morphAttributeCount),D.push(u.numDirLights),D.push(u.numPointLights),D.push(u.numSpotLights),D.push(u.numSpotLightMaps),D.push(u.numHemiLights),D.push(u.numRectAreaLights),D.push(u.numDirLightShadows),D.push(u.numPointLightShadows),D.push(u.numSpotLightShadows),D.push(u.numSpotLightShadowsWithMaps),D.push(u.numLightProbes),D.push(u.shadowMapType),D.push(u.toneMapping),D.push(u.numClippingPlanes),D.push(u.numClipIntersection),
D.push(u.depthPacking),h.disableAll(),u.isWebGL2&&h.enable(0),u.supportsVertexTextures&&h.enable(1),u.instancing&&h.enable(2),u.instancingColor&&h.enable(3),u.instancingMorph&&h.enable(4),u.matcap&&h.enable(5),u.envMap&&h.enable(6),u.normalMapObjectSpace&&h.enable(7),u.normalMapTangentSpace&&h.enable(8),u.clearcoat&&h.enable(9),u.iridescence&&h.enable(10),u.alphaTest&&h.enable(11),u.vertexColors&&h.enable(12),u.vertexAlphas&&h.enable(13),u.vertexUv1s&&h.enable(14),u.vertexUv2s&&h.enable(15),u.vertexUv3s&&
h.enable(16),u.vertexTangents&&h.enable(17),u.anisotropy&&h.enable(18),u.alphaHash&&h.enable(19),u.batching&&h.enable(20),D.push(h.mask),h.disableAll(),u.fog&&h.enable(0),u.useFog&&h.enable(1),u.flatShading&&h.enable(2),u.logarithmicDepthBuffer&&h.enable(3),u.skinning&&h.enable(4),u.morphTargets&&h.enable(5),u.morphNormals&&h.enable(6),u.morphColors&&h.enable(7),u.premultipliedAlpha&&h.enable(8),u.shadowMapEnabled&&h.enable(9),u.useLegacyLights&&h.enable(10),u.doubleSided&&h.enable(11),u.flipSided&&
h.enable(12),u.useDepthPacking&&h.enable(13),u.dithering&&h.enable(14),u.transmission&&h.enable(15),u.sheen&&h.enable(16),u.opaque&&h.enable(17),u.pointsUvs&&h.enable(18),u.decodeVideoTexture&&h.enable(19),u.alphaToCoverage&&h.enable(20),D.push(h.mask),D.push(a.outputColorSpace));D.push(u.customProgramCacheKey);return D.join()},getUniforms:function(u){const D=C[u.type];return D?ri.clone(Nc[D].uniforms):u.uniforms},acquireProgram:function(u,D){let aa;for(let J=0,K=m.length;J<K;J++){const U=m[J];if(U.cacheKey===
D){aa=U;++aa.usedTimes;break}}void 0===aa&&(aa=new ql(a,D,u,f),m.push(aa));return aa},releaseProgram:function(u){if(0===--u.usedTimes){const D=m.indexOf(u);m[D]=m[m.length-1];m.pop();u.destroy()}},releaseShaderCache:function(u){l.remove(u)},programs:m,dispose:function(){l.dispose()}}}function ul(){let a=new WeakMap;return{get:function(b){let c=a.get(b);void 0===c&&(c={},a.set(b,c));return c},remove:function(b){a.delete(b)},update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function vl(a,
b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function si(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function ti(){function a(g,k,h,l,n,m){let p=b[c];void 0===p?(p={id:g.id,object:g,geometry:k,material:h,groupOrder:l,renderOrder:g.renderOrder,
z:n,group:m},b[c]=p):(p.id=g.id,p.object=g,p.geometry=k,p.material=h,p.groupOrder=l,p.renderOrder=g.renderOrder,p.z=n,p.group=m);c++;return p}const b=[];let c=0;const d=[],e=[],f=[];return{opaque:d,transmissive:e,transparent:f,init:function(){c=0;d.length=0;e.length=0;f.length=0},push:function(g,k,h,l,n,m){g=a(g,k,h,l,n,m);0<h.transmission?e.push(g):!0===h.transparent?f.push(g):d.push(g)},unshift:function(g,k,h,l,n,m){g=a(g,k,h,l,n,m);0<h.transmission?e.unshift(g):!0===h.transparent?f.unshift(g):
d.unshift(g)},finish:function(){for(let g=c,k=b.length;g<k;g++){const h=b[g];if(null===h.id)break;h.id=null;h.object=null;h.geometry=null;h.material=null;h.group=null}},sort:function(g,k){1<d.length&&d.sort(g||vl);1<e.length&&e.sort(k||si);1<f.length&&f.sort(k||si)}}}function wl(){let a=new WeakMap;return{get:function(b,c){const d=a.get(b);void 0===d?(c=new ti,a.set(b,[c])):c>=d.length?(c=new ti,d.push(c)):c=d[c];return c},dispose:function(){a=new WeakMap}}}function xl(){const a={};return{get:function(b){if(void 0!==
a[b.id])return a[b.id];let c;switch(b.type){case "DirectionalLight":c={direction:new I,color:new Ya};break;case "SpotLight":c={position:new I,direction:new I,color:new Ya,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case "PointLight":c={position:new I,color:new Ya,distance:0,decay:0};break;case "HemisphereLight":c={direction:new I,skyColor:new Ya,groundColor:new Ya};break;case "RectAreaLight":c={color:new Ya,position:new I,halfWidth:new I,halfHeight:new I}}return a[b.id]=c}}}function yl(){const a=
{};return{get:function(b){if(void 0!==a[b.id])return a[b.id];let c;switch(b.type){case "DirectionalLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xa};break;case "SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xa};break;case "PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xa,shadowCameraNear:1,shadowCameraFar:1E3}}return a[b.id]=c}}}function zl(a,b){return(b.castShadow?2:0)-(a.castShadow?2:0)+(b.map?1:0)-(a.map?
1:0)}function Al(a,b){const c=new xl,d=yl(),e={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],
pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;9>h;h++)e.probe.push(new I);const f=new I,g=new lb,k=new lb;return{setup:function(h,l){let n=0,m=0,p=0;for(var v=0;9>v;v++)e.probe[v].set(0,0,0);let t=v=0,x=0,C=0,u=0,D=0,aa=0,J=0,K=0,U=0,W=0;h.sort(zl);l=!0===l?Math.PI:1;for(let ca=0,Ga=h.length;ca<Ga;ca++){var R=h[ca],fa=R.color,ea=R.intensity,na=R.distance,Ea=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)n+=fa.r*ea*l,m+=fa.g*ea*l,p+=
fa.b*ea*l;else if(R.isLightProbe){for(Ea=0;9>Ea;Ea++)e.probe[Ea].addScaledVector(R.sh.coefficients[Ea],ea);W++}else if(R.isDirectionalLight)ea=c.get(R),ea.color.copy(R.color).multiplyScalar(R.intensity*l),R.castShadow&&(fa=R.shadow,na=d.get(R),na.shadowBias=fa.bias,na.shadowNormalBias=fa.normalBias,na.shadowRadius=fa.radius,na.shadowMapSize=fa.mapSize,e.directionalShadow[v]=na,e.directionalShadowMap[v]=Ea,e.directionalShadowMatrix[v]=R.shadow.matrix,D++),e.directional[v]=ea,v++;else if(R.isSpotLight){const ta=
c.get(R);ta.position.setFromMatrixPosition(R.matrixWorld);ta.color.copy(fa).multiplyScalar(ea*l);ta.distance=na;ta.coneCos=Math.cos(R.angle);ta.penumbraCos=Math.cos(R.angle*(1-R.penumbra));ta.decay=R.decay;e.spot[x]=ta;ea=R.shadow;R.map&&(e.spotLightMap[K]=R.map,K++,ea.updateMatrices(R),R.castShadow&&U++);e.spotLightMatrix[x]=ea.matrix;R.castShadow&&(R=d.get(R),R.shadowBias=ea.bias,R.shadowNormalBias=ea.normalBias,R.shadowRadius=ea.radius,R.shadowMapSize=ea.mapSize,e.spotShadow[x]=R,e.spotShadowMap[x]=
Ea,J++);x++}else R.isRectAreaLight?(Ea=c.get(R),Ea.color.copy(fa).multiplyScalar(ea),Ea.halfWidth.set(.5*R.width,0,0),Ea.halfHeight.set(0,.5*R.height,0),e.rectArea[C]=Ea,C++):R.isPointLight?(ea=c.get(R),ea.color.copy(R.color).multiplyScalar(R.intensity*l),ea.distance=R.distance,ea.decay=R.decay,R.castShadow&&(fa=R.shadow,na=d.get(R),na.shadowBias=fa.bias,na.shadowNormalBias=fa.normalBias,na.shadowRadius=fa.radius,na.shadowMapSize=fa.mapSize,na.shadowCameraNear=fa.camera.near,na.shadowCameraFar=fa.camera.far,
e.pointShadow[t]=na,e.pointShadowMap[t]=Ea,e.pointShadowMatrix[t]=R.shadow.matrix,aa++),e.point[t]=ea,t++):R.isHemisphereLight&&(Ea=c.get(R),Ea.skyColor.copy(R.color).multiplyScalar(ea*l),Ea.groundColor.copy(R.groundColor).multiplyScalar(ea*l),e.hemi[u]=Ea,u++)}0<C&&(b.isWebGL2?!0===a.has("OES_texture_float_linear")?(e.rectAreaLTC1=Ra.LTC_FLOAT_1,e.rectAreaLTC2=Ra.LTC_FLOAT_2):(e.rectAreaLTC1=Ra.LTC_HALF_1,e.rectAreaLTC2=Ra.LTC_HALF_2):!0===a.has("OES_texture_float_linear")?(e.rectAreaLTC1=Ra.LTC_FLOAT_1,
e.rectAreaLTC2=Ra.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(e.rectAreaLTC1=Ra.LTC_HALF_1,e.rectAreaLTC2=Ra.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions."));e.ambient[0]=n;e.ambient[1]=m;e.ambient[2]=p;h=e.hash;if(h.directionalLength!==v||h.pointLength!==t||h.spotLength!==x||h.rectAreaLength!==C||h.hemiLength!==u||h.numDirectionalShadows!==D||h.numPointShadows!==aa||h.numSpotShadows!==J||h.numSpotMaps!==K||h.numLightProbes!==
W)e.directional.length=v,e.spot.length=x,e.rectArea.length=C,e.point.length=t,e.hemi.length=u,e.directionalShadow.length=D,e.directionalShadowMap.length=D,e.pointShadow.length=aa,e.pointShadowMap.length=aa,e.spotShadow.length=J,e.spotShadowMap.length=J,e.directionalShadowMatrix.length=D,e.pointShadowMatrix.length=aa,e.spotLightMatrix.length=J+K-U,e.spotLightMap.length=K,e.numSpotLightShadowsWithMaps=U,e.numLightProbes=W,h.directionalLength=v,h.pointLength=t,h.spotLength=x,h.rectAreaLength=C,h.hemiLength=
u,h.numDirectionalShadows=D,h.numPointShadows=aa,h.numSpotShadows=J,h.numSpotMaps=K,h.numLightProbes=W,e.version=Bl++},setupView:function(h,l){let n=0,m=0,p=0,v=0,t=0;l=l.matrixWorldInverse;for(let C=0,u=h.length;C<u;C++){const D=h[C];if(D.isDirectionalLight){var x=e.directional[n];x.direction.setFromMatrixPosition(D.matrixWorld);f.setFromMatrixPosition(D.target.matrixWorld);x.direction.sub(f);x.direction.transformDirection(l);n++}else D.isSpotLight?(x=e.spot[p],x.position.setFromMatrixPosition(D.matrixWorld),
x.position.applyMatrix4(l),x.direction.setFromMatrixPosition(D.matrixWorld),f.setFromMatrixPosition(D.target.matrixWorld),x.direction.sub(f),x.direction.transformDirection(l),p++):D.isRectAreaLight?(x=e.rectArea[v],x.position.setFromMatrixPosition(D.matrixWorld),x.position.applyMatrix4(l),k.identity(),g.copy(D.matrixWorld),g.premultiply(l),k.extractRotation(g),x.halfWidth.set(.5*D.width,0,0),x.halfHeight.set(0,.5*D.height,0),x.halfWidth.applyMatrix4(k),x.halfHeight.applyMatrix4(k),v++):D.isPointLight?
(x=e.point[m],x.position.setFromMatrixPosition(D.matrixWorld),x.position.applyMatrix4(l),m++):D.isHemisphereLight&&(x=e.hemi[t],x.direction.setFromMatrixPosition(D.matrixWorld),x.direction.transformDirection(l),t++)}},state:e}}function ui(a,b){const c=new Al(a,b),d=[],e=[];return{init:function(){d.length=0;e.length=0},state:{lightsArray:d,shadowsArray:e,lights:c},setupLights:function(f){c.setup(d,f)},setupLightsView:function(f){c.setupView(d,f)},pushLight:function(f){d.push(f)},pushShadow:function(f){e.push(f)}}}
function Cl(a,b){let c=new WeakMap;return{get:function(d,e=0){const f=c.get(d);void 0===f?(e=new ui(a,b),c.set(d,[e])):e>=f.length?(e=new ui(a,b),f.push(e)):e=f[e];return e},dispose:function(){c=new WeakMap}}}function Dl(a,b,c){function d(J,K,U,W){J=!0===U.isPointLight?J.customDistanceMaterial:J.customDepthMaterial;if(void 0===J&&(J=!0===U.isPointLight?m:n,a.localClippingEnabled&&!0===K.clipShadows&&Array.isArray(K.clippingPlanes)&&0!==K.clippingPlanes.length||K.displacementMap&&0!==K.displacementScale||
K.alphaMap&&0<K.alphaTest||K.map&&0<K.alphaTest)){var R=J.uuid;const fa=K.uuid;let ea=p[R];void 0===ea&&(ea={},p[R]=ea);R=ea[fa];void 0===R&&(R=J.clone(),ea[fa]=R,K.addEventListener("dispose",f));J=R}J.visible=K.visible;J.wireframe=K.wireframe;J.side=3===W?null!==K.shadowSide?K.shadowSide:K.side:null!==K.shadowSide?K.shadowSide:t[K.side];J.alphaMap=K.alphaMap;J.alphaTest=K.alphaTest;J.map=K.map;J.clipShadows=K.clipShadows;J.clippingPlanes=K.clippingPlanes;J.clipIntersection=K.clipIntersection;J.displacementMap=
K.displacementMap;J.displacementScale=K.displacementScale;J.displacementBias=K.displacementBias;J.wireframeLinewidth=K.wireframeLinewidth;J.linewidth=K.linewidth;!0===U.isPointLight&&!0===J.isMeshDistanceMaterial&&(a.properties.get(J).light=U);return J}function e(J,K,U,W,R){if(!1!==J.visible){if(J.layers.test(K.layers)&&(J.isMesh||J.isLine||J.isPoints)&&(J.castShadow||J.receiveShadow&&3===R)&&(!J.frustumCulled||g.intersectsObject(J))){J.modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,J.matrixWorld);
const na=b.update(J);var fa=J.material;if(Array.isArray(fa)){const Ea=na.groups;for(let ca=0,Ga=Ea.length;ca<Ga;ca++){const ta=Ea[ca];var ea=fa[ta.materialIndex];ea&&ea.visible&&(ea=d(J,ea,W,R),J.onBeforeShadow(a,J,K,U,na,ea,ta),a.renderBufferDirect(U,null,na,ea,J,ta),J.onAfterShadow(a,J,K,U,na,ea,ta))}}else fa.visible&&(fa=d(J,fa,W,R),J.onBeforeShadow(a,J,K,U,na,fa,null),a.renderBufferDirect(U,null,na,fa,J,null),J.onAfterShadow(a,J,K,U,na,fa,null))}J=J.children;for(let na=0,Ea=J.length;na<Ea;na++)e(J[na],
K,U,W,R)}}function f(J){J.target.removeEventListener("dispose",f);for(const K in p){const U=p[K],W=J.target.uuid;W in U&&(U[W].dispose(),delete U[W])}}let g=new Ee;const k=new xa,h=new xa,l=new Mb,n=new ug({depthPacking:3201}),m=new vg,p={},v=c.maxTextureSize,t={[0]:1,[1]:0,[2]:2},x=new Mc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xa},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position \x3d vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include \x3cpacking\x3e\nvoid main() {\n\tconst float samples \x3d float( VSM_SAMPLES );\n\tfloat mean \x3d 0.0;\n\tfloat squared_mean \x3d 0.0;\n\tfloat uvStride \x3d samples \x3c\x3d 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart \x3d samples \x3c\x3d 1.0 ? 0.0 : - 1.0;\n\tfor ( float i \x3d 0.0; i \x3c samples; i ++ ) {\n\t\tfloat uvOffset \x3d uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution \x3d unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean +\x3d distribution.x;\n\t\t\tsquared_mean +\x3d distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth \x3d unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean +\x3d depth;\n\t\t\tsquared_mean +\x3d depth * depth;\n\t\t#endif\n\t}\n\tmean \x3d mean / samples;\n\tsquared_mean \x3d squared_mean / samples;\n\tfloat std_dev \x3d sqrt( squared_mean - mean * mean );\n\tgl_FragColor \x3d pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),
C=x.clone();C.defines.HORIZONTAL_PASS=1;c=new tb;c.setAttribute("position",new Nb(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const u=new dc(c,x),D=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;let aa=this.type=1;this.render=function(J,K,U){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==J.length){var W=a.getRenderTarget(),R=a.getActiveCubeFace(),fa=a.getActiveMipmapLevel(),ea=a.state;ea.setBlending(0);ea.buffers.color.setClear(1,1,1,1);ea.buffers.depth.setTest(!0);
ea.setScissorTest(!1);var na=3!==aa&&3===this.type,Ea=3===aa&&3!==this.type;for(let Sa=0,cb=J.length;Sa<cb;Sa++){var ca=J[Sa];const $a=ca.shadow;if(void 0===$a)console.warn("THREE.WebGLShadowMap:",ca,"has no shadow.");else if(!1!==$a.autoUpdate||!1!==$a.needsUpdate){k.copy($a.mapSize);var Ga=$a.getFrameExtents();k.multiply(Ga);h.copy($a.mapSize);if(k.x>v||k.y>v)k.x>v&&(h.x=Math.floor(v/Ga.x),k.x=h.x*Ga.x,$a.mapSize.x=h.x),k.y>v&&(h.y=Math.floor(v/Ga.y),k.y=h.y*Ga.y,$a.mapSize.y=h.y);if(null===$a.map||
!0===na||!0===Ea)Ga=3!==this.type?{minFilter:1003,magFilter:1003}:{},null!==$a.map&&$a.map.dispose(),$a.map=new Oc(k.x,k.y,Ga),$a.map.texture.name=ca.name+".shadowMap",$a.camera.updateProjectionMatrix();a.setRenderTarget($a.map);a.clear();Ga=$a.getViewportCount();for(var ta=0;ta<Ga;ta++){const Ha=$a.getViewport(ta);l.set(h.x*Ha.x,h.y*Ha.y,h.x*Ha.z,h.y*Ha.w);ea.viewport(l);$a.updateMatrices(ca,ta);g=$a.getFrustum();e(K,U,$a.camera,ca,this.type)}!0!==$a.isPointLightShadow&&3===this.type&&(ca=$a,Ga=
U,ta=b.update(u),x.defines.VSM_SAMPLES!==ca.blurSamples&&(x.defines.VSM_SAMPLES=ca.blurSamples,C.defines.VSM_SAMPLES=ca.blurSamples,x.needsUpdate=!0,C.needsUpdate=!0),null===ca.mapPass&&(ca.mapPass=new Oc(k.x,k.y)),x.uniforms.shadow_pass.value=ca.map.texture,x.uniforms.resolution.value=ca.mapSize,x.uniforms.radius.value=ca.radius,a.setRenderTarget(ca.mapPass),a.clear(),a.renderBufferDirect(Ga,null,ta,x,u,null),C.uniforms.shadow_pass.value=ca.mapPass.texture,C.uniforms.resolution.value=ca.mapSize,
C.uniforms.radius.value=ca.radius,a.setRenderTarget(ca.map),a.clear(),a.renderBufferDirect(Ga,null,ta,C,u,null));$a.needsUpdate=!1}}aa=this.type;D.needsUpdate=!1;a.setRenderTarget(W,R,fa)}}}function El(a,b,c){function d(H,sa,ia,Ka){const Ta=new Uint8Array(4),mb=a.createTexture();a.bindTexture(H,mb);a.texParameteri(H,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(H,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let db=0;db<ia;db++)!n||H!==a.TEXTURE_3D&&H!==a.TEXTURE_2D_ARRAY?a.texImage2D(sa+db,0,a.RGBA,1,1,
0,a.RGBA,a.UNSIGNED_BYTE,Ta):a.texImage3D(sa,0,a.RGBA,1,1,Ka,0,a.RGBA,a.UNSIGNED_BYTE,Ta);return mb}function e(H){!0!==C[H]&&(a.enable(H),C[H]=!0)}function f(H){!1!==C[H]&&(a.disable(H),C[H]=!1)}function g(H,sa,ia,Ka,Ta,mb,db,Ib,jc,Jb){if(0===H)!0===K&&(f(a.BLEND),K=!1);else if(!1===K&&(e(a.BLEND),K=!0),5!==H){if(H!==U||Jb!==ta){if(100!==W||100!==ea)a.blendEquation(a.FUNC_ADD),ea=W=100;if(Jb)switch(H){case 1:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.ONE,
a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}else switch(H){case 1:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFunc(a.ZERO,a.SRC_COLOR);break;
default:console.error("THREE.WebGLState: Invalid blending: ",H)}Ea=na=fa=R=null;ca.set(0,0,0);Ga=0;U=H;ta=Jb}}else{Ta=Ta||sa;mb=mb||ia;db=db||Ka;if(sa!==W||Ta!==ea)a.blendEquationSeparate(Fa[sa],Fa[Ta]),W=sa,ea=Ta;if(ia!==R||Ka!==fa||mb!==na||db!==Ea)a.blendFuncSeparate(oa[ia],oa[Ka],oa[mb],oa[db]),R=ia,fa=Ka,na=mb,Ea=db;if(!1===Ib.equals(ca)||jc!==Ga)a.blendColor(Ib.r,Ib.g,Ib.b,jc),ca.copy(Ib),Ga=jc;U=H;ta=!1}}function k(H){Sa!==H&&(H?a.frontFace(a.CW):a.frontFace(a.CCW),Sa=H)}function h(H){0!==
H?(e(a.CULL_FACE),H!==cb&&(1===H?a.cullFace(a.BACK):2===H?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):f(a.CULL_FACE);cb=H}function l(H,sa,ia){if(H){if(e(a.POLYGON_OFFSET_FILL),Ha!==sa||Ba!==ia)a.polygonOffset(sa,ia),Ha=sa,Ba=ia}else f(a.POLYGON_OFFSET_FILL)}const n=c.isWebGL2,m=new function(){let H=!1;const sa=new Mb;let ia=null;const Ka=new Mb(0,0,0,0);return{setMask:function(Ta){ia===Ta||H||(a.colorMask(Ta,Ta,Ta,Ta),ia=Ta)},setLocked:function(Ta){H=Ta},setClear:function(Ta,mb,db,Ib,jc){!0===
jc&&(Ta*=Ib,mb*=Ib,db*=Ib);sa.set(Ta,mb,db,Ib);!1===Ka.equals(sa)&&(a.clearColor(Ta,mb,db,Ib),Ka.copy(sa))},reset:function(){H=!1;ia=null;Ka.set(-1,0,0,0)}}},p=new function(){let H=!1,sa=null,ia=null,Ka=null;return{setTest:function(Ta){Ta?e(a.DEPTH_TEST):f(a.DEPTH_TEST)},setMask:function(Ta){sa===Ta||H||(a.depthMask(Ta),sa=Ta)},setFunc:function(Ta){if(ia!==Ta){switch(Ta){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);
break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}ia=Ta}},setLocked:function(Ta){H=Ta},setClear:function(Ta){Ka!==Ta&&(a.clearDepth(Ta),Ka=Ta)},reset:function(){H=!1;Ka=ia=sa=null}}},v=new function(){let H=!1,sa=null,ia=null,Ka=null,Ta=null,mb=null,db=null,Ib=null,jc=null;return{setTest:function(Jb){H||(Jb?e(a.STENCIL_TEST):f(a.STENCIL_TEST))},setMask:function(Jb){sa===Jb||
H||(a.stencilMask(Jb),sa=Jb)},setFunc:function(Jb,Ub,wc){if(ia!==Jb||Ka!==Ub||Ta!==wc)a.stencilFunc(Jb,Ub,wc),ia=Jb,Ka=Ub,Ta=wc},setOp:function(Jb,Ub,wc){if(mb!==Jb||db!==Ub||Ib!==wc)a.stencilOp(Jb,Ub,wc),mb=Jb,db=Ub,Ib=wc},setLocked:function(Jb){H=Jb},setClear:function(Jb){jc!==Jb&&(a.clearStencil(Jb),jc=Jb)},reset:function(){H=!1;jc=Ib=db=mb=Ta=Ka=ia=sa=null}}},t=new WeakMap,x=new WeakMap;let C={},u={},D=new WeakMap,aa=[],J=null,K=!1,U=null,W=null,R=null,fa=null,ea=null,na=null,Ea=null,ca=new Ya(0,
0,0),Ga=0,ta=!1,Sa=null,cb=null,$a=null,Ha=null,Ba=null;const Ia=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Xa=!1;var z=0;z=a.getParameter(a.VERSION);-1!==z.indexOf("WebGL")?(z=parseFloat(/^WebGL (\d)/.exec(z)[1]),Xa=1<=z):-1!==z.indexOf("OpenGL ES")&&(z=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),Xa=2<=z);let A=null,E={};z=a.getParameter(a.SCISSOR_BOX);const O=a.getParameter(a.VIEWPORT),M=(new Mb).fromArray(z),ra=(new Mb).fromArray(O),Pa={};Pa[a.TEXTURE_2D]=d(a.TEXTURE_2D,a.TEXTURE_2D,1);
Pa[a.TEXTURE_CUBE_MAP]=d(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);n&&(Pa[a.TEXTURE_2D_ARRAY]=d(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),Pa[a.TEXTURE_3D]=d(a.TEXTURE_3D,a.TEXTURE_3D,1,1));m.setClear(0,0,0,1);p.setClear(1);v.setClear(0);e(a.DEPTH_TEST);p.setFunc(3);k(!1);h(1);e(a.CULL_FACE);g(0);const Fa={[100]:a.FUNC_ADD,[101]:a.FUNC_SUBTRACT,[102]:a.FUNC_REVERSE_SUBTRACT};n?(Fa[103]=a.MIN,Fa[104]=a.MAX):(z=b.get("EXT_blend_minmax"),null!==z&&(Fa[103]=z.MIN_EXT,Fa[104]=z.MAX_EXT));const oa=
{[200]:a.ZERO,[201]:a.ONE,[202]:a.SRC_COLOR,[204]:a.SRC_ALPHA,[210]:a.SRC_ALPHA_SATURATE,[208]:a.DST_COLOR,[206]:a.DST_ALPHA,[203]:a.ONE_MINUS_SRC_COLOR,[205]:a.ONE_MINUS_SRC_ALPHA,[209]:a.ONE_MINUS_DST_COLOR,[207]:a.ONE_MINUS_DST_ALPHA,[211]:a.CONSTANT_COLOR,[212]:a.ONE_MINUS_CONSTANT_COLOR,[213]:a.CONSTANT_ALPHA,[214]:a.ONE_MINUS_CONSTANT_ALPHA};return{buffers:{color:m,depth:p,stencil:v},enable:e,disable:f,bindFramebuffer:function(H,sa){return u[H]!==sa?(a.bindFramebuffer(H,sa),u[H]=sa,n&&(H===
a.DRAW_FRAMEBUFFER&&(u[a.FRAMEBUFFER]=sa),H===a.FRAMEBUFFER&&(u[a.DRAW_FRAMEBUFFER]=sa)),!0):!1},drawBuffers:function(H,sa){let ia=aa,Ka=!1;if(H){if(ia=D.get(sa),void 0===ia&&(ia=[],D.set(sa,ia)),H=H.textures,ia.length!==H.length||ia[0]!==a.COLOR_ATTACHMENT0){for(let Ta=0,mb=H.length;Ta<mb;Ta++)ia[Ta]=a.COLOR_ATTACHMENT0+Ta;ia.length=H.length;Ka=!0}}else ia[0]!==a.BACK&&(ia[0]=a.BACK,Ka=!0);if(Ka)if(c.isWebGL2)a.drawBuffers(ia);else if(!0===b.has("WEBGL_draw_buffers"))b.get("WEBGL_draw_buffers").drawBuffersWEBGL(ia);
else throw Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension");},useProgram:function(H){return J!==H?(a.useProgram(H),J=H,!0):!1},setBlending:g,setMaterial:function(H,sa){2===H.side?f(a.CULL_FACE):e(a.CULL_FACE);let ia=1===H.side;sa&&(ia=!ia);k(ia);1===H.blending&&!1===H.transparent?g(0):g(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.blendColor,H.blendAlpha,H.premultipliedAlpha);p.setFunc(H.depthFunc);
p.setTest(H.depthTest);p.setMask(H.depthWrite);m.setMask(H.colorWrite);sa=H.stencilWrite;v.setTest(sa);sa&&(v.setMask(H.stencilWriteMask),v.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),v.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass));l(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits);!0===H.alphaToCoverage?e(a.SAMPLE_ALPHA_TO_COVERAGE):f(a.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:k,setCullFace:h,setLineWidth:function(H){H!==$a&&(Xa&&a.lineWidth(H),$a=H)},setPolygonOffset:l,
setScissorTest:function(H){H?e(a.SCISSOR_TEST):f(a.SCISSOR_TEST)},activeTexture:function(H){void 0===H&&(H=a.TEXTURE0+Ia-1);A!==H&&(a.activeTexture(H),A=H)},bindTexture:function(H,sa,ia){void 0===ia&&(ia=null===A?a.TEXTURE0+Ia-1:A);let Ka=E[ia];void 0===Ka&&(Ka={type:void 0,texture:void 0},E[ia]=Ka);if(Ka.type!==H||Ka.texture!==sa)A!==ia&&(a.activeTexture(ia),A=ia),a.bindTexture(H,sa||Pa[H]),Ka.type=H,Ka.texture=sa},unbindTexture:function(){const H=E[A];void 0!==H&&void 0!==H.type&&(a.bindTexture(H.type,
null),H.type=void 0,H.texture=void 0)},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexImage3D:function(){try{a.compressedTexImage3D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},
updateUBOMapping:function(H,sa){let ia=x.get(sa);void 0===ia&&(ia=new WeakMap,x.set(sa,ia));let Ka=ia.get(H);void 0===Ka&&(Ka=a.getUniformBlockIndex(sa,H.name),ia.set(H,Ka))},uniformBlockBinding:function(H,sa){const ia=x.get(sa).get(H);t.get(sa)!==ia&&(a.uniformBlockBinding(sa,ia,H.__bindingPointIndex),t.set(sa,ia))},texStorage2D:function(){try{a.texStorage2D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage3D:function(){try{a.texStorage3D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",
H)}},texSubImage2D:function(){try{a.texSubImage2D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage3D:function(){try{a.texSubImage3D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage2D:function(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage3D:function(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},scissor:function(H){!1===
M.equals(H)&&(a.scissor(H.x,H.y,H.z,H.w),M.copy(H))},viewport:function(H){!1===ra.equals(H)&&(a.viewport(H.x,H.y,H.z,H.w),ra.copy(H))},reset:function(){a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.POLYGON_OFFSET_FILL);a.disable(a.SCISSOR_TEST);a.disable(a.STENCIL_TEST);a.disable(a.SAMPLE_ALPHA_TO_COVERAGE);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO);a.blendColor(0,0,0,0);a.colorMask(!0,!0,!0,!0);a.clearColor(0,
0,0,0);a.depthMask(!0);a.depthFunc(a.LESS);a.clearDepth(1);a.stencilMask(4294967295);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.clearStencil(0);a.cullFace(a.BACK);a.frontFace(a.CCW);a.polygonOffset(0,0);a.activeTexture(a.TEXTURE0);a.bindFramebuffer(a.FRAMEBUFFER,null);!0===n&&(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null));a.useProgram(null);a.lineWidth(1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.viewport(0,0,a.canvas.width,
a.canvas.height);C={};A=null;E={};u={};D=new WeakMap;aa=[];J=null;K=!1;Ea=na=ea=fa=R=W=U=null;ca=new Ya(0,0,0);Ga=0;ta=!1;Ba=Ha=$a=cb=Sa=null;M.set(0,0,a.canvas.width,a.canvas.height);ra.set(0,0,a.canvas.width,a.canvas.height);m.reset();p.reset();v.reset()}}}function Fl(a,b,c,d,e,f,g){function k(z,A,E,O){var M=1;const ra=ea(z);if(ra.width>O||ra.height>O)M=O/Math.max(ra.width,ra.height);if(1>M||!0===A){if("undefined"!==typeof HTMLImageElement&&z instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&
z instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&z instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&z instanceof VideoFrame)return O=A?wa:Math.floor,A=O(M*ra.width),M=O(M*ra.height),void 0===Sa&&(Sa=$a?new OffscreenCanvas(A,M):Wb("canvas")),E=E?$a?new OffscreenCanvas(A,M):Wb("canvas"):Sa,E.width=A,E.height=M,E.getContext("2d").drawImage(z,0,0,A,M),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ra.width+"x"+ra.height+") to ("+A+"x"+M+")."),E;"data"in z&&
console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ra.width+"x"+ra.height+").")}return z}function h(z){z=ea(z);return Ua(z.width)&&Ua(z.height)}function l(z,A){return z.generateMipmaps&&A&&1003!==z.minFilter&&1006!==z.minFilter}function n(z,A,E,O,M=!1){if(!1===na)return A;if(null!==z){if(void 0!==a[z])return a[z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+z+"'")}z=A;A===a.RED&&(E===a.FLOAT&&(z=a.R32F),E===a.HALF_FLOAT&&(z=a.R16F),E===
a.UNSIGNED_BYTE&&(z=a.R8));A===a.RED_INTEGER&&(E===a.UNSIGNED_BYTE&&(z=a.R8UI),E===a.UNSIGNED_SHORT&&(z=a.R16UI),E===a.UNSIGNED_INT&&(z=a.R32UI),E===a.BYTE&&(z=a.R8I),E===a.SHORT&&(z=a.R16I),E===a.INT&&(z=a.R32I));A===a.RG&&(E===a.FLOAT&&(z=a.RG32F),E===a.HALF_FLOAT&&(z=a.RG16F),E===a.UNSIGNED_BYTE&&(z=a.RG8));A===a.RG_INTEGER&&(E===a.UNSIGNED_BYTE&&(z=a.RG8UI),E===a.UNSIGNED_SHORT&&(z=a.RG16UI),E===a.UNSIGNED_INT&&(z=a.RG32UI),E===a.BYTE&&(z=a.RG8I),E===a.SHORT&&(z=a.RG16I),E===a.INT&&(z=a.RG32I));
A===a.RGBA&&(A=M?"linear":Kb.getTransfer(O),E===a.FLOAT&&(z=a.RGBA32F),E===a.HALF_FLOAT&&(z=a.RGBA16F),E===a.UNSIGNED_BYTE&&(z="srgb"===A?a.SRGB8_ALPHA8:a.RGBA8),E===a.UNSIGNED_SHORT_4_4_4_4&&(z=a.RGBA4),E===a.UNSIGNED_SHORT_5_5_5_1&&(z=a.RGB5_A1));z!==a.R16F&&z!==a.R32F&&z!==a.RG16F&&z!==a.RG32F&&z!==a.RGBA16F&&z!==a.RGBA32F||b.get("EXT_color_buffer_float");return z}function m(z,A,E){return!0===l(z,E)||z.isFramebufferTexture&&1003!==z.minFilter&&1006!==z.minFilter?Math.log2(Math.max(A.width,A.height))+
1:void 0!==z.mipmaps&&0<z.mipmaps.length?z.mipmaps.length:z.isCompressedTexture&&Array.isArray(z.image)?A.mipmaps.length:1}function p(z){return 1003===z||1004===z||1005===z?a.NEAREST:a.LINEAR}function v(z){z=z.target;z.removeEventListener("dispose",v);var A=d.get(z);if(void 0!==A.__webglInit){var E=z.source,O=cb.get(E);O&&(A=O[A.__cacheKey],A.usedTimes--,0===A.usedTimes&&x(z),0===Object.keys(O).length&&cb.delete(E));d.remove(z)}z.isVideoTexture&&ta.delete(z)}function t(z){z=z.target;z.removeEventListener("dispose",
t);var A=d.get(z);z.depthTexture&&z.depthTexture.dispose();if(z.isWebGLCubeRenderTarget)for(var E=0;6>E;E++){if(Array.isArray(A.__webglFramebuffer[E]))for(let O=0;O<A.__webglFramebuffer[E].length;O++)a.deleteFramebuffer(A.__webglFramebuffer[E][O]);else a.deleteFramebuffer(A.__webglFramebuffer[E]);A.__webglDepthbuffer&&a.deleteRenderbuffer(A.__webglDepthbuffer[E])}else{if(Array.isArray(A.__webglFramebuffer))for(E=0;E<A.__webglFramebuffer.length;E++)a.deleteFramebuffer(A.__webglFramebuffer[E]);else a.deleteFramebuffer(A.__webglFramebuffer);
A.__webglDepthbuffer&&a.deleteRenderbuffer(A.__webglDepthbuffer);A.__webglMultisampledFramebuffer&&a.deleteFramebuffer(A.__webglMultisampledFramebuffer);if(A.__webglColorRenderbuffer)for(E=0;E<A.__webglColorRenderbuffer.length;E++)A.__webglColorRenderbuffer[E]&&a.deleteRenderbuffer(A.__webglColorRenderbuffer[E]);A.__webglDepthRenderbuffer&&a.deleteRenderbuffer(A.__webglDepthRenderbuffer)}A=z.textures;for(let O=0,M=A.length;O<M;O++)E=d.get(A[O]),E.__webglTexture&&(a.deleteTexture(E.__webglTexture),
g.memory.textures--),d.remove(A[O]);d.remove(z)}function x(z){const A=d.get(z);a.deleteTexture(A.__webglTexture);delete cb.get(z.source)[A.__cacheKey];g.memory.textures--}function C(z,A){const E=d.get(z);if(z.isVideoTexture){var O=g.render.frame;ta.get(z)!==O&&(ta.set(z,O),z.update())}if(!1===z.isRenderTargetTexture&&0<z.version&&E.__version!==z.version)if(O=z.image,null===O)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(!1===O.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");
else{aa(E,z,A);return}c.bindTexture(a.TEXTURE_2D,E.__webglTexture,a.TEXTURE0+A)}function u(z,A,E){1015!==A.type||!1!==b.has("OES_texture_float_linear")||1006!==A.magFilter&&1007!==A.magFilter&&1005!==A.magFilter&&1008!==A.magFilter&&1006!==A.minFilter&&1007!==A.minFilter&&1005!==A.minFilter&&1008!==A.minFilter||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device.");E?(a.texParameteri(z,a.TEXTURE_WRAP_S,
Ba[A.wrapS]),a.texParameteri(z,a.TEXTURE_WRAP_T,Ba[A.wrapT]),z!==a.TEXTURE_3D&&z!==a.TEXTURE_2D_ARRAY||a.texParameteri(z,a.TEXTURE_WRAP_R,Ba[A.wrapR]),a.texParameteri(z,a.TEXTURE_MAG_FILTER,Ia[A.magFilter]),a.texParameteri(z,a.TEXTURE_MIN_FILTER,Ia[A.minFilter])):(a.texParameteri(z,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(z,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),z!==a.TEXTURE_3D&&z!==a.TEXTURE_2D_ARRAY||a.texParameteri(z,a.TEXTURE_WRAP_R,a.CLAMP_TO_EDGE),1001===A.wrapS&&1001===A.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),
a.texParameteri(z,a.TEXTURE_MAG_FILTER,p(A.magFilter)),a.texParameteri(z,a.TEXTURE_MIN_FILTER,p(A.minFilter)),1003!==A.minFilter&&1006!==A.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));A.compareFunction&&(a.texParameteri(z,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(z,a.TEXTURE_COMPARE_FUNC,Xa[A.compareFunction]));!0!==b.has("EXT_texture_filter_anisotropic")||1003===A.magFilter||
1005!==A.minFilter&&1008!==A.minFilter||1015===A.type&&!1===b.has("OES_texture_float_linear")||!1===na&&1016===A.type&&!1===b.has("OES_texture_half_float_linear")||!(1<A.anisotropy||d.get(A).__currentAnisotropy)||(E=b.get("EXT_texture_filter_anisotropic"),a.texParameterf(z,E.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,e.getMaxAnisotropy())),d.get(A).__currentAnisotropy=A.anisotropy)}function D(z,A){let E=!1;void 0===z.__webglInit&&(z.__webglInit=!0,A.addEventListener("dispose",v));var O=A.source;
let M=cb.get(O);void 0===M&&(M={},cb.set(O,M));O=[];O.push(A.wrapS);O.push(A.wrapT);O.push(A.wrapR||0);O.push(A.magFilter);O.push(A.minFilter);O.push(A.anisotropy);O.push(A.internalFormat);O.push(A.format);O.push(A.type);O.push(A.generateMipmaps);O.push(A.premultiplyAlpha);O.push(A.flipY);O.push(A.unpackAlignment);O.push(A.colorSpace);O=O.join();if(O!==z.__cacheKey){void 0===M[O]&&(M[O]={texture:a.createTexture(),usedTimes:0},g.memory.textures++,E=!0);M[O].usedTimes++;const ra=M[z.__cacheKey];void 0!==
ra&&(M[z.__cacheKey].usedTimes--,0===ra.usedTimes&&x(A));z.__cacheKey=O;z.__webglTexture=M[O].texture}return E}function aa(z,A,E){let O=a.TEXTURE_2D;if(A.isDataArrayTexture||A.isCompressedArrayTexture)O=a.TEXTURE_2D_ARRAY;A.isData3DTexture&&(O=a.TEXTURE_3D);var M=D(z,A);const ra=A.source;c.bindTexture(O,z.__webglTexture,a.TEXTURE0+E);const Pa=d.get(ra);if(ra.version!==Pa.__version||!0===M){c.activeTexture(a.TEXTURE0+E);E=Kb.getPrimaries(Kb.workingColorSpace);var Fa=""===A.colorSpace?null:Kb.getPrimaries(A.colorSpace);
E=""===A.colorSpace||E===Fa?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,A.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,A.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,E);E=na?!1:1001!==A.wrapS||1001!==A.wrapT||1003!==A.minFilter&&1006!==A.minFilter;E=E&&!1===h(A.image);var oa=k(A.image,E,!1,e.maxTextureSize);oa=fa(A,oa);E=h(oa)||na;Fa=f.convert(A.format,A.colorSpace);let ia=f.convert(A.type),
Ka=n(A.internalFormat,Fa,ia,A.colorSpace,A.isVideoTexture);u(O,A,E);var H=A.mipmaps,sa=na&&!0!==A.isVideoTexture&&36196!==Ka;const Ta=void 0===Pa.__version||!0===M,mb=ra.dataReady;M=m(A,oa,E);if(A.isDepthTexture)Ka=a.DEPTH_COMPONENT,na?Ka=1015===A.type?a.DEPTH_COMPONENT32F:1014===A.type?a.DEPTH_COMPONENT24:1020===A.type?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT16:1015===A.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===A.format&&Ka===a.DEPTH_COMPONENT&&1012!==
A.type&&1014!==A.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),A.type=1014,ia=f.convert(A.type)),1027===A.format&&Ka===a.DEPTH_COMPONENT&&(Ka=a.DEPTH_STENCIL,1020!==A.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),A.type=1020,ia=f.convert(A.type))),Ta&&(sa?c.texStorage2D(a.TEXTURE_2D,1,Ka,oa.width,oa.height):c.texImage2D(a.TEXTURE_2D,0,Ka,oa.width,oa.height,0,Fa,ia,null));
else if(A.isDataTexture)if(0<H.length&&E){sa&&Ta&&c.texStorage2D(a.TEXTURE_2D,M,Ka,H[0].width,H[0].height);for(let db=0,Ib=H.length;db<Ib;db++)M=H[db],sa?mb&&c.texSubImage2D(a.TEXTURE_2D,db,0,0,M.width,M.height,Fa,ia,M.data):c.texImage2D(a.TEXTURE_2D,db,Ka,M.width,M.height,0,Fa,ia,M.data);A.generateMipmaps=!1}else sa?(Ta&&c.texStorage2D(a.TEXTURE_2D,M,Ka,oa.width,oa.height),mb&&c.texSubImage2D(a.TEXTURE_2D,0,0,0,oa.width,oa.height,Fa,ia,oa.data)):c.texImage2D(a.TEXTURE_2D,0,Ka,oa.width,oa.height,
0,Fa,ia,oa.data);else if(A.isCompressedTexture)if(A.isCompressedArrayTexture){sa&&Ta&&c.texStorage3D(a.TEXTURE_2D_ARRAY,M,Ka,H[0].width,H[0].height,oa.depth);for(let db=0,Ib=H.length;db<Ib;db++)M=H[db],1023!==A.format?null!==Fa?sa?mb&&c.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,db,0,0,0,M.width,M.height,oa.depth,Fa,M.data,0,0):c.compressedTexImage3D(a.TEXTURE_2D_ARRAY,db,Ka,M.width,M.height,oa.depth,0,M.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):
sa?mb&&c.texSubImage3D(a.TEXTURE_2D_ARRAY,db,0,0,0,M.width,M.height,oa.depth,Fa,ia,M.data):c.texImage3D(a.TEXTURE_2D_ARRAY,db,Ka,M.width,M.height,oa.depth,0,Fa,ia,M.data)}else{sa&&Ta&&c.texStorage2D(a.TEXTURE_2D,M,Ka,H[0].width,H[0].height);for(let db=0,Ib=H.length;db<Ib;db++)M=H[db],1023!==A.format?null!==Fa?sa?mb&&c.compressedTexSubImage2D(a.TEXTURE_2D,db,0,0,M.width,M.height,Fa,M.data):c.compressedTexImage2D(a.TEXTURE_2D,db,Ka,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):
sa?mb&&c.texSubImage2D(a.TEXTURE_2D,db,0,0,M.width,M.height,Fa,ia,M.data):c.texImage2D(a.TEXTURE_2D,db,Ka,M.width,M.height,0,Fa,ia,M.data)}else if(A.isDataArrayTexture)sa?(Ta&&c.texStorage3D(a.TEXTURE_2D_ARRAY,M,Ka,oa.width,oa.height,oa.depth),mb&&c.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,oa.width,oa.height,oa.depth,Fa,ia,oa.data)):c.texImage3D(a.TEXTURE_2D_ARRAY,0,Ka,oa.width,oa.height,oa.depth,0,Fa,ia,oa.data);else if(A.isData3DTexture)sa?(Ta&&c.texStorage3D(a.TEXTURE_3D,M,Ka,oa.width,oa.height,
oa.depth),mb&&c.texSubImage3D(a.TEXTURE_3D,0,0,0,0,oa.width,oa.height,oa.depth,Fa,ia,oa.data)):c.texImage3D(a.TEXTURE_3D,0,Ka,oa.width,oa.height,oa.depth,0,Fa,ia,oa.data);else if(A.isFramebufferTexture){if(Ta)if(sa)c.texStorage2D(a.TEXTURE_2D,M,Ka,oa.width,oa.height);else for(H=oa.width,oa=oa.height,sa=0;sa<M;sa++)c.texImage2D(a.TEXTURE_2D,sa,Ka,H,oa,0,Fa,ia,null),H>>=1,oa>>=1}else if(0<H.length&&E){sa&&Ta&&(oa=ea(H[0]),c.texStorage2D(a.TEXTURE_2D,M,Ka,oa.width,oa.height));for(let db=0,Ib=H.length;db<
Ib;db++)M=H[db],sa?mb&&c.texSubImage2D(a.TEXTURE_2D,db,0,0,Fa,ia,M):c.texImage2D(a.TEXTURE_2D,db,Ka,Fa,ia,M);A.generateMipmaps=!1}else sa?(Ta&&(H=ea(oa),c.texStorage2D(a.TEXTURE_2D,M,Ka,H.width,H.height)),mb&&c.texSubImage2D(a.TEXTURE_2D,0,0,0,Fa,ia,oa)):c.texImage2D(a.TEXTURE_2D,0,Ka,Fa,ia,oa);l(A,E)&&a.generateMipmap(O);Pa.__version=ra.version;if(A.onUpdate)A.onUpdate(A)}z.__version=A.version}function J(z,A,E,O,M,ra){const Pa=f.convert(E.format,E.colorSpace),Fa=f.convert(E.type),oa=n(E.internalFormat,
Pa,Fa,E.colorSpace);if(!d.get(A).__hasExternalTextures){const H=Math.max(1,A.width>>ra),sa=Math.max(1,A.height>>ra);M===a.TEXTURE_3D||M===a.TEXTURE_2D_ARRAY?c.texImage3D(M,ra,oa,H,sa,A.depth,0,Pa,Fa,null):c.texImage2D(M,ra,oa,H,sa,0,Pa,Fa,null)}c.bindFramebuffer(a.FRAMEBUFFER,z);R(A)?Ea.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,O,M,d.get(E).__webglTexture,0,W(A)):(M===a.TEXTURE_2D||M>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&M<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,O,M,
d.get(E).__webglTexture,ra);c.bindFramebuffer(a.FRAMEBUFFER,null)}function K(z,A,E){a.bindRenderbuffer(a.RENDERBUFFER,z);if(A.depthBuffer&&!A.stencilBuffer){var O=!0===na?a.DEPTH_COMPONENT24:a.DEPTH_COMPONENT16;E||R(A)?((E=A.depthTexture)&&E.isDepthTexture&&(1015===E.type?O=a.DEPTH_COMPONENT32F:1014===E.type&&(O=a.DEPTH_COMPONENT24)),E=W(A),R(A)?Ea.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,E,O,A.width,A.height):a.renderbufferStorageMultisample(a.RENDERBUFFER,E,O,A.width,A.height)):a.renderbufferStorage(a.RENDERBUFFER,
O,A.width,A.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,z)}else if(A.depthBuffer&&A.stencilBuffer)O=W(A),E&&!1===R(A)?a.renderbufferStorageMultisample(a.RENDERBUFFER,O,a.DEPTH24_STENCIL8,A.width,A.height):R(A)?Ea.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,O,a.DEPTH24_STENCIL8,A.width,A.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,A.width,A.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,z);else for(z=
A.textures,O=0;O<z.length;O++){var M=z[O],ra=f.convert(M.format,M.colorSpace);const Pa=f.convert(M.type);M=n(M.internalFormat,ra,Pa,M.colorSpace);ra=W(A);E&&!1===R(A)?a.renderbufferStorageMultisample(a.RENDERBUFFER,ra,M,A.width,A.height):R(A)?Ea.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,ra,M,A.width,A.height):a.renderbufferStorage(a.RENDERBUFFER,M,A.width,A.height)}a.bindRenderbuffer(a.RENDERBUFFER,null)}function U(z){var A=d.get(z),E=!0===z.isWebGLCubeRenderTarget;if(z.depthTexture&&!A.__autoAllocateDepthBuffer){if(E)throw Error("target.depthTexture not supported in Cube render targets");
A=A.__webglFramebuffer;if(z&&z.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");c.bindFramebuffer(a.FRAMEBUFFER,A);if(!z.depthTexture||!z.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(z.depthTexture).__webglTexture&&z.depthTexture.image.width===z.width&&z.depthTexture.image.height===z.height||(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=
!0);C(z.depthTexture,0);A=d.get(z.depthTexture).__webglTexture;E=W(z);if(1026===z.depthTexture.format)R(z)?Ea.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,A,0,E):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,A,0);else if(1027===z.depthTexture.format)R(z)?Ea.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,A,0,E):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,A,0);else throw Error("Unknown depthTexture format");
}else if(E)for(A.__webglDepthbuffer=[],E=0;6>E;E++)c.bindFramebuffer(a.FRAMEBUFFER,A.__webglFramebuffer[E]),A.__webglDepthbuffer[E]=a.createRenderbuffer(),K(A.__webglDepthbuffer[E],z,!1);else c.bindFramebuffer(a.FRAMEBUFFER,A.__webglFramebuffer),A.__webglDepthbuffer=a.createRenderbuffer(),K(A.__webglDepthbuffer,z,!1);c.bindFramebuffer(a.FRAMEBUFFER,null)}function W(z){return Math.min(e.maxSamples,z.samples)}function R(z){const A=d.get(z);return na&&0<z.samples&&!0===b.has("WEBGL_multisampled_render_to_texture")&&
!1!==A.__useRenderToTexture}function fa(z,A){const E=z.colorSpace,O=z.format,M=z.type;if(!0===z.isCompressedTexture||!0===z.isVideoTexture||1035===z.format)return A;"srgb-linear"!==E&&""!==E&&("srgb"===Kb.getTransfer(E)?!1===na?!0===b.has("EXT_sRGB")&&1023===O?(z.format=1035,z.minFilter=1006,z.generateMipmaps=!1):A=kg.sRGBToLinear(A):1023===O&&1009===M||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",
E));return A}function ea(z){"undefined"!==typeof HTMLImageElement&&z instanceof HTMLImageElement?(Ga.width=z.naturalWidth||z.width,Ga.height=z.naturalHeight||z.height):"undefined"!==typeof VideoFrame&&z instanceof VideoFrame?(Ga.width=z.displayWidth,Ga.height=z.displayHeight):(Ga.width=z.width,Ga.height=z.height);return Ga}const na=e.isWebGL2,Ea=b.has("WEBGL_multisampled_render_to_texture")?b.get("WEBGL_multisampled_render_to_texture"):null,ca="undefined"===typeof navigator?!1:/OculusBrowser/g.test(navigator.userAgent),
Ga=new xa,ta=new WeakMap;let Sa;const cb=new WeakMap;let $a=!1;try{$a="undefined"!==typeof OffscreenCanvas&&null!==(new OffscreenCanvas(1,1)).getContext("2d")}catch(z){}let Ha=0;const Ba={[1E3]:a.REPEAT,[1001]:a.CLAMP_TO_EDGE,[1002]:a.MIRRORED_REPEAT},Ia={[1003]:a.NEAREST,[1004]:a.NEAREST_MIPMAP_NEAREST,[1005]:a.NEAREST_MIPMAP_LINEAR,[1006]:a.LINEAR,[1007]:a.LINEAR_MIPMAP_NEAREST,[1008]:a.LINEAR_MIPMAP_LINEAR},Xa={[512]:a.NEVER,[519]:a.ALWAYS,[513]:a.LESS,[515]:a.LEQUAL,[514]:a.EQUAL,[518]:a.GEQUAL,
[516]:a.GREATER,[517]:a.NOTEQUAL};this.allocateTextureUnit=function(){const z=Ha;z>=e.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+z+" texture units while this GPU supports only "+e.maxTextures);Ha+=1;return z};this.resetTextureUnits=function(){Ha=0};this.setTexture2D=C;this.setTexture2DArray=function(z,A){const E=d.get(z);0<z.version&&E.__version!==z.version?aa(E,z,A):c.bindTexture(a.TEXTURE_2D_ARRAY,E.__webglTexture,a.TEXTURE0+A)};this.setTexture3D=function(z,A){const E=d.get(z);
0<z.version&&E.__version!==z.version?aa(E,z,A):c.bindTexture(a.TEXTURE_3D,E.__webglTexture,a.TEXTURE0+A)};this.setTextureCube=function(z,A){const E=d.get(z);if(0<z.version&&E.__version!==z.version){if(6===z.image.length){var O=D(E,z),M=z.source;c.bindTexture(a.TEXTURE_CUBE_MAP,E.__webglTexture,a.TEXTURE0+A);var ra=d.get(M);if(M.version!==ra.__version||!0===O){c.activeTexture(a.TEXTURE0+A);A=Kb.getPrimaries(Kb.workingColorSpace);var Pa=""===z.colorSpace?null:Kb.getPrimaries(z.colorSpace);A=""===z.colorSpace||
A===Pa?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,z.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,z.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,A);var Fa=z.isCompressedTexture||z.image[0].isCompressedTexture,oa=z.image[0]&&z.image[0].isDataTexture;A=[];for(Pa=0;6>Pa;Pa++)A[Pa]=Fa||oa?oa?z.image[Pa].image:z.image[Pa]:k(z.image[Pa],!1,!0,e.maxCubemapSize),A[Pa]=fa(z,A[Pa]);var H=A[0];Pa=h(H)||
na;const Ka=f.convert(z.format,z.colorSpace),Ta=f.convert(z.type),mb=n(z.internalFormat,Ka,Ta,z.colorSpace),db=na&&!0!==z.isVideoTexture;var sa=void 0===ra.__version||!0===O;O=M.dataReady;var ia=m(z,H,Pa);u(a.TEXTURE_CUBE_MAP,z,Pa);if(Fa)for(db&&sa&&c.texStorage2D(a.TEXTURE_CUBE_MAP,ia,mb,H.width,H.height),oa=0;6>oa;oa++)for(Fa=A[oa].mipmaps,ia=0;ia<Fa.length;ia++)H=Fa[ia],1023!==z.format?null!==Ka?db?O&&c.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+oa,ia,0,0,H.width,H.height,Ka,H.data):
c.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+oa,ia,mb,H.width,H.height,0,H.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):db?O&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+oa,ia,0,0,H.width,H.height,Ka,Ta,H.data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+oa,ia,mb,H.width,H.height,0,Ka,Ta,H.data);else for(Fa=z.mipmaps,db&&sa&&(0<Fa.length&&ia++,H=ea(A[0]),c.texStorage2D(a.TEXTURE_CUBE_MAP,ia,mb,H.width,H.height)),ia=
0;6>ia;ia++)if(oa)for(db?O&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,0,0,0,A[ia].width,A[ia].height,Ka,Ta,A[ia].data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,0,mb,A[ia].width,A[ia].height,0,Ka,Ta,A[ia].data),H=0;H<Fa.length;H++)sa=Fa[H].image[ia].image,db?O&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,H+1,0,0,sa.width,sa.height,Ka,Ta,sa.data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,H+1,mb,sa.width,sa.height,0,Ka,Ta,sa.data);else for(db?O&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+
ia,0,0,0,Ka,Ta,A[ia]):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,0,mb,Ka,Ta,A[ia]),H=0;H<Fa.length;H++)sa=Fa[H],db?O&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,H+1,0,0,Ka,Ta,sa.image[ia]):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ia,H+1,mb,Ka,Ta,sa.image[ia]);l(z,Pa)&&a.generateMipmap(a.TEXTURE_CUBE_MAP);ra.__version=M.version;if(z.onUpdate)z.onUpdate(z)}E.__version=z.version}}else c.bindTexture(a.TEXTURE_CUBE_MAP,E.__webglTexture,a.TEXTURE0+A)};this.rebindTextures=function(z,A,E){const O=
d.get(z);void 0!==A&&J(O.__webglFramebuffer,z,z.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0);void 0!==E&&U(z)};this.setupRenderTarget=function(z){var A=z.texture;const E=d.get(z);var O=d.get(A);z.addEventListener("dispose",t);var M=z.textures;const ra=!0===z.isWebGLCubeRenderTarget,Pa=1<M.length,Fa=h(z)||na;Pa||(void 0===O.__webglTexture&&(O.__webglTexture=a.createTexture()),O.__version=A.version,g.memory.textures++);if(ra){E.__webglFramebuffer=[];for(var oa=0;6>oa;oa++)if(na&&A.mipmaps&&0<A.mipmaps.length){E.__webglFramebuffer[oa]=
[];for(var H=0;H<A.mipmaps.length;H++)E.__webglFramebuffer[oa][H]=a.createFramebuffer()}else E.__webglFramebuffer[oa]=a.createFramebuffer()}else{if(na&&A.mipmaps&&0<A.mipmaps.length)for(E.__webglFramebuffer=[],oa=0;oa<A.mipmaps.length;oa++)E.__webglFramebuffer[oa]=a.createFramebuffer();else E.__webglFramebuffer=a.createFramebuffer();if(Pa)if(e.drawBuffers)for(let ia=0,Ka=M.length;ia<Ka;ia++)oa=d.get(M[ia]),void 0===oa.__webglTexture&&(oa.__webglTexture=a.createTexture(),g.memory.textures++);else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");
if(na&&0<z.samples&&!1===R(z)){E.__webglMultisampledFramebuffer=a.createFramebuffer();E.__webglColorRenderbuffer=[];c.bindFramebuffer(a.FRAMEBUFFER,E.__webglMultisampledFramebuffer);for(oa=0;oa<M.length;oa++){H=M[oa];E.__webglColorRenderbuffer[oa]=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,E.__webglColorRenderbuffer[oa]);var sa=f.convert(H.format,H.colorSpace);const ia=f.convert(H.type);H=n(H.internalFormat,sa,ia,H.colorSpace,!0===z.isXRRenderTarget);sa=W(z);a.renderbufferStorageMultisample(a.RENDERBUFFER,
sa,H,z.width,z.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+oa,a.RENDERBUFFER,E.__webglColorRenderbuffer[oa])}a.bindRenderbuffer(a.RENDERBUFFER,null);z.depthBuffer&&(E.__webglDepthRenderbuffer=a.createRenderbuffer(),K(E.__webglDepthRenderbuffer,z,!0));c.bindFramebuffer(a.FRAMEBUFFER,null)}}if(ra){c.bindTexture(a.TEXTURE_CUBE_MAP,O.__webglTexture);u(a.TEXTURE_CUBE_MAP,A,Fa);for(M=0;6>M;M++)if(na&&A.mipmaps&&0<A.mipmaps.length)for(O=0;O<A.mipmaps.length;O++)J(E.__webglFramebuffer[M][O],
z,A,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+M,O);else J(E.__webglFramebuffer[M],z,A,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+M,0);l(A,Fa)&&a.generateMipmap(a.TEXTURE_CUBE_MAP)}else if(Pa)for(let ia=0,Ka=M.length;ia<Ka;ia++)A=M[ia],O=d.get(A),c.bindTexture(a.TEXTURE_2D,O.__webglTexture),u(a.TEXTURE_2D,A,Fa),J(E.__webglFramebuffer,z,A,a.COLOR_ATTACHMENT0+ia,a.TEXTURE_2D,0),l(A,Fa)&&a.generateMipmap(a.TEXTURE_2D);else{M=a.TEXTURE_2D;if(z.isWebGL3DRenderTarget||z.isWebGLArrayRenderTarget)na?
M=z.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.");c.bindTexture(M,O.__webglTexture);u(M,A,Fa);if(na&&A.mipmaps&&0<A.mipmaps.length)for(O=0;O<A.mipmaps.length;O++)J(E.__webglFramebuffer[O],z,A,a.COLOR_ATTACHMENT0,M,O);else J(E.__webglFramebuffer,z,A,a.COLOR_ATTACHMENT0,M,0);l(A,Fa)&&a.generateMipmap(M)}c.unbindTexture();z.depthBuffer&&U(z)};this.updateRenderTargetMipmap=function(z){const A=
h(z)||na,E=z.textures;for(let M=0,ra=E.length;M<ra;M++){var O=E[M];if(l(O,A)){const Pa=z.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D;O=d.get(O).__webglTexture;c.bindTexture(Pa,O);a.generateMipmap(Pa);c.unbindTexture()}}};this.updateMultisampleRenderTarget=function(z){if(na&&0<z.samples&&!1===R(z)){const M=z.textures;var A=z.width;const ra=z.height;let Pa=a.COLOR_BUFFER_BIT;const Fa=[],oa=z.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,H=d.get(z),sa=1<M.length;if(sa)for(var E=
0;E<M.length;E++)c.bindFramebuffer(a.FRAMEBUFFER,H.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+E,a.RENDERBUFFER,null),c.bindFramebuffer(a.FRAMEBUFFER,H.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+E,a.TEXTURE_2D,null,0);c.bindFramebuffer(a.READ_FRAMEBUFFER,H.__webglMultisampledFramebuffer);c.bindFramebuffer(a.DRAW_FRAMEBUFFER,H.__webglFramebuffer);for(E=0;E<M.length;E++){Fa.push(a.COLOR_ATTACHMENT0+E);z.depthBuffer&&
Fa.push(oa);var O=void 0!==H.__ignoreDepthValues?H.__ignoreDepthValues:!1;!1===O&&(z.depthBuffer&&(Pa|=a.DEPTH_BUFFER_BIT),z.stencilBuffer&&(Pa|=a.STENCIL_BUFFER_BIT));sa&&a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,H.__webglColorRenderbuffer[E]);!0===O&&(a.invalidateFramebuffer(a.READ_FRAMEBUFFER,[oa]),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[oa]));sa&&(O=d.get(M[E]).__webglTexture,a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,O,
0));a.blitFramebuffer(0,0,A,ra,0,0,A,ra,Pa,a.NEAREST);ca&&a.invalidateFramebuffer(a.READ_FRAMEBUFFER,Fa)}c.bindFramebuffer(a.READ_FRAMEBUFFER,null);c.bindFramebuffer(a.DRAW_FRAMEBUFFER,null);if(sa)for(z=0;z<M.length;z++)c.bindFramebuffer(a.FRAMEBUFFER,H.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+z,a.RENDERBUFFER,H.__webglColorRenderbuffer[z]),A=d.get(M[z]).__webglTexture,c.bindFramebuffer(a.FRAMEBUFFER,H.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,
a.COLOR_ATTACHMENT0+z,a.TEXTURE_2D,A,0);c.bindFramebuffer(a.DRAW_FRAMEBUFFER,H.__webglMultisampledFramebuffer)}};this.setupDepthRenderbuffer=U;this.setupFrameBufferTexture=J;this.useMultisampledRTT=R}function vi(a,b,c){const d=c.isWebGL2;return{convert:function(e,f=""){const g=Kb.getTransfer(f);if(1009===e)return a.UNSIGNED_BYTE;if(1017===e)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return a.UNSIGNED_SHORT_5_5_5_1;if(1010===e)return a.BYTE;if(1011===e)return a.SHORT;if(1012===e)return a.UNSIGNED_SHORT;
if(1013===e)return a.INT;if(1014===e)return a.UNSIGNED_INT;if(1015===e)return a.FLOAT;if(1016===e){if(d)return a.HALF_FLOAT;f=b.get("OES_texture_half_float");return null!==f?f.HALF_FLOAT_OES:null}if(1021===e)return a.ALPHA;if(1023===e)return a.RGBA;if(1024===e)return a.LUMINANCE;if(1025===e)return a.LUMINANCE_ALPHA;if(1026===e)return a.DEPTH_COMPONENT;if(1027===e)return a.DEPTH_STENCIL;if(1035===e)return f=b.get("EXT_sRGB"),null!==f?f.SRGB_ALPHA_EXT:null;if(1028===e)return a.RED;if(1029===e)return a.RED_INTEGER;
if(1030===e)return a.RG;if(1031===e)return a.RG_INTEGER;if(1033===e)return a.RGBA_INTEGER;if(33776===e||33777===e||33778===e||33779===e)if("srgb"===g)if(f=b.get("WEBGL_compressed_texture_s3tc_srgb"),null!==f){if(33776===e)return f.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===e)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===e)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===e)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(f=b.get("WEBGL_compressed_texture_s3tc"),
null!==f){if(33776===e)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(35840===e||35841===e||35842===e||35843===e)if(f=b.get("WEBGL_compressed_texture_pvrtc"),null!==f){if(35840===e)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===
e)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(36196===e)return f=b.get("WEBGL_compressed_texture_etc1"),null!==f?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===e||37496===e)if(f=b.get("WEBGL_compressed_texture_etc"),null!==f){if(37492===e)return"srgb"===g?f.COMPRESSED_SRGB8_ETC2:f.COMPRESSED_RGB8_ETC2;if(37496===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:f.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===
e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e)if(f=b.get("WEBGL_compressed_texture_astc"),null!==f){if(37808===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:f.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:f.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:f.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:
f.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:f.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:f.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:f.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:f.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:
f.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:f.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:f.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:f.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:f.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===e)return"srgb"===g?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:
f.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(36492===e||36494===e||36495===e)if(f=b.get("EXT_texture_compression_bptc"),null!==f){if(36492===e)return"srgb"===g?f.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:f.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===e)return f.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===e)return f.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(36283===e||36284===e||36285===e||36286===e)if(f=b.get("EXT_texture_compression_rgtc"),null!==f){if(36492===e)return f.COMPRESSED_RED_RGTC1_EXT;
if(36284===e)return f.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===e)return f.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===e)return f.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;if(1020===e){if(d)return a.UNSIGNED_INT_24_8;f=b.get("WEBGL_depth_texture");return null!==f?f.UNSIGNED_INT_24_8_WEBGL:null}return void 0!==a[e]?a[e]:null}}}function Gl(a,b){function c(e,f){!0===e.matrixAutoUpdate&&e.updateMatrix();f.value.copy(e.matrix)}function d(e,f){e.opacity.value=f.opacity;f.color&&e.diffuse.value.copy(f.color);
f.emissive&&e.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity);f.map&&(e.map.value=f.map,c(f.map,e.mapTransform));f.alphaMap&&(e.alphaMap.value=f.alphaMap,c(f.alphaMap,e.alphaMapTransform));f.bumpMap&&(e.bumpMap.value=f.bumpMap,c(f.bumpMap,e.bumpMapTransform),e.bumpScale.value=f.bumpScale,1===f.side&&(e.bumpScale.value*=-1));f.normalMap&&(e.normalMap.value=f.normalMap,c(f.normalMap,e.normalMapTransform),e.normalScale.value.copy(f.normalScale),1===f.side&&e.normalScale.value.negate());
f.displacementMap&&(e.displacementMap.value=f.displacementMap,c(f.displacementMap,e.displacementMapTransform),e.displacementScale.value=f.displacementScale,e.displacementBias.value=f.displacementBias);f.emissiveMap&&(e.emissiveMap.value=f.emissiveMap,c(f.emissiveMap,e.emissiveMapTransform));f.specularMap&&(e.specularMap.value=f.specularMap,c(f.specularMap,e.specularMapTransform));0<f.alphaTest&&(e.alphaTest.value=f.alphaTest);var g=b.get(f);const k=g.envMap;g=g.envMapRotation;k&&(e.envMap.value=k,
Jc.copy(g),Jc.x*=-1,Jc.y*=-1,Jc.z*=-1,k.isCubeTexture&&!1===k.isRenderTargetTexture&&(Jc.y*=-1,Jc.z*=-1),e.envMapRotation.value.setFromMatrix4(Hl.makeRotationFromEuler(Jc)),e.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,e.reflectivity.value=f.reflectivity,e.ior.value=f.ior,e.refractionRatio.value=f.refractionRatio);f.lightMap&&(e.lightMap.value=f.lightMap,e.lightMapIntensity.value=f.lightMapIntensity*(!0===a._useLegacyLights?Math.PI:1),c(f.lightMap,e.lightMapTransform));f.aoMap&&
(e.aoMap.value=f.aoMap,e.aoMapIntensity.value=f.aoMapIntensity,c(f.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(e,f){f.color.getRGB(e.fogColor.value,ya(a));f.isFog?(e.fogNear.value=f.near,e.fogFar.value=f.far):f.isFogExp2&&(e.fogDensity.value=f.density)},refreshMaterialUniforms:function(e,f,g,k,h){f.isMeshBasicMaterial?d(e,f):f.isMeshLambertMaterial?d(e,f):f.isMeshToonMaterial?(d(e,f),f.gradientMap&&(e.gradientMap.value=f.gradientMap)):f.isMeshPhongMaterial?(d(e,f),e.specular.value.copy(f.specular),
e.shininess.value=Math.max(f.shininess,1E-4)):f.isMeshStandardMaterial?(d(e,f),e.metalness.value=f.metalness,f.metalnessMap&&(e.metalnessMap.value=f.metalnessMap,c(f.metalnessMap,e.metalnessMapTransform)),e.roughness.value=f.roughness,f.roughnessMap&&(e.roughnessMap.value=f.roughnessMap,c(f.roughnessMap,e.roughnessMapTransform)),b.get(f).envMap&&(e.envMapIntensity.value=f.envMapIntensity),f.isMeshPhysicalMaterial&&(e.ior.value=f.ior,0<f.sheen&&(e.sheenColor.value.copy(f.sheenColor).multiplyScalar(f.sheen),
e.sheenRoughness.value=f.sheenRoughness,f.sheenColorMap&&(e.sheenColorMap.value=f.sheenColorMap,c(f.sheenColorMap,e.sheenColorMapTransform)),f.sheenRoughnessMap&&(e.sheenRoughnessMap.value=f.sheenRoughnessMap,c(f.sheenRoughnessMap,e.sheenRoughnessMapTransform))),0<f.clearcoat&&(e.clearcoat.value=f.clearcoat,e.clearcoatRoughness.value=f.clearcoatRoughness,f.clearcoatMap&&(e.clearcoatMap.value=f.clearcoatMap,c(f.clearcoatMap,e.clearcoatMapTransform)),f.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=
f.clearcoatRoughnessMap,c(f.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),f.clearcoatNormalMap&&(e.clearcoatNormalMap.value=f.clearcoatNormalMap,c(f.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),1===f.side&&e.clearcoatNormalScale.value.negate())),0<f.iridescence&&(e.iridescence.value=f.iridescence,e.iridescenceIOR.value=f.iridescenceIOR,e.iridescenceThicknessMinimum.value=f.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=
f.iridescenceThicknessRange[1],f.iridescenceMap&&(e.iridescenceMap.value=f.iridescenceMap,c(f.iridescenceMap,e.iridescenceMapTransform)),f.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=f.iridescenceThicknessMap,c(f.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),0<f.transmission&&(e.transmission.value=f.transmission,e.transmissionSamplerMap.value=h.texture,e.transmissionSamplerSize.value.set(h.width,h.height),f.transmissionMap&&(e.transmissionMap.value=f.transmissionMap,
c(f.transmissionMap,e.transmissionMapTransform)),e.thickness.value=f.thickness,f.thicknessMap&&(e.thicknessMap.value=f.thicknessMap,c(f.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=f.attenuationDistance,e.attenuationColor.value.copy(f.attenuationColor)),0<f.anisotropy&&(e.anisotropyVector.value.set(f.anisotropy*Math.cos(f.anisotropyRotation),f.anisotropy*Math.sin(f.anisotropyRotation)),f.anisotropyMap&&(e.anisotropyMap.value=f.anisotropyMap,c(f.anisotropyMap,e.anisotropyMapTransform))),
e.specularIntensity.value=f.specularIntensity,e.specularColor.value.copy(f.specularColor),f.specularColorMap&&(e.specularColorMap.value=f.specularColorMap,c(f.specularColorMap,e.specularColorMapTransform)),f.specularIntensityMap&&(e.specularIntensityMap.value=f.specularIntensityMap,c(f.specularIntensityMap,e.specularIntensityMapTransform)))):f.isMeshMatcapMaterial?(d(e,f),f.matcap&&(e.matcap.value=f.matcap)):f.isMeshDepthMaterial?d(e,f):f.isMeshDistanceMaterial?(d(e,f),f=b.get(f).light,e.referencePosition.value.setFromMatrixPosition(f.matrixWorld),
e.nearDistance.value=f.shadow.camera.near,e.farDistance.value=f.shadow.camera.far):f.isMeshNormalMaterial?d(e,f):f.isLineBasicMaterial?(e.diffuse.value.copy(f.color),e.opacity.value=f.opacity,f.map&&(e.map.value=f.map,c(f.map,e.mapTransform)),f.isLineDashedMaterial&&(e.dashSize.value=f.dashSize,e.totalSize.value=f.dashSize+f.gapSize,e.scale.value=f.scale)):f.isPointsMaterial?(e.diffuse.value.copy(f.color),e.opacity.value=f.opacity,e.size.value=f.size*g,e.scale.value=.5*k,f.map&&(e.map.value=f.map,
c(f.map,e.uvTransform)),f.alphaMap&&(e.alphaMap.value=f.alphaMap,c(f.alphaMap,e.alphaMapTransform)),0<f.alphaTest&&(e.alphaTest.value=f.alphaTest)):f.isSpriteMaterial?(e.diffuse.value.copy(f.color),e.opacity.value=f.opacity,e.rotation.value=f.rotation,f.map&&(e.map.value=f.map,c(f.map,e.mapTransform)),f.alphaMap&&(e.alphaMap.value=f.alphaMap,c(f.alphaMap,e.alphaMapTransform)),0<f.alphaTest&&(e.alphaTest.value=f.alphaTest)):f.isShadowMaterial?(e.color.value.copy(f.color),e.opacity.value=f.opacity):
f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}}}function Il(a,b,c,d){function e(m){var p=m.uniforms;let v=0;for(let t=0,x=p.length;t<x;t++){const C=Array.isArray(p[t])?p[t]:[p[t]];for(let u=0,D=C.length;u<D;u++){const aa=C[u],J=Array.isArray(aa.value)?aa.value:[aa.value];for(let K=0,U=J.length;K<U;K++){const W=f(J[K]),R=v%16;0!==R&&16-R<W.boundary&&(v+=16-R);aa.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT);aa.__offset=v;v+=W.storage}}}p=v%16;0<p&&(v+=16-p);m.__size=v;m.__cache=
{};return this}function f(m){const p={boundary:0,storage:0};"number"===typeof m||"boolean"===typeof m?(p.boundary=4,p.storage=4):m.isVector2?(p.boundary=8,p.storage=8):m.isVector3||m.isColor?(p.boundary=16,p.storage=12):m.isVector4?(p.boundary=16,p.storage=16):m.isMatrix3?(p.boundary=48,p.storage=48):m.isMatrix4?(p.boundary=64,p.storage=64):m.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",
m);return p}function g(m){m=m.target;m.removeEventListener("dispose",g);const p=l.indexOf(m.__bindingPointIndex);l.splice(p,1);a.deleteBuffer(k[m.id]);delete k[m.id];delete h[m.id]}let k={},h={},l=[];const n=c.isWebGL2?a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS):0;return{bind:function(m,p){d.uniformBlockBinding(m,p.program)},update:function(m,p){var v=k[m.id];if(void 0===v){e(m);a:{for(v=0;v<n;v++)if(-1===l.indexOf(v)){l.push(v);break a}console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.");
v=0}m.__bindingPointIndex=v;var t=a.createBuffer(),x=m.__size,C=m.usage;a.bindBuffer(a.UNIFORM_BUFFER,t);a.bufferData(a.UNIFORM_BUFFER,x,C);a.bindBuffer(a.UNIFORM_BUFFER,null);a.bindBufferBase(a.UNIFORM_BUFFER,v,t);v=t;k[m.id]=v;m.addEventListener("dispose",g)}d.updateUBOMapping(m,p.program);p=b.render.frame;if(h[m.id]!==p){v=m.uniforms;t=m.__cache;a.bindBuffer(a.UNIFORM_BUFFER,k[m.id]);for(let J=0,K=v.length;J<K;J++){x=Array.isArray(v[J])?v[J]:[v[J]];for(let U=0,W=x.length;U<W;U++){C=x[U];a:{var u=
C.value;var D=J+"_"+U;if(void 0===t[D])t[D]="number"===typeof u||"boolean"===typeof u?u:u.clone(),u=!0;else{var aa=t[D];if("number"===typeof u||"boolean"===typeof u){if(aa!==u){t[D]=u;u=!0;break a}}else if(!1===aa.equals(u)){aa.copy(u);u=!0;break a}u=!1}}if(!0===u){u=C.__offset;D=Array.isArray(C.value)?C.value:[C.value];aa=0;for(let R=0;R<D.length;R++){const fa=D[R],ea=f(fa);"number"===typeof fa||"boolean"===typeof fa?(C.__data[0]=fa,a.bufferSubData(a.UNIFORM_BUFFER,u+aa,C.__data)):fa.isMatrix3?(C.__data[0]=
fa.elements[0],C.__data[1]=fa.elements[1],C.__data[2]=fa.elements[2],C.__data[3]=0,C.__data[4]=fa.elements[3],C.__data[5]=fa.elements[4],C.__data[6]=fa.elements[5],C.__data[7]=0,C.__data[8]=fa.elements[6],C.__data[9]=fa.elements[7],C.__data[10]=fa.elements[8],C.__data[11]=0):(fa.toArray(C.__data,aa),aa+=ea.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,u,C.__data)}}}a.bindBuffer(a.UNIFORM_BUFFER,null);h[m.id]=p}},dispose:function(){for(const m in k)a.deleteBuffer(k[m]);l=
[];k={};h={}}}}function of(a,b,c,d,e,f){de.subVectors(a,c).addScalar(.5).multiply(d);void 0!==e?(Fe.x=f*de.x-e*de.y,Fe.y=e*de.x+f*de.y):Fe.copy(de);a.copy(b);a.x+=Fe.x;a.y+=Fe.y;a.applyMatrix4(wi)}function Jl(a,b){return a.z-b.z}function Kl(a,b){return b.z-a.z}function Ll(a,b,c=0){const d=b.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==b.array.constructor){const e=a.count;for(let f=0;f<e;f++)for(let g=0;g<d;g++)b.setComponent(f+c,g,a.getComponent(f,g))}else b.array.set(a.array,
c*d);b.needsUpdate=!0}function xi(a,b,c,d,e,f,g){const k=wg.distanceSqToPoint(a);k<c&&(c=new I,wg.closestPointToPoint(a,c),c.applyMatrix4(d),a=e.ray.origin.distanceTo(c),a<e.near||a>e.far||f.push({distance:a,distanceToRay:Math.sqrt(k),point:c,index:b,face:null,object:g}))}function xg(){let a=0,b=0,c=0,d=0;return{initCatmullRom:function(e,f,g,k,h){e=h*(g-e);k=h*(k-f);a=f;b=e;c=-3*f+3*g-2*e-k;d=2*f-2*g+e+k},initNonuniformCatmullRom:function(e,f,g,k,h,l,n){e=((f-e)/h-(g-e)/(h+l)+(g-f)/l)*l;k=((g-f)/
l-(k-f)/(l+n)+(k-g)/n)*l;a=f;b=e;c=-3*f+3*g-2*e-k;d=2*f-2*g+e+k},calc:function(e){const f=e*e;return a+b*e+c*f+d*f*e}}}function yi(a,b,c,d,e){b=.5*(d-b);e=.5*(e-c);const f=a*a;return(2*c-2*d+b+e)*a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function Ge(a,b,c,d){const e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function He(a,b,c,d,e){const f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function zi(a,b,c,d,e){let f,g=0;for(let k=b,h=c-d;k<c;k+=d)g+=(a[h]-a[k])*(a[k+1]+a[h+1]),h=k;if(e===0<g)for(e=b;e<c;e+=d)f=
Ai(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=Ai(e,a[e],a[e+1],f);f&&pf(f,f.next)&&(Ie(f),f=f.next);return f}function Gd(a,b){if(!a)return a;b||(b=a);let c;do if(c=!1,a.steiner||!pf(a,a.next)&&0!==Yb(a.prev,a,a.next))a=a.next;else{Ie(a);a=b=a.prev;if(a===a.next)break;c=!0}while(c||a!==b);return b}function Je(a,b,c,d,e,f,g){if(a){if(!g&&f){var k=a,h=k;do 0===h.z&&(h.z=yg(h.x,h.y,d,e,f)),h.prevZ=h.prev,h=h.nextZ=h.next;while(h!==k);h.prevZ.nextZ=null;h.prevZ=null;k=h;var l,n,m,p,v=1;do{h=k;var t=k=
null;for(n=0;h;){n++;var x=h;for(l=m=0;l<v&&(m++,x=x.nextZ,x);l++);for(p=v;0<m||0<p&&x;)0!==m&&(0===p||!x||h.z<=x.z)?(l=h,h=h.nextZ,m--):(l=x,x=x.nextZ,p--),t?t.nextZ=l:k=l,l.prevZ=t,t=l;h=x}t.nextZ=null;v*=2}while(1<n)}for(k=a;a.prev!==a.next;){h=a.prev;x=a.next;if(f)t=Ml(a,d,e,f);else a:{t=a.prev;var C=a;p=a.next;if(0<=Yb(t,C,p)){t=!1;break a}n=t.x;m=C.x;v=p.x;l=t.y;C=C.y;const u=p.y,D=n<m?n<v?n:v:m<v?m:v,aa=l<C?l<u?l:u:C<u?C:u,J=n>m?n>v?n:v:m>v?m:v,K=l>C?l>u?l:u:C>u?C:u;for(p=p.next;p!==t;){if(p.x>=
D&&p.x<=J&&p.y>=aa&&p.y<=K&&ee(n,l,m,C,v,u,p.x,p.y)&&0<=Yb(p.prev,p,p.next)){t=!1;break a}p=p.next}t=!0}if(t)b.push(h.i/c|0),b.push(a.i/c|0),b.push(x.i/c|0),Ie(a),k=a=x.next;else if(a=x,a===k){if(!g)Je(Gd(a),b,c,d,e,f,1);else if(1===g){a=Gd(a);g=b;k=c;h=a;do x=h.prev,t=h.next.next,!pf(x,t)&&Bi(x,h,h.next,t)&&Ke(x,t)&&Ke(t,x)&&(g.push(x.i/k|0),g.push(h.i/k|0),g.push(t.i/k|0),Ie(h),Ie(h.next),h=a=t),h=h.next;while(h!==a);a=Gd(h);Je(a,b,c,d,e,f,2)}else if(2===g)a:{g=a;do{for(k=g.next.next;k!==g.prev;){if(h=
g.i!==k.i){h=g;x=k;if(t=h.next.i!==x.i&&h.prev.i!==x.i){b:{t=h;do{if(t.i!==h.i&&t.next.i!==h.i&&t.i!==x.i&&t.next.i!==x.i&&Bi(t,t.next,h,x)){t=!0;break b}t=t.next}while(t!==h);t=!1}t=!t}if(t){if(t=Ke(h,x)&&Ke(x,h)){t=h;n=!1;m=(h.x+x.x)/2;v=(h.y+x.y)/2;do t.y>v!==t.next.y>v&&t.next.y!==t.y&&m<(t.next.x-t.x)*(v-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==h);t=n}t=t&&(Yb(h.prev,h,x.prev)||Yb(h,x.prev,x))||pf(h,x)&&0<Yb(h.prev,h,h.next)&&0<Yb(x.prev,x,x.next)}h=t}if(h){a=Ci(g,k);g=Gd(g,g.next);
a=Gd(a,a.next);Je(g,b,c,d,e,f,0);Je(a,b,c,d,e,f,0);break a}k=k.next}g=g.next}while(g!==a)}break}}}}function Ml(a,b,c,d){const e=a.prev,f=a.next;if(0<=Yb(e,a,f))return!1;const g=e.x,k=a.x,h=f.x,l=e.y,n=a.y,m=f.y,p=g<k?g<h?g:h:k<h?k:h,v=l<n?l<m?l:m:n<m?n:m,t=g>k?g>h?g:h:k>h?k:h,x=l>n?l>m?l:m:n>m?n:m,C=yg(p,v,b,c,d);b=yg(t,x,b,c,d);c=a.prevZ;for(a=a.nextZ;c&&c.z>=C&&a&&a.z<=b;){if(c.x>=p&&c.x<=t&&c.y>=v&&c.y<=x&&c!==e&&c!==f&&ee(g,l,k,n,h,m,c.x,c.y)&&0<=Yb(c.prev,c,c.next))return!1;c=c.prevZ;if(a.x>=
p&&a.x<=t&&a.y>=v&&a.y<=x&&a!==e&&a!==f&&ee(g,l,k,n,h,m,a.x,a.y)&&0<=Yb(a.prev,a,a.next))return!1;a=a.nextZ}for(;c&&c.z>=C;){if(c.x>=p&&c.x<=t&&c.y>=v&&c.y<=x&&c!==e&&c!==f&&ee(g,l,k,n,h,m,c.x,c.y)&&0<=Yb(c.prev,c,c.next))return!1;c=c.prevZ}for(;a&&a.z<=b;){if(a.x>=p&&a.x<=t&&a.y>=v&&a.y<=x&&a!==e&&a!==f&&ee(g,l,k,n,h,m,a.x,a.y)&&0<=Yb(a.prev,a,a.next))return!1;a=a.nextZ}return!0}function Nl(a,b){return a.x-b.x}function yg(a,b,c,d,e){a=(a-c)*e|0;b=(b-d)*e|0;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;
a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function ee(a,b,c,d,e,f,g,k){return(e-g)*(b-k)>=(a-g)*(f-k)&&(a-g)*(d-k)>=(c-g)*(b-k)&&(c-g)*(f-k)>=(e-g)*(d-k)}function Yb(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function pf(a,b){return a.x===b.x&&a.y===b.y}function Bi(a,b,c,d){const e=qf(Yb(a,b,c)),f=qf(Yb(a,b,d)),g=qf(Yb(c,d,a)),k=qf(Yb(c,d,b));return e!==f&&g!==k||0===e&&rf(a,c,b)||0===f&&rf(a,d,b)||
0===g&&rf(c,a,d)||0===k&&rf(c,b,d)?!0:!1}function rf(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function qf(a){return 0<a?1:0>a?-1:0}function Ke(a,b){return 0>Yb(a.prev,a,a.next)?0<=Yb(a,b,a.next)&&0<=Yb(a,a.prev,b):0>Yb(a,b,a.prev)||0>Yb(a,a.next,b)}function Ci(a,b){const c=new zg(a.i,a.x,a.y),d=new zg(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function Ai(a,b,c,
d){a=new zg(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function Ie(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function zg(a,b,c){this.i=a;this.x=b;this.y=c;this.next=this.prev=null;this.z=0;this.nextZ=this.prevZ=null;this.steiner=!1}function Di(a){const b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function Ei(a,b){for(let c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}function Fi(a,b,c){const d=
`${a.x},${a.y},${a.z}-${b.x},${b.y},${b.z}`;a=`${b.x},${b.y},${b.z}-${a.x},${a.y},${a.z}`;if(!0===c.has(d)||!0===c.has(a))return!1;c.add(d);c.add(a);return!0}function Hd(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)}function Gi(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function Hi(a){const b=a.length,c=Array(b);for(let d=0;d!==b;++d)c[d]=d;c.sort(function(d,e){return a[d]-a[e]});return c}function Ag(a,b,c){const d=
a.length,e=new a.constructor(d);for(let f=0,g=0;g!==d;++f){const k=c[f]*b;for(let h=0;h!==b;++h)e[g++]=a[k+h]}return e}function Bg(a,b,c,d){let e=1,f=a[0];for(;void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),
f=a[e++];while(void 0!==f)}}}function Ol(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return Le;case "vector":case "vector2":case "vector3":case "vector4":return Me;case "color":return Cg;case "quaternion":return fe;case "bool":case "boolean":return Id;case "string":return Jd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Ii(){return("undefined"===typeof performance?Date:performance).now()}function Ji(a,b){return a.distance-
b.distance}function Dg(a,b,c,d){a.layers.test(b.layers)&&a.raycast(b,c);if(!0===d){a=a.children;for(let e=0,f=a.length;e<f;e++)Dg(a[e],b,c,!0)}}function Ki(a){const b=[];!0===a.isBone&&b.push(a);for(let c=0;c<a.children.length;c++)b.push.apply(b,Ki(a.children[c]));return b}function bc(a,b,c,d,e,f,g){sf.set(e,f,g).unproject(d);a=b[a];if(void 0!==a){c=c.getAttribute("position");for(let k=0,h=a.length;k<h;k++)c.setXYZ(a[k],sf.x,sf.y,sf.z)}}class dd{addEventListener(a,b){void 0===this._listeners&&(this._listeners=
{});const c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)}hasEventListener(a,b){if(void 0===this._listeners)return!1;const c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)}removeEventListener(a,b){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1)))}dispatchEvent(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(let c=0,d=b.length;c<d;c++)b[c].call(this,
a);a.target=null}}}}const oc="00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f 40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f 50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f 60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f 80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f 90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff".split(" ");
let Li=1234567;const Kd=Math.PI/180,ge=180/Math.PI,Pl={DEG2RAD:Kd,RAD2DEG:ge,generateUUID:pa,clamp:ib,euclideanModulo:Ma,mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},inverseLerp:function(a,b,c){return a!==b?(c-a)/(b-a):0},lerp:ua,damp:function(a,b,c,d){return ua(a,b,1-Math.exp(-c*d))},pingpong:function(a,b=1){return b-Math.abs(Ma(a,2*b)-b)},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=
c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){void 0!==a&&(Li=a);a=Li+=1831565813;a=Math.imul(a^a>>>15,a|1);a^=a+Math.imul(a^a>>>7,a|61);return((a^a>>>14)>>>0)/4294967296},degToRad:function(a){return a*Kd},radToDeg:function(a){return a*ge},isPowerOfTwo:Ua,ceilPowerOfTwo:function(a){return Math.pow(2,
Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:wa,setQuaternionFromProperEuler:function(a,b,c,d,e){var f=Math.cos;const g=Math.sin,k=f(c/2);c=g(c/2);const h=f((b+d)/2),l=g((b+d)/2),n=f((b-d)/2),m=g((b-d)/2);f=f((d-b)/2);b=g((d-b)/2);switch(e){case "XYX":a.set(k*l,c*n,c*m,k*h);break;case "YZY":a.set(c*m,k*l,c*n,k*h);break;case "ZXZ":a.set(c*n,c*m,k*l,k*h);break;case "XZX":a.set(k*l,c*b,c*f,k*h);break;case "YXY":a.set(c*f,k*l,c*b,k*h);break;case "ZYZ":a.set(c*b,c*f,k*l,k*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+
e)}},normalize:Qa,denormalize:qa};class xa{constructor(a=0,b=0){xa.prototype.isVector2=!0;this.x=a;this.y=b}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,b){this.x=a;this.y=b;return this}setScalar(a){this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;
case 1:return this.y;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y)}copy(a){this.x=a.x;this.y=a.y;return this}add(a){this.x+=a.x;this.y+=a.y;return this}addScalar(a){this.x+=a;this.y+=a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this}addScaledVector(a,b){this.x+=a.x*b;this.y+=a.y*b;return this}sub(a){this.x-=a.x;this.y-=a.y;return this}subScalar(a){this.x-=a;this.y-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-
b.y;return this}multiply(a){this.x*=a.x;this.y*=a.y;return this}multiplyScalar(a){this.x*=a;this.y*=a;return this}divide(a){this.x/=a.x;this.y/=a.y;return this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=a[1]*b+a[4]*c+a[7];return this}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this}clamp(a,b){this.x=Math.max(a.x,
Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this}clampScalar(a,b){this.x=Math.max(a,Math.min(b,this.x));this.y=Math.max(a,Math.min(b,this.y));return this}clampLength(a,b){const c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=
Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){const b=Math.sqrt(this.lengthSq()*a.lengthSq());
if(0===b)return Math.PI/2;a=this.dot(a)/b;return Math.acos(ib(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const b=this.x-a.x;a=this.y-a.y;return b*b+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this}lerpVectors(a,b,c){this.x=a.x+(b.x-a.x)*c;this.y=a.y+(b.y-a.y)*c;return this}equals(a){return a.x===this.x&&a.y===
this.y}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;return a}fromBufferAttribute(a,b){this.x=a.getX(b);this.y=a.getY(b);return this}rotateAround(a,b){const c=Math.cos(b);b=Math.sin(b);const d=this.x-a.x,e=this.y-a.y;this.x=d*c-e*b+a.x;this.y=d*b+e*c+a.y;return this}random(){this.x=Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y}}class ob{constructor(a,b,c,d,e,f,g,k,h){ob.prototype.isMatrix3=!0;this.elements=
[1,0,0,0,1,0,0,0,1];void 0!==a&&this.set(a,b,c,d,e,f,g,k,h)}set(a,b,c,d,e,f,g,k,h){const l=this.elements;l[0]=a;l[1]=d;l[2]=g;l[3]=b;l[4]=e;l[5]=k;l[6]=c;l[7]=f;l[8]=h;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(a){const b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this}extractBasis(a,b,c){a.setFromMatrix3Column(this,0);b.setFromMatrix3Column(this,1);c.setFromMatrix3Column(this,2);return this}setFromMatrix4(a){a=
a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];const e=c[3],f=c[6],g=c[1],k=c[4],h=c[7],l=c[2],n=c[5];c=c[8];const m=d[0],p=d[3],v=d[6],t=d[1],x=d[4],C=d[7],u=d[2],D=d[5];d=d[8];b[0]=a*m+e*t+f*u;b[3]=a*p+e*x+f*D;b[6]=a*v+e*C+f*d;b[1]=g*m+k*t+h*u;b[4]=g*p+k*x+h*D;b[7]=g*v+k*C+h*d;b[2]=l*m+n*t+
c*u;b[5]=l*p+n*x+c*D;b[8]=l*v+n*C+c*d;return this}multiplyScalar(a){const b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this}determinant(){var a=this.elements;const b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],k=a[6],h=a[7];a=a[8];return b*f*a-b*g*h-c*e*a+c*g*k+d*e*h-d*f*k}invert(){const a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],k=a[6],h=a[7],l=a[8],n=l*f-g*h,m=g*k-l*e,p=h*e-f*k;var v=b*n+c*m+d*p;if(0===v)return this.set(0,0,0,0,0,0,0,
0,0);v=1/v;a[0]=n*v;a[1]=(d*h-l*c)*v;a[2]=(g*c-d*f)*v;a[3]=m*v;a[4]=(l*b-d*k)*v;a[5]=(d*e-g*b)*v;a[6]=p*v;a[7]=(c*k-h*b)*v;a[8]=(f*b-c*e)*v;return this}transpose(){let a;const b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this}setUvTransform(a,
b,c,d,e,f,g){const k=Math.cos(e);e=Math.sin(e);this.set(c*k,c*e,-c*(k*f+e*g)+f+a,-d*e,d*k,-d*(-e*f+k*g)+g+b,0,0,1);return this}scale(a,b){this.premultiply(Eg.makeScale(a,b));return this}rotate(a){this.premultiply(Eg.makeRotation(-a));return this}translate(a,b){this.premultiply(Eg.makeTranslation(a,b));return this}makeTranslation(a,b){a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,b,0,0,1);return this}makeRotation(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,a,b,0,0,0,1);return this}makeScale(a,
b){this.set(a,0,0,0,b,0,0,0,1);return this}equals(a){const b=this.elements;a=a.elements;for(let c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0}fromArray(a,b=0){for(let c=0;9>c;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){const c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}clone(){return(new this.constructor).fromArray(this.elements)}}const Eg=new ob,he={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,
Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Wh={},Mi=(new ob).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Ni=(new ob).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),tf={["srgb-linear"]:{transfer:"linear",primaries:"rec709",toReference:a=>a,fromReference:a=>a},srgb:{transfer:"srgb",primaries:"rec709",toReference:a=>a.convertSRGBToLinear(),fromReference:a=>a.convertLinearToSRGB()},["display-p3-linear"]:{transfer:"linear",primaries:"p3",
toReference:a=>a.applyMatrix3(Ni),fromReference:a=>a.applyMatrix3(Mi)},["display-p3"]:{transfer:"srgb",primaries:"p3",toReference:a=>a.convertSRGBToLinear().applyMatrix3(Ni),fromReference:a=>a.applyMatrix3(Mi).convertLinearToSRGB()}},Ql=new Set(["srgb-linear","display-p3-linear"]),Kb={enabled:!0,_workingColorSpace:"srgb-linear",get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(a){if(!Ql.has(a))throw Error(`Unsupported working color space, "${a}".`);this._workingColorSpace=
a},convert:function(a,b,c){if(!1===this.enabled||b===c||!b||!c)return a;b=tf[b].toReference;c=tf[c].fromReference;return c(b(a))},fromWorkingColorSpace:function(a,b){return this.convert(a,this._workingColorSpace,b)},toWorkingColorSpace:function(a,b){return this.convert(a,b,this._workingColorSpace)},getPrimaries:function(a){return tf[a].primaries},getTransfer:function(a){return""===a?"linear":tf[a].transfer}};let ie;class kg{static getDataURL(a){if(/^data:/i.test(a.src)||"undefined"===typeof HTMLCanvasElement)return a.src;
if(a instanceof HTMLCanvasElement)var b=a;else void 0===ie&&(ie=Wb("canvas")),ie.width=a.width,ie.height=a.height,b=ie.getContext("2d"),a instanceof ImageData?b.putImageData(a,0,0):b.drawImage(a,0,0,a.width,a.height),b=ie;return 2048<b.width||2048<b.height?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",a),b.toDataURL("image/jpeg",.6)):b.toDataURL("image/png")}static sRGBToLinear(a){if("undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement||
"undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap){var b=Wb("canvas");b.width=a.width;b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0,a.width,a.height);a=c.getImageData(0,0,a.width,a.height);const d=a.data;for(let e=0;e<d.length;e++)d[e]=255*Na(d[e]/255);c.putImageData(a,0,0);return b}if(a.data){b=a.data.slice(0);for(c=0;c<b.length;c++)b[c]=b instanceof Uint8Array||b instanceof Uint8ClampedArray?Math.floor(255*
Na(b[c]/255)):Na(b[c]);return{data:b,width:a.width,height:a.height}}console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.");return a}}let Rl=0;class Ld{constructor(a=null){this.isSource=!0;Object.defineProperty(this,"id",{value:Rl++});this.uuid=pa();this.data=a;this.dataReady=!0;this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){const b=void 0===a||"string"===typeof a;if(!b&&void 0!==a.images[this.uuid])return a.images[this.uuid];
const c={uuid:this.uuid,url:""},d=this.data;if(null!==d){let e;if(Array.isArray(d)){e=[];for(let f=0,g=d.length;f<g;f++)d[f].isDataTexture?e.push(Q(d[f].image)):e.push(Q(d[f]))}else e=Q(d);c.url=e}b||(a.images[this.uuid]=c);return c}}let Sl=0;class cc extends dd{constructor(a=cc.DEFAULT_IMAGE,b=cc.DEFAULT_MAPPING,c=1001,d=1001,e=1006,f=1008,g=1023,k=1009,h=cc.DEFAULT_ANISOTROPY,l=""){super();this.isTexture=!0;Object.defineProperty(this,"id",{value:Sl++});this.uuid=pa();this.name="";this.source=new Ld(a);
this.mipmaps=[];this.mapping=b;this.channel=0;this.wrapS=c;this.wrapT=d;this.magFilter=e;this.minFilter=f;this.anisotropy=h;this.format=g;this.internalFormat=null;this.type=k;this.offset=new xa(0,0);this.repeat=new xa(1,1);this.center=new xa(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new ob;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.colorSpace=l;this.userData={};this.version=0;this.onUpdate=null;this.needsPMREMUpdate=this.isRenderTargetTexture=
!1}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.source=a.source;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.channel=a.channel;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;
this.format=a.format;this.internalFormat=a.internalFormat;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.colorSpace=a.colorSpace;this.userData=JSON.parse(JSON.stringify(a.userData));this.needsUpdate=!0;return this}toJSON(a){const b=
void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];const c={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,
colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};0<Object.keys(this.userData).length&&(c.userData=this.userData);b||(a.textures[this.uuid]=c);return c}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(300!==this.mapping)return a;a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=
Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y);return a}set needsUpdate(a){!0===a&&(this.version++,this.source.needsUpdate=!0)}}cc.DEFAULT_IMAGE=null;cc.DEFAULT_MAPPING=300;cc.DEFAULT_ANISOTROPY=1;class Mb{constructor(a=
0,b=0,c=0,d=1){Mb.prototype.isVector4=!0;this.x=a;this.y=b;this.z=c;this.w=d}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this}setScalar(a){this.w=this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setW(a){this.w=a;return this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;
case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;this.w+=
a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this}addScaledVector(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this}subScalar(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this}multiplyScalar(a){this.x*=
a;this.y*=a;this.z*=a;this.w*=a;return this}applyMatrix4(a){const b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this}setAxisAngleFromRotationMatrix(a){a=
a.elements;var b=a[0];var c=a[4];var d=a[8];const e=a[1];var f=a[5],g=a[9];var k=a[2];var h=a[6];var l=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-k)&&.01>Math.abs(g-h)){if(.1>Math.abs(c+e)&&.1>Math.abs(d+k)&&.1>Math.abs(g+h)&&.1>Math.abs(b+f+l-3))return this.set(1,0,0,0),this;a=Math.PI;b=(b+1)/2;f=(f+1)/2;l=(l+1)/2;c=(c+e)/4;d=(d+k)/4;g=(g+h)/4;b>f&&b>l?.01>b?(h=0,c=k=.707106781):(h=Math.sqrt(b),k=c/h,c=d/h):f>l?.01>f?(h=.707106781,k=0,c=.707106781):(k=Math.sqrt(f),h=c/k,c=g/k):.01>l?(k=h=.707106781,
c=0):(c=Math.sqrt(l),h=d/c,k=g/c);this.set(h,k,c,a);return this}a=Math.sqrt((h-g)*(h-g)+(d-k)*(d-k)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(h-g)/a;this.y=(d-k)/a;this.z=(e-c)/a;this.w=Math.acos((b+f+l-1)/2);return this}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this}clamp(a,b){this.x=
Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this}clampScalar(a,b){this.x=Math.max(a,Math.min(b,this.x));this.y=Math.max(a,Math.min(b,this.y));this.z=Math.max(a,Math.min(b,this.z));this.w=Math.max(a,Math.min(b,this.w));return this}clampLength(a,b){const c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))}floor(){this.x=Math.floor(this.x);this.y=
Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=
-this.z;this.w=-this.w;return this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*
b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this}lerpVectors(a,b,c){this.x=a.x+(b.x-a.x)*c;this.y=a.y+(b.y-a.y)*c;this.z=a.z+(b.z-a.z)*c;this.w=a.w+(b.w-a.w)*c;return this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a}fromBufferAttribute(a,b){this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=
a.getW(b);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}class Oi extends dd{constructor(a=1,b=1,c={}){super();this.isRenderTarget=!0;this.width=a;this.height=b;this.depth=1;this.scissor=new Mb(0,0,a,b);this.scissorTest=!1;this.viewport=new Mb(0,0,a,b);a={width:a,height:b,depth:1};c=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:1006,depthBuffer:!0,
stencilBuffer:!1,depthTexture:null,samples:0,count:1},c);a=new cc(a,c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace);a.flipY=!1;a.generateMipmaps=c.generateMipmaps;a.internalFormat=c.internalFormat;this.textures=[];b=c.count;for(let d=0;d<b;d++)this.textures[d]=a.clone(),this.textures[d].isRenderTargetTexture=!0;this.depthBuffer=c.depthBuffer;this.stencilBuffer=c.stencilBuffer;this.depthTexture=c.depthTexture;this.samples=c.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=
a}setSize(a,b,c=1){if(this.width!==a||this.height!==b||this.depth!==c){this.width=a;this.height=b;this.depth=c;for(let d=0,e=this.textures.length;d<e;d++)this.textures[d].image.width=a,this.textures[d].image.height=b,this.textures[d].image.depth=c;this.dispose()}this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)}clone(){return(new this.constructor).copy(this)}copy(a){this.width=a.width;this.height=a.height;this.depth=a.depth;this.scissor.copy(a.scissor);this.scissorTest=a.scissorTest;this.viewport.copy(a.viewport);
this.textures.length=0;for(let c=0,d=a.textures.length;c<d;c++)this.textures[c]=a.textures[c].clone(),this.textures[c].isRenderTargetTexture=!0;const b=Object.assign({},a.texture.image);this.texture.source=new Ld(b);this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone());this.samples=a.samples;return this}dispose(){this.dispatchEvent({type:"dispose"})}}class Oc extends Oi{constructor(a=1,b=1,c={}){super(a,b,c);this.isWebGLRenderTarget=
!0}}class lf extends cc{constructor(a=null,b=1,c=1,d=1){super(null);this.isDataArrayTexture=!0;this.image={data:a,width:b,height:c,depth:d};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}class Tl extends Oc{constructor(a=1,b=1,c=1,d={}){super(a,b,d);this.isWebGLArrayRenderTarget=!0;this.depth=c;this.texture=new lf(null,a,b,c);this.texture.isRenderTargetTexture=!0}}class Fg extends cc{constructor(a=null,b=1,c=1,d=1){super(null);this.isData3DTexture=
!0;this.image={data:a,width:b,height:c,depth:d};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}class Ul extends Oc{constructor(a=1,b=1,c=1,d={}){super(a,b,d);this.isWebGL3DRenderTarget=!0;this.depth=c;this.texture=new Fg(null,a,b,c);this.texture.isRenderTargetTexture=!0}}class Cc{constructor(a=0,b=0,c=0,d=1){this.isQuaternion=!0;this._x=a;this._y=b;this._z=c;this._w=d}static slerpFlat(a,b,c,d,e,f,g){let k=c[d+0],h=c[d+1],l=c[d+2];c=c[d+
3];d=e[f+0];const n=e[f+1],m=e[f+2];e=e[f+3];if(0===g)a[b+0]=k,a[b+1]=h,a[b+2]=l,a[b+3]=c;else if(1===g)a[b+0]=d,a[b+1]=n,a[b+2]=m,a[b+3]=e;else{if(c!==e||k!==d||h!==n||l!==m){f=1-g;var p=k*d+h*n+l*m+c*e,v=0<=p?1:-1,t=1-p*p;t>Number.EPSILON&&(t=Math.sqrt(t),p=Math.atan2(t,p*v),f=Math.sin(f*p)/t,g=Math.sin(g*p)/t);v*=g;k=k*f+d*v;h=h*f+n*v;l=l*f+m*v;c=c*f+e*v;f===1-g&&(g=1/Math.sqrt(k*k+h*h+l*l+c*c),k*=g,h*=g,l*=g,c*=g)}a[b]=k;a[b+1]=h;a[b+2]=l;a[b+3]=c}}static multiplyQuaternionsFlat(a,b,c,d,e,f){const g=
c[d],k=c[d+1],h=c[d+2];c=c[d+3];d=e[f];const l=e[f+1],n=e[f+2];e=e[f+3];a[b]=g*e+c*d+k*n-h*l;a[b+1]=k*e+c*l+h*d-g*n;a[b+2]=h*e+c*n+g*l-k*d;a[b+3]=c*e-g*d-k*l-h*n;return a}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a;this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a;this._onChangeCallback()}set(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this._onChangeCallback();
return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this._onChangeCallback();return this}setFromEuler(a,b=!0){var c=a._x,d=a._y,e=a._z;a=a._order;var f=Math.cos;const g=Math.sin,k=f(c/2),h=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);switch(a){case "XYZ":this._x=c*h*f+k*d*e;this._y=k*d*f-c*h*e;this._z=k*h*e+c*d*f;this._w=k*h*f-c*d*e;break;case "YXZ":this._x=c*h*f+k*d*e;this._y=k*d*f-c*h*e;this._z=k*h*e-c*d*f;this._w=
k*h*f+c*d*e;break;case "ZXY":this._x=c*h*f-k*d*e;this._y=k*d*f+c*h*e;this._z=k*h*e+c*d*f;this._w=k*h*f-c*d*e;break;case "ZYX":this._x=c*h*f-k*d*e;this._y=k*d*f+c*h*e;this._z=k*h*e-c*d*f;this._w=k*h*f+c*d*e;break;case "YZX":this._x=c*h*f+k*d*e;this._y=k*d*f+c*h*e;this._z=k*h*e-c*d*f;this._w=k*h*f-c*d*e;break;case "XZY":this._x=c*h*f-k*d*e;this._y=k*d*f-c*h*e;this._z=k*h*e+c*d*f;this._w=k*h*f+c*d*e;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}!0===
b&&this._onChangeCallback();return this}setFromAxisAngle(a,b){b/=2;const c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this._onChangeCallback();return this}setFromRotationMatrix(a){var b=a.elements,c=b[0];a=b[4];const d=b[8],e=b[1],f=b[5],g=b[9],k=b[2],h=b[6];b=b[10];const l=c+f+b;0<l?(c=.5/Math.sqrt(l+1),this._w=.25/c,this._x=(h-g)*c,this._y=(d-k)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(h-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+k)/c):f>b?(c=
2*Math.sqrt(1+f-c-b),this._w=(d-k)/c,this._x=(a+e)/c,this._y=.25*c,this._z=(g+h)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+k)/c,this._y=(g+h)/c,this._z=.25*c);this._onChangeCallback();return this}setFromUnitVectors(a,b){let c=a.dot(b)+1;c<Number.EPSILON?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x);this._w=c;return this.normalize()}angleTo(a){return 2*
Math.acos(Math.abs(ib(this.dot(a),-1,1)))}rotateTowards(a,b){const c=this.angleTo(a);if(0===c)return this;this.slerp(a,Math.min(1,b/c));return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+
this._z*this._z+this._w*this._w)}normalize(){let a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this._onChangeCallback();return this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,b){const c=a._x,d=a._y,e=a._z;a=a._w;const f=b._x,g=b._y,k=b._z;b=b._w;this._x=c*b+a*f+d*k-e*g;this._y=d*b+a*g+e*f-c*k;this._z=e*b+a*k+c*g-d*f;this._w=a*b-c*f-d*g-e*k;this._onChangeCallback();
return this}slerp(a,b){if(0===b)return this;if(1===b)return this.copy(a);const c=this._x,d=this._y,e=this._z,f=this._w;var g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize(),this;a=Math.sqrt(a);const k=Math.atan2(a,g);g=Math.sin((1-b)*
k)/a;b=Math.sin(b*k)/a;this._w=f*g+this._w*b;this._x=c*g+this._x*b;this._y=d*g+this._y*b;this._z=e*g+this._z*b;this._onChangeCallback();return this}slerpQuaternions(a,b,c){return this.copy(a).slerp(b,c)}random(){const a=2*Math.PI*Math.random(),b=2*Math.PI*Math.random();var c=Math.random();const d=Math.sqrt(1-c);c=Math.sqrt(c);return this.set(d*Math.sin(a),d*Math.cos(a),c*Math.sin(b),c*Math.cos(b))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,b=0){this._x=
a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this._onChangeCallback();return this}toArray(a=[],b=0){a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a}fromBufferAttribute(a,b){this._x=a.getX(b);this._y=a.getY(b);this._z=a.getZ(b);this._w=a.getW(b);this._onChangeCallback();return this}toJSON(){return this.toArray()}_onChange(a){this._onChangeCallback=a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}class I{constructor(a=
0,b=0,c=0){I.prototype.isVector3=!0;this.x=a;this.y=b;this.z=c}set(a,b,c){void 0===c&&(c=this.z);this.x=a;this.y=b;this.z=c;return this}setScalar(a){this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;
default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this}addScaledVector(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this}subScalar(a){this.x-=a;this.y-=
a;this.z-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this}multiplyScalar(a){this.x*=a;this.y*=a;this.z*=a;return this}multiplyVectors(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this}applyEuler(a){return this.applyQuaternion(Pi.setFromEuler(a))}applyAxisAngle(a,b){return this.applyQuaternion(Pi.setFromAxisAngle(a,b))}applyMatrix3(a){const b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*
b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const b=this.x,c=this.y,d=this.z;a=a.elements;const e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this}applyQuaternion(a){const b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;const k=2*(f*d-g*c),h=2*(g*b-e*d),l=2*(e*c-f*b);this.x=
b+a*k+f*l-g*h;this.y=c+a*h+g*k-e*l;this.z=d+a*l+e*h-f*k;return this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()}divide(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this}divideScalar(a){return this.multiplyScalar(1/
a)}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this}clamp(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this}clampScalar(a,b){this.x=Math.max(a,Math.min(b,this.x));this.y=Math.max(a,Math.min(b,this.y));this.z=Math.max(a,Math.min(b,this.z));return this}clampLength(a,
b){const c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);return this}negate(){this.x=
-this.x;this.y=-this.y;this.z=-this.z;return this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this}lerpVectors(a,
b,c){this.x=a.x+(b.x-a.x)*c;this.y=a.y+(b.y-a.y)*c;this.z=a.z+(b.z-a.z)*c;return this}cross(a){return this.crossVectors(this,a)}crossVectors(a,b){const c=a.x,d=a.y;a=a.z;const e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this}projectOnVector(a){var b=a.lengthSq();if(0===b)return this.set(0,0,0);b=a.dot(this)/b;return this.copy(a).multiplyScalar(b)}projectOnPlane(a){Gg.copy(this).projectOnVector(a);return this.sub(Gg)}reflect(a){return this.sub(Gg.copy(a).multiplyScalar(2*
this.dot(a)))}angleTo(a){const b=Math.sqrt(this.lengthSq()*a.lengthSq());if(0===b)return Math.PI/2;a=this.dot(a)/b;return Math.acos(ib(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,b,c){const d=Math.sin(b)*
a;this.x=d*Math.sin(c);this.y=Math.cos(b)*a;this.z=d*Math.cos(c);return this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,b,c){this.x=a*Math.sin(b);this.y=c;this.z=a*Math.cos(b);return this}setFromMatrixPosition(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this}setFromMatrixScale(a){const b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;
this.y=c;this.z=a;return this}setFromMatrixColumn(a,b){return this.fromArray(a.elements,4*b)}setFromMatrix3Column(a,b){return this.fromArray(a.elements,3*b)}setFromEuler(a){this.x=a._x;this.y=a._y;this.z=a._z;return this}setFromColor(a){this.x=a.r;this.y=a.g;this.z=a.b;return this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a}fromBufferAttribute(a,b){this.x=
a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const a=Math.random()*Math.PI*2,b=2*Math.random()-1,c=Math.sqrt(1-b*b);this.x=c*Math.cos(a);this.y=b;this.z=c*Math.sin(a);return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z}}const Gg=new I,Pi=new Cc;class xc{constructor(a=new I(Infinity,Infinity,Infinity),b=new I(-Infinity,-Infinity,-Infinity)){this.isBox3=!0;this.min=a;
this.max=b}set(a,b){this.min.copy(a);this.max.copy(b);return this}setFromArray(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b+=3)this.expandByPoint(Rc.fromArray(a,b));return this}setFromBufferAttribute(a){this.makeEmpty();for(let b=0,c=a.count;b<c;b++)this.expandByPoint(Rc.fromBufferAttribute(a,b));return this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){b=Rc.copy(b).multiplyScalar(.5);this.min.copy(a).sub(b);this.max.copy(a).add(b);
return this}setFromObject(a,b=!1){this.makeEmpty();return this.expandByObject(a,b)}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?
a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}expandByObject(a,b=!1){a.updateWorldMatrix(!1,!1);const c=a.geometry;if(void 0!==c){const d=c.getAttribute("position");if(!0===b&&void 0!==d&&!0!==a.isInstancedMesh)for(let e=0,f=d.count;e<f;e++)!0===a.isMesh?a.getVertexPosition(e,Rc):Rc.fromBufferAttribute(d,
e),Rc.applyMatrix4(a.matrixWorld),this.expandByPoint(Rc);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),uf.copy(a.boundingBox)):(null===c.boundingBox&&c.computeBoundingBox(),uf.copy(c.boundingBox)),uf.applyMatrix4(a.matrixWorld),this.union(uf)}a=a.children;for(let d=0,e=a.length;d<e;d++)this.expandByObject(a[d],b);return this}containsPoint(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0}containsBox(a){return this.min.x<=
a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0}intersectsSphere(a){this.clampPoint(a.center,Rc);return Rc.distanceToSquared(a.center)<=
a.radius*a.radius}intersectsPlane(a){let b,c;0<a.normal.x?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x);0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=-a.constant&&c>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(Ne);vf.subVectors(this.max,
Ne);je.subVectors(a.a,Ne);ke.subVectors(a.b,Ne);le.subVectors(a.c,Ne);qd.subVectors(ke,je);rd.subVectors(le,ke);Md.subVectors(je,le);a=[0,-qd.z,qd.y,0,-rd.z,rd.y,0,-Md.z,Md.y,qd.z,0,-qd.x,rd.z,0,-rd.x,Md.z,0,-Md.x,-qd.y,qd.x,0,-rd.y,rd.x,0,-Md.y,Md.x,0];if(!S(a,je,ke,le,vf))return!1;a=[1,0,0,0,1,0,0,0,1];if(!S(a,je,ke,le,vf))return!1;wf.crossVectors(qd,rd);a=[wf.x,wf.y,wf.z];return S(a,je,ke,le,vf)}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,
Rc).distanceTo(a)}getBoundingSphere(a){this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(Rc).length());return a}intersect(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);this.max.max(a.max);return this}applyMatrix4(a){if(this.isEmpty())return this;ed[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a);ed[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a);ed[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a);
ed[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a);ed[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a);ed[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a);ed[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a);ed[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a);this.setFromPoints(ed);return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const ed=[new I,new I,new I,new I,new I,new I,
new I,new I],Rc=new I,uf=new xc,je=new I,ke=new I,le=new I,qd=new I,rd=new I,Md=new I,Ne=new I,vf=new I,wf=new I,Cd=new I,Vl=new xc,Oe=new I,Hg=new I;class qc{constructor(a=new I,b=-1){this.isSphere=!0;this.center=a;this.radius=b}set(a,b){this.center.copy(a);this.radius=b;return this}setFromPoints(a,b){const c=this.center;void 0!==b?c.copy(b):Vl.setFromPoints(a).getCenter(c);b=0;for(let d=0,e=a.length;d<e;d++)b=Math.max(b,c.distanceToSquared(a[d]));this.radius=Math.sqrt(b);return this}copy(a){this.center.copy(a.center);
this.radius=a.radius;return this}isEmpty(){return 0>this.radius}makeEmpty(){this.center.set(0,0,0);this.radius=-1;return this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,
b){const c=this.center.distanceToSquared(a);b.copy(a);c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b}getBoundingBox(a){if(this.isEmpty())return a.makeEmpty(),a;a.set(this.center,this.center);a.expandByScalar(this.radius);return a}applyMatrix4(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this}translate(a){this.center.add(a);return this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=
0,this;Oe.subVectors(a,this.center);a=Oe.lengthSq();if(a>this.radius*this.radius){a=Math.sqrt(a);const b=.5*(a-this.radius);this.center.addScaledVector(Oe,b/a);this.radius+=b}return this}union(a){if(a.isEmpty())return this;if(this.isEmpty())return this.copy(a),this;!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(Hg.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(Oe.copy(a.center).add(Hg)),this.expandByPoint(Oe.copy(a.center).sub(Hg)));return this}equals(a){return a.center.equals(this.center)&&
a.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const fd=new I,Ig=new I,xf=new I,sd=new I,Jg=new I,yf=new I,Kg=new I;class me{constructor(a=new I,b=new I(0,0,-1)){this.origin=a;this.direction=b}set(a,b){this.origin.copy(a);this.direction.copy(b);return this}copy(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this}at(a,b){return b.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){this.direction.copy(a).sub(this.origin).normalize();return this}recast(a){this.origin.copy(this.at(a,
fd));return this}closestPointToPoint(a,b){b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const b=fd.subVectors(a,this.origin).dot(this.direction);if(0>b)return this.origin.distanceToSquared(a);fd.copy(this.origin).addScaledVector(this.direction,b);return fd.distanceToSquared(a)}distanceSqToSegment(a,b,c,d){Ig.copy(a).add(b).multiplyScalar(.5);
xf.copy(b).sub(a).normalize();sd.copy(this.origin).sub(Ig);var e=.5*a.distanceTo(b),f=-this.direction.dot(xf);const g=sd.dot(this.direction),k=-sd.dot(xf),h=sd.lengthSq(),l=Math.abs(1-f*f);let n;0<l?(a=f*k-g,b=f*g-k,n=e*l,0<=a?b>=-n?b<=n?(e=1/l,a*=e,b*=e,f=a*(a+f*b+2*g)+b*(f*a+b+2*k)+h):(b=e,a=Math.max(0,-(f*b+g)),f=-a*a+b*(b+2*k)+h):(b=-e,a=Math.max(0,-(f*b+g)),f=-a*a+b*(b+2*k)+h):b<=-n?(a=Math.max(0,-(-f*e+g)),b=0<a?-e:Math.min(Math.max(-e,-k),e),f=-a*a+b*(b+2*k)+h):b<=n?(a=0,b=Math.min(Math.max(-e,
-k),e),f=b*(b+2*k)+h):(a=Math.max(0,-(f*e+g)),b=0<a?e:Math.min(Math.max(-e,-k),e),f=-a*a+b*(b+2*k)+h)):(b=0<f?-e:e,a=Math.max(0,-(f*b+g)),f=-a*a+b*(b+2*k)+h);c&&c.copy(this.origin).addScaledVector(this.direction,a);d&&d.copy(Ig).addScaledVector(xf,b);return f}intersectSphere(a,b){fd.subVectors(a.center,this.origin);var c=fd.dot(this.direction),d=fd.dot(fd)-c*c;a=a.radius*a.radius;if(d>a)return null;a=Math.sqrt(a-d);d=c-a;c+=a;return 0>c?null:0>d?this.at(c,b):this.at(d,b)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=
a.radius*a.radius}distanceToPlane(a){const b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null}intersectPlane(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)}intersectsPlane(a){const b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1}intersectBox(a,b){let c;var d=1/this.direction.x;var e=1/this.direction.y;const f=1/this.direction.z,g=this.origin;
0<=d?(c=(a.min.x-g.x)*d,d*=a.max.x-g.x):(c=(a.max.x-g.x)*d,d*=a.min.x-g.x);if(0<=e){var k=(a.min.y-g.y)*e;e*=a.max.y-g.y}else k=(a.max.y-g.y)*e,e*=a.min.y-g.y;if(c>e||k>d)return null;if(k>c||isNaN(c))c=k;if(e<d||isNaN(d))d=e;0<=f?(k=(a.min.z-g.z)*f,a=(a.max.z-g.z)*f):(k=(a.max.z-g.z)*f,a=(a.min.z-g.z)*f);if(c>a||k>d)return null;if(k>c||c!==c)c=k;if(a<d||d!==d)d=a;return 0>d?null:this.at(0<=c?c:d,b)}intersectsBox(a){return null!==this.intersectBox(a,fd)}intersectTriangle(a,b,c,d,e){Jg.subVectors(b,
a);yf.subVectors(c,a);Kg.crossVectors(Jg,yf);b=this.direction.dot(Kg);if(0<b){if(d)return null;d=1}else if(0>b)d=-1,b=-b;else return null;sd.subVectors(this.origin,a);a=d*this.direction.dot(yf.crossVectors(sd,yf));if(0>a)return null;c=d*this.direction.dot(Jg.cross(sd));if(0>c||a+c>b)return null;a=-d*sd.dot(Kg);return 0>a?null:this.at(a/b,e)}applyMatrix4(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}
class lb{constructor(a,b,c,d,e,f,g,k,h,l,n,m,p,v,t,x){lb.prototype.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];void 0!==a&&this.set(a,b,c,d,e,f,g,k,h,l,n,m,p,v,t,x)}set(a,b,c,d,e,f,g,k,h,l,n,m,p,v,t,x){const C=this.elements;C[0]=a;C[4]=b;C[8]=c;C[12]=d;C[1]=e;C[5]=f;C[9]=g;C[13]=k;C[2]=h;C[6]=l;C[10]=n;C[14]=m;C[3]=p;C[7]=v;C[11]=t;C[15]=x;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return(new lb).fromArray(this.elements)}copy(a){const b=this.elements;
a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this}copyPosition(a){const b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this}setFromMatrix3(a){a=a.elements;this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1);return this}extractBasis(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,
2);return this}makeBasis(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this}extractRotation(a){const b=this.elements,c=a.elements,d=1/ne.setFromMatrixColumn(a,0).length(),e=1/ne.setFromMatrixColumn(a,1).length();a=1/ne.setFromMatrixColumn(a,2).length();b[0]=c[0]*d;b[1]=c[1]*d;b[2]=c[2]*d;b[3]=0;b[4]=c[4]*e;b[5]=c[5]*e;b[6]=c[6]*e;b[7]=0;b[8]=c[8]*a;b[9]=c[9]*a;b[10]=c[10]*a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this}makeRotationFromEuler(a){const b=this.elements;
var c=a.x,d=a.y,e=a.z;const f=Math.cos(c);c=Math.sin(c);const g=Math.cos(d);d=Math.sin(d);const k=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=f*k;var h=f*e,l=c*k,n=c*e;b[0]=g*k;b[4]=-g*e;b[8]=d;b[1]=h+l*d;b[5]=a-n*d;b[9]=-c*g;b[2]=n-a*d;b[6]=l+h*d;b[10]=f*g}else"YXZ"===a.order?(a=g*k,h=g*e,l=d*k,n=d*e,b[0]=a+n*c,b[4]=l*c-h,b[8]=f*d,b[1]=f*e,b[5]=f*k,b[9]=-c,b[2]=h*c-l,b[6]=n+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*k,h=g*e,l=d*k,n=d*e,b[0]=a-n*c,b[4]=-f*e,b[8]=l+h*c,b[1]=h+l*c,b[5]=f*k,b[9]=n-a*c,
b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*k,h=f*e,l=c*k,n=c*e,b[0]=g*k,b[4]=l*d-h,b[8]=a*d+n,b[1]=g*e,b[5]=n*d+a,b[9]=h*d-l,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,h=f*d,l=c*g,n=c*d,b[0]=g*k,b[4]=n-a*e,b[8]=l*e+h,b[1]=e,b[5]=f*k,b[9]=-c*k,b[2]=-d*k,b[6]=h*e+l,b[10]=a-n*e):"XZY"===a.order&&(a=f*g,h=f*d,l=c*g,n=c*d,b[0]=g*k,b[4]=-e,b[8]=d*k,b[1]=a*e+n,b[5]=f*k,b[9]=h*e-l,b[2]=l*e-h,b[6]=c*k,b[10]=n*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this}makeRotationFromQuaternion(a){return this.compose(Wl,
a,Xl)}lookAt(a,b,c){const d=this.elements;yc.subVectors(a,b);0===yc.lengthSq()&&(yc.z=1);yc.normalize();td.crossVectors(c,yc);0===td.lengthSq()&&(1===Math.abs(c.z)?yc.x+=1E-4:yc.z+=1E-4,yc.normalize(),td.crossVectors(c,yc));td.normalize();zf.crossVectors(yc,td);d[0]=td.x;d[4]=zf.x;d[8]=yc.x;d[1]=td.y;d[5]=zf.y;d[9]=yc.y;d[2]=td.z;d[6]=zf.z;d[10]=yc.z;return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){var c=a.elements,
d=b.elements;b=this.elements;a=c[0];const e=c[4],f=c[8],g=c[12],k=c[1],h=c[5],l=c[9],n=c[13],m=c[2],p=c[6],v=c[10],t=c[14],x=c[3],C=c[7],u=c[11];c=c[15];const D=d[0],aa=d[4],J=d[8],K=d[12],U=d[1],W=d[5],R=d[9],fa=d[13],ea=d[2],na=d[6],Ea=d[10],ca=d[14],Ga=d[3],ta=d[7],Sa=d[11];d=d[15];b[0]=a*D+e*U+f*ea+g*Ga;b[4]=a*aa+e*W+f*na+g*ta;b[8]=a*J+e*R+f*Ea+g*Sa;b[12]=a*K+e*fa+f*ca+g*d;b[1]=k*D+h*U+l*ea+n*Ga;b[5]=k*aa+h*W+l*na+n*ta;b[9]=k*J+h*R+l*Ea+n*Sa;b[13]=k*K+h*fa+l*ca+n*d;b[2]=m*D+p*U+v*ea+t*Ga;b[6]=
m*aa+p*W+v*na+t*ta;b[10]=m*J+p*R+v*Ea+t*Sa;b[14]=m*K+p*fa+v*ca+t*d;b[3]=x*D+C*U+u*ea+c*Ga;b[7]=x*aa+C*W+u*na+c*ta;b[11]=x*J+C*R+u*Ea+c*Sa;b[15]=x*K+C*fa+u*ca+c*d;return this}multiplyScalar(a){const b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this}determinant(){const a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],k=a[9],h=a[13],l=a[2],n=a[6],m=a[10],p=a[14];return a[3]*(+e*k*
n-d*h*n-e*g*m+c*h*m+d*g*p-c*k*p)+a[7]*(+b*k*p-b*h*m+e*f*m-d*f*p+d*h*l-e*k*l)+a[11]*(+b*h*n-b*g*p-e*f*n+c*f*p+e*g*l-c*h*l)+a[15]*(-d*g*l-b*k*n+b*g*m+d*f*n-c*f*m+c*k*l)}transpose(){const a=this.elements;let b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this}setPosition(a,b,c){const d=this.elements;a.isVector3?(d[12]=a.x,d[13]=a.y,d[14]=a.z):(d[12]=a,d[13]=b,d[14]=c);return this}invert(){const a=
this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],k=a[6],h=a[7],l=a[8],n=a[9],m=a[10],p=a[11],v=a[12],t=a[13],x=a[14],C=a[15],u=n*x*h-t*m*h+t*k*p-g*x*p-n*k*C+g*m*C,D=v*m*h-l*x*h-v*k*p+f*x*p+l*k*C-f*m*C,aa=l*t*h-v*n*h+v*g*p-f*t*p-l*g*C+f*n*C,J=v*n*k-l*t*k-v*g*m+f*t*m+l*g*x-f*n*x;var K=b*u+c*D+d*aa+e*J;if(0===K)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);K=1/K;a[0]=u*K;a[1]=(t*m*e-n*x*e-t*d*p+c*x*p+n*d*C-c*m*C)*K;a[2]=(g*x*e-t*k*e+t*d*h-c*x*h-g*d*C+c*k*C)*K;a[3]=(n*k*e-g*m*e-n*d*h+c*m*h+
g*d*p-c*k*p)*K;a[4]=D*K;a[5]=(l*x*e-v*m*e+v*d*p-b*x*p-l*d*C+b*m*C)*K;a[6]=(v*k*e-f*x*e-v*d*h+b*x*h+f*d*C-b*k*C)*K;a[7]=(f*m*e-l*k*e+l*d*h-b*m*h-f*d*p+b*k*p)*K;a[8]=aa*K;a[9]=(v*n*e-l*t*e-v*c*p+b*t*p+l*c*C-b*n*C)*K;a[10]=(f*t*e-v*g*e+v*c*h-b*t*h-f*c*C+b*g*C)*K;a[11]=(l*g*e-f*n*e-l*c*h+b*n*h+f*c*p-b*g*p)*K;a[12]=J*K;a[13]=(l*t*d-v*n*d+v*c*m-b*t*m-l*c*x+b*n*x)*K;a[14]=(v*g*d-f*t*d-v*c*k+b*t*k+f*c*x-b*g*x)*K;a[15]=(f*n*d-l*g*d+l*c*k-b*n*k-f*c*m+b*g*m)*K;return this}scale(a){const b=this.elements,c=a.x,
d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this}getMaxScaleOnAxis(){const a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,b,c){a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this}makeRotationX(a){const b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,
b,0,0,0,0,1);return this}makeRotationY(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this}makeRotationZ(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(a,b){const c=Math.cos(b);b=Math.sin(b);const d=1-c,e=a.x,f=a.y;a=a.z;const g=d*e,k=d*f;this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,k*f+c,k*a-b*e,0,g*a-b*f,k*a+b*e,d*a*a+c,0,0,0,0,1);return this}makeScale(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,
1);return this}makeShear(a,b,c,d,e,f){this.set(1,c,e,0,a,1,f,0,b,d,1,0,0,0,0,1);return this}compose(a,b,c){const d=this.elements;var e=b._x,f=b._y,g=b._z,k=b._w,h=e+e,l=f+f,n=g+g;b=e*h;const m=e*l;e*=n;const p=f*l;f*=n;g*=n;h*=k;l*=k;k*=n;n=c.x;const v=c.y;c=c.z;d[0]=(1-(p+g))*n;d[1]=(m+k)*n;d[2]=(e-l)*n;d[3]=0;d[4]=(m-k)*v;d[5]=(1-(b+g))*v;d[6]=(f+h)*v;d[7]=0;d[8]=(e+l)*c;d[9]=(f-h)*c;d[10]=(1-(b+p))*c;d[11]=0;d[12]=a.x;d[13]=a.y;d[14]=a.z;d[15]=1;return this}decompose(a,b,c){var d=this.elements;
let e=ne.set(d[0],d[1],d[2]).length();const f=ne.set(d[4],d[5],d[6]).length(),g=ne.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e);a.x=d[12];a.y=d[13];a.z=d[14];fc.copy(this);a=1/e;d=1/f;const k=1/g;fc.elements[0]*=a;fc.elements[1]*=a;fc.elements[2]*=a;fc.elements[4]*=d;fc.elements[5]*=d;fc.elements[6]*=d;fc.elements[8]*=k;fc.elements[9]*=k;fc.elements[10]*=k;b.setFromRotationMatrix(fc);c.x=e;c.y=f;c.z=g;return this}makePerspective(a,b,c,d,e,f,g=2E3){const k=this.elements;if(2E3===g)g=
-(f+e)/(f-e),f=-2*f*e/(f-e);else if(2001===g)g=-f/(f-e),f=-f*e/(f-e);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+g);k[0]=2*e/(b-a);k[4]=0;k[8]=(b+a)/(b-a);k[12]=0;k[1]=0;k[5]=2*e/(c-d);k[9]=(c+d)/(c-d);k[13]=0;k[2]=0;k[6]=0;k[10]=g;k[14]=f;k[3]=0;k[7]=0;k[11]=-1;k[15]=0;return this}makeOrthographic(a,b,c,d,e,f,g=2E3){const k=this.elements,h=1/(b-a),l=1/(c-d);var n=1/(f-e);if(2E3===g)e=(f+e)*n,n*=-2;else if(2001===g)e*=n,n*=-1;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+
g);k[0]=2*h;k[4]=0;k[8]=0;k[12]=-((b+a)*h);k[1]=0;k[5]=2*l;k[9]=0;k[13]=-((c+d)*l);k[2]=0;k[6]=0;k[10]=n;k[14]=-e;k[3]=0;k[7]=0;k[11]=0;k[15]=1;return this}equals(a){const b=this.elements;a=a.elements;for(let c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0}fromArray(a,b=0){for(let c=0;16>c;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){const c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];
a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}}const ne=new I,fc=new lb,Wl=new I(0,0,0),Xl=new I(1,1,1),td=new I,zf=new I,yc=new I,Qi=new lb,Ri=new Cc;class Kc{constructor(a=0,b=0,c=0,d=Kc.DEFAULT_ORDER){this.isEuler=!0;this._x=a;this._y=b;this._z=c;this._order=d}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a;this._onChangeCallback()}get order(){return this._order}set order(a){this._order=
a;this._onChangeCallback()}set(a,b,c,d=this._order){this._x=a;this._y=b;this._z=c;this._order=d;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._onChangeCallback();return this}setFromRotationMatrix(a,b=this._order,c=!0){var d=a.elements;a=d[0];const e=d[4],f=d[8],g=d[1],k=d[5],h=d[9],l=d[2],n=d[6];d=d[10];switch(b){case "XYZ":this._y=Math.asin(ib(f,-1,1));.9999999>
Math.abs(f)?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-e,a)):(this._x=Math.atan2(n,k),this._z=0);break;case "YXZ":this._x=Math.asin(-ib(h,-1,1));.9999999>Math.abs(h)?(this._y=Math.atan2(f,d),this._z=Math.atan2(g,k)):(this._y=Math.atan2(-l,a),this._z=0);break;case "ZXY":this._x=Math.asin(ib(n,-1,1));.9999999>Math.abs(n)?(this._y=Math.atan2(-l,d),this._z=Math.atan2(-e,k)):(this._y=0,this._z=Math.atan2(g,a));break;case "ZYX":this._y=Math.asin(-ib(l,-1,1));.9999999>Math.abs(l)?(this._x=Math.atan2(n,
d),this._z=Math.atan2(g,a)):(this._x=0,this._z=Math.atan2(-e,k));break;case "YZX":this._z=Math.asin(ib(g,-1,1));.9999999>Math.abs(g)?(this._x=Math.atan2(-h,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(f,d));break;case "XZY":this._z=Math.asin(-ib(e,-1,1));.9999999>Math.abs(e)?(this._x=Math.atan2(n,k),this._y=Math.atan2(f,a)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}this._order=b;!0===c&&this._onChangeCallback();
return this}setFromQuaternion(a,b,c){Qi.makeRotationFromQuaternion(a);return this.setFromRotationMatrix(Qi,b,c)}setFromVector3(a,b=this._order){return this.set(a.x,a.y,a.z,b)}reorder(a){Ri.setFromEuler(this);return this.setFromQuaternion(Ri,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this._onChangeCallback();return this}toArray(a=[],b=0){a[b]=this._x;a[b+1]=this._y;
a[b+2]=this._z;a[b+3]=this._order;return a}_onChange(a){this._onChangeCallback=a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._order}}Kc.DEFAULT_ORDER="XYZ";class nf{constructor(){this.mask=1}set(a){this.mask=(1<<a|0)>>>0}enable(a){this.mask=this.mask|1<<a|0}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a|0}disable(a){this.mask&=~(1<<a|0)}disableAll(){this.mask=0}test(a){return 0!==(this.mask&a.mask)}isEnabled(a){return 0!==(this.mask&
(1<<a|0))}}let Yl=0;const Si=new I,oe=new Cc,gd=new lb,Af=new I,Pe=new I,Zl=new I,$l=new Cc,Ti=new I(1,0,0),Ui=new I(0,1,0),Vi=new I(0,0,1),am={type:"added"},bm={type:"removed"},Lg={type:"childadded",child:null},Mg={type:"childremoved",child:null};class Gb extends dd{constructor(){super();this.isObject3D=!0;Object.defineProperty(this,"id",{value:Yl++});this.uuid=pa();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=Gb.DEFAULT_UP.clone();const a=new I,b=new Kc,c=new Cc,d=
new I(1,1,1);b._onChange(function(){c.setFromEuler(b,!1)});c._onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new lb},normalMatrix:{value:new ob}});this.matrix=new lb;this.matrixWorld=new lb;this.matrixAutoUpdate=Gb.DEFAULT_MATRIX_AUTO_UPDATE;this.matrixWorldAutoUpdate=
Gb.DEFAULT_MATRIX_WORLD_AUTO_UPDATE;this.matrixWorldNeedsUpdate=!1;this.layers=new nf;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.animations=[];this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(a);this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){this.quaternion.premultiply(a);return this}setRotationFromAxisAngle(a,
b){this.quaternion.setFromAxisAngle(a,b)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,b){oe.setFromAxisAngle(a,b);this.quaternion.multiply(oe);return this}rotateOnWorldAxis(a,b){oe.setFromAxisAngle(a,b);this.quaternion.premultiply(oe);return this}rotateX(a){return this.rotateOnAxis(Ti,a)}rotateY(a){return this.rotateOnAxis(Ui,a)}rotateZ(a){return this.rotateOnAxis(Vi,
a)}translateOnAxis(a,b){Si.copy(a).applyQuaternion(this.quaternion);this.position.add(Si.multiplyScalar(b));return this}translateX(a){return this.translateOnAxis(Ti,a)}translateY(a){return this.translateOnAxis(Ui,a)}translateZ(a){return this.translateOnAxis(Vi,a)}localToWorld(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(this.matrixWorld)}worldToLocal(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(gd.copy(this.matrixWorld).invert())}lookAt(a,b,c){a.isVector3?Af.copy(a):Af.set(a,b,
c);a=this.parent;this.updateWorldMatrix(!0,!1);Pe.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?gd.lookAt(Pe,Af,this.up):gd.lookAt(Af,Pe,this.up);this.quaternion.setFromRotationMatrix(gd);a&&(gd.extractRotation(a.matrixWorld),oe.setFromRotationMatrix(gd),this.quaternion.premultiply(oe.invert()))}add(a){if(1<arguments.length){for(let b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a),a.dispatchEvent(am),Lg.child=a,this.dispatchEvent(Lg),Lg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this}remove(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(bm),Mg.child=a,this.dispatchEvent(Mg),Mg.child=
null);return this}removeFromParent(){const a=this.parent;null!==a&&a.remove(this);return this}clear(){return this.remove(...this.children)}attach(a){this.updateWorldMatrix(!0,!1);gd.copy(this.matrixWorld).invert();null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),gd.multiply(a.parent.matrixWorld));a.applyMatrix4(gd);this.add(a);a.updateWorldMatrix(!1,!0);return this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,
b){if(this[a]===b)return this;for(let c=0,d=this.children.length;c<d;c++){const e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}}getObjectsByProperty(a,b,c=[]){this[a]===b&&c.push(this);const d=this.children;for(let e=0,f=d.length;e<f;e++)d[e].getObjectsByProperty(a,b,c);return c}getWorldPosition(a){this.updateWorldMatrix(!0,!1);return a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(Pe,a,Zl);return a}getWorldScale(a){this.updateWorldMatrix(!0,
!1);this.matrixWorld.decompose(Pe,$l,a);return a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);const b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(a){a(this);const b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverse(a)}traverseVisible(a){if(!1!==this.visible){a(this);var b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}}traverseAncestors(a){const b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,
this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;const b=this.children;for(let c=0,d=b.length;c<d;c++){const e=b[c];!0!==e.matrixWorldAutoUpdate&&!0!==a||e.updateMatrixWorld(a)}}updateWorldMatrix(a,b){const c=this.parent;!0===a&&null!==
c&&!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!0,!1);this.matrixAutoUpdate&&this.updateMatrix();null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);if(!0===b){a=this.children;for(let d=0,e=a.length;d<e;d++)b=a[d],!0===b.matrixWorldAutoUpdate&&b.updateWorldMatrix(!1,!0)}}toJSON(a){function b(k,h){void 0===k[h.uuid]&&(k[h.uuid]=h.toJSON(a));return h.uuid}function c(k){const h=[];for(const l in k){const n=k[l];delete n.metadata;
h.push(n)}return h}var d=void 0===a||"string"===typeof a;const e={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},e.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);!1===this.frustumCulled&&(f.frustumCulled=!1);0!==this.renderOrder&&
(f.renderOrder=this.renderOrder);0<Object.keys(this.userData).length&&(f.userData=this.userData);f.layers=this.layers.mask;f.matrix=this.matrix.toArray();f.up=this.up.toArray();!1===this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1);this.isInstancedMesh&&(f.type="InstancedMesh",f.count=this.count,f.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(f.instanceColor=this.instanceColor.toJSON()));this.isBatchedMesh&&(f.type="BatchedMesh",f.perObjectFrustumCulled=this.perObjectFrustumCulled,
f.sortObjects=this.sortObjects,f.drawRanges=this._drawRanges,f.reservedRanges=this._reservedRanges,f.visibility=this._visibility,f.active=this._active,f.bounds=this._bounds.map(k=>({boxInitialized:k.boxInitialized,boxMin:k.box.min.toArray(),boxMax:k.box.max.toArray(),sphereInitialized:k.sphereInitialized,sphereRadius:k.sphere.radius,sphereCenter:k.sphere.center.toArray()})),f.maxGeometryCount=this._maxGeometryCount,f.maxVertexCount=this._maxVertexCount,f.maxIndexCount=this._maxIndexCount,f.geometryInitialized=
this._geometryInitialized,f.geometryCount=this._geometryCount,f.matricesTexture=this._matricesTexture.toJSON(a),null!==this.boundingSphere&&(f.boundingSphere={center:f.boundingSphere.center.toArray(),radius:f.boundingSphere.radius}),null!==this.boundingBox&&(f.boundingBox={min:f.boundingBox.min.toArray(),max:f.boundingBox.max.toArray()}));if(this.isScene)this.background&&(this.background.isColor?f.background=this.background.toJSON():this.background.isTexture&&(f.background=this.background.toJSON(a).uuid)),
this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(f.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(let k=0,h=g.length;k<h;k++)b(a.shapes,g[k]);else b(a.shapes,g)}this.isSkinnedMesh&&(f.bindMode=this.bindMode,f.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(b(a.skeletons,
this.skeleton),f.skeleton=this.skeleton.uuid));if(void 0!==this.material)if(Array.isArray(this.material)){g=[];for(let k=0,h=this.material.length;k<h;k++)g.push(b(a.materials,this.material[k]));f.material=g}else f.material=b(a.materials,this.material);if(0<this.children.length)for(f.children=[],g=0;g<this.children.length;g++)f.children.push(this.children[g].toJSON(a).object);if(0<this.animations.length)for(f.animations=[],g=0;g<this.animations.length;g++)f.animations.push(b(a.animations,this.animations[g]));
if(d){d=c(a.geometries);g=c(a.materials);const k=c(a.textures),h=c(a.images),l=c(a.shapes),n=c(a.skeletons),m=c(a.animations),p=c(a.nodes);0<d.length&&(e.geometries=d);0<g.length&&(e.materials=g);0<k.length&&(e.textures=k);0<h.length&&(e.images=h);0<l.length&&(e.shapes=l);0<n.length&&(e.skeletons=n);0<m.length&&(e.animations=m);0<p.length&&(e.nodes=p)}e.object=f;return e}clone(a){return(new this.constructor).copy(this,a)}copy(a,b=!0){this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);
this.rotation.order=a.rotation.order;this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.animations=
a.animations.slice();this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this}}Gb.DEFAULT_UP=new I(0,1,0);Gb.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gb.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Sc=new I,hd=new I,Ng=new I,id=new I,pe=new I,qe=new I,Wi=new I,Og=new I,Pg=new I,Qg=new I;class Gc{constructor(a=new I,b=new I,c=new I){this.a=a;this.b=b;this.c=c}static getNormal(a,b,c,d){d.subVectors(c,b);Sc.subVectors(a,b);d.cross(Sc);
a=d.lengthSq();return 0<a?d.multiplyScalar(1/Math.sqrt(a)):d.set(0,0,0)}static getBarycoord(a,b,c,d,e){Sc.subVectors(d,b);hd.subVectors(c,b);Ng.subVectors(a,b);a=Sc.dot(Sc);b=Sc.dot(hd);c=Sc.dot(Ng);var f=hd.dot(hd);d=hd.dot(Ng);var g=a*f-b*b;if(0===g)return e.set(0,0,0),null;g=1/g;f=(f*c-b*d)*g;a=(a*d-b*c)*g;return e.set(1-f-a,a,f)}static containsPoint(a,b,c,d){return null===this.getBarycoord(a,b,c,d,id)?!1:0<=id.x&&0<=id.y&&1>=id.x+id.y}static getInterpolation(a,b,c,d,e,f,g,k){if(null===this.getBarycoord(a,
b,c,d,id))return k.x=0,k.y=0,"z"in k&&(k.z=0),"w"in k&&(k.w=0),null;k.setScalar(0);k.addScaledVector(e,id.x);k.addScaledVector(f,id.y);k.addScaledVector(g,id.z);return k}static isFrontFacing(a,b,c,d){Sc.subVectors(c,b);hd.subVectors(a,b);return 0>Sc.cross(hd).dot(d)?!0:!1}set(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this}setFromPointsAndIndices(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this}setFromAttributeAndIndices(a,b,c,d){this.a.fromBufferAttribute(a,
b);this.b.fromBufferAttribute(a,c);this.c.fromBufferAttribute(a,d);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this}getArea(){Sc.subVectors(this.c,this.b);hd.subVectors(this.a,this.b);return.5*Sc.cross(hd).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return Gc.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,
b){return Gc.getBarycoord(a,this.a,this.b,this.c,b)}getInterpolation(a,b,c,d,e){return Gc.getInterpolation(a,this.a,this.b,this.c,b,c,d,e)}containsPoint(a){return Gc.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return Gc.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,b){const c=this.a;var d=this.b,e=this.c;pe.subVectors(d,c);qe.subVectors(e,c);Og.subVectors(a,c);var f=pe.dot(Og),g=qe.dot(Og);if(0>=f&&0>=g)return b.copy(c);Pg.subVectors(a,
d);const k=pe.dot(Pg),h=qe.dot(Pg);if(0<=k&&h<=k)return b.copy(d);var l=f*h-k*g;if(0>=l&&0<=f&&0>=k)return d=f/(f-k),b.copy(c).addScaledVector(pe,d);Qg.subVectors(a,e);a=pe.dot(Qg);const n=qe.dot(Qg);if(0<=n&&a<=n)return b.copy(e);f=a*g-f*n;if(0>=f&&0<=g&&0>=n)return l=g/(g-n),b.copy(c).addScaledVector(qe,l);g=k*n-a*h;if(0>=g&&0<=h-k&&0<=a-n)return Wi.subVectors(e,d),l=(h-k)/(h-k+(a-n)),b.copy(d).addScaledVector(Wi,l);e=1/(g+f+l);d=f*e;l*=e;return b.copy(c).addScaledVector(pe,d).addScaledVector(qe,
l)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}const Xi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,
darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,
gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,
lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,
orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,
slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ud={h:0,s:0,l:0},Bf={h:0,s:0,l:0};class Ya{constructor(a,b,c){this.isColor=!0;this.b=this.g=this.r=1;return this.set(a,b,c)}set(a,b,c){void 0===b&&void 0===c?a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a):
this.setRGB(a,b,c);return this}setScalar(a){this.b=this.g=this.r=a;return this}setHex(a,b="srgb"){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;Kb.toWorkingColorSpace(this,b);return this}setRGB(a,b,c,d=Kb.workingColorSpace){this.r=a;this.g=b;this.b=c;Kb.toWorkingColorSpace(this,d);return this}setHSL(a,b,c,d=Kb.workingColorSpace){a=Ma(a,1);b=ib(b,0,1);c=ib(c,0,1);0===b?this.r=this.g=this.b=c:(b=.5>=c?c*(1+b):c+b-c*b,c=2*c-b,this.r=Z(c,b,a+1/3),this.g=Z(c,b,a),this.b=
Z(c,b,a-1/3));Kb.toWorkingColorSpace(this,d);return this}setStyle(a,b="srgb"){function c(f){void 0!==f&&1>parseFloat(f)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var d;if(d=/^(\w+)\(([^\)]*)\)/.exec(a)){var e=d[2];switch(d[1]){case "rgb":case "rgba":if(d=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return c(d[4]),this.setRGB(Math.min(255,parseInt(d[1],10))/255,Math.min(255,parseInt(d[2],10))/255,Math.min(255,parseInt(d[3],10))/255,b);if(d=/^\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return c(d[4]),
this.setRGB(Math.min(100,parseInt(d[1],10))/100,Math.min(100,parseInt(d[2],10))/100,Math.min(100,parseInt(d[3],10))/100,b);break;case "hsl":case "hsla":if(d=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return c(d[4]),this.setHSL(parseFloat(d[1])/360,parseFloat(d[2])/100,parseFloat(d[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(d=/^#([A-Fa-f\d]+)$/.exec(a)){e=d[1];d=e.length;if(3===d)return this.setRGB(parseInt(e.charAt(0),
16)/15,parseInt(e.charAt(1),16)/15,parseInt(e.charAt(2),16)/15,b);if(6===d)return this.setHex(parseInt(e,16),b);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&0<a.length)return this.setColorName(a,b);return this}setColorName(a,b="srgb"){const c=Xi[a.toLowerCase()];void 0!==c?this.setHex(c,b):console.warn("THREE.Color: Unknown color "+a);return this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){this.r=a.r;this.g=a.g;this.b=a.b;return this}copySRGBToLinear(a){this.r=
Na(a.r);this.g=Na(a.g);this.b=Na(a.b);return this}copyLinearToSRGB(a){this.r=ma(a.r);this.g=ma(a.g);this.b=ma(a.b);return this}convertSRGBToLinear(){this.copySRGBToLinear(this);return this}convertLinearToSRGB(){this.copyLinearToSRGB(this);return this}getHex(a="srgb"){Kb.fromWorkingColorSpace(rc.copy(this),a);return 65536*Math.round(ib(255*rc.r,0,255))+256*Math.round(ib(255*rc.g,0,255))+Math.round(ib(255*rc.b,0,255))}getHexString(a="srgb"){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,
b=Kb.workingColorSpace){Kb.fromWorkingColorSpace(rc.copy(this),b);b=rc.r;const c=rc.g,d=rc.b,e=Math.max(b,c,d);var f=Math.min(b,c,d);let g;const k=(f+e)/2;if(f===e)f=g=0;else{const h=e-f;f=.5>=k?h/(e+f):h/(2-e-f);switch(e){case b:g=(c-d)/h+(c<d?6:0);break;case c:g=(d-b)/h+2;break;case d:g=(b-c)/h+4}g/=6}a.h=g;a.s=f;a.l=k;return a}getRGB(a,b=Kb.workingColorSpace){Kb.fromWorkingColorSpace(rc.copy(this),b);a.r=rc.r;a.g=rc.g;a.b=rc.b;return a}getStyle(a="srgb"){Kb.fromWorkingColorSpace(rc.copy(this),
a);const b=rc.r,c=rc.g,d=rc.b;return"srgb"!==a?`color(${a} ${b.toFixed(3)} ${c.toFixed(3)} ${d.toFixed(3)})`:`rgb(${Math.round(255*b)},${Math.round(255*c)},${Math.round(255*d)})`}offsetHSL(a,b,c){this.getHSL(ud);return this.setHSL(ud.h+a,ud.s+b,ud.l+c)}add(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this}addColors(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this}addScalar(a){this.r+=a;this.g+=a;this.b+=a;return this}sub(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);
this.b=Math.max(0,this.b-a.b);return this}multiply(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this}multiplyScalar(a){this.r*=a;this.g*=a;this.b*=a;return this}lerp(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this}lerpColors(a,b,c){this.r=a.r+(b.r-a.r)*c;this.g=a.g+(b.g-a.g)*c;this.b=a.b+(b.b-a.b)*c;return this}lerpHSL(a,b){this.getHSL(ud);a.getHSL(Bf);a=ua(ud.h,Bf.h,b);const c=ua(ud.s,Bf.s,b);b=ua(ud.l,Bf.l,b);this.setHSL(a,c,b);return this}setFromVector3(a){this.r=
a.x;this.g=a.y;this.b=a.z;return this}applyMatrix3(a){const b=this.r,c=this.g,d=this.b;a=a.elements;this.r=a[0]*b+a[3]*c+a[6]*d;this.g=a[1]*b+a[4]*c+a[7]*d;this.b=a[2]*b+a[5]*c+a[8]*d;return this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,b=0){this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this}toArray(a=[],b=0){a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a}fromBufferAttribute(a,b){this.r=a.getX(b);this.g=a.getY(b);this.b=a.getZ(b);return this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r;
yield this.g;yield this.b}}const rc=new Ya;Ya.NAMES=Xi;let cm=0;class sc extends dd{constructor(){super();this.isMaterial=!0;Object.defineProperty(this,"id",{value:cm++});this.uuid=pa();this.name="";this.type="Material";this.blending=1;this.side=0;this.vertexColors=!1;this.opacity=1;this.alphaHash=this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.blendColor=new Ya(0,0,0);this.blendAlpha=0;this.depthFunc=
3;this.depthWrite=this.depthTest=!0;this.stencilWriteMask=255;this.stencilFunc=519;this.stencilRef=0;this.stencilFuncMask=255;this.stencilZPass=this.stencilZFail=this.stencilFail=7680;this.stencilWrite=!1;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.forceSinglePass=this.premultipliedAlpha=this.alphaToCoverage=this.dithering=!1;this.toneMapped=
this.visible=!0;this.userData={};this._alphaTest=this.version=0}get alphaTest(){return this._alphaTest}set alphaTest(a){0<this._alphaTest!==0<a&&this.version++;this._alphaTest=a}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(const b in a){const c=a[b];if(void 0===c){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}const d=this[b];void 0===d?console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`):
d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c}}toJSON(a){function b(e){const f=[];for(const g in e){const k=e[g];delete k.metadata;f.push(k)}return f}var c=void 0===a||"string"===typeof a;c&&(a={textures:{},images:{}});const d={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid;d.type=this.type;""!==this.name&&(d.name=this.name);this.color&&this.color.isColor&&(d.color=this.color.getHex());void 0!==this.roughness&&(d.roughness=this.roughness);
void 0!==this.metalness&&(d.metalness=this.metalness);void 0!==this.sheen&&(d.sheen=this.sheen);this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex());void 0!==this.sheenRoughness&&(d.sheenRoughness=this.sheenRoughness);this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex());void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex());
void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity);this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex());void 0!==this.shininess&&(d.shininess=this.shininess);void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat);void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness);this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(a).uuid);this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&
(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid);this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray());void 0!==this.iridescence&&(d.iridescence=this.iridescence);void 0!==this.iridescenceIOR&&(d.iridescenceIOR=this.iridescenceIOR);void 0!==this.iridescenceThicknessRange&&(d.iridescenceThicknessRange=this.iridescenceThicknessRange);this.iridescenceMap&&
this.iridescenceMap.isTexture&&(d.iridescenceMap=this.iridescenceMap.toJSON(a).uuid);this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(d.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid);void 0!==this.anisotropy&&(d.anisotropy=this.anisotropy);void 0!==this.anisotropyRotation&&(d.anisotropyRotation=this.anisotropyRotation);this.anisotropyMap&&this.anisotropyMap.isTexture&&(d.anisotropyMap=this.anisotropyMap.toJSON(a).uuid);this.map&&this.map.isTexture&&(d.map=
this.map.toJSON(a).uuid);this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(a).uuid,d.lightMapIntensity=this.lightMapIntensity);this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=
this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&
(d.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid);this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid);this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&
(d.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(d.combine=this.combine));void 0!==this.envMapRotation&&(d.envMapRotation=this.envMapRotation.toArray());void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity);void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity);void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio);this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.transmission&&(d.transmission=
this.transmission);this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(a).uuid);void 0!==this.thickness&&(d.thickness=this.thickness);this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(a).uuid);void 0!==this.attenuationDistance&&Infinity!==this.attenuationDistance&&(d.attenuationDistance=this.attenuationDistance);void 0!==this.attenuationColor&&(d.attenuationColor=this.attenuationColor.getHex());void 0!==this.size&&
(d.size=this.size);null!==this.shadowSide&&(d.shadowSide=this.shadowSide);void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation);1!==this.blending&&(d.blending=this.blending);0!==this.side&&(d.side=this.side);!0===this.vertexColors&&(d.vertexColors=!0);1>this.opacity&&(d.opacity=this.opacity);!0===this.transparent&&(d.transparent=!0);204!==this.blendSrc&&(d.blendSrc=this.blendSrc);205!==this.blendDst&&(d.blendDst=this.blendDst);100!==this.blendEquation&&(d.blendEquation=this.blendEquation);
null!==this.blendSrcAlpha&&(d.blendSrcAlpha=this.blendSrcAlpha);null!==this.blendDstAlpha&&(d.blendDstAlpha=this.blendDstAlpha);null!==this.blendEquationAlpha&&(d.blendEquationAlpha=this.blendEquationAlpha);this.blendColor&&this.blendColor.isColor&&(d.blendColor=this.blendColor.getHex());0!==this.blendAlpha&&(d.blendAlpha=this.blendAlpha);3!==this.depthFunc&&(d.depthFunc=this.depthFunc);!1===this.depthTest&&(d.depthTest=this.depthTest);!1===this.depthWrite&&(d.depthWrite=this.depthWrite);!1===this.colorWrite&&
(d.colorWrite=this.colorWrite);255!==this.stencilWriteMask&&(d.stencilWriteMask=this.stencilWriteMask);519!==this.stencilFunc&&(d.stencilFunc=this.stencilFunc);0!==this.stencilRef&&(d.stencilRef=this.stencilRef);255!==this.stencilFuncMask&&(d.stencilFuncMask=this.stencilFuncMask);7680!==this.stencilFail&&(d.stencilFail=this.stencilFail);7680!==this.stencilZFail&&(d.stencilZFail=this.stencilZFail);7680!==this.stencilZPass&&(d.stencilZPass=this.stencilZPass);!0===this.stencilWrite&&(d.stencilWrite=
this.stencilWrite);void 0!==this.rotation&&0!==this.rotation&&(d.rotation=this.rotation);!0===this.polygonOffset&&(d.polygonOffset=!0);0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor);0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits);void 0!==this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth);void 0!==this.dashSize&&(d.dashSize=this.dashSize);void 0!==this.gapSize&&(d.gapSize=this.gapSize);void 0!==this.scale&&(d.scale=this.scale);
!0===this.dithering&&(d.dithering=!0);0<this.alphaTest&&(d.alphaTest=this.alphaTest);!0===this.alphaHash&&(d.alphaHash=!0);!0===this.alphaToCoverage&&(d.alphaToCoverage=!0);!0===this.premultipliedAlpha&&(d.premultipliedAlpha=!0);!0===this.forceSinglePass&&(d.forceSinglePass=!0);!0===this.wireframe&&(d.wireframe=!0);1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&
(d.wireframeLinejoin=this.wireframeLinejoin);!0===this.flatShading&&(d.flatShading=!0);!1===this.visible&&(d.visible=!1);!1===this.toneMapped&&(d.toneMapped=!1);!1===this.fog&&(d.fog=!1);0<Object.keys(this.userData).length&&(d.userData=this.userData);c&&(c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a));return d}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.blending=a.blending;this.side=a.side;this.vertexColors=a.vertexColors;this.opacity=
a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.blendColor.copy(a.blendColor);this.blendAlpha=a.blendAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.stencilWriteMask=a.stencilWriteMask;this.stencilFunc=a.stencilFunc;this.stencilRef=a.stencilRef;this.stencilFuncMask=
a.stencilFuncMask;this.stencilFail=a.stencilFail;this.stencilZFail=a.stencilZFail;this.stencilZPass=a.stencilZPass;this.stencilWrite=a.stencilWrite;const b=a.clippingPlanes;let c=null;if(null!==b){const d=b.length;c=Array(d);for(let e=0;e!==d;++e)c[e]=b[e].clone()}this.clippingPlanes=c;this.clipIntersection=a.clipIntersection;this.clipShadows=a.clipShadows;this.shadowSide=a.shadowSide;this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=
a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.alphaHash=a.alphaHash;this.alphaToCoverage=a.alphaToCoverage;this.premultipliedAlpha=a.premultipliedAlpha;this.forceSinglePass=a.forceSinglePass;this.visible=a.visible;this.toneMapped=a.toneMapped;this.userData=JSON.parse(JSON.stringify(a.userData));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}}class vd extends sc{constructor(a){super();
this.isMeshBasicMaterial=!0;this.type="MeshBasicMaterial";this.color=new Ya(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Kc;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;
this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.fog=
a.fog;return this}}const cd=function(){var a=new ArrayBuffer(4);const b=new Float32Array(a);a=new Uint32Array(a);const c=new Uint32Array(512),d=new Uint32Array(512);for(var e=0;256>e;++e){var f=e-127;-27>f?(c[e]=0,c[e|256]=32768,d[e]=24,d[e|256]=24):-14>f?(c[e]=1024>>-f-14,c[e|256]=1024>>-f-14|32768,d[e]=-f-1,d[e|256]=-f-1):15>=f?(c[e]=f+15<<10,c[e|256]=f+15<<10|32768,d[e]=13,d[e|256]=13):128>f?(c[e]=31744,c[e|256]=64512,d[e]=24,d[e|256]=24):(c[e]=31744,c[e|256]=64512,d[e]=13,d[e|256]=13)}e=new Uint32Array(2048);
f=new Uint32Array(64);const g=new Uint32Array(64);for(var k=1;1024>k;++k){let h=k<<13,l=0;for(;0===(h&8388608);)h<<=1,l-=8388608;h&=-8388609;l+=947912704;e[k]=h|l}for(k=1024;2048>k;++k)e[k]=939524096+(k-1024<<13);for(k=1;31>k;++k)f[k]=k<<23;f[31]=1199570944;f[32]=2147483648;for(k=33;63>k;++k)f[k]=2147483648+(k-32<<23);f[63]=3347054592;for(k=1;64>k;++k)32!==k&&(g[k]=1024);return{floatView:b,uint32View:a,baseTable:c,shiftTable:d,mantissaTable:e,exponentTable:f,offsetTable:g}}(),dm={toHalfFloat:P,fromHalfFloat:V},
gc=new I,Cf=new xa;class Nb{constructor(a,b,c=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0;this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=c;this.usage=35044;this._updateRange={offset:0,count:-1};this.updateRanges=[];this.gpuType=1015;this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}get updateRange(){Wa("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead.");
return this._updateRange}setUsage(a){this.usage=a;return this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.usage=a.usage;this.gpuType=a.gpuType;return this}copyAt(a,b,c){a*=this.itemSize;c*=b.itemSize;for(let d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this}copyArray(a){this.array.set(a);
return this}applyMatrix3(a){if(2===this.itemSize)for(let b=0,c=this.count;b<c;b++)Cf.fromBufferAttribute(this,b),Cf.applyMatrix3(a),this.setXY(b,Cf.x,Cf.y);else if(3===this.itemSize)for(let b=0,c=this.count;b<c;b++)gc.fromBufferAttribute(this,b),gc.applyMatrix3(a),this.setXYZ(b,gc.x,gc.y,gc.z);return this}applyMatrix4(a){for(let b=0,c=this.count;b<c;b++)gc.fromBufferAttribute(this,b),gc.applyMatrix4(a),this.setXYZ(b,gc.x,gc.y,gc.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)gc.fromBufferAttribute(this,
b),gc.applyNormalMatrix(a),this.setXYZ(b,gc.x,gc.y,gc.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)gc.fromBufferAttribute(this,b),gc.transformDirection(a),this.setXYZ(b,gc.x,gc.y,gc.z);return this}set(a,b=0){this.array.set(a,b);return this}getComponent(a,b){a=this.array[a*this.itemSize+b];this.normalized&&(a=qa(a,this.array));return a}setComponent(a,b,c){this.normalized&&(c=Qa(c,this.array));this.array[a*this.itemSize+b]=c;return this}getX(a){a=this.array[a*this.itemSize];
this.normalized&&(a=qa(a,this.array));return a}setX(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize]=b;return this}getY(a){a=this.array[a*this.itemSize+1];this.normalized&&(a=qa(a,this.array));return a}setY(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+1]=b;return this}getZ(a){a=this.array[a*this.itemSize+2];this.normalized&&(a=qa(a,this.array));return a}setZ(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+2]=b;return this}getW(a){a=
this.array[a*this.itemSize+3];this.normalized&&(a=qa(a,this.array));return a}setW(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+3]=b;return this}setXY(a,b,c){a*=this.itemSize;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array));this.array[a+0]=b;this.array[a+1]=c;return this}setXYZ(a,b,c,d){a*=this.itemSize;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array),d=Qa(d,this.array));this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this}setXYZW(a,b,c,d,e){a*=
this.itemSize;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array),d=Qa(d,this.array),e=Qa(e,this.array));this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this}onUpload(a){this.onUploadCallback=a;return this}clone(){return(new this.constructor(this.array,this.itemSize)).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};""!==this.name&&(a.name=this.name);35044!==this.usage&&
(a.usage=this.usage);return a}}class em extends Nb{constructor(a,b,c){super(new Int8Array(a),b,c)}}class fm extends Nb{constructor(a,b,c){super(new Uint8Array(a),b,c)}}class gm extends Nb{constructor(a,b,c){super(new Uint8ClampedArray(a),b,c)}}class hm extends Nb{constructor(a,b,c){super(new Int16Array(a),b,c)}}class ng extends Nb{constructor(a,b,c){super(new Uint16Array(a),b,c)}}class im extends Nb{constructor(a,b,c){super(new Int32Array(a),b,c)}}class mg extends Nb{constructor(a,b,c){super(new Uint32Array(a),
b,c)}}class jm extends Nb{constructor(a,b,c){super(new Uint16Array(a),b,c);this.isFloat16BufferAttribute=!0}getX(a){a=V(this.array[a*this.itemSize]);this.normalized&&(a=qa(a,this.array));return a}setX(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize]=P(b);return this}getY(a){a=V(this.array[a*this.itemSize+1]);this.normalized&&(a=qa(a,this.array));return a}setY(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+1]=P(b);return this}getZ(a){a=V(this.array[a*this.itemSize+
2]);this.normalized&&(a=qa(a,this.array));return a}setZ(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+2]=P(b);return this}getW(a){a=V(this.array[a*this.itemSize+3]);this.normalized&&(a=qa(a,this.array));return a}setW(a,b){this.normalized&&(b=Qa(b,this.array));this.array[a*this.itemSize+3]=P(b);return this}setXY(a,b,c){a*=this.itemSize;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array));this.array[a+0]=P(b);this.array[a+1]=P(c);return this}setXYZ(a,b,c,d){a*=this.itemSize;
this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array),d=Qa(d,this.array));this.array[a+0]=P(b);this.array[a+1]=P(c);this.array[a+2]=P(d);return this}setXYZW(a,b,c,d,e){a*=this.itemSize;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array),d=Qa(d,this.array),e=Qa(e,this.array));this.array[a+0]=P(b);this.array[a+1]=P(c);this.array[a+2]=P(d);this.array[a+3]=P(e);return this}}class eb extends Nb{constructor(a,b,c){super(new Float32Array(a),b,c)}}let km=0;const Lc=new lb,Rg=new Gb,re=new I,Fc=new xc,
Qe=new xc,kc=new I;class tb extends dd{constructor(){super();this.isBufferGeometry=!0;Object.defineProperty(this,"id",{value:km++});this.uuid=pa();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=!1;this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}getIndex(){return this.index}setIndex(a){Array.isArray(a)?this.index=new (Tb(a)?mg:ng)(a,1):this.index=a;return this}getAttribute(a){return this.attributes[a]}setAttribute(a,
b){this.attributes[a]=b;return this}deleteAttribute(a){delete this.attributes[a];return this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,b,c=0){this.groups.push({start:a,count:b,materialIndex:c})}clearGroups(){this.groups=[]}setDrawRange(a,b){this.drawRange.start=a;this.drawRange.count=b}applyMatrix4(a){var b=this.attributes.position;void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0);b=this.attributes.normal;if(void 0!==b){const c=(new ob).getNormalMatrix(a);b.applyNormalMatrix(c);
b.needsUpdate=!0}b=this.attributes.tangent;void 0!==b&&(b.transformDirection(a),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this}applyQuaternion(a){Lc.makeRotationFromQuaternion(a);this.applyMatrix4(Lc);return this}rotateX(a){Lc.makeRotationX(a);this.applyMatrix4(Lc);return this}rotateY(a){Lc.makeRotationY(a);this.applyMatrix4(Lc);return this}rotateZ(a){Lc.makeRotationZ(a);this.applyMatrix4(Lc);return this}translate(a,
b,c){Lc.makeTranslation(a,b,c);this.applyMatrix4(Lc);return this}scale(a,b,c){Lc.makeScale(a,b,c);this.applyMatrix4(Lc);return this}lookAt(a){Rg.lookAt(a);Rg.updateMatrix();this.applyMatrix4(Rg.matrix);return this}center(){this.computeBoundingBox();this.boundingBox.getCenter(re).negate();this.translate(re.x,re.y,re.z);return this}setFromPoints(a){const b=[];for(let c=0,d=a.length;c<d;c++){const e=a[c];b.push(e.x,e.y,e.z||0)}this.setAttribute("position",new eb(b,3));return this}computeBoundingBox(){null===
this.boundingBox&&(this.boundingBox=new xc);const a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new I(-Infinity,-Infinity,-Infinity),new I(Infinity,Infinity,Infinity));else{if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),b)for(let c=0,d=b.length;c<d;c++)Fc.setFromBufferAttribute(b[c]),this.morphTargetsRelative?
(kc.addVectors(this.boundingBox.min,Fc.min),this.boundingBox.expandByPoint(kc),kc.addVectors(this.boundingBox.max,Fc.max),this.boundingBox.expandByPoint(kc)):(this.boundingBox.expandByPoint(Fc.min),this.boundingBox.expandByPoint(Fc.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',
this)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qc);const a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new I,Infinity);else if(a){const c=this.boundingSphere.center;Fc.setFromBufferAttribute(a);if(b)for(let e=0,f=b.length;e<f;e++)Qe.setFromBufferAttribute(b[e]),this.morphTargetsRelative?
(kc.addVectors(Fc.min,Qe.min),Fc.expandByPoint(kc),kc.addVectors(Fc.max,Qe.max),Fc.expandByPoint(kc)):(Fc.expandByPoint(Qe.min),Fc.expandByPoint(Qe.max));Fc.getCenter(c);let d=0;for(let e=0,f=a.count;e<f;e++)kc.fromBufferAttribute(a,e),d=Math.max(d,c.distanceToSquared(kc));if(b)for(let e=0,f=b.length;e<f;e++){const g=b[e],k=this.morphTargetsRelative;for(let h=0,l=g.count;h<l;h++)kc.fromBufferAttribute(g,h),k&&(re.fromBufferAttribute(a,h),kc.add(re)),d=Math.max(d,c.distanceToSquared(kc))}this.boundingSphere.radius=
Math.sqrt(d);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){function a(R,fa,ea){n.fromBufferAttribute(e,R);m.fromBufferAttribute(e,fa);p.fromBufferAttribute(e,ea);v.fromBufferAttribute(g,R);t.fromBufferAttribute(g,fa);x.fromBufferAttribute(g,ea);m.sub(n);p.sub(n);t.sub(v);x.sub(v);const na=1/(t.x*x.y-x.x*t.y);isFinite(na)&&(C.copy(m).multiplyScalar(x.y).addScaledVector(p,
-t.y).multiplyScalar(na),u.copy(p).multiplyScalar(t.x).addScaledVector(m,-x.x).multiplyScalar(na),h[R].add(C),h[fa].add(C),h[ea].add(C),l[R].add(u),l[fa].add(u),l[ea].add(u))}function b(R){U.fromBufferAttribute(f,R);W.copy(U);var fa=h[R];J.copy(fa);J.sub(U.multiplyScalar(U.dot(fa))).normalize();K.crossVectors(W,fa);fa=K.dot(l[R]);k.setXYZW(R,J.x,J.y,J.z,0>fa?-1:1)}const c=this.index;var d=this.attributes;if(null===c||void 0===d.position||void 0===d.normal||void 0===d.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");
else{var e=d.position,f=d.normal,g=d.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Nb(new Float32Array(4*e.count),4));var k=this.getAttribute("tangent"),h=[],l=[];for(d=0;d<e.count;d++)h[d]=new I,l[d]=new I;var n=new I,m=new I,p=new I,v=new xa,t=new xa,x=new xa,C=new I,u=new I;d=this.groups;0===d.length&&(d=[{start:0,count:c.count}]);for(let R=0,fa=d.length;R<fa;++R){var D=d[R],aa=D.start;D=D.count;for(let ea=aa,na=aa+D;ea<na;ea+=3)a(c.getX(ea+0),c.getX(ea+1),c.getX(ea+2))}var J=
new I,K=new I,U=new I,W=new I;for(let R=0,fa=d.length;R<fa;++R){D=d[R];aa=D.start;D=D.count;for(let ea=aa,na=aa+D;ea<na;ea+=3)b(c.getX(ea+0)),b(c.getX(ea+1)),b(c.getX(ea+2))}}}computeVertexNormals(){const a=this.index,b=this.getAttribute("position");if(void 0!==b){let c=this.getAttribute("normal");if(void 0===c)c=new Nb(new Float32Array(3*b.count),3),this.setAttribute("normal",c);else for(let m=0,p=c.count;m<p;m++)c.setXYZ(m,0,0,0);const d=new I,e=new I,f=new I,g=new I,k=new I,h=new I,l=new I,n=new I;
if(a)for(let m=0,p=a.count;m<p;m+=3){const v=a.getX(m+0),t=a.getX(m+1),x=a.getX(m+2);d.fromBufferAttribute(b,v);e.fromBufferAttribute(b,t);f.fromBufferAttribute(b,x);l.subVectors(f,e);n.subVectors(d,e);l.cross(n);g.fromBufferAttribute(c,v);k.fromBufferAttribute(c,t);h.fromBufferAttribute(c,x);g.add(l);k.add(l);h.add(l);c.setXYZ(v,g.x,g.y,g.z);c.setXYZ(t,k.x,k.y,k.z);c.setXYZ(x,h.x,h.y,h.z)}else for(let m=0,p=b.count;m<p;m+=3)d.fromBufferAttribute(b,m+0),e.fromBufferAttribute(b,m+1),f.fromBufferAttribute(b,
m+2),l.subVectors(f,e),n.subVectors(d,e),l.cross(n),c.setXYZ(m+0,l.x,l.y,l.z),c.setXYZ(m+1,l.x,l.y,l.z),c.setXYZ(m+2,l.x,l.y,l.z);this.normalizeNormals();c.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let b=0,c=a.count;b<c;b++)kc.fromBufferAttribute(a,b),kc.normalize(),a.setXYZ(b,kc.x,kc.y,kc.z)}toNonIndexed(){function a(k,h){const l=k.array,n=k.itemSize,m=k.normalized,p=new l.constructor(h.length*n);let v,t=0;for(let x=0,C=h.length;x<C;x++){v=k.isInterleavedBufferAttribute?
h[x]*k.data.stride+k.offset:h[x]*n;for(let u=0;u<n;u++)p[t++]=l[v++]}return new Nb(p,n,m)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const b=new tb;var c=this.index.array,d=this.attributes;for(var e in d){var f=a(d[e],c);b.setAttribute(e,f)}d=this.morphAttributes;for(var g in d){e=[];f=d[g];for(let k=0,h=f.length;k<h;k++){const l=a(f[k],c);e.push(l)}b.morphAttributes[g]=e}b.morphTargetsRelative=this.morphTargetsRelative;
c=this.groups;for(let k=0,h=c.length;k<h;k++)g=c[k],b.addGroup(g.start,g.count,g.materialIndex);return b}toJSON(){const a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var b=this.parameters;for(var c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};c=this.index;null!==c&&(a.data.index={type:c.array.constructor.name,
array:Array.prototype.slice.call(c.array)});c=this.attributes;for(var d in c)a.data.attributes[d]=c[d].toJSON(a.data);d={};c=!1;for(b in this.morphAttributes){const e=this.morphAttributes[b],f=[];for(let g=0,k=e.length;g<k;g++)f.push(e[g].toJSON(a.data));0<f.length&&(d[b]=f,c=!0)}c&&(a.data.morphAttributes=d,a.data.morphTargetsRelative=this.morphTargetsRelative);b=this.groups;0<b.length&&(a.data.groups=JSON.parse(JSON.stringify(b)));b=this.boundingSphere;null!==b&&(a.data.boundingSphere={center:b.center.toArray(),
radius:b.radius});return a}clone(){return(new this.constructor).copy(this)}copy(a){this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;var b={};this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone(b));c=a.attributes;for(var d in c)this.setAttribute(d,c[d].clone(b));d=a.morphAttributes;for(var e in d){c=[];const f=d[e];for(let g=0,k=f.length;g<k;g++)c.push(f[g].clone(b));this.morphAttributes[e]=c}this.morphTargetsRelative=a.morphTargetsRelative;
b=a.groups;for(let f=0,g=b.length;f<g;f++)e=b[f],this.addGroup(e.start,e.count,e.materialIndex);b=a.boundingBox;null!==b&&(this.boundingBox=b.clone());b=a.boundingSphere;null!==b&&(this.boundingSphere=b.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;return this}dispose(){this.dispatchEvent({type:"dispose"})}}const Yi=new lb,Nd=new me,Df=new qc,Zi=new I,Dd=new I,Ed=new I,Fd=new I,Sg=new I,Ef=new I,gf=new xa,hf=new xa,jf=new xa,Xh=new I,
Yh=new I,Zh=new I,$d=new I,ff=new I;class dc extends Gb{constructor(a=new tb,b=new vd){super();this.isMesh=!0;this.type="Mesh";this.geometry=a;this.material=b;this.updateMorphTargets()}copy(a,b){super.copy(a,b);void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;
return this}updateMorphTargets(){var a=this.geometry.morphAttributes,b=Object.keys(a);if(0<b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let c=0,d=a.length;c<d;c++)b=a[c].name||String(c),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=c}}getVertexPosition(a,b){var c=this.geometry;const d=c.morphAttributes.position,e=c.morphTargetsRelative;b.fromBufferAttribute(c.attributes.position,a);c=this.morphTargetInfluences;if(d&&c){Ef.set(0,
0,0);for(let f=0,g=d.length;f<g;f++){const k=c[f];0!==k&&(Sg.fromBufferAttribute(d[f],a),e?Ef.addScaledVector(Sg,k):Ef.addScaledVector(Sg.sub(b),k))}b.add(Ef)}return b}raycast(a,b){const c=this.geometry,d=this.matrixWorld;void 0!==this.material&&(null===c.boundingSphere&&c.computeBoundingSphere(),Df.copy(c.boundingSphere),Df.applyMatrix4(d),Nd.copy(a.ray).recast(a.near),!1===Df.containsPoint(Nd.origin)&&(null===Nd.intersectSphere(Df,Zi)||Nd.origin.distanceToSquared(Zi)>(a.far-a.near)**2)||(Yi.copy(d).invert(),
Nd.copy(a.ray).applyMatrix4(Yi),null!==c.boundingBox&&!1===Nd.intersectsBox(c.boundingBox)||this._computeIntersections(a,b,Nd)))}_computeIntersections(a,b,c){var d=this.geometry;const e=this.material;var f=d.index,g=d.attributes.position;const k=d.attributes.uv,h=d.attributes.uv1,l=d.attributes.normal;var n=d.groups;d=d.drawRange;if(null!==f)if(Array.isArray(e))for(let t=0,x=n.length;t<x;t++){g=n[t];var m=e[g.materialIndex];var p=Math.max(g.start,d.start);var v=Math.min(f.count,Math.min(g.start+g.count,
d.start+d.count));for(let C=p,u=v;C<u;C+=3){p=f.getX(C);v=f.getX(C+1);const D=f.getX(C+2);if(p=ha(this,m,a,c,k,h,l,p,v,D))p.faceIndex=Math.floor(C/3),p.face.materialIndex=g.materialIndex,b.push(p)}}else{n=Math.max(0,d.start);d=Math.min(f.count,d.start+d.count);for(let t=n,x=d;t<x;t+=3)if(d=f.getX(t),n=f.getX(t+1),g=f.getX(t+2),p=ha(this,e,a,c,k,h,l,d,n,g))p.faceIndex=Math.floor(t/3),b.push(p)}else if(void 0!==g)if(Array.isArray(e))for(let t=0,x=n.length;t<x;t++){f=n[t];m=e[f.materialIndex];p=Math.max(f.start,
d.start);v=Math.min(g.count,Math.min(f.start+f.count,d.start+d.count));for(let C=p,u=v;C<u;C+=3)if(p=ha(this,m,a,c,k,h,l,C,C+1,C+2))p.faceIndex=Math.floor(C/3),p.face.materialIndex=f.materialIndex,b.push(p)}else{f=Math.max(0,d.start);d=Math.min(g.count,d.start+d.count);for(let t=f,x=d;t<x;t+=3)if(p=ha(this,e,a,c,k,h,l,t,t+1,t+2))p.faceIndex=Math.floor(t/3),b.push(p)}}}class ae extends tb{constructor(a=1,b=1,c=1,d=1,e=1,f=1){function g(t,x,C,u,D,aa,J,K,U,W,R){const fa=aa/U,ea=J/W,na=aa/2,Ea=J/2,ca=
K/2;J=U+1;const Ga=W+1;let ta=aa=0;const Sa=new I;for(let cb=0;cb<Ga;cb++){const $a=cb*ea-Ea;for(let Ha=0;Ha<J;Ha++)Sa[t]=(Ha*fa-na)*u,Sa[x]=$a*D,Sa[C]=ca,l.push(Sa.x,Sa.y,Sa.z),Sa[t]=0,Sa[x]=0,Sa[C]=0<K?1:-1,n.push(Sa.x,Sa.y,Sa.z),m.push(Ha/U),m.push(1-cb/W),aa+=1}for(t=0;t<W;t++)for(x=0;x<U;x++)C=p+x+J*(t+1),u=p+(x+1)+J*(t+1),D=p+(x+1)+J*t,h.push(p+x+J*t,C,D),h.push(C,u,D),ta+=6;k.addGroup(v,ta,R);v+=ta;p+=aa}super();this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,
heightSegments:e,depthSegments:f};const k=this;d=Math.floor(d);e=Math.floor(e);f=Math.floor(f);const h=[],l=[],n=[],m=[];let p=0,v=0;g("z","y","x",-1,-1,c,b,a,f,e,0);g("z","y","x",1,-1,c,b,-a,f,e,1);g("x","z","y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(h);this.setAttribute("position",new eb(l,3));this.setAttribute("normal",new eb(n,3));this.setAttribute("uv",new eb(m,2))}copy(a){super.copy(a);this.parameters=
Object.assign({},a.parameters);return this}static fromJSON(a){return new ae(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}const ri={clone:Aa,merge:Ca};class Mc extends sc{constructor(a){super();this.isShaderMaterial=!0;this.type="ShaderMaterial";this.defines={};this.uniforms={};this.uniformsGroups=[];this.vertexShader="void main() {\n\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor \x3d vec4( 1.0, 0.0, 0.0, 1.0 );\n}";
this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.clipping=this.lights=this.fog=!1;this.forceSinglePass=!0;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.glslVersion=null;void 0!==a&&this.setValues(a)}copy(a){super.copy(a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;
this.uniforms=Aa(a.uniforms);var b=a.uniformsGroups;const c=[];for(let d=0;d<b.length;d++)c.push(b[d].clone());this.uniformsGroups=c;this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.fog=a.fog;this.lights=a.lights;this.clipping=a.clipping;this.extensions=Object.assign({},a.extensions);this.glslVersion=a.glslVersion;return this}toJSON(a){const b=super.toJSON(a);b.glslVersion=this.glslVersion;b.uniforms={};for(const c in this.uniforms){const d=
this.uniforms[c].value;b.uniforms[c]=d&&d.isTexture?{type:"t",value:d.toJSON(a).uuid}:d&&d.isColor?{type:"c",value:d.getHex()}:d&&d.isVector2?{type:"v2",value:d.toArray()}:d&&d.isVector3?{type:"v3",value:d.toArray()}:d&&d.isVector4?{type:"v4",value:d.toArray()}:d&&d.isMatrix3?{type:"m3",value:d.toArray()}:d&&d.isMatrix4?{type:"m4",value:d.toArray()}:{value:d}}0<Object.keys(this.defines).length&&(b.defines=this.defines);b.vertexShader=this.vertexShader;b.fragmentShader=this.fragmentShader;b.lights=
this.lights;b.clipping=this.clipping;a={};for(const c in this.extensions)!0===this.extensions[c]&&(a[c]=!0);0<Object.keys(a).length&&(b.extensions=a);return b}}class Ff extends Gb{constructor(){super();this.isCamera=!0;this.type="Camera";this.matrixWorldInverse=new lb;this.projectionMatrix=new lb;this.projectionMatrixInverse=new lb;this.coordinateSystem=2E3}copy(a,b){super.copy(a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);this.projectionMatrixInverse.copy(a.projectionMatrixInverse);
this.coordinateSystem=a.coordinateSystem;return this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a);this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,b){super.updateWorldMatrix(a,b);this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const wd=new I,$i=new xa,aj=new xa;class lc extends Ff{constructor(a=50,b=1,c=.1,d=2E3){super();this.isPerspectiveCamera=!0;
this.type="PerspectiveCamera";this.fov=a;this.zoom=1;this.near=c;this.far=d;this.focus=10;this.aspect=b;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}copy(a,b){super.copy(a,b);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this}setFocalLength(a){a=.5*this.getFilmHeight()/a;this.fov=2*ge*Math.atan(a);
this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(.5*Kd*this.fov);return.5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*ge*Math.atan(Math.tan(.5*Kd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,b,c){wd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse);b.set(wd.x,wd.y).multiplyScalar(-a/wd.z);wd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse);c.set(wd.x,
wd.y).multiplyScalar(-a/wd.z)}getViewSize(a,b){this.getViewBounds(a,$i,aj);return b.subVectors(aj,$i)}setViewOffset(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){const a=
this.near;let b=a*Math.tan(.5*Kd*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d;var f=this.view;if(null!==this.view&&this.view.enabled){const g=f.fullWidth,k=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/k;d*=f.width/g;c*=f.height/k}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.fov=this.fov;a.object.zoom=
this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}}class bj extends Gb{constructor(a,b,c){super();this.type="CubeCamera";this.renderTarget=c;this.coordinateSystem=null;this.activeMipmapLevel=0;c=new lc(-90,1,a,b);c.layers=this.layers;this.add(c);c=new lc(-90,1,a,b);c.layers=this.layers;this.add(c);c=
new lc(-90,1,a,b);c.layers=this.layers;this.add(c);c=new lc(-90,1,a,b);c.layers=this.layers;this.add(c);c=new lc(-90,1,a,b);c.layers=this.layers;this.add(c);a=new lc(-90,1,a,b);a.layers=this.layers;this.add(a)}updateCoordinateSystem(){const a=this.coordinateSystem,b=this.children.concat(),[c,d,e,f,g,k]=b;for(const h of b)this.remove(h);if(2E3===a)c.up.set(0,1,0),c.lookAt(1,0,0),d.up.set(0,1,0),d.lookAt(-1,0,0),e.up.set(0,0,-1),e.lookAt(0,1,0),f.up.set(0,0,1),f.lookAt(0,-1,0),g.up.set(0,1,0),g.lookAt(0,
0,1),k.up.set(0,1,0),k.lookAt(0,0,-1);else if(2001===a)c.up.set(0,-1,0),c.lookAt(-1,0,0),d.up.set(0,-1,0),d.lookAt(1,0,0),e.up.set(0,0,1),e.lookAt(0,1,0),f.up.set(0,0,-1),f.lookAt(0,-1,0),g.up.set(0,-1,0),g.lookAt(0,0,1),k.up.set(0,-1,0),k.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(const h of b)this.add(h),h.updateMatrixWorld()}update(a,b){null===this.parent&&this.updateMatrixWorld();const {renderTarget:c,activeMipmapLevel:d}=this;
this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const [e,f,g,k,h,l]=this.children,n=a.getRenderTarget(),m=a.getActiveCubeFace(),p=a.getActiveMipmapLevel(),v=a.xr.enabled;a.xr.enabled=!1;const t=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;a.setRenderTarget(c,0,d);a.render(b,e);a.setRenderTarget(c,1,d);a.render(b,f);a.setRenderTarget(c,2,d);a.render(b,g);a.setRenderTarget(c,3,d);a.render(b,k);a.setRenderTarget(c,4,d);a.render(b,
h);c.texture.generateMipmaps=t;a.setRenderTarget(c,5,d);a.render(b,l);a.setRenderTarget(n,m,p);a.xr.enabled=v;c.texture.needsPMREMUpdate=!0}}class Re extends cc{constructor(a,b,c,d,e,f,g,k,h,l){a=void 0!==a?a:[];super(a,void 0!==b?b:301,c,d,e,f,g,k,h,l);this.isCubeTexture=!0;this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class $h extends Oc{constructor(a=1,b={}){super(a,a,b);this.isWebGLCubeRenderTarget=!0;a={width:a,height:a,depth:1};this.texture=new Re([a,a,a,a,a,a],b.mapping,
b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.colorSpace);this.texture.isRenderTargetTexture=!0;this.texture.generateMipmaps=void 0!==b.generateMipmaps?b.generateMipmaps:!1;this.texture.minFilter=void 0!==b.minFilter?b.minFilter:1006}fromEquirectangularTexture(a,b){this.texture.type=b.type;this.texture.colorSpace=b.colorSpace;this.texture.generateMipmaps=b.generateMipmaps;this.texture.minFilter=b.minFilter;this.texture.magFilter=b.magFilter;var c=new ae(5,5,5),d=new Mc({name:"CubemapFromEquirect",
uniforms:Aa({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include \x3cbegin_vertex\x3e\n\t\t\t\t\t#include \x3cproject_vertex\x3e\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include \x3ccommon\x3e\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction \x3d normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV \x3d equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",
side:1,blending:0});d.uniforms.tEquirect.value=b;c=new dc(c,d);d=b.minFilter;1008===b.minFilter&&(b.minFilter=1006);(new bj(1,10,this)).update(a,c);b.minFilter=d;c.geometry.dispose();c.material.dispose();return this}clear(a,b,c,d){const e=a.getRenderTarget();for(let f=0;6>f;f++)a.setRenderTarget(this,f),a.clear(b,c,d);a.setRenderTarget(e)}}const Tg=new I,lm=new I,mm=new ob;class od{constructor(a=new I(1,0,0),b=0){this.isPlane=!0;this.normal=a;this.constant=b}set(a,b){this.normal.copy(a);this.constant=
b;return this}setComponents(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this}setFromNormalAndCoplanarPoint(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this}setFromCoplanarPoints(a,b,c){b=Tg.subVectors(c,b).cross(lm.subVectors(a,b)).normalize();this.setFromNormalAndCoplanarPoint(b,a);return this}copy(a){this.normal.copy(a.normal);this.constant=a.constant;return this}normalize(){const a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this}negate(){this.constant*=
-1;this.normal.negate();return this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,b){return b.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,b){const c=a.delta(Tg);var d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?b.copy(a.start):null;d=-(a.start.dot(this.normal)+this.constant)/d;return 0>d||1<d?null:b.copy(a.start).addScaledVector(c,d)}intersectsLine(a){const b=
this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,b){b=b||mm.getNormalMatrix(a);a=this.coplanarPoint(Tg).applyMatrix4(a);b=this.normal.applyMatrix3(b).normalize();this.constant=-a.dot(b);return this}translate(a){this.constant-=a.dot(this.normal);return this}equals(a){return a.normal.equals(this.normal)&&
a.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Od=new qc,Gf=new I;class Ee{constructor(a=new od,b=new od,c=new od,d=new od,e=new od,f=new od){this.planes=[a,b,c,d,e,f]}set(a,b,c,d,e,f){const g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this}copy(a){const b=this.planes;for(let c=0;6>c;c++)b[c].copy(a.planes[c]);return this}setFromProjectionMatrix(a,b=2E3){const c=this.planes;var d=a.elements;a=d[0];const e=d[1],
f=d[2],g=d[3],k=d[4],h=d[5],l=d[6],n=d[7],m=d[8],p=d[9],v=d[10],t=d[11],x=d[12],C=d[13],u=d[14];d=d[15];c[0].setComponents(g-a,n-k,t-m,d-x).normalize();c[1].setComponents(g+a,n+k,t+m,d+x).normalize();c[2].setComponents(g+e,n+h,t+p,d+C).normalize();c[3].setComponents(g-e,n-h,t-p,d-C).normalize();c[4].setComponents(g-f,n-l,t-v,d-u).normalize();if(2E3===b)c[5].setComponents(g+f,n+l,t+v,d+u).normalize();else if(2001===b)c[5].setComponents(f,l,v,u).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+
b);return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),Od.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const b=a.geometry;null===b.boundingSphere&&b.computeBoundingSphere();Od.copy(b.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(Od)}intersectsSprite(a){Od.center.set(0,0,0);Od.radius=.7071067811865476;Od.applyMatrix4(a.matrixWorld);return this.intersectsSphere(Od)}intersectsSphere(a){const b=this.planes,
c=a.center;a=-a.radius;for(let d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0}intersectsBox(a){const b=this.planes;for(let c=0;6>c;c++){const d=b[c];Gf.x=0<d.normal.x?a.max.x:a.min.x;Gf.y=0<d.normal.y?a.max.y:a.min.y;Gf.z=0<d.normal.z?a.max.z:a.min.z;if(0>d.distanceToPoint(Gf))return!1}return!0}containsPoint(a){const b=this.planes;for(let c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}clone(){return(new this.constructor).copy(this)}}class De extends tb{constructor(a=1,b=1,
c=1,d=1){super();this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=a/2,f=b/2;c=Math.floor(c);d=Math.floor(d);const g=c+1;var k=d+1,h=a/c,l=b/d;b=[];a=[];const n=[],m=[];for(let p=0;p<k;p++){const v=p*l-f;for(let t=0;t<g;t++)a.push(t*h-e,-v,0),n.push(0,0,1),m.push(t/c),m.push(1-p/d)}for(e=0;e<d;e++)for(f=0;f<c;f++)k=f+g*(e+1),h=f+1+g*(e+1),l=f+1+g*e,b.push(f+g*e,k,l),b.push(k,h,l);this.setIndex(b);this.setAttribute("position",new eb(a,3));this.setAttribute("normal",
new eb(n,3));this.setAttribute("uv",new eb(m,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new De(a.width,a.height,a.widthSegments,a.heightSegments)}}const pb={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a \x3c getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE \x3d 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv \x3d max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale \x3d 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales \x3d vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha \x3d vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor \x3d fract( log2( pixScale ) );\n\t\tfloat x \x3d ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a \x3d min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases \x3d vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold \x3d ( x \x3c ( 1.0 - a ) )\n\t\t\t? ( ( x \x3c a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",
alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a \x3d smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a \x3c alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",
aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion \x3d ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *\x3d ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD )\n\t\tfloat dotNV \x3d saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *\x3d computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size \x3d textureSize( batchingTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",
batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix \x3d getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed \x3d vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition \x3d vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal \x3d vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent \x3d vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G \x3d G_BlinnPhong_Implicit( );\n\tfloat D \x3d D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",
iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 \x3d mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 \x3d sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase \x3d 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val \x3d vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos \x3d vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var \x3d vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz \x3d val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x +\x3d 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /\x3d 1.0685e-7;\n\t\tvec3 rgb \x3d XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR \x3d mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq \x3d pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq \x3d 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq \x3c 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 \x3d sqrt( cosTheta2Sq );\n\t\tfloat R0 \x3d IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 \x3d F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 \x3d 1.0 - R12;\n\t\tfloat phi12 \x3d 0.0;\n\t\tif ( iridescenceIOR \x3c outsideIOR ) phi12 \x3d PI;\n\t\tfloat phi21 \x3d PI - phi12;\n\t\tvec3 baseIOR \x3d Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 \x3d IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 \x3d F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 \x3d vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] \x3c iridescenceIOR ) phi23[ 0 ] \x3d PI;\n\t\tif ( baseIOR[ 1 ] \x3c iridescenceIOR ) phi23[ 1 ] \x3d PI;\n\t\tif ( baseIOR[ 2 ] \x3c iridescenceIOR ) phi23[ 2 ] \x3d PI;\n\t\tfloat OPD \x3d 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi \x3d vec3( phi21 ) + phi23;\n\t\tvec3 R123 \x3d clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 \x3d sqrt( R123 );\n\t\tvec3 Rs \x3d pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 \x3d R12 + Rs;\n\t\tI \x3d C0;\n\t\tvec3 Cm \x3d Rs - T121;\n\t\tfor ( int m \x3d 1; m \x3c\x3d 2; ++ m ) {\n\t\t\tCm *\x3d r123;\n\t\t\tvec3 Sm \x3d 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI +\x3d Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx \x3d dFdx( vBumpMapUv );\n\t\tvec2 dSTdy \x3d dFdy( vBumpMapUv );\n\t\tfloat Hll \x3d bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX \x3d normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY \x3d normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN \x3d surf_norm;\n\t\tvec3 R1 \x3d cross( vSigmaY, vN );\n\t\tvec3 R2 \x3d cross( vN, vSigmaX );\n\t\tfloat fDet \x3d dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad \x3d sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity \x3d 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *\x3d smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity \x3d\x3d 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity \x3d 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *\x3d 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *\x3d 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *\x3d clipOpacity;\n\t\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tbool clipped \x3d true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tclipped \x3d ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) \x26\x26 clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvClipPosition \x3d - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *\x3d vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *\x3d vColor;\n#endif",
color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor \x3d vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor \x3d vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *\x3d color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *\x3d instanceColor.xyz;\n#endif",
common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 \x3d x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a \x3d 12.9898, b \x3d 78.233, c \x3d 43758.5453;\n\thighp float dt \x3d dot( uv.xy, vec2( a,b ) ), sn \x3d mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent \x3d max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] \x3d vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] \x3d vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] \x3d vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights \x3d vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] \x3d\x3d - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u \x3d atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v \x3d asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection \x3d abs( direction );\n\t\tfloat face \x3d - 1.0;\n\t\tif ( absDirection.x \x3e absDirection.z ) {\n\t\t\tif ( absDirection.x \x3e absDirection.y )\n\t\t\t\tface \x3d direction.x \x3e 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z \x3e absDirection.y )\n\t\t\t\tface \x3d direction.z \x3e 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face \x3d\x3d 0.0 ) {\n\t\t\tuv \x3d vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 1.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face \x3d\x3d 2.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face \x3d\x3d 3.0 ) {\n\t\t\tuv \x3d vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 4.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv \x3d vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face \x3d getFace( direction );\n\t\tfloat filterInt \x3d max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt \x3d max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize \x3d exp2( mipInt );\n\t\thighp vec2 uv \x3d getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face \x3e 2.0 ) {\n\t\t\tuv.y +\x3d faceSize;\n\t\t\tface -\x3d 3.0;\n\t\t}\n\t\tuv.x +\x3d face * faceSize;\n\t\tuv.x +\x3d filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y +\x3d 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *\x3d CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *\x3d CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip \x3d 0.0;\n\t\tif ( roughness \x3e\x3d cubeUV_r1 ) {\n\t\t\tmip \x3d ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r4 ) {\n\t\t\tmip \x3d ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r5 ) {\n\t\t\tmip \x3d ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r6 ) {\n\t\t\tmip \x3d ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip \x3d - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip \x3d clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF \x3d fract( mip );\n\t\tfloat mipInt \x3d floor( mip );\n\t\tvec3 color0 \x3d bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF \x3d\x3d 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 \x3d bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal \x3d objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent \x3d objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm \x3d mat3( batchingMatrix );\n\ttransformedNormal /\x3d vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal \x3d bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im \x3d mat3( instanceMatrix );\n\ttransformedNormal /\x3d vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal \x3d im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal \x3d normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal \x3d - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent \x3d ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent \x3d - transformedTangent;\n\t#endif\n#endif",
displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed +\x3d normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor \x3d texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *\x3d emissiveColor.rgb;\n#endif",
emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor \x3d linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 \x3d mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB \x3d mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag \x3d normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec \x3d reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec \x3d refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec \x3d vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor \x3d textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor \x3d vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight \x3d mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight \x3d mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight +\x3d envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec \x3d reflect( - viewDir, normal );\n\t\t\treflectVec \x3d normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec \x3d inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal \x3d cross( bitangent, viewDir );\n\t\t\t\tbentNormal \x3d normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal \x3d normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition \x3d worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex \x3d normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect \x3d reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect \x3d refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tvFogDepth \x3d - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor \x3d 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor \x3d smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb \x3d mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL \x3d dot( normal, lightDirection );\n\tvec2 coord \x3d vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw \x3d fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance \x3d lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse +\x3d lightMapIrradiance;\n#endif",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularStrength \x3d specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",
lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x \x3d normal.x, y \x3d normal.y, z \x3d normal.z;\n\tvec3 result \x3d shCoefficients[ 0 ] * 0.886227;\n\tresult +\x3d shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult +\x3d shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult +\x3d shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult +\x3d shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult +\x3d shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult +\x3d shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult +\x3d shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult +\x3d shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance \x3d shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance \x3d ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance \x3e 0.0 \x26\x26 decayExponent \x3e 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff \x3d 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance \x3e 0.0 ) {\n\t\t\tdistanceFalloff *\x3d pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS \x3e 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color \x3d directionalLight.color;\n\t\tlight.direction \x3d directionalLight.direction;\n\t\tlight.visible \x3d true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS \x3e 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d pointLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat lightDistance \x3d length( lVector );\n\t\tlight.color \x3d pointLight.color;\n\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS \x3e 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d spotLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat angleCos \x3d dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation \x3d getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation \x3e 0.0 ) {\n\t\t\tfloat lightDistance \x3d length( lVector );\n\t\t\tlight.color \x3d spotLight.color * spotAttenuation;\n\t\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color \x3d vec3( 0.0 );\n\t\t\tlight.visible \x3d false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS \x3e 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL \x3d dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight \x3d 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance \x3d mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",
lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance \x3d getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularColor \x3d specular;\nmaterial.specularShininess \x3d shininess;\nmaterial.specularStrength \x3d specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy \x3d max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness \x3d max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness \x3d max( roughnessFactor, 0.0525 );material.roughness +\x3d geometryRoughness;\nmaterial.roughness \x3d min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior \x3d ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor \x3d specularIntensity;\n\t\tvec3 specularColorFactor \x3d specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *\x3d texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *\x3d texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 \x3d mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor \x3d 1.0;\n\t\tvec3 specularColorFactor \x3d vec3( 1.0 );\n\t\tmaterial.specularF90 \x3d 1.0;\n\t#endif\n\tmaterial.specularColor \x3d mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor \x3d mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 \x3d 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat \x3d clearcoat;\n\tmaterial.clearcoatRoughness \x3d clearcoatRoughness;\n\tmaterial.clearcoatF0 \x3d vec3( 0.04 );\n\tmaterial.clearcoatF90 \x3d 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *\x3d texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *\x3d texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat \x3d saturate( material.clearcoat );\tmaterial.clearcoatRoughness \x3d max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness +\x3d geometryRoughness;\n\tmaterial.clearcoatRoughness \x3d min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence \x3d iridescence;\n\tmaterial.iridescenceIOR \x3d iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *\x3d texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness \x3d (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness \x3d iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor \x3d sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *\x3d texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness \x3d clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *\x3d texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat \x3d mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar \x3d texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV \x3d anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV \x3d anisotropyVector;\n\t#endif\n\tmaterial.anisotropy \x3d length( anisotropyV );\n\tif( material.anisotropy \x3d\x3d 0.0 ) {\n\t\tanisotropyV \x3d vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /\x3d material.anisotropy;\n\t\tmaterial.anisotropy \x3d saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT \x3d mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT \x3d tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB \x3d tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect \x3d vec3( 0.0 );\nvec3 clearcoatSpecularIndirect \x3d vec3( 0.0 );\nvec3 sheenSpecularDirect \x3d vec3( 0.0 );\nvec3 sheenSpecularIndirect \x3d vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x \x3d clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 \x3d x * x;\n    float x5 \x3d clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat gv \x3d dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl \x3d dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat denom \x3d pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv \x3d dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl \x3d dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v \x3d 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 \x3d alphaT * alphaB;\n\t\thighp vec3 v \x3d vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 \x3d dot( v, v );\n\t\tfloat w2 \x3d a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 \x3d material.clearcoatF0;\n\t\tfloat f90 \x3d material.clearcoatF90;\n\t\tfloat roughness \x3d material.clearcoatRoughness;\n\t\tfloat alpha \x3d pow2( roughness );\n\t\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\t\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 \x3d material.specularColor;\n\tfloat f90 \x3d material.specularF90;\n\tfloat roughness \x3d material.roughness;\n\tfloat alpha \x3d pow2( roughness );\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF \x3d mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL \x3d dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV \x3d dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH \x3d dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL \x3d dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV \x3d dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH \x3d dot( material.anisotropyB, halfDir );\n\t\tfloat V \x3d V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D \x3d D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE \x3d 64.0;\n\tconst float LUT_SCALE \x3d ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS \x3d 0.5 / LUT_SIZE;\n\tfloat dotNV \x3d saturate( dot( N, V ) );\n\tvec2 uv \x3d vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv \x3d uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l \x3d length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x \x3d dot( v1, v2 );\n\tfloat y \x3d abs( x );\n\tfloat a \x3d 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b \x3d 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v \x3d a / b;\n\tfloat theta_sintheta \x3d ( x \x3e 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 \x3d rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 \x3d rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal \x3d cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) \x3c 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 \x3d normalize( V - N * dot( V, N ) );\n\tT2 \x3d - cross( N, T1 );\n\tmat3 mat \x3d mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] \x3d mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] \x3d mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] \x3d mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] \x3d mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] \x3d normalize( coords[ 0 ] );\n\tcoords[ 1 ] \x3d normalize( coords[ 1 ] );\n\tcoords[ 2 ] \x3d normalize( coords[ 2 ] );\n\tcoords[ 3 ] \x3d normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor \x3d vec3( 0.0 );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result \x3d LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha \x3d pow2( roughness );\n\tfloat invAlpha \x3d 1.0 / alpha;\n\tfloat cos2h \x3d dotNH * dotNH;\n\tfloat sin2h \x3d max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat D \x3d D_Charlie( sheenRoughness, dotNH );\n\tfloat V \x3d V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat r2 \x3d roughness * roughness;\n\tfloat a \x3d roughness \x3c 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b \x3d roughness \x3c 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG \x3d exp( a * dotNV + b ) + ( roughness \x3c 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 \x3d vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 \x3d vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r \x3d roughness * c0 + c1;\n\tfloat a004 \x3d min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab \x3d vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr \x3d mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr \x3d specularColor;\n\t#endif\n\tvec3 FssEss \x3d Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess \x3d fab.x + fab.y;\n\tfloat Ems \x3d 1.0 - Ess;\n\tvec3 Favg \x3d Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms \x3d FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter +\x3d FssEss;\n\tmultiScatter +\x3d Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal \x3d geometryNormal;\n\t\tvec3 viewDir \x3d geometryViewDir;\n\t\tvec3 position \x3d geometryPosition;\n\t\tvec3 lightPos \x3d rectAreaLight.position;\n\t\tvec3 halfWidth \x3d rectAreaLight.halfWidth;\n\t\tvec3 halfHeight \x3d rectAreaLight.halfHeight;\n\t\tvec3 lightColor \x3d rectAreaLight.color;\n\t\tfloat roughness \x3d material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] \x3d lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] \x3d lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] \x3d lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] \x3d lightPos + halfWidth + halfHeight;\n\t\tvec2 uv \x3d LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 \x3d texture2D( ltc_1, uv );\n\t\tvec4 t2 \x3d texture2D( ltc_2, uv );\n\t\tmat3 mInv \x3d mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel \x3d ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular +\x3d lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse +\x3d lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc \x3d saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance \x3d dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect +\x3d ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect +\x3d irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect +\x3d clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect +\x3d irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering \x3d vec3( 0.0 );\n\tvec3 multiScattering \x3d vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance \x3d irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering \x3d singleScattering + multiScattering;\n\tvec3 diffuse \x3d material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular +\x3d radiance * singleScattering;\n\treflectedLight.indirectSpecular +\x3d multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse +\x3d diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nvec3 geometryPosition \x3d - vViewPosition;\nvec3 geometryNormal \x3d normal;\nvec3 geometryViewDir \x3d ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal \x3d vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal \x3d clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi \x3d saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness \x3d\x3d 0.0 ) {\n\t\tmaterial.iridescence \x3d 0.0;\n\t} else {\n\t\tmaterial.iridescence \x3d saturate( material.iridescence );\n\t}\n\tif ( material.iridescence \x3e 0.0 ) {\n\t\tmaterial.iridescenceFresnel \x3d evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 \x3d Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight \x3d pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow \x3d pointLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight \x3d spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX \x3c NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord \x3d vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap \x3d all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor \x3d texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color \x3d inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow \x3d spotLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow \x3d directionalLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight \x3d rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance \x3d vec3( 0.0 );\n\tvec3 irradiance \x3d getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance +\x3d getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS \x3e 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance \x3d vec3( 0.0 );\n\tvec3 clearcoatRadiance \x3d vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance \x3d lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance +\x3d lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD ) \x26\x26 defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance +\x3d getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) \x26\x26 defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance +\x3d getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance +\x3d getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance +\x3d getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) \x26\x26 defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT \x3d vIsPerspective \x3d\x3d 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) \x26\x26 defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth \x3d 1.0 + gl_Position.w;\n\t\tvIsPerspective \x3d float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z \x3d log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *\x3d gl_Position.w;\n\t\t}\n\t#endif\n#endif",
map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor \x3d texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor \x3d vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *\x3d sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",
map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv \x3d vUv;\n\t#else\n\t\tvec2 uv \x3d ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *\x3d texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
metalnessmap_fragment:"float metalnessFactor \x3d metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness \x3d texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *\x3d texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence \x3d texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] \x3d  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",
morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) \x26\x26 defined( MORPHTARGETS_TEXTURE )\n\tvColor *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",
morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *\x3d morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) objectNormal +\x3d getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal +\x3d morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal +\x3d morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal +\x3d morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal +\x3d morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex \x3d vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y \x3d texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x \x3d texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV \x3d ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *\x3d morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) transformed +\x3d getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed +\x3d morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed +\x3d morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed +\x3d morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed +\x3d morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed +\x3d morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed +\x3d morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed +\x3d morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed +\x3d morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",
normal_fragment_begin:"float faceDirection \x3d gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx \x3d dFdx( vViewPosition );\n\tvec3 fdy \x3d dFdy( vViewPosition );\n\tvec3 normal \x3d normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal \x3d normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *\x3d faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn \x3d getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn[0] *\x3d faceDirection;\n\t\ttbn[1] *\x3d faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 \x3d getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn2[0] *\x3d faceDirection;\n\t\ttbn2[1] *\x3d faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal \x3d normal;",
normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal \x3d - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal \x3d normal * faceDirection;\n\t#endif\n\tnormal \x3d normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *\x3d normalScale;\n\tnormal \x3d normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal \x3d perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",
normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal \x3d normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent \x3d normalize( transformedTangent );\n\t\tvBitangent \x3d normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) \x26\x26 ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 \x3d dFdx( eye_pos.xyz );\n\t\tvec3 q1 \x3d dFdy( eye_pos.xyz );\n\t\tvec2 st0 \x3d dFdx( uv.st );\n\t\tvec2 st1 \x3d dFdy( uv.st );\n\t\tvec3 N \x3d surf_norm;\n\t\tvec3 q1perp \x3d cross( q1, N );\n\t\tvec3 q0perp \x3d cross( N, q0 );\n\t\tvec3 T \x3d q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B \x3d q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det \x3d max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale \x3d ( det \x3d\x3d 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",
clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal \x3d nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN \x3d texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *\x3d clearcoatNormalScale;\n\tclearcoatNormal \x3d normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",
iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a \x3d 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *\x3d material.transmissionAlpha;\n#endif\ngl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale \x3d 256. / 255.;const float UnpackDownscale \x3d 255. / 256.;\nconst vec3 PackFactors \x3d vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors \x3d UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 \x3d 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r \x3d vec4( fract( v * PackFactors ), v );\n\tr.yzw -\x3d r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r \x3d vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *\x3d gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition \x3d vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition \x3d batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition \x3d instanceMatrix * mvPosition;\n#endif\nmvPosition \x3d modelViewMatrix * mvPosition;\ngl_Position \x3d projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb \x3d dithering( gl_FragColor.rgb );\n#endif",
dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position \x3d rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB \x3d vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB \x3d mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor \x3d roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness \x3d texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *\x3d texelRoughness.g;\n#endif",
roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS \x3e 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion \x3d 1.0;\n\t\tvec2 distribution \x3d texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow \x3d step( compare , distribution.x );\n\t\tif (hard_shadow !\x3d 1.0 ) {\n\t\t\tfloat distance \x3d compare - distribution.x ;\n\t\t\tfloat variance \x3d max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability \x3d variance / (variance + distance * distance );\t\t\tsoftness_probability \x3d clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion \x3d clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow \x3d 1.0;\n\t\tshadowCoord.xyz /\x3d shadowCoord.w;\n\t\tshadowCoord.z +\x3d shadowBias;\n\t\tbool inFrustum \x3d shadowCoord.x \x3e\x3d 0.0 \x26\x26 shadowCoord.x \x3c\x3d 1.0 \x26\x26 shadowCoord.y \x3e\x3d 0.0 \x26\x26 shadowCoord.y \x3c\x3d 1.0;\n\t\tbool frustumTest \x3d inFrustum \x26\x26 shadowCoord.z \x3c\x3d 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 \x3d - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 \x3d - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 \x3d + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 \x3d + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 \x3d dx0 / 2.0;\n\t\t\tfloat dy2 \x3d dy0 / 2.0;\n\t\t\tfloat dx3 \x3d dx1 / 2.0;\n\t\t\tfloat dy3 \x3d dy1 / 2.0;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx \x3d texelSize.x;\n\t\t\tfloat dy \x3d texelSize.y;\n\t\t\tvec2 uv \x3d shadowCoord.xy;\n\t\t\tvec2 f \x3d fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -\x3d f * texelSize;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow \x3d VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow \x3d texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV \x3d abs( v );\n\t\tfloat scaleToCube \x3d 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *\x3d scaleToCube;\n\t\tv *\x3d scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar \x3d v.xy;\n\t\tfloat almostATexel \x3d 1.5 * texelSizeY;\n\t\tfloat almostOne \x3d 1.0 - almostATexel;\n\t\tif ( absV.z \x3e\x3d almostOne ) {\n\t\t\tif ( v.z \x3e 0.0 )\n\t\t\t\tplanar.x \x3d 4.0 - v.x;\n\t\t} else if ( absV.x \x3e\x3d almostOne ) {\n\t\t\tfloat signX \x3d sign( v.x );\n\t\t\tplanar.x \x3d v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y \x3e\x3d almostOne ) {\n\t\t\tfloat signY \x3d sign( v.y );\n\t\t\tplanar.x \x3d v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y \x3d v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize \x3d vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition \x3d shadowCoord.xyz;\n\t\tfloat dp \x3d ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp +\x3d shadowBias;\n\t\tvec3 bd3D \x3d normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset \x3d vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) \x26\x26 ( NUM_DIR_LIGHT_SHADOWS \x3e 0 || NUM_POINT_LIGHT_SHADOWS \x3e 0 ) ) || ( NUM_SPOT_LIGHT_COORDS \x3e 0 )\n\tvec3 shadowWorldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] \x3d directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] \x3d pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition \x3d worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) \x26\x26 UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz +\x3d shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] \x3d spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow \x3d 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight \x3d spotLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight \x3d pointLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX \x3d getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY \x3d getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ \x3d getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW \x3d getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size \x3d textureSize( boneTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex \x3d bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned \x3d vec4( 0.0 );\n\tskinned +\x3d boneMatX * skinVertex * skinWeight.x;\n\tskinned +\x3d boneMatY * skinVertex * skinWeight.y;\n\tskinned +\x3d boneMatZ * skinVertex * skinWeight.z;\n\tskinned +\x3d boneMatW * skinVertex * skinWeight.w;\n\ttransformed \x3d ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix \x3d mat4( 0.0 );\n\tskinMatrix +\x3d skinWeight.x * boneMatX;\n\tskinMatrix +\x3d skinWeight.y * boneMatY;\n\tskinMatrix +\x3d skinWeight.z * boneMatZ;\n\tskinMatrix +\x3d skinWeight.w * boneMatW;\n\tskinMatrix \x3d bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal \x3d vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent \x3d vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular \x3d texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength \x3d texelSpecular.r;\n#else\n\tspecularStrength \x3d 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb \x3d toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a \x3d v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b \x3d v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat \x3d mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat \x3d mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *\x3d toneMappingExposure / 0.6;\n\tcolor \x3d ACESInputMat * color;\n\tcolor \x3d RRTAndODTFit( color );\n\tcolor \x3d ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB \x3d mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 \x3d mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 \x3d x * x;\n\tvec3 x4 \x3d x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix \x3d mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix \x3d mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv \x3d - 12.47393;\tconst float AgxMaxEv \x3d 4.026069;\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor \x3d AgXInsetMatrix * color;\n\tcolor \x3d max( color, 1e-10 );\tcolor \x3d log2( color );\n\tcolor \x3d ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\tcolor \x3d agxDefaultContrastApprox( color );\n\tcolor \x3d AgXOutsetMatrix * color;\n\tcolor \x3d pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor \x3d LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression \x3d 0.8 - 0.04;\n\tfloat desaturation \x3d 0.15;\n\tcolor *\x3d toneMappingExposure;\n\tfloat x \x3d min(color.r, min(color.g, color.b));\n\tfloat offset \x3d x \x3c 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -\x3d offset;\n\tfloat peak \x3d max(color.r, max(color.g, color.b));\n\tif (peak \x3c startCompression) return color;\n\tfloat d \x3d 1. - startCompression;\n\tfloat newPeak \x3d 1. - d * d / (peak + d - startCompression);\n\tcolor *\x3d newPeak / peak;\n\tfloat g \x3d 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",
transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission \x3d transmission;\n\tmaterial.transmissionAlpha \x3d 1.0;\n\tmaterial.thickness \x3d thickness;\n\tmaterial.attenuationDistance \x3d attenuationDistance;\n\tmaterial.attenuationColor \x3d attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *\x3d texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *\x3d texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos \x3d vWorldPosition;\n\tvec3 v \x3d normalize( cameraPosition - pos );\n\tvec3 n \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted \x3d getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha \x3d mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse \x3d mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",
transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv \x3d uv * texelSize.zw + 0.5;\n\t\tvec2 iuv \x3d floor( uv );\n\t\tvec2 fuv \x3d fract( uv );\n\t\tfloat g0x \x3d g0( fuv.x );\n\t\tfloat g1x \x3d g1( fuv.x );\n\t\tfloat h0x \x3d h0( fuv.x );\n\t\tfloat h1x \x3d h1( fuv.x );\n\t\tfloat h0y \x3d h0( fuv.y );\n\t\tfloat h1y \x3d h1( fuv.y );\n\t\tvec2 p0 \x3d ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 \x3d ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 \x3d ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 \x3d ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize \x3d vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize \x3d vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv \x3d 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv \x3d 1.0 / cLodSize;\n\t\tvec4 fSample \x3d bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample \x3d bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector \x3d refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x \x3d length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y \x3d length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z \x3d length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod \x3d log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient \x3d -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance \x3d exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay \x3d getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit \x3d position + transmissionRay;\n\t\tvec4 ndcPos \x3d projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords \x3d ndcPos.xy / ndcPos.w;\n\t\trefractionCoords +\x3d 1.0;\n\t\trefractionCoords /\x3d 2.0;\n\t\tvec4 transmittedLight \x3d getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance \x3d diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor \x3d transmittance * transmittedLight.rgb;\n\t\tvec3 F \x3d EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor \x3d ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",
uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv \x3d vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv \x3d ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv \x3d ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv \x3d ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv \x3d ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv \x3d ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv \x3d ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv \x3d ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv \x3d ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv \x3d ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv \x3d ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv \x3d ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv \x3d ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv \x3d ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv \x3d ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv \x3d ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv \x3d ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv \x3d ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv \x3d ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv \x3d ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv \x3d ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv \x3d ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv \x3d ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv \x3d ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",
worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvec4 worldPosition \x3d vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition \x3d batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition \x3d instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition \x3d modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position \x3d vec4( position.xy, 1.0, 1.0 );\n}",
background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor \x3d texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor \x3d vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
backgroundCube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include \x3ccube_uv_reflection_fragment\x3e\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor \x3d textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor \x3d textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
cube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor \x3d textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor \x3d texColor;\n\tgl_FragColor.a *\x3d opacity;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
depth_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvHighPrecisionZW \x3d gl_Position.zw;\n}",
depth_frag:"#if DEPTH_PACKING \x3d\x3d 3200\n\tuniform float opacity;\n#endif\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tdiffuseColor.a \x3d opacity;\n\t#endif\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\tfloat fragCoordZ \x3d 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tgl_FragColor \x3d vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING \x3d\x3d 3201\n\t\tgl_FragColor \x3d packDepthToRGBA( fragCoordZ );\n\t#endif\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvWorldPosition \x3d worldPosition.xyz;\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main () {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\tfloat dist \x3d length( vWorldPosition - referencePosition );\n\tdist \x3d ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist \x3d saturate( dist );\n\tgl_FragColor \x3d packDepthToRGBA( dist );\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvec3 direction \x3d normalize( vWorldDirection );\n\tvec2 sampleUV \x3d equirectUv( direction );\n\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\tvLineDistance \x3d scale * lineDistance;\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tif ( mod( vLineDistance, totalSize ) \x3e dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
meshbasic_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinbase_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t\t#include \x3cdefaultnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse +\x3d lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse +\x3d vec3( 1.0 );\n\t#endif\n\t#include \x3caomap_fragment\x3e\n\treflectedLight.indirectDiffuse *\x3d diffuseColor.rgb;\n\tvec3 outgoingLight \x3d reflectedLight.indirectDiffuse;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_lambert_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_lambert_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tvec3 viewDir \x3d normalize( vViewPosition );\n\tvec3 x \x3d normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y \x3d cross( viewDir, x );\n\tvec2 uv \x3d vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor \x3d texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor \x3d vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight \x3d diffuseColor.rgb * matcapColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition \x3d - mvPosition.xyz;\n#endif\n}",
meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 0.0, 0.0, 0.0, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tgl_FragColor \x3d vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a \x3d 1.0;\n\t#endif\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_phong_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_phong_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n#ifdef USE_TRANSMISSION\n\tvWorldPosition \x3d worldPosition.xyz;\n#endif\n}",
meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3ciridescence_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_physical_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_physical_pars_fragment\x3e\n#include \x3ctransmission_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cclearcoat_pars_fragment\x3e\n#include \x3ciridescence_pars_fragment\x3e\n#include \x3croughnessmap_pars_fragment\x3e\n#include \x3cmetalnessmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3croughnessmap_fragment\x3e\n\t#include \x3cmetalnessmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cclearcoat_normal_fragment_begin\x3e\n\t#include \x3cclearcoat_normal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_physical_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 totalDiffuse \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular \x3d reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include \x3ctransmission_fragment\x3e\n\tvec3 outgoingLight \x3d totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp \x3d 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight \x3d outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc \x3d saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc \x3d F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight \x3d outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cgradientmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_toon_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_toon_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_PointSize \x3d size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *\x3d ( scale / - mvPosition.z );\n\t#endif\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cmap_particle_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_particle_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
shadow_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\nvoid main() {\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cshadowmask_pars_fragment\x3e\nvoid main() {\n\t#include \x3clogdepthbuf_fragment\x3e\n\tgl_FragColor \x3d vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\tvec4 mvPosition \x3d modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x \x3d length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y \x3d length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *\x3d - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition \x3d ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x \x3d cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y \x3d sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy +\x3d rotatedPosition;\n\tgl_Position \x3d projectionMatrix * mvPosition;\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}"},
Ra={common:{diffuse:{value:new Ya(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ob},alphaMap:{value:null},alphaMapTransform:{value:new ob},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ob}},envmap:{envMap:{value:null},envMapRotation:{value:new ob},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ob}},lightmap:{lightMap:{value:null},
lightMapIntensity:{value:1},lightMapTransform:{value:new ob}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ob},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ob},normalScale:{value:new xa(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ob},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ob}},metalnessmap:{metalnessMap:{value:null},
metalnessMapTransform:{value:new ob}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ob}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new Ya(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},
directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},
shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ya(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ob},alphaTest:{value:0},uvTransform:{value:new ob}},
sprite:{diffuse:{value:new Ya(16777215)},opacity:{value:1},center:{value:new xa(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ob},alphaMap:{value:null},alphaMapTransform:{value:new ob},alphaTest:{value:0}}},Nc={basic:{uniforms:Ca([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.fog]),vertexShader:pb.meshbasic_vert,fragmentShader:pb.meshbasic_frag},lambert:{uniforms:Ca([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,
Ra.fog,Ra.lights,{emissive:{value:new Ya(0)}}]),vertexShader:pb.meshlambert_vert,fragmentShader:pb.meshlambert_frag},phong:{uniforms:Ca([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.fog,Ra.lights,{emissive:{value:new Ya(0)},specular:{value:new Ya(1118481)},shininess:{value:30}}]),vertexShader:pb.meshphong_vert,fragmentShader:pb.meshphong_frag},standard:{uniforms:Ca([Ra.common,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,
Ra.normalmap,Ra.displacementmap,Ra.roughnessmap,Ra.metalnessmap,Ra.fog,Ra.lights,{emissive:{value:new Ya(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pb.meshphysical_vert,fragmentShader:pb.meshphysical_frag},toon:{uniforms:Ca([Ra.common,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.gradientmap,Ra.fog,Ra.lights,{emissive:{value:new Ya(0)}}]),vertexShader:pb.meshtoon_vert,fragmentShader:pb.meshtoon_frag},matcap:{uniforms:Ca([Ra.common,
Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.fog,{matcap:{value:null}}]),vertexShader:pb.meshmatcap_vert,fragmentShader:pb.meshmatcap_frag},points:{uniforms:Ca([Ra.points,Ra.fog]),vertexShader:pb.points_vert,fragmentShader:pb.points_frag},dashed:{uniforms:Ca([Ra.common,Ra.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pb.linedashed_vert,fragmentShader:pb.linedashed_frag},depth:{uniforms:Ca([Ra.common,Ra.displacementmap]),vertexShader:pb.depth_vert,fragmentShader:pb.depth_frag},
normal:{uniforms:Ca([Ra.common,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,{opacity:{value:1}}]),vertexShader:pb.meshnormal_vert,fragmentShader:pb.meshnormal_frag},sprite:{uniforms:Ca([Ra.sprite,Ra.fog]),vertexShader:pb.sprite_vert,fragmentShader:pb.sprite_frag},background:{uniforms:{uvTransform:{value:new ob},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:pb.background_vert,fragmentShader:pb.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},
backgroundIntensity:{value:1},backgroundRotation:{value:new ob}},vertexShader:pb.backgroundCube_vert,fragmentShader:pb.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:pb.cube_vert,fragmentShader:pb.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pb.equirect_vert,fragmentShader:pb.equirect_frag},distanceRGBA:{uniforms:Ca([Ra.common,Ra.displacementmap,{referencePosition:{value:new I},nearDistance:{value:1},farDistance:{value:1E3}}]),
vertexShader:pb.distanceRGBA_vert,fragmentShader:pb.distanceRGBA_frag},shadow:{uniforms:Ca([Ra.lights,Ra.fog,{color:{value:new Ya(0)},opacity:{value:1}}]),vertexShader:pb.shadow_vert,fragmentShader:pb.shadow_frag}};Nc.physical={uniforms:Ca([Nc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ob},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ob},clearcoatNormalScale:{value:new xa(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},
clearcoatRoughnessMapTransform:{value:new ob},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ob},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ob},sheen:{value:0},sheenColor:{value:new Ya(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ob},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ob},
transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ob},transmissionSamplerSize:{value:new xa},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ob},attenuationDistance:{value:0},attenuationColor:{value:new Ya(0)},specularColor:{value:new Ya(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ob},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ob},
anisotropyVector:{value:new xa},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ob}}]),vertexShader:pb.meshphysical_vert,fragmentShader:pb.meshphysical_frag};const kf={r:0,b:0,g:0},Hc=new Kc,Ok=new lb;class Hf extends Ff{constructor(a=-1,b=1,c=1,d=-1,e=.1,f=2E3){super();this.isOrthographicCamera=!0;this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=e;this.far=f;this.updateProjectionMatrix()}copy(a,b){super.copy(a,b);this.left=
a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this}setViewOffset(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()}clearViewOffset(){null!==
this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;let e=c-a;c+=a;a=d+b;b=d-b;null!==this.view&&this.view.enabled&&(d=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom,e+=d*this.view.offsetX,c=e+d*this.view.width,a-=b*this.view.offsetY,b=a-b*this.view.height);this.projectionMatrix.makeOrthographic(e,
c,a,b,this.near,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}}const cj=[.125,.215,.35,.446,.526,.582],Ug=new Hf,dj=new Ya;let Vg=null,Wg=0,Xg=0;const Pd=(1+Math.sqrt(5))/2,se=1/Pd,
ej=[new I(1,1,1),new I(-1,1,1),new I(1,1,-1),new I(-1,1,-1),new I(0,Pd,se),new I(0,Pd,-se),new I(se,0,Pd),new I(-se,0,Pd),new I(Pd,se,0),new I(-Pd,se,0)];class lg{constructor(a){this._renderer=a;this._pingPongRenderTarget=null;this._cubeSize=this._lodMax=0;this._lodPlanes=[];this._sizeLods=[];this._sigmas=[];this._equirectMaterial=this._cubemapMaterial=this._blurMaterial=null;this._compileMaterial(this._blurMaterial)}fromScene(a,b=0,c=.1,d=100){Vg=this._renderer.getRenderTarget();Wg=this._renderer.getActiveCubeFace();
Xg=this._renderer.getActiveMipmapLevel();this._setSize(256);const e=this._allocateTargets();e.depthBuffer=!0;this._sceneToCubeUV(a,c,d,e);0<b&&this._blur(e,0,0,b);this._applyPMREM(e);this._cleanup(e);return e}fromEquirectangular(a,b=null){return this._fromTexture(a,b)}fromCubemap(a,b=null){return this._fromTexture(a,b)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=vb(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&
(this._equirectMaterial=ub(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose();null!==this._cubemapMaterial&&this._cubemapMaterial.dispose();null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a));this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose();null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(Vg,
Wg,Xg);a.scissorTest=!1;fb(a,0,0,a.width,a.height)}_fromTexture(a,b){301===a.mapping||302===a.mapping?this._setSize(0===a.image.length?16:a.image[0].width||a.image[0].image.width):this._setSize(a.image.width/4);Vg=this._renderer.getRenderTarget();Wg=this._renderer.getActiveCubeFace();Xg=this._renderer.getActiveMipmapLevel();b=b||this._allocateTargets();this._textureToCubeUV(a,b);this._applyPMREM(b);this._cleanup(b);return b}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),b=4*this._cubeSize;
var c={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:"srgb-linear",depthBuffer:!1};const d=wb(a,b,c);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==b){null!==this._pingPongRenderTarget&&this._dispose();this._pingPongRenderTarget=wb(a,b,c);({_lodMax:c}=this);var e=[],f=[];const l=[];let n=c;const m=c-4+1+cj.length;for(let p=0;p<m;p++){var g=Math.pow(2,n);f.push(g);var k=1/g;p>c-4?k=cj[p-c+4-1]:0===
p&&(k=0);l.push(k);k=1/(g-2);g=-k;k=1+k;var h=[g,g,k,g,k,k,g,g,k,k,g,k];g=new Float32Array(108);k=new Float32Array(72);const v=new Float32Array(36);for(let t=0;6>t;t++){const x=t%3*2/3-1,C=2<t?0:-1;g.set([x,C,0,x+2/3,C,0,x+2/3,C+1,0,x,C,0,x+2/3,C+1,0,x,C+1,0],18*t);k.set(h,12*t);v.set([t,t,t,t,t,t],6*t)}h=new tb;h.setAttribute("position",new Nb(g,3));h.setAttribute("uv",new Nb(k,2));h.setAttribute("faceIndex",new Nb(v,1));e.push(h);4<n&&n--}({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=
{lodPlanes:e,sizeLods:f,sigmas:l});e=new Float32Array(20);f=new I(0,1,0);this._blurMaterial=new Mc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/b,CUBEUV_MAX_MIP:`${c}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:f}},vertexShader:Zb(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include \x3ccube_uv_reflection_fragment\x3e\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta \x3d cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection \x3d vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis \x3d latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis \x3d vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis \x3d normalize( axis );\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb +\x3d weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i \x3d 1; i \x3c n; i++ ) {\n\n\t\t\t\t\tif ( i \x3e\x3d samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta \x3d dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}return d}_compileMaterial(a){a=new dc(this._lodPlanes[0],a);this._renderer.compile(a,Ug)}_sceneToCubeUV(a,b,c,d){b=new lc(90,1,b,c);c=[1,-1,1,1,1,1];const e=[1,1,1,-1,-1,-1],f=this._renderer,g=f.autoClear,k=f.toneMapping;f.getClearColor(dj);f.toneMapping=0;f.autoClear=!1;var h=new vd({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});const l=new dc(new ae,h);let n=!1;const m=a.background;m?m.isColor&&(h.color.copy(m),a.background=null,n=!0):(h.color.copy(dj),
n=!0);for(h=0;6>h;h++){const p=h%3;0===p?(b.up.set(0,c[h],0),b.lookAt(e[h],0,0)):1===p?(b.up.set(0,0,c[h]),b.lookAt(0,e[h],0)):(b.up.set(0,c[h],0),b.lookAt(0,0,e[h]));const v=this._cubeSize;fb(d,p*v,2<h?v:0,v,v);f.setRenderTarget(d);n&&f.render(l,b);f.render(a,b)}l.geometry.dispose();l.material.dispose();f.toneMapping=k;f.autoClear=g;a.background=m}_textureToCubeUV(a,b){const c=this._renderer;var d=301===a.mapping||302===a.mapping;d?(null===this._cubemapMaterial&&(this._cubemapMaterial=vb()),this._cubemapMaterial.uniforms.flipEnvMap.value=
!1===a.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ub());const e=d?this._cubemapMaterial:this._equirectMaterial;d=new dc(this._lodPlanes[0],e);e.uniforms.envMap.value=a;a=this._cubeSize;fb(b,0,0,3*a,2*a);c.setRenderTarget(b);c.render(d,Ug)}_applyPMREM(a){const b=this._renderer,c=b.autoClear;b.autoClear=!1;for(let d=1;d<this._lodPlanes.length;d++)this._blur(a,d-1,d,Math.sqrt(this._sigmas[d]*this._sigmas[d]-this._sigmas[d-1]*this._sigmas[d-1]),ej[(d-1)%ej.length]);
b.autoClear=c}_blur(a,b,c,d,e){const f=this._pingPongRenderTarget;this._halfBlur(a,f,b,c,d,"latitudinal",e);this._halfBlur(f,a,c,c,d,"longitudinal",e)}_halfBlur(a,b,c,d,e,f,g){const k=this._renderer;var h=this._blurMaterial;"latitudinal"!==f&&"longitudinal"!==f&&console.error("blur direction must be either latitudinal or longitudinal!");const l=new dc(this._lodPlanes[d],h);h=h.uniforms;var n=this._sizeLods[c]-1;n=isFinite(e)?Math.PI/(2*n):2*Math.PI/39;var m=e/n;const p=isFinite(e)?1+Math.floor(3*
m):20;20<p&&console.warn(`sigmaRadians, ${e}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${20}`);e=[];let v=0;for(let x=0;20>x;++x){var t=x/m;t=Math.exp(-t*t/2);e.push(t);0===x?v+=t:x<p&&(v+=2*t)}for(m=0;m<e.length;m++)e[m]/=v;h.envMap.value=a.texture;h.samples.value=p;h.weights.value=e;h.latitudinal.value="latitudinal"===f;g&&(h.poleAxis.value=g);({_lodMax:a}=this);h.dTheta.value=n;h.mipInt.value=a-c;c=this._sizeLods[d];fb(b,3*c*(d>a-4?d-a+4:0),4*(this._cubeSize-
c),3*c,2*c);k.setRenderTarget(b);k.render(l,Ug)}}class Yg extends cc{constructor(a,b,c,d,e,f,g,k,h,l){l=void 0!==l?l:1026;if(1026!==l&&1027!==l)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&1026===l&&(c=1014);void 0===c&&1027===l&&(c=1020);super(null,d,e,f,g,k,l,c,h);this.isDepthTexture=!0;this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==k?k:1003;this.generateMipmaps=this.flipY=!1;this.compareFunction=
null}copy(a){super.copy(a);this.compareFunction=a.compareFunction;return this}toJSON(a){a=super.toJSON(a);null!==this.compareFunction&&(a.compareFunction=this.compareFunction);return a}}const gi=new cc,fi=new Yg(1,1);fi.compareFunction=515;const ji=new lf,hi=new Fg,ii=new Re,ai=[],bi=[],ei=new Float32Array(16),di=new Float32Array(9),ci=new Float32Array(4);class nm{constructor(a,b,c){this.id=a;this.addr=c;this.cache=[];this.type=b.type;this.setValue=qg(b.type)}}class om{constructor(a,b,c){this.id=
a;this.addr=c;this.cache=[];this.type=b.type;this.size=b.size;this.setValue=gl(b.type)}}class pm{constructor(a){this.id=a;this.seq=[];this.map={}}setValue(a,b,c){const d=this.seq;for(let e=0,f=d.length;e!==f;++e){const g=d[e];g.setValue(a,b[g.id],c)}}}const Zg=/(\w+)(\])?(\[|\.)?/g;class mf{constructor(a,b){this.seq=[];this.map={};const c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(let l=0;l<c;++l){var d=a.getActiveUniform(b,l),e=a.getUniformLocation(b,d.name),f=this,g=d.name;const n=g.length;
for(Zg.lastIndex=0;;){const m=Zg.exec(g),p=Zg.lastIndex;var k=m[1],h=m[3];"]"===m[2]&&(k|=0);if(void 0===h||"["===h&&p+2===n){g=f;d=void 0===h?new nm(k,d,e):new om(k,d,e);g.seq.push(d);g.map[d.id]=d;break}else h=f.map[k],void 0===h&&(h=new pm(k),k=f,f=h,k.seq.push(f),k.map[f.id]=f),f=h}}}setValue(a,b,c,d){b=this.map[b];void 0!==b&&b.setValue(a,c,d)}setOptional(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)}static upload(a,b,c,d){for(let e=0,f=b.length;e!==f;++e){const g=b[e],k=c[g.id];!1!==k.needsUpdate&&
g.setValue(a,k.value,d)}}static seqWithValue(a,b){const c=[];for(let d=0,e=a.length;d!==e;++d){const f=a[d];f.id in b&&c.push(f)}return c}}let rl=0;const tg=/^[ \t]*#include +<([\w\d./]+)>/gm,kl=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]),qi=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;let qm=0;class tl{constructor(){this.shaderCache=
new Map;this.materialCache=new Map}update(a){var b=a.fragmentShader;const c=this._getShaderStage(a.vertexShader);b=this._getShaderStage(b);a=this._getShaderCacheForMaterial(a);!1===a.has(c)&&(a.add(c),c.usedTimes++);!1===a.has(b)&&(a.add(b),b.usedTimes++);return this}remove(a){const b=this.materialCache.get(a);for(const c of b)c.usedTimes--,0===c.usedTimes&&this.shaderCache.delete(c.code);this.materialCache.delete(a);return this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear();
this.materialCache.clear()}_getShaderCacheForMaterial(a){const b=this.materialCache;let c=b.get(a);void 0===c&&(c=new Set,b.set(a,c));return c}_getShaderStage(a){const b=this.shaderCache;let c=b.get(a);void 0===c&&(c=new rm(a),b.set(a,c));return c}}class rm{constructor(a){this.id=qm++;this.code=a;this.usedTimes=0}}let Bl=0;class ug extends sc{constructor(a){super();this.isMeshDepthMaterial=!0;this.type="MeshDepthMaterial";this.depthPacking=3200;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=
1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)}copy(a){super.copy(a);this.depthPacking=a.depthPacking;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this}}class vg extends sc{constructor(a){super();this.isMeshDistanceMaterial=!0;this.type="MeshDistanceMaterial";this.displacementMap=
this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.setValues(a)}copy(a){super.copy(a);this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this}}class fj extends lc{constructor(a=[]){super();this.isArrayCamera=!0;this.cameras=a}}class te extends Gb{constructor(){super();this.isGroup=!0;this.type="Group"}}const sm={type:"move"};class $g{constructor(){this._hand=
this._grip=this._targetRay=null}getHandSpace(){null===this._hand&&(this._hand=new te,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1});return this._hand}getTargetRaySpace(){null===this._targetRay&&(this._targetRay=new te,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new I,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new I);return this._targetRay}getGripSpace(){null===
this._grip&&(this._grip=new te,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new I,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new I);return this._grip}dispatchEvent(a){null!==this._targetRay&&this._targetRay.dispatchEvent(a);null!==this._grip&&this._grip.dispatchEvent(a);null!==this._hand&&this._hand.dispatchEvent(a);return this}connect(a){if(a&&a.hand){const b=this._hand;if(b)for(const c of a.hand.values())this._getHandJoint(b,
c)}this.dispatchEvent({type:"connected",data:a});return this}disconnect(a){this.dispatchEvent({type:"disconnected",data:a});null!==this._targetRay&&(this._targetRay.visible=!1);null!==this._grip&&(this._grip.visible=!1);null!==this._hand&&(this._hand.visible=!1);return this}update(a,b,c){let d=null,e=null,f=null;const g=this._targetRay,k=this._grip,h=this._hand;if(a&&"visible-blurred"!==b.session.visibilityState){if(h&&a.hand){f=!0;for(var l of a.hand.values()){const n=b.getJointPose(l,c),m=this._getHandJoint(h,
l);null!==n&&(m.matrix.fromArray(n.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=n.radius);m.visible=null!==n}l=h.joints["index-finger-tip"].position.distanceTo(h.joints["thumb-tip"].position);h.inputState.pinching&&.025<l?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!h.inputState.pinching&&.015>=l&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,
target:this}))}else null!==k&&a.gripSpace&&(e=b.getPose(a.gripSpace,c),null!==e&&(k.matrix.fromArray(e.transform.matrix),k.matrix.decompose(k.position,k.rotation,k.scale),k.matrixWorldNeedsUpdate=!0,e.linearVelocity?(k.hasLinearVelocity=!0,k.linearVelocity.copy(e.linearVelocity)):k.hasLinearVelocity=!1,e.angularVelocity?(k.hasAngularVelocity=!0,k.angularVelocity.copy(e.angularVelocity)):k.hasAngularVelocity=!1));null!==g&&(d=b.getPose(a.targetRaySpace,c),null===d&&null!==e&&(d=e),null!==d&&(g.matrix.fromArray(d.transform.matrix),
g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,d.linearVelocity?(g.hasLinearVelocity=!0,g.linearVelocity.copy(d.linearVelocity)):g.hasLinearVelocity=!1,d.angularVelocity?(g.hasAngularVelocity=!0,g.angularVelocity.copy(d.angularVelocity)):g.hasAngularVelocity=!1,this.dispatchEvent(sm)))}null!==g&&(g.visible=null!==d);null!==k&&(k.visible=null!==e);null!==h&&(h.visible=null!==f);return this}_getHandJoint(a,b){if(void 0===a.joints[b.jointName]){const c=new te;c.matrixAutoUpdate=
!1;c.visible=!1;a.joints[b.jointName]=c;a.add(c)}return a.joints[b.jointName]}}class tm{constructor(){this.mesh=this.texture=null;this.depthFar=this.depthNear=0}init(a,b,c){if(null===this.texture){const d=new cc;a.properties.get(d).__webglTexture=b.texture;if(b.depthNear!=c.depthNear||b.depthFar!=c.depthFar)this.depthNear=b.depthNear,this.depthFar=b.depthFar;this.texture=d}}render(a,b){if(null!==this.texture){if(null===this.mesh){var c=b.cameras[0].viewport;c=new Mc({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position \x3d vec4( position, 1.0 );\n\n}",
fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord \x3d vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x \x3e\x3d 1.0 ) {\n\n\t\tgl_FragDepthEXT \x3d texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT \x3d texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:c.z},
depthHeight:{value:c.w}}});this.mesh=new dc(new De(20,20),c)}a.render(this.mesh,b)}}reset(){this.mesh=this.texture=null}}class um extends dd{constructor(a,b){function c(Ba){var Ia=W.indexOf(Ba.inputSource);-1!==Ia&&(Ia=U[Ia],void 0!==Ia&&(Ia.update(Ba.inputSource,Ba.frame,p||l),Ia.dispatchEvent({type:Ba.type,data:Ba.inputSource})))}function d(){k.removeEventListener("select",c);k.removeEventListener("selectstart",c);k.removeEventListener("selectend",c);k.removeEventListener("squeeze",c);k.removeEventListener("squeezestart",
c);k.removeEventListener("squeezeend",c);k.removeEventListener("end",d);k.removeEventListener("inputsourceschange",e);for(let Ba=0;Ba<U.length;Ba++){const Ia=W[Ba];null!==Ia&&(W[Ba]=null,U[Ba].disconnect(Ia))}ta=Ga=null;D.reset();a.setRenderTarget(J);K=k=t=x=C=null;Ha.stop();g.isPresenting=!1;a.setPixelRatio(fa);a.setSize(R.width,R.height,!1);g.dispatchEvent({type:"sessionend"})}function e(Ba){for(var Ia=0;Ia<Ba.removed.length;Ia++){var Xa=Ba.removed[Ia],z=W.indexOf(Xa);0<=z&&(W[z]=null,U[z].disconnect(Xa))}for(Ia=
0;Ia<Ba.added.length;Ia++){Xa=Ba.added[Ia];z=W.indexOf(Xa);if(-1===z){for(let A=0;A<U.length;A++)if(A>=W.length){W.push(Xa);z=A;break}else if(null===W[A]){W[A]=Xa;z=A;break}if(-1===z)break}(z=U[z])&&z.connect(Xa)}}function f(Ba,Ia){null===Ia?Ba.matrixWorld.copy(Ba.matrix):Ba.matrixWorld.multiplyMatrices(Ia.matrixWorld,Ba.matrix);Ba.matrixWorldInverse.copy(Ba.matrixWorld).invert()}super();const g=this;let k=null,h=1,l=null,n="local-floor",m=1,p=null,v=null,t=null,x=null,C=null,u=null;const D=new tm,
aa=b.getContextAttributes();let J=null,K=null;const U=[],W=[],R=new xa;let fa=null;const ea=new lc;ea.layers.enable(1);ea.viewport=new Mb;const na=new lc;na.layers.enable(2);na.viewport=new Mb;const Ea=[ea,na],ca=new fj;ca.layers.enable(1);ca.layers.enable(2);let Ga=null,ta=null;this.cameraAutoUpdate=!0;this.isPresenting=this.enabled=!1;this.getController=function(Ba){let Ia=U[Ba];void 0===Ia&&(Ia=new $g,U[Ba]=Ia);return Ia.getTargetRaySpace()};this.getControllerGrip=function(Ba){let Ia=U[Ba];void 0===
Ia&&(Ia=new $g,U[Ba]=Ia);return Ia.getGripSpace()};this.getHand=function(Ba){let Ia=U[Ba];void 0===Ia&&(Ia=new $g,U[Ba]=Ia);return Ia.getHandSpace()};this.setFramebufferScaleFactor=function(Ba){h=Ba;!0===g.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(Ba){n=Ba;!0===g.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};this.getReferenceSpace=function(){return p||
l};this.setReferenceSpace=function(Ba){p=Ba};this.getBaseLayer=function(){return null!==x?x:C};this.getBinding=function(){return t};this.getFrame=function(){return u};this.getSession=function(){return k};this.setSession=async function(Ba){k=Ba;if(null!==k){J=a.getRenderTarget();k.addEventListener("select",c);k.addEventListener("selectstart",c);k.addEventListener("selectend",c);k.addEventListener("squeeze",c);k.addEventListener("squeezestart",c);k.addEventListener("squeezeend",c);k.addEventListener("end",
d);k.addEventListener("inputsourceschange",e);!0!==aa.xrCompatible&&await b.makeXRCompatible();fa=a.getPixelRatio();a.getSize(R);if(void 0===k.renderState.layers||!1===a.capabilities.isWebGL2)C=new XRWebGLLayer(k,b,{antialias:void 0===k.renderState.layers?aa.antialias:!0,alpha:!0,depth:aa.depth,stencil:aa.stencil,framebufferScaleFactor:h}),k.updateRenderState({baseLayer:C}),a.setPixelRatio(1),a.setSize(C.framebufferWidth,C.framebufferHeight,!1),K=new Oc(C.framebufferWidth,C.framebufferHeight,{format:1023,
type:1009,colorSpace:a.outputColorSpace,stencilBuffer:aa.stencil});else{let Xa=Ba=null;var Ia=null;aa.depth&&(Ia=aa.stencil?b.DEPTH24_STENCIL8:b.DEPTH_COMPONENT24,Ba=aa.stencil?1027:1026,Xa=aa.stencil?1020:1014);Ia={colorFormat:b.RGBA8,depthFormat:Ia,scaleFactor:h};t=new XRWebGLBinding(k,b);x=t.createProjectionLayer(Ia);k.updateRenderState({layers:[x]});a.setPixelRatio(1);a.setSize(x.textureWidth,x.textureHeight,!1);K=new Oc(x.textureWidth,x.textureHeight,{format:1023,type:1009,depthTexture:new Yg(x.textureWidth,
x.textureHeight,Xa,void 0,void 0,void 0,void 0,void 0,void 0,Ba),stencilBuffer:aa.stencil,colorSpace:a.outputColorSpace,samples:aa.antialias?4:0});a.properties.get(K).__ignoreDepthValues=x.ignoreDepthValues}K.isXRRenderTarget=!0;this.setFoveation(m);p=null;l=await k.requestReferenceSpace(n);Ha.setContext(k);Ha.start();g.isPresenting=!0;g.dispatchEvent({type:"sessionstart"})}};this.getEnvironmentBlendMode=function(){if(null!==k)return k.environmentBlendMode};const Sa=new I,cb=new I;this.updateCamera=
function(Ba){if(null!==k){null!==D.texture&&(Ba.near=D.depthNear,Ba.far=D.depthFar);ca.near=na.near=ea.near=Ba.near;ca.far=na.far=ea.far=Ba.far;if(Ga!==ca.near||ta!==ca.far)k.updateRenderState({depthNear:ca.near,depthFar:ca.far}),Ga=ca.near,ta=ca.far,ea.near=Ga,ea.far=ta,na.near=Ga,na.far=ta,ea.updateProjectionMatrix(),na.updateProjectionMatrix(),Ba.updateProjectionMatrix();var Ia=Ba.parent,Xa=ca.cameras;f(ca,Ia);for(var z=0;z<Xa.length;z++)f(Xa[z],Ia);if(2===Xa.length){Sa.setFromMatrixPosition(ea.matrixWorld);
cb.setFromMatrixPosition(na.matrixWorld);Xa=Sa.distanceTo(cb);var A=ea.projectionMatrix.elements,E=na.projectionMatrix.elements,O=A[14]/(A[10]-1);z=A[14]/(A[10]+1);const Pa=(A[9]+1)/A[5],Fa=(A[9]-1)/A[5];var M=(A[8]-1)/A[0],ra=(E[8]+1)/E[0];E=O*M;A=O*ra;ra=Xa/(-M+ra);M=ra*-M;ea.matrixWorld.decompose(ca.position,ca.quaternion,ca.scale);ca.translateX(M);ca.translateZ(ra);ca.matrixWorld.compose(ca.position,ca.quaternion,ca.scale);ca.matrixWorldInverse.copy(ca.matrixWorld).invert();O+=ra;ra=z+ra;ca.projectionMatrix.makePerspective(E-
M,A+(Xa-M),Pa*z/ra*O,Fa*z/ra*O,O,ra);ca.projectionMatrixInverse.copy(ca.projectionMatrix).invert()}else ca.projectionMatrix.copy(ea.projectionMatrix);null===Ia?Ba.matrix.copy(ca.matrixWorld):(Ba.matrix.copy(Ia.matrixWorld),Ba.matrix.invert(),Ba.matrix.multiply(ca.matrixWorld));Ba.matrix.decompose(Ba.position,Ba.quaternion,Ba.scale);Ba.updateMatrixWorld(!0);Ba.projectionMatrix.copy(ca.projectionMatrix);Ba.projectionMatrixInverse.copy(ca.projectionMatrixInverse);Ba.isPerspectiveCamera&&(Ba.fov=2*ge*
Math.atan(1/Ba.projectionMatrix.elements[5]),Ba.zoom=1)}};this.getCamera=function(){return ca};this.getFoveation=function(){if(null!==x||null!==C)return m};this.setFoveation=function(Ba){m=Ba;null!==x&&(x.fixedFoveation=Ba);null!==C&&void 0!==C.fixedFoveation&&(C.fixedFoveation=Ba)};this.hasDepthSensing=function(){return null!==D.texture};let $a=null;const Ha=new La;Ha.setAnimationLoop(function(Ba,Ia){v=Ia.getViewerPose(p||l);u=Ia;if(null!==v){var Xa=v.views;null!==C&&(a.setRenderTargetFramebuffer(K,
C.framebuffer),a.setRenderTarget(K));var z=!1;Xa.length!==ca.cameras.length&&(ca.cameras.length=0,z=!0);for(var A=0;A<Xa.length;A++){const O=Xa[A];let M;if(null!==C)M=C.getViewport(O);else{var E=t.getViewSubImage(x,O);M=E.viewport;0===A&&(a.setRenderTargetTextures(K,E.colorTexture,x.ignoreDepthValues?void 0:E.depthStencilTexture),a.setRenderTarget(K))}E=Ea[A];void 0===E&&(E=new lc,E.layers.enable(A),E.viewport=new Mb,Ea[A]=E);E.matrix.fromArray(O.transform.matrix);E.matrix.decompose(E.position,E.quaternion,
E.scale);E.projectionMatrix.fromArray(O.projectionMatrix);E.projectionMatrixInverse.copy(E.projectionMatrix).invert();E.viewport.set(M.x,M.y,M.width,M.height);0===A&&(ca.matrix.copy(E.matrix),ca.matrix.decompose(ca.position,ca.quaternion,ca.scale));!0===z&&ca.cameras.push(E)}(z=k.enabledFeatures)&&z.includes("depth-sensing")&&(Xa=t.getDepthInformation(Xa[0]))&&Xa.isValid&&Xa.texture&&D.init(a,Xa,k.renderState)}for(Xa=0;Xa<U.length;Xa++)z=W[Xa],A=U[Xa],null!==z&&void 0!==A&&A.update(z,Ia,p||l);D.render(a,
ca);$a&&$a(Ba,Ia);Ia.detectedPlanes&&g.dispatchEvent({type:"planesdetected",data:Ia});u=null});this.setAnimationLoop=function(Ba){$a=Ba};this.dispose=function(){}}}const Jc=new Kc,Hl=new lb;class gj{constructor(a={}){function b(B,T){for(let ja=0;ja<B.length;ja++){const la=D.getContext(B[ja],T);if(null!==la)return la}return null}function c(){Xb=new Hb(ka);Lb=new Va(ka,Xb,a);Xb.init(Lb);Yc=new vi(ka,Xb,Lb);Db=new El(ka,Xb,Lb);Ec=new rb(ka);Eb=new ul;Pb=new Fl(ka,Xb,Db,Eb,Lb,Yc,Ec);ue=new kb(Ha);ve=
new Ob(Ha);Se=new Za(ka,Lb);Qd=new va(ka,Xb,Se,Lb);ah=new Sb(ka,Se,Ec,Qd);we=new ic(ka,ah,Se,Ec);hj=new pc(ka,Lb,Pb);Zc=new jb(Eb);jd=new sl(Ha,ue,ve,Xb,Lb,Qd,Zc);bh=new Gl(Ha,Eb);If=new wl;Jf=new Cl(Xb,Lb);$c=new Ja(Ha,ue,ve,Db,we,Ea,R);Tc=new Dl(Ha,we,Lb);Kf=new Il(ka,Ec,Lb,Db);ij=new za(ka,Xb,Ec,Lb);jj=new ec(ka,Xb,Ec,Lb);Ec.programs=jd.programs;Ha.capabilities=Lb;Ha.extensions=Xb;Ha.properties=Eb;Ha.renderLists=If;Ha.shadowMap=Tc;Ha.state=Db;Ha.info=Ec}function d(B){B.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");
Ba=!0}function e(){console.log("THREE.WebGLRenderer: Context Restored.");Ba=!1;const B=Ec.autoReset,T=Tc.enabled,ja=Tc.autoUpdate,la=Tc.needsUpdate,X=Tc.type;c();Ec.autoReset=B;Tc.enabled=T;Tc.autoUpdate=ja;Tc.needsUpdate=la;Tc.type=X}function f(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function g(B){B=B.target;B.removeEventListener("dispose",g);k(B);Eb.remove(B)}function k(B){const T=Eb.get(B).programs;void 0!==T&&(T.forEach(function(ja){jd.releaseProgram(ja)}),
B.isShaderMaterial&&jd.releaseShaderCache(B))}function h(B,T,ja){!0===B.transparent&&2===B.side&&!1===B.forceSinglePass?(B.side=1,B.needsUpdate=!0,x(B,T,ja),B.side=0,B.needsUpdate=!0,x(B,T,ja),B.side=2):x(B,T,ja)}function l(){Rd.stop()}function n(){Rd.start()}function m(B,T,ja,la){if(!1!==B.visible){if(B.layers.test(T.layers))if(B.isGroup)ja=B.renderOrder;else if(B.isLOD)!0===B.autoUpdate&&B.update(T);else if(B.isLight)Sa.pushLight(B),B.castShadow&&Sa.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||
Ib.intersectsSprite(B)){la&&Qc.setFromMatrixPosition(B.matrixWorld).applyMatrix4(wc);var X=we.update(B),bb=B.material;bb.visible&&ta.push(B,X,bb,ja,Qc.z,null)}}else if(B.isMesh||B.isLine||B.isPoints)if(!B.frustumCulled||Ib.intersectsObject(B))if(X=we.update(B),bb=B.material,la&&(void 0!==B.boundingSphere?(null===B.boundingSphere&&B.computeBoundingSphere(),Qc.copy(B.boundingSphere.center)):(null===X.boundingSphere&&X.computeBoundingSphere(),Qc.copy(X.boundingSphere.center)),Qc.applyMatrix4(B.matrixWorld).applyMatrix4(wc)),
Array.isArray(bb)){const gb=X.groups;for(let ab=0,Ab=gb.length;ab<Ab;ab++){const Qb=gb[ab],yb=bb[Qb.materialIndex];yb&&yb.visible&&ta.push(B,X,yb,ja,Qc.z,Qb)}}else bb.visible&&ta.push(B,X,bb,ja,Qc.z,null);B=B.children;for(let gb=0,ab=B.length;gb<ab;gb++)m(B[gb],T,ja,la)}}function p(B,T,ja,la){const X=B.opaque,bb=B.transmissive;B=B.transparent;Sa.setupLightsView(ja);!0===jc&&Zc.setGlobalState(Ha.clippingPlanes,ja);if(0<bb.length&&null===(!0===T.isScene?T.overrideMaterial:null)){var gb=Lb.isWebGL2;
null===Ub&&(Ub=new Oc(1,1,{generateMipmaps:!0,type:Xb.has("EXT_color_buffer_half_float")?1016:1009,minFilter:1008,samples:gb?4:0}));Ha.getDrawingBufferSize(pd);gb?Ub.setSize(pd.x,pd.y):Ub.setSize(wa(pd.x),wa(pd.y));gb=Ha.getRenderTarget();Ha.setRenderTarget(Ub);Ha.getClearColor(Pa);Fa=Ha.getClearAlpha();1>Fa&&Ha.setClearColor(16777215,.5);Ha.clear();var ab=Ha.toneMapping;Ha.toneMapping=0;v(X,T,ja);Pb.updateMultisampleRenderTarget(Ub);Pb.updateRenderTargetMipmap(Ub);var Ab=!1;for(let yb=0,mc=bb.length;yb<
mc;yb++){var Qb=bb[yb];const ad=Qb.object,Uc=Qb.geometry,Vc=Qb.material;Qb=Qb.group;2===Vc.side&&ad.layers.test(ja.layers)&&(Ab=Vc.side,Vc.side=1,Vc.needsUpdate=!0,t(ad,T,ja,Uc,Vc,Qb),Vc.side=Ab,Ab=Vc.needsUpdate=!0)}!0===Ab&&(Pb.updateMultisampleRenderTarget(Ub),Pb.updateRenderTargetMipmap(Ub));Ha.setRenderTarget(gb);Ha.setClearColor(Pa,Fa);Ha.toneMapping=ab}la&&Db.viewport(O.copy(la));0<X.length&&v(X,T,ja);0<bb.length&&v(bb,T,ja);0<B.length&&v(B,T,ja);Db.buffers.depth.setTest(!0);Db.buffers.depth.setMask(!0);
Db.buffers.color.setMask(!0);Db.setPolygonOffset(!1)}function v(B,T,ja){const la=!0===T.isScene?T.overrideMaterial:null;for(let bb=0,gb=B.length;bb<gb;bb++){var X=B[bb];const ab=X.object,Ab=X.geometry,Qb=null===la?X.material:la;X=X.group;ab.layers.test(ja.layers)&&t(ab,T,ja,Ab,Qb,X)}}function t(B,T,ja,la,X,bb){B.onBeforeRender(Ha,T,ja,la,X,bb);B.modelViewMatrix.multiplyMatrices(ja.matrixWorldInverse,B.matrixWorld);B.normalMatrix.getNormalMatrix(B.modelViewMatrix);X.onBeforeRender(Ha,T,ja,la,B,bb);
!0===X.transparent&&2===X.side&&!1===X.forceSinglePass?(X.side=1,X.needsUpdate=!0,Ha.renderBufferDirect(ja,T,la,X,B,bb),X.side=0,X.needsUpdate=!0,Ha.renderBufferDirect(ja,T,la,X,B,bb),X.side=2):Ha.renderBufferDirect(ja,T,la,X,B,bb);B.onAfterRender(Ha,T,ja,la,X,bb)}function x(B,T,ja){!0!==T.isScene&&(T=ce);const la=Eb.get(B),X=Sa.state.lights,bb=X.state.version,gb=jd.getParameters(B,X.state,Sa.state.shadowsArray,T,ja),ab=jd.getProgramCacheKey(gb);let Ab=la.programs;la.environment=B.isMeshStandardMaterial?
T.environment:null;la.fog=T.fog;la.envMap=(B.isMeshStandardMaterial?ve:ue).get(B.envMap||la.environment);la.envMapRotation=null!==la.environment&&null===B.envMap?T.environmentRotation:B.envMapRotation;void 0===Ab&&(B.addEventListener("dispose",g),Ab=new Map,la.programs=Ab);T=Ab.get(ab);if(void 0!==T){if(la.currentProgram===T&&la.lightsStateVersion===bb)return u(B,gb),T}else gb.uniforms=jd.getUniforms(B),B.onBuild(ja,gb,Ha),B.onBeforeCompile(gb,Ha),T=jd.acquireProgram(gb,ab),Ab.set(ab,T),la.uniforms=
gb.uniforms;ja=la.uniforms;if(!B.isShaderMaterial&&!B.isRawShaderMaterial||!0===B.clipping)ja.clippingPlanes=Zc.uniform;u(B,gb);la.needsLights=B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&!0===B.lights;la.lightsStateVersion=bb;la.needsLights&&(ja.ambientLightColor.value=X.state.ambient,ja.lightProbe.value=X.state.probe,ja.directionalLights.value=X.state.directional,ja.directionalLightShadows.value=X.state.directionalShadow,
ja.spotLights.value=X.state.spot,ja.spotLightShadows.value=X.state.spotShadow,ja.rectAreaLights.value=X.state.rectArea,ja.ltc_1.value=X.state.rectAreaLTC1,ja.ltc_2.value=X.state.rectAreaLTC2,ja.pointLights.value=X.state.point,ja.pointLightShadows.value=X.state.pointShadow,ja.hemisphereLights.value=X.state.hemi,ja.directionalShadowMap.value=X.state.directionalShadowMap,ja.directionalShadowMatrix.value=X.state.directionalShadowMatrix,ja.spotShadowMap.value=X.state.spotShadowMap,ja.spotLightMatrix.value=
X.state.spotLightMatrix,ja.spotLightMap.value=X.state.spotLightMap,ja.pointShadowMap.value=X.state.pointShadowMap,ja.pointShadowMatrix.value=X.state.pointShadowMatrix);la.currentProgram=T;la.uniformsList=null;return T}function C(B){if(null===B.uniformsList){const T=B.currentProgram.getUniforms();B.uniformsList=mf.seqWithValue(T.seq,B.uniforms)}return B.uniformsList}function u(B,T){B=Eb.get(B);B.outputColorSpace=T.outputColorSpace;B.batching=T.batching;B.instancing=T.instancing;B.instancingColor=T.instancingColor;
B.instancingMorph=T.instancingMorph;B.skinning=T.skinning;B.morphTargets=T.morphTargets;B.morphNormals=T.morphNormals;B.morphColors=T.morphColors;B.morphTargetsCount=T.morphTargetsCount;B.numClippingPlanes=T.numClippingPlanes;B.numIntersection=T.numClipIntersection;B.vertexAlphas=T.vertexAlphas;B.vertexTangents=T.vertexTangents;B.toneMapping=T.toneMapping}const {canvas:D=Y(),context:aa=null,depth:J=!0,stencil:K=!0,alpha:U=!1,antialias:W=!1,premultipliedAlpha:R=!0,preserveDrawingBuffer:fa=!1,powerPreference:ea=
"default",failIfMajorPerformanceCaveat:na=!1}=a;this.isWebGLRenderer=!0;let Ea;Ea=null!==aa?aa.getContextAttributes().alpha:U;const ca=new Uint32Array(4),Ga=new Int32Array(4);let ta=null,Sa=null;const cb=[],$a=[];this.domElement=D;this.debug={checkShaderErrors:!0,onShaderError:null};this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this._outputColorSpace="srgb";this._useLegacyLights=!1;this.toneMapping=
0;this.toneMappingExposure=1;const Ha=this;let Ba=!1,Ia=0,Xa=0,z=null,A=-1,E=null;const O=new Mb,M=new Mb;let ra=null;const Pa=new Ya(0);let Fa=0,oa=D.width,H=D.height,sa=1,ia=null,Ka=null;const Ta=new Mb(0,0,oa,H),mb=new Mb(0,0,oa,H);let db=!1;const Ib=new Ee;let jc=!1,Jb=!1,Ub=null;const wc=new lb,pd=new xa,Qc=new I,ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ka=aa;try{const B={alpha:!0,depth:J,stencil:K,antialias:W,premultipliedAlpha:R,preserveDrawingBuffer:fa,
powerPreference:ea,failIfMajorPerformanceCaveat:na};"setAttribute"in D&&D.setAttribute("data-engine","three.js r162");D.addEventListener("webglcontextlost",d,!1);D.addEventListener("webglcontextrestored",e,!1);D.addEventListener("webglcontextcreationerror",f,!1);if(null===ka){const T=["webgl2","webgl","experimental-webgl"];!0===Ha.isWebGL1Renderer&&T.shift();ka=b(T,B);if(null===ka){if(b(T))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");
}}"undefined"!==typeof WebGLRenderingContext&&ka instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163.");void 0===ka.getShaderPrecisionFormat&&(ka.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B;}let Xb,Lb,Db,Ec,Eb,Pb,ue,ve,Se,ah,we,jd,bh,If,Jf,Zc,Tc,$c,hj,ij,jj,Yc,Qd,Kf;c();const tc=new um(Ha,ka);this.xr=tc;this.getContext=
function(){return ka};this.getContextAttributes=function(){return ka.getContextAttributes()};this.forceContextLoss=function(){const B=Xb.get("WEBGL_lose_context");B&&B.loseContext()};this.forceContextRestore=function(){const B=Xb.get("WEBGL_lose_context");B&&B.restoreContext()};this.getPixelRatio=function(){return sa};this.setPixelRatio=function(B){void 0!==B&&(sa=B,this.setSize(oa,H,!1))};this.getSize=function(B){return B.set(oa,H)};this.setSize=function(B,T,ja=!0){tc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):
(oa=B,H=T,D.width=Math.floor(B*sa),D.height=Math.floor(T*sa),!0===ja&&(D.style.width=B+"px",D.style.height=T+"px"),this.setViewport(0,0,B,T))};this.getDrawingBufferSize=function(B){return B.set(oa*sa,H*sa).floor()};this.setDrawingBufferSize=function(B,T,ja){oa=B;H=T;sa=ja;D.width=Math.floor(B*ja);D.height=Math.floor(T*ja);this.setViewport(0,0,B,T)};this.getCurrentViewport=function(B){return B.copy(O)};this.getViewport=function(B){return B.copy(Ta)};this.setViewport=function(B,T,ja,la){B.isVector4?
Ta.set(B.x,B.y,B.z,B.w):Ta.set(B,T,ja,la);Db.viewport(O.copy(Ta).multiplyScalar(sa).round())};this.getScissor=function(B){return B.copy(mb)};this.setScissor=function(B,T,ja,la){B.isVector4?mb.set(B.x,B.y,B.z,B.w):mb.set(B,T,ja,la);Db.scissor(M.copy(mb).multiplyScalar(sa).round())};this.getScissorTest=function(){return db};this.setScissorTest=function(B){Db.setScissorTest(db=B)};this.setOpaqueSort=function(B){ia=B};this.setTransparentSort=function(B){Ka=B};this.getClearColor=function(B){return B.copy($c.getClearColor())};
this.setClearColor=function(){$c.setClearColor.apply($c,arguments)};this.getClearAlpha=function(){return $c.getClearAlpha()};this.setClearAlpha=function(){$c.setClearAlpha.apply($c,arguments)};this.clear=function(B=!0,T=!0,ja=!0){let la=0;if(B)if(B=!1,null!==z&&(B=z.texture.format,B=1033===B||1031===B||1029===B),B){B=z.texture.type;B=1009===B||1014===B||1012===B||1020===B||1017===B||1018===B;var X=$c.getClearColor();const bb=$c.getClearAlpha(),gb=X.r,ab=X.g;X=X.b;B?(ca[0]=gb,ca[1]=ab,ca[2]=X,ca[3]=
bb,ka.clearBufferuiv(ka.COLOR,0,ca)):(Ga[0]=gb,Ga[1]=ab,Ga[2]=X,Ga[3]=bb,ka.clearBufferiv(ka.COLOR,0,Ga))}else la|=ka.COLOR_BUFFER_BIT;T&&(la|=ka.DEPTH_BUFFER_BIT);ja&&(la|=ka.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295));ka.clear(la)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){D.removeEventListener("webglcontextlost",d,!1);D.removeEventListener("webglcontextrestored",
e,!1);D.removeEventListener("webglcontextcreationerror",f,!1);If.dispose();Jf.dispose();Eb.dispose();ue.dispose();ve.dispose();we.dispose();Qd.dispose();Kf.dispose();jd.dispose();tc.dispose();tc.removeEventListener("sessionstart",l);tc.removeEventListener("sessionend",n);Ub&&(Ub.dispose(),Ub=null);Rd.stop()};this.renderBufferDirect=function(B,T,ja,la,X,bb){null===T&&(T=ce);var gb=X.isMesh&&0>X.matrixWorld.determinant(),ab=T;!0!==ab.isScene&&(ab=ce);Pb.resetTextureUnits();T=ab.fog;var Ab=la.isMeshStandardMaterial?
ab.environment:null,Qb=null===z?Ha.outputColorSpace:!0===z.isXRRenderTarget?z.texture.colorSpace:"srgb-linear";Ab=(la.isMeshStandardMaterial?ve:ue).get(la.envMap||Ab);var yb=!0===la.vertexColors&&!!ja.attributes.color&&4===ja.attributes.color.itemSize,mc=!!ja.attributes.tangent&&(!!la.normalMap||0<la.anisotropy),ad=!!ja.morphAttributes.position,Uc=!!ja.morphAttributes.normal;const Vc=!!ja.morphAttributes.color;let Lf=0;!la.toneMapped||null!==z&&!0!==z.isXRRenderTarget||(Lf=Ha.toneMapping);var nb=
ja.morphAttributes.position||ja.morphAttributes.normal||ja.morphAttributes.color;const vm=void 0!==nb?nb.length:0;nb=Eb.get(la);const wm=Sa.state.lights;!0!==jc||!0!==Jb&&B===E||Zc.setState(la,B,B===E&&la.id===A);let Vb=!1;la.version===nb.__version?nb.needsLights&&nb.lightsStateVersion!==wm.state.version?Vb=!0:nb.outputColorSpace!==Qb?Vb=!0:X.isBatchedMesh&&!1===nb.batching?Vb=!0:X.isBatchedMesh||!0!==nb.batching?X.isInstancedMesh&&!1===nb.instancing?Vb=!0:X.isInstancedMesh||!0!==nb.instancing?X.isSkinnedMesh&&
!1===nb.skinning?Vb=!0:X.isSkinnedMesh||!0!==nb.skinning?X.isInstancedMesh&&!0===nb.instancingColor&&null===X.instanceColor?Vb=!0:X.isInstancedMesh&&!1===nb.instancingColor&&null!==X.instanceColor?Vb=!0:X.isInstancedMesh&&!0===nb.instancingMorph&&null===X.morphTexture?Vb=!0:X.isInstancedMesh&&!1===nb.instancingMorph&&null!==X.morphTexture?Vb=!0:nb.envMap!==Ab?Vb=!0:!0===la.fog&&nb.fog!==T?Vb=!0:void 0===nb.numClippingPlanes||nb.numClippingPlanes===Zc.numPlanes&&nb.numIntersection===Zc.numIntersection?
nb.vertexAlphas!==yb?Vb=!0:nb.vertexTangents!==mc?Vb=!0:nb.morphTargets!==ad?Vb=!0:nb.morphNormals!==Uc?Vb=!0:nb.morphColors!==Vc?Vb=!0:nb.toneMapping!==Lf?Vb=!0:!0===Lb.isWebGL2&&nb.morphTargetsCount!==vm&&(Vb=!0):Vb=!0:Vb=!0:Vb=!0:Vb=!0:(Vb=!0,nb.__version=la.version);Qb=nb.currentProgram;!0===Vb&&(Qb=x(la,ab,X));ad=mc=Uc=!1;ab=Qb.getUniforms();yb=nb.uniforms;Db.useProgram(Qb.program)&&(ad=mc=Uc=!0);la.id!==A&&(A=la.id,mc=!0);if(Uc||E!==B)ab.setValue(ka,"projectionMatrix",B.projectionMatrix),ab.setValue(ka,
"viewMatrix",B.matrixWorldInverse),Uc=ab.map.cameraPosition,void 0!==Uc&&Uc.setValue(ka,Qc.setFromMatrixPosition(B.matrixWorld)),Lb.logarithmicDepthBuffer&&ab.setValue(ka,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(la.isMeshPhongMaterial||la.isMeshToonMaterial||la.isMeshLambertMaterial||la.isMeshBasicMaterial||la.isMeshStandardMaterial||la.isShaderMaterial)&&ab.setValue(ka,"isOrthographic",!0===B.isOrthographicCamera),E!==B&&(E=B,ad=mc=!0);X.isSkinnedMesh&&(ab.setOptional(ka,X,"bindMatrix"),
ab.setOptional(ka,X,"bindMatrixInverse"),B=X.skeleton)&&(Lb.floatVertexTextures?(null===B.boneTexture&&B.computeBoneTexture(),ab.setValue(ka,"boneTexture",B.boneTexture,Pb)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."));X.isBatchedMesh&&(ab.setOptional(ka,X,"batchingTexture"),ab.setValue(ka,"batchingTexture",X._matricesTexture,Pb));B=ja.morphAttributes;(void 0!==B.position||void 0!==B.normal||
void 0!==B.color&&!0===Lb.isWebGL2)&&hj.update(X,ja,Qb);if(mc||nb.receiveShadow!==X.receiveShadow)nb.receiveShadow=X.receiveShadow,ab.setValue(ka,"receiveShadow",X.receiveShadow);la.isMeshGouraudMaterial&&null!==la.envMap&&(yb.envMap.value=Ab,yb.flipEnvMap.value=Ab.isCubeTexture&&!1===Ab.isRenderTargetTexture?-1:1);mc&&(ab.setValue(ka,"toneMappingExposure",Ha.toneMappingExposure),nb.needsLights&&(B=ad,yb.ambientLightColor.needsUpdate=B,yb.lightProbe.needsUpdate=B,yb.directionalLights.needsUpdate=
B,yb.directionalLightShadows.needsUpdate=B,yb.pointLights.needsUpdate=B,yb.pointLightShadows.needsUpdate=B,yb.spotLights.needsUpdate=B,yb.spotLightShadows.needsUpdate=B,yb.rectAreaLights.needsUpdate=B,yb.hemisphereLights.needsUpdate=B),T&&!0===la.fog&&bh.refreshFogUniforms(yb,T),bh.refreshMaterialUniforms(yb,la,sa,H,Ub),mf.upload(ka,C(nb),yb,Pb));la.isShaderMaterial&&!0===la.uniformsNeedUpdate&&(mf.upload(ka,C(nb),yb,Pb),la.uniformsNeedUpdate=!1);la.isSpriteMaterial&&ab.setValue(ka,"center",X.center);
ab.setValue(ka,"modelViewMatrix",X.modelViewMatrix);ab.setValue(ka,"normalMatrix",X.normalMatrix);ab.setValue(ka,"modelMatrix",X.matrixWorld);if(la.isShaderMaterial||la.isRawShaderMaterial){T=la.uniformsGroups;for(let ch=0,xm=T.length;ch<xm;ch++)Lb.isWebGL2?(B=T[ch],Kf.update(B,Qb),Kf.bind(B,Qb)):console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}T=Qb;Db.setMaterial(la,gb);B=ja.index;Ab=1;if(!0===la.wireframe){B=ah.getWireframeAttribute(ja);if(void 0===B)return;
Ab=2}ab=ja.drawRange;nb=ja.attributes.position;gb=ab.start*Ab;ab=(ab.start+ab.count)*Ab;null!==bb&&(gb=Math.max(gb,bb.start*Ab),ab=Math.min(ab,(bb.start+bb.count)*Ab));null!==B?(gb=Math.max(gb,0),ab=Math.min(ab,B.count)):void 0!==nb&&null!==nb&&(gb=Math.max(gb,0),ab=Math.min(ab,nb.count));bb=ab-gb;0>bb||Infinity===bb||(Qd.setup(X,la,T,ja,B),T=ij,null!==B&&(B=Se.get(B),T=jj,T.setIndex(B)),X.isMesh?!0===la.wireframe?(Db.setLineWidth(la.wireframeLinewidth*(null===z?sa:1)),T.setMode(ka.LINES)):T.setMode(ka.TRIANGLES):
X.isLine?(la=la.linewidth,void 0===la&&(la=1),Db.setLineWidth(la*(null===z?sa:1)),X.isLineSegments?T.setMode(ka.LINES):X.isLineLoop?T.setMode(ka.LINE_LOOP):T.setMode(ka.LINE_STRIP)):X.isPoints?T.setMode(ka.POINTS):X.isSprite&&T.setMode(ka.TRIANGLES),X.isBatchedMesh?T.renderMultiDraw(X._multiDrawStarts,X._multiDrawCounts,X._multiDrawCount):X.isInstancedMesh?T.renderInstances(gb,bb,X.count):ja.isInstancedBufferGeometry?T.renderInstances(gb,bb,Math.min(ja.instanceCount,void 0!==ja._maxInstanceCount?
ja._maxInstanceCount:Infinity)):T.render(gb,bb))};this.compile=function(B,T,ja=null){null===ja&&(ja=B);Sa=Jf.get(ja);Sa.init();$a.push(Sa);ja.traverseVisible(function(X){X.isLight&&X.layers.test(T.layers)&&(Sa.pushLight(X),X.castShadow&&Sa.pushShadow(X))});B!==ja&&B.traverseVisible(function(X){X.isLight&&X.layers.test(T.layers)&&(Sa.pushLight(X),X.castShadow&&Sa.pushShadow(X))});Sa.setupLights(Ha._useLegacyLights);const la=new Set;B.traverse(function(X){const bb=X.material;if(bb)if(Array.isArray(bb))for(let gb=
0;gb<bb.length;gb++){const ab=bb[gb];h(ab,ja,X);la.add(ab)}else h(bb,ja,X),la.add(bb)});$a.pop();Sa=null;return la};this.compileAsync=function(B,T,ja=null){const la=this.compile(B,T,ja);return new Promise(X=>{function bb(){la.forEach(function(gb){Eb.get(gb).currentProgram.isReady()&&la.delete(gb)});0===la.size?X(B):setTimeout(bb,10)}null!==Xb.get("KHR_parallel_shader_compile")?bb():setTimeout(bb,10)})};let dh=null;const Rd=new La;Rd.setAnimationLoop(function(B){dh&&dh(B)});"undefined"!==typeof self&&
Rd.setContext(self);this.setAnimationLoop=function(B){dh=B;tc.setAnimationLoop(B);null===B?Rd.stop():Rd.start()};tc.addEventListener("sessionstart",l);tc.addEventListener("sessionend",n);this.render=function(B,T){if(void 0!==T&&!0!==T.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!0!==Ba){!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld();null===T.parent&&!0===T.matrixWorldAutoUpdate&&T.updateMatrixWorld();!0===tc.enabled&&!0===tc.isPresenting&&
(!0===tc.cameraAutoUpdate&&tc.updateCamera(T),T=tc.getCamera());if(!0===B.isScene)B.onBeforeRender(Ha,B,T,z);Sa=Jf.get(B,$a.length);Sa.init();$a.push(Sa);wc.multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse);Ib.setFromProjectionMatrix(wc);Jb=this.localClippingEnabled;jc=Zc.init(this.clippingPlanes,Jb);ta=If.get(B,cb.length);ta.init();cb.push(ta);m(B,T,0,Ha.sortObjects);ta.finish();!0===Ha.sortObjects&&ta.sort(ia,Ka);this.info.render.frame++;!0===jc&&Zc.beginShadows();Tc.render(Sa.state.shadowsArray,
B,T);!0===jc&&Zc.endShadows();!0===this.info.autoReset&&this.info.reset();!1!==tc.enabled&&!1!==tc.isPresenting&&!1!==tc.hasDepthSensing()||$c.render(ta,B);Sa.setupLights(Ha._useLegacyLights);if(T.isArrayCamera){const ja=T.cameras;for(let la=0,X=ja.length;la<X;la++){const bb=ja[la];p(ta,B,bb,bb.viewport)}}else p(ta,B,T);null!==z&&(Pb.updateMultisampleRenderTarget(z),Pb.updateRenderTargetMipmap(z));if(!0===B.isScene)B.onAfterRender(Ha,B,T);Qd.resetDefaultState();A=-1;E=null;$a.pop();Sa=0<$a.length?
$a[$a.length-1]:null;cb.pop();ta=0<cb.length?cb[cb.length-1]:null}};this.getActiveCubeFace=function(){return Ia};this.getActiveMipmapLevel=function(){return Xa};this.getRenderTarget=function(){return z};this.setRenderTargetTextures=function(B,T,ja){Eb.get(B.texture).__webglTexture=T;Eb.get(B.depthTexture).__webglTexture=ja;B=Eb.get(B);B.__hasExternalTextures=!0;B.__autoAllocateDepthBuffer=void 0===ja;B.__autoAllocateDepthBuffer||!0!==Xb.has("WEBGL_multisampled_render_to_texture")||(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),
B.__useRenderToTexture=!1)};this.setRenderTargetFramebuffer=function(B,T){B=Eb.get(B);B.__webglFramebuffer=T;B.__useDefaultFramebuffer=void 0===T};this.setRenderTarget=function(B,T=0,ja=0){z=B;Ia=T;Xa=ja;let la=!0;var X=null;let bb=!1,gb=!1;if(B){X=Eb.get(B);void 0!==X.__useDefaultFramebuffer?(Db.bindFramebuffer(ka.FRAMEBUFFER,null),la=!1):void 0===X.__webglFramebuffer?Pb.setupRenderTarget(B):X.__hasExternalTextures&&Pb.rebindTextures(B,Eb.get(B.texture).__webglTexture,Eb.get(B.depthTexture).__webglTexture);
X=B.texture;if(X.isData3DTexture||X.isDataArrayTexture||X.isCompressedArrayTexture)gb=!0;X=Eb.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(X=Array.isArray(X[T])?X[T][ja]:X[T],bb=!0):X=Lb.isWebGL2&&0<B.samples&&!1===Pb.useMultisampledRTT(B)?Eb.get(B).__webglMultisampledFramebuffer:Array.isArray(X)?X[ja]:X;O.copy(B.viewport);M.copy(B.scissor);ra=B.scissorTest}else O.copy(Ta).multiplyScalar(sa).floor(),M.copy(mb).multiplyScalar(sa).floor(),ra=db;Db.bindFramebuffer(ka.FRAMEBUFFER,X)&&Lb.drawBuffers&&
la&&Db.drawBuffers(B,X);Db.viewport(O);Db.scissor(M);Db.setScissorTest(ra);bb?(B=Eb.get(B.texture),ka.framebufferTexture2D(ka.FRAMEBUFFER,ka.COLOR_ATTACHMENT0,ka.TEXTURE_CUBE_MAP_POSITIVE_X+T,B.__webglTexture,ja)):gb&&(B=Eb.get(B.texture),ka.framebufferTextureLayer(ka.FRAMEBUFFER,ka.COLOR_ATTACHMENT0,B.__webglTexture,ja||0,T||0));A=-1};this.readRenderTargetPixels=function(B,T,ja,la,X,bb,gb){if(B&&B.isWebGLRenderTarget){var ab=Eb.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget&&void 0!==gb&&(ab=
ab[gb]);if(ab){Db.bindFramebuffer(ka.FRAMEBUFFER,ab);try{const Qb=B.texture,yb=Qb.format,mc=Qb.type;if(1023!==yb&&Yc.convert(yb)!==ka.getParameter(ka.IMPLEMENTATION_COLOR_READ_FORMAT))console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");else{var Ab=1016===mc&&(Xb.has("EXT_color_buffer_half_float")||Lb.isWebGL2&&Xb.has("EXT_color_buffer_float"));1009===mc||Yc.convert(mc)===ka.getParameter(ka.IMPLEMENTATION_COLOR_READ_TYPE)||1015===
mc&&(Lb.isWebGL2||Xb.has("OES_texture_float")||Xb.has("WEBGL_color_buffer_float"))||Ab?0<=T&&T<=B.width-la&&0<=ja&&ja<=B.height-X&&ka.readPixels(T,ja,la,X,Yc.convert(yb),Yc.convert(mc),bb):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}}finally{B=null!==z?Eb.get(z).__webglFramebuffer:null,Db.bindFramebuffer(ka.FRAMEBUFFER,B)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};
this.copyFramebufferToTexture=function(B,T,ja=0){var la=Math.pow(2,-ja);const X=Math.floor(T.image.width*la);la=Math.floor(T.image.height*la);Pb.setTexture2D(T,0);ka.copyTexSubImage2D(ka.TEXTURE_2D,ja,0,0,B.x,B.y,X,la);Db.unbindTexture()};this.copyTextureToTexture=function(B,T,ja,la=0){const X=T.image.width,bb=T.image.height,gb=Yc.convert(ja.format),ab=Yc.convert(ja.type);Pb.setTexture2D(ja,0);ka.pixelStorei(ka.UNPACK_FLIP_Y_WEBGL,ja.flipY);ka.pixelStorei(ka.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ja.premultiplyAlpha);
ka.pixelStorei(ka.UNPACK_ALIGNMENT,ja.unpackAlignment);T.isDataTexture?ka.texSubImage2D(ka.TEXTURE_2D,la,B.x,B.y,X,bb,gb,ab,T.image.data):T.isCompressedTexture?ka.compressedTexSubImage2D(ka.TEXTURE_2D,la,B.x,B.y,T.mipmaps[0].width,T.mipmaps[0].height,gb,T.mipmaps[0].data):ka.texSubImage2D(ka.TEXTURE_2D,la,B.x,B.y,gb,ab,T.image);0===la&&ja.generateMipmaps&&ka.generateMipmap(ka.TEXTURE_2D);Db.unbindTexture()};this.copyTextureToTexture3D=function(B,T,ja,la,X=0){if(Ha.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");
else{var bb=Math.round(B.max.x-B.min.x),gb=Math.round(B.max.y-B.min.y),ab=B.max.z-B.min.z+1,Ab=Yc.convert(la.format),Qb=Yc.convert(la.type);if(la.isData3DTexture){Pb.setTexture3D(la,0);var yb=ka.TEXTURE_3D}else if(la.isDataArrayTexture||la.isCompressedArrayTexture)Pb.setTexture2DArray(la,0),yb=ka.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ka.pixelStorei(ka.UNPACK_FLIP_Y_WEBGL,la.flipY);ka.pixelStorei(ka.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
la.premultiplyAlpha);ka.pixelStorei(ka.UNPACK_ALIGNMENT,la.unpackAlignment);var mc=ka.getParameter(ka.UNPACK_ROW_LENGTH),ad=ka.getParameter(ka.UNPACK_IMAGE_HEIGHT),Uc=ka.getParameter(ka.UNPACK_SKIP_PIXELS),Vc=ka.getParameter(ka.UNPACK_SKIP_ROWS),Lf=ka.getParameter(ka.UNPACK_SKIP_IMAGES),nb=ja.isCompressedTexture?ja.mipmaps[X]:ja.image;ka.pixelStorei(ka.UNPACK_ROW_LENGTH,nb.width);ka.pixelStorei(ka.UNPACK_IMAGE_HEIGHT,nb.height);ka.pixelStorei(ka.UNPACK_SKIP_PIXELS,B.min.x);ka.pixelStorei(ka.UNPACK_SKIP_ROWS,
B.min.y);ka.pixelStorei(ka.UNPACK_SKIP_IMAGES,B.min.z);ja.isDataTexture||ja.isData3DTexture?ka.texSubImage3D(yb,X,T.x,T.y,T.z,bb,gb,ab,Ab,Qb,nb.data):la.isCompressedArrayTexture?ka.compressedTexSubImage3D(yb,X,T.x,T.y,T.z,bb,gb,ab,Ab,nb.data):ka.texSubImage3D(yb,X,T.x,T.y,T.z,bb,gb,ab,Ab,Qb,nb);ka.pixelStorei(ka.UNPACK_ROW_LENGTH,mc);ka.pixelStorei(ka.UNPACK_IMAGE_HEIGHT,ad);ka.pixelStorei(ka.UNPACK_SKIP_PIXELS,Uc);ka.pixelStorei(ka.UNPACK_SKIP_ROWS,Vc);ka.pixelStorei(ka.UNPACK_SKIP_IMAGES,Lf);0===
X&&la.generateMipmaps&&ka.generateMipmap(yb);Db.unbindTexture()}};this.initTexture=function(B){B.isCubeTexture?Pb.setTextureCube(B,0):B.isData3DTexture?Pb.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?Pb.setTexture2DArray(B,0):Pb.setTexture2D(B,0);Db.unbindTexture()};this.resetState=function(){Xa=Ia=0;z=null;Db.reset();Qd.reset()};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return 2E3}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=
a;const b=this.getContext();b.drawingBufferColorSpace="display-p3"===a?"display-p3":"srgb";b.unpackColorSpace="display-p3-linear"===Kb.workingColorSpace?"display-p3":"srgb"}get useLegacyLights(){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733.");return this._useLegacyLights}set useLegacyLights(a){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733.");
this._useLegacyLights=a}}class kj extends gj{}kj.prototype.isWebGL1Renderer=!0;class eh{constructor(a,b=2.5E-4){this.isFogExp2=!0;this.name="";this.color=new Ya(a);this.density=b}clone(){return new eh(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class fh{constructor(a,b=1,c=1E3){this.isFog=!0;this.name="";this.color=new Ya(a);this.near=b;this.far=c}clone(){return new fh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",
name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class lj extends Gb{constructor(){super();this.isScene=!0;this.type="Scene";this.fog=this.environment=this.background=null;this.backgroundBlurriness=0;this.backgroundIntensity=1;this.backgroundRotation=new Kc;this.environmentRotation=new Kc;this.overrideMaterial=null;"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,b){super.copy(a,b);null!==a.background&&
(this.background=a.background.clone());null!==a.environment&&(this.environment=a.environment.clone());null!==a.fog&&(this.fog=a.fog.clone());this.backgroundBlurriness=a.backgroundBlurriness;this.backgroundIntensity=a.backgroundIntensity;this.backgroundRotation.copy(a.backgroundRotation);this.environmentRotation.copy(a.environmentRotation);null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.matrixAutoUpdate=a.matrixAutoUpdate;return this}toJSON(a){a=super.toJSON(a);null!==
this.fog&&(a.object.fog=this.fog.toJSON());0<this.backgroundBlurriness&&(a.object.backgroundBlurriness=this.backgroundBlurriness);1!==this.backgroundIntensity&&(a.object.backgroundIntensity=this.backgroundIntensity);a.object.backgroundRotation=this.backgroundRotation.toArray();a.object.environmentRotation=this.environmentRotation.toArray();return a}}class Mf{constructor(a,b){this.isInterleavedBuffer=!0;this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.usage=35044;this._updateRange=
{offset:0,count:-1};this.updateRanges=[];this.version=0;this.uuid=pa()}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}get updateRange(){Wa("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead.");return this._updateRange}setUsage(a){this.usage=a;return this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){this.array=new a.array.constructor(a.array);this.count=
a.count;this.stride=a.stride;this.usage=a.usage;return this}copyAt(a,b,c){a*=this.stride;c*=b.stride;for(let d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this}set(a,b=0){this.array.set(a,b);return this}clone(a){void 0===a.arrayBuffers&&(a.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pa());void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);a=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]);
a=new this.constructor(a,this.stride);a.setUsage(this.usage);return a}onUpload(a){this.onUploadCallback=a;return this}toJSON(a){void 0===a.arrayBuffers&&(a.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pa());void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer)));return{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const zc=new I;class xe{constructor(a,
b,c,d=!1){this.isInterleavedBufferAttribute=!0;this.name="";this.data=a;this.itemSize=b;this.offset=c;this.normalized=d}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=a}applyMatrix4(a){for(let b=0,c=this.data.count;b<c;b++)zc.fromBufferAttribute(this,b),zc.applyMatrix4(a),this.setXYZ(b,zc.x,zc.y,zc.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)zc.fromBufferAttribute(this,b),zc.applyNormalMatrix(a),this.setXYZ(b,
zc.x,zc.y,zc.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)zc.fromBufferAttribute(this,b),zc.transformDirection(a),this.setXYZ(b,zc.x,zc.y,zc.z);return this}getComponent(a,b){a=this.array[a*this.data.stride+this.offset+b];this.normalized&&(a=qa(a,this.array));return a}setComponent(a,b,c){this.normalized&&(c=Qa(c,this.array));this.data.array[a*this.data.stride+this.offset+b]=c;return this}setX(a,b){this.normalized&&(b=Qa(b,this.array));this.data.array[a*this.data.stride+this.offset]=
b;return this}setY(a,b){this.normalized&&(b=Qa(b,this.array));this.data.array[a*this.data.stride+this.offset+1]=b;return this}setZ(a,b){this.normalized&&(b=Qa(b,this.array));this.data.array[a*this.data.stride+this.offset+2]=b;return this}setW(a,b){this.normalized&&(b=Qa(b,this.array));this.data.array[a*this.data.stride+this.offset+3]=b;return this}getX(a){a=this.data.array[a*this.data.stride+this.offset];this.normalized&&(a=qa(a,this.array));return a}getY(a){a=this.data.array[a*this.data.stride+this.offset+
1];this.normalized&&(a=qa(a,this.array));return a}getZ(a){a=this.data.array[a*this.data.stride+this.offset+2];this.normalized&&(a=qa(a,this.array));return a}getW(a){a=this.data.array[a*this.data.stride+this.offset+3];this.normalized&&(a=qa(a,this.array));return a}setXY(a,b,c){a=a*this.data.stride+this.offset;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array));this.data.array[a+0]=b;this.data.array[a+1]=c;return this}setXYZ(a,b,c,d){a=a*this.data.stride+this.offset;this.normalized&&(b=Qa(b,this.array),
c=Qa(c,this.array),d=Qa(d,this.array));this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this}setXYZW(a,b,c,d,e){a=a*this.data.stride+this.offset;this.normalized&&(b=Qa(b,this.array),c=Qa(c,this.array),d=Qa(d,this.array),e=Qa(e,this.array));this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}clone(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");
a=[];for(let b=0;b<this.count;b++){const c=b*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)a.push(this.data.array[c+d])}return new Nb(new this.array.constructor(a),this.itemSize,this.normalized)}void 0===a.interleavedBuffers&&(a.interleavedBuffers={});void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a));return new xe(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");
a=[];for(let b=0;b<this.count;b++){const c=b*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)a.push(this.data.array[c+d])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}void 0===a.interleavedBuffers&&(a.interleavedBuffers={});void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a));return{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}
class gh extends sc{constructor(a){super();this.isSpriteMaterial=!0;this.type="SpriteMaterial";this.color=new Ya(16777215);this.alphaMap=this.map=null;this.rotation=0;this.fog=this.transparent=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.rotation=a.rotation;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}let ye;const Te=new I,ze=new I,Ae=new I,de=new xa,Fe=new xa,wi=new lb,Nf=new I,Ue=new I,
Of=new I,mj=new xa,hh=new xa,nj=new xa;class oj extends Gb{constructor(a=new gh){super();this.isSprite=!0;this.type="Sprite";if(void 0===ye){ye=new tb;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new Mf(b,5);ye.setIndex([0,1,2,0,2,3]);ye.setAttribute("position",new xe(b,3,0,!1));ye.setAttribute("uv",new xe(b,2,3,!1))}this.geometry=ye;this.material=a;this.center=new xa(.5,.5)}raycast(a,b){null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');
ze.setFromMatrixScale(this.matrixWorld);wi.copy(a.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld);Ae.setFromMatrixPosition(this.modelViewMatrix);a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ze.multiplyScalar(-Ae.z);var c=this.material.rotation;let d;if(0!==c){d=Math.cos(c);var e=Math.sin(c)}c=this.center;of(Nf.set(-.5,-.5,0),Ae,c,ze,e,d);of(Ue.set(.5,-.5,0),Ae,c,ze,e,d);of(Of.set(.5,.5,0),Ae,c,ze,e,d);mj.set(0,0);hh.set(1,
0);nj.set(1,1);let f=a.ray.intersectTriangle(Nf,Ue,Of,!1,Te);if(null===f&&(of(Ue.set(-.5,.5,0),Ae,c,ze,e,d),hh.set(0,1),f=a.ray.intersectTriangle(Nf,Of,Ue,!1,Te),null===f))return;e=a.ray.origin.distanceTo(Te);e<a.near||e>a.far||b.push({distance:e,point:Te.clone(),uv:Gc.getInterpolation(Te,Nf,Ue,Of,mj,hh,nj,new xa),face:null,object:this})}copy(a,b){super.copy(a,b);void 0!==a.center&&this.center.copy(a.center);this.material=a.material;return this}}const Pf=new I,pj=new I;class qj extends Gb{constructor(){super();
this._currentLevel=0;this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}});this.autoUpdate=!0}copy(a){super.copy(a,!1);const b=a.levels;for(let c=0,d=b.length;c<d;c++){const e=b[c];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}this.autoUpdate=a.autoUpdate;return this}addLevel(a,b=0,c=0){b=Math.abs(b);const d=this.levels;let e;for(e=0;e<d.length&&!(b<d[e].distance);e++);d.splice(e,0,{distance:b,hysteresis:c,object:a});this.add(a);return this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(a){const b=
this.levels;if(0<b.length){let c,d;c=1;for(d=b.length;c<d;c++){let e=b[c].distance;b[c].object.visible&&(e-=e*b[c].hysteresis);if(a<e)break}return b[c-1].object}return null}raycast(a,b){if(0<this.levels.length){Pf.setFromMatrixPosition(this.matrixWorld);const c=a.ray.origin.distanceTo(Pf);this.getObjectForDistance(c).raycast(a,b)}}update(a){const b=this.levels;if(1<b.length){Pf.setFromMatrixPosition(a.matrixWorld);pj.setFromMatrixPosition(this.matrixWorld);a=Pf.distanceTo(pj)/a.zoom;b[0].object.visible=
!0;let c,d;c=1;for(d=b.length;c<d;c++){let e=b[c].distance;b[c].object.visible&&(e-=e*b[c].hysteresis);if(a>=e)b[c-1].object.visible=!1,b[c].object.visible=!0;else break}for(this._currentLevel=c-1;c<d;c++)b[c].object.visible=!1}}toJSON(a){a=super.toJSON(a);!1===this.autoUpdate&&(a.object.autoUpdate=!1);a.object.levels=[];const b=this.levels;for(let c=0,d=b.length;c<d;c++){const e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return a}}const rj=new I,
sj=new Mb,tj=new Mb,ym=new I,uj=new lb,Qf=new I,ih=new qc,vj=new lb,jh=new me;class wj extends dc{constructor(a,b){super(a,b);this.isSkinnedMesh=!0;this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new lb;this.bindMatrixInverse=new lb;this.boundingSphere=this.boundingBox=null}computeBoundingBox(){var a=this.geometry;null===this.boundingBox&&(this.boundingBox=new xc);this.boundingBox.makeEmpty();a=a.getAttribute("position");for(let b=0;b<a.count;b++)this.getVertexPosition(b,Qf),this.boundingBox.expandByPoint(Qf)}computeBoundingSphere(){var a=
this.geometry;null===this.boundingSphere&&(this.boundingSphere=new qc);this.boundingSphere.makeEmpty();a=a.getAttribute("position");for(let b=0;b<a.count;b++)this.getVertexPosition(b,Qf),this.boundingSphere.expandByPoint(Qf)}copy(a,b){super.copy(a,b);this.bindMode=a.bindMode;this.bindMatrix.copy(a.bindMatrix);this.bindMatrixInverse.copy(a.bindMatrixInverse);this.skeleton=a.skeleton;null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());
return this}raycast(a,b){const c=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ih.copy(this.boundingSphere),ih.applyMatrix4(c),!1!==a.ray.intersectsSphere(ih)&&(vj.copy(c).invert(),jh.copy(a.ray).applyMatrix4(vj),null!==this.boundingBox&&!1===jh.intersectsBox(this.boundingBox)||this._computeIntersections(a,b,jh)))}getVertexPosition(a,b){super.getVertexPosition(a,b);this.applyBoneTransform(a,b);return b}bind(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),
this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.copy(b).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const a=new Mb,b=this.geometry.attributes.skinWeight;for(let c=0,d=b.count;c<d;c++){a.fromBufferAttribute(b,c);const e=1/a.manhattanLength();Infinity!==e?a.multiplyScalar(e):a.set(1,0,0,0);b.setXYZW(c,a.x,a.y,a.z,a.w)}}updateMatrixWorld(a){super.updateMatrixWorld(a);"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():
"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(a,b){const c=this.skeleton;var d=this.geometry;sj.fromBufferAttribute(d.attributes.skinIndex,a);tj.fromBufferAttribute(d.attributes.skinWeight,a);rj.copy(b).applyMatrix4(this.bindMatrix);b.set(0,0,0);for(a=0;4>a;a++)if(d=tj.getComponent(a),0!==d){const e=sj.getComponent(a);uj.multiplyMatrices(c.bones[e].matrixWorld,c.boneInverses[e]);
b.addScaledVector(ym.copy(rj).applyMatrix4(uj),d)}return b.applyMatrix4(this.bindMatrixInverse)}}class kh extends Gb{constructor(){super();this.isBone=!0;this.type="Bone"}}class xd extends cc{constructor(a=null,b=1,c=1,d,e,f,g,k,h=1003,l=1003,n,m){super(null,f,g,k,h,l,d,e,n,m);this.isDataTexture=!0;this.image={data:a,width:b,height:c};this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}const xj=new lb,zm=new lb;class lh{constructor(a=[],b=[]){this.uuid=pa();this.bones=a.slice(0);this.boneInverses=
b;this.boneTexture=this.boneMatrices=null;this.init()}init(){const a=this.bones,b=this.boneInverses;this.boneMatrices=new Float32Array(16*a.length);if(0===b.length)this.calculateInverses();else if(a.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.");this.boneInverses=[];for(let c=0,d=this.bones.length;c<d;c++)this.boneInverses.push(new lb)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,b=this.bones.length;a<b;a++){const c=
new lb;this.bones[a]&&c.copy(this.bones[a].matrixWorld).invert();this.boneInverses.push(c)}}pose(){for(let b=0,c=this.bones.length;b<c;b++){var a=this.bones[b];a&&a.matrixWorld.copy(this.boneInverses[b]).invert()}for(let b=0,c=this.bones.length;b<c;b++)if(a=this.bones[b])a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)}update(){const a=this.bones,b=this.boneInverses,
c=this.boneMatrices,d=this.boneTexture;for(let e=0,f=a.length;e<f;e++)xj.multiplyMatrices(a[e]?a[e].matrixWorld:zm,b[e]),xj.toArray(c,16*e);null!==d&&(d.needsUpdate=!0)}clone(){return new lh(this.bones,this.boneInverses)}computeBoneTexture(){var a=Math.sqrt(4*this.bones.length);a=4*Math.ceil(a/4);a=Math.max(a,4);const b=new Float32Array(a*a*4);b.set(this.boneMatrices);a=new xd(b,a,a,1023,1015);a.needsUpdate=!0;this.boneMatrices=b;this.boneTexture=a;return this}getBoneByName(a){for(let b=0,c=this.bones.length;b<
c;b++){const d=this.bones[b];if(d.name===a)return d}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,b){this.uuid=a.uuid;for(let c=0,d=a.bones.length;c<d;c++){const e=a.bones[c];let f=b[e];void 0===f&&(console.warn("THREE.Skeleton: No bone found with UUID:",e),f=new kh);this.bones.push(f);this.boneInverses.push((new lb).fromArray(a.boneInverses[c]))}this.init();return this}toJSON(){const a={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},
bones:[],boneInverses:[]};a.uuid=this.uuid;const b=this.bones,c=this.boneInverses;for(let d=0,e=b.length;d<e;d++)a.bones.push(b[d].uuid),a.boneInverses.push(c[d].toArray());return a}}class Be extends Nb{constructor(a,b,c,d=1){super(a,b,c);this.isInstancedBufferAttribute=!0;this.meshPerAttribute=d}copy(a){super.copy(a);this.meshPerAttribute=a.meshPerAttribute;return this}toJSON(){const a=super.toJSON();a.meshPerAttribute=this.meshPerAttribute;a.isInstancedBufferAttribute=!0;return a}}const Ce=new lb,
yj=new lb,Rf=[],zj=new xc,Am=new lb,Ve=new dc,We=new qc;class Aj extends dc{constructor(a,b,c){super(a,b);this.isInstancedMesh=!0;this.instanceMatrix=new Be(new Float32Array(16*c),16);this.morphTexture=this.instanceColor=null;this.count=c;this.boundingSphere=this.boundingBox=null;for(a=0;a<c;a++)this.setMatrixAt(a,Am)}computeBoundingBox(){const a=this.geometry,b=this.count;null===this.boundingBox&&(this.boundingBox=new xc);null===a.boundingBox&&a.computeBoundingBox();this.boundingBox.makeEmpty();
for(let c=0;c<b;c++)this.getMatrixAt(c,Ce),zj.copy(a.boundingBox).applyMatrix4(Ce),this.boundingBox.union(zj)}computeBoundingSphere(){const a=this.geometry,b=this.count;null===this.boundingSphere&&(this.boundingSphere=new qc);null===a.boundingSphere&&a.computeBoundingSphere();this.boundingSphere.makeEmpty();for(let c=0;c<b;c++)this.getMatrixAt(c,Ce),We.copy(a.boundingSphere).applyMatrix4(Ce),this.boundingSphere.union(We)}copy(a,b){super.copy(a,b);this.instanceMatrix.copy(a.instanceMatrix);null!==
a.instanceColor&&(this.instanceColor=a.instanceColor.clone());this.count=a.count;null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this}getColorAt(a,b){b.fromArray(this.instanceColor.array,3*a)}getMatrixAt(a,b){b.fromArray(this.instanceMatrix.array,16*a)}getMorphAt(a,b){b=b.morphTargetInfluences;const c=this.morphTexture.source.data.data;a=a*(b.length+1)+1;for(let d=0;d<b.length;d++)b[d]=c[a+d]}raycast(a,b){const c=
this.matrixWorld,d=this.count;Ve.geometry=this.geometry;Ve.material=this.material;if(void 0!==Ve.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),We.copy(this.boundingSphere),We.applyMatrix4(c),!1!==a.ray.intersectsSphere(We)))for(let e=0;e<d;e++){this.getMatrixAt(e,Ce);yj.multiplyMatrices(c,Ce);Ve.matrixWorld=yj;Ve.raycast(a,Rf);for(let f=0,g=Rf.length;f<g;f++){const k=Rf[f];k.instanceId=e;k.object=this;b.push(k)}Rf.length=0}}setColorAt(a,b){null===this.instanceColor&&(this.instanceColor=
new Be(new Float32Array(3*this.instanceMatrix.count),3));b.toArray(this.instanceColor.array,3*a)}setMatrixAt(a,b){b.toArray(this.instanceMatrix.array,16*a)}setMorphAt(a,b){b=b.morphTargetInfluences;const c=b.length+1;null===this.morphTexture&&(this.morphTexture=new xd(new Float32Array(c*this.count),c,this.count,1028,1015));const d=this.morphTexture.source.data.data;let e=0;for(let f=0;f<b.length;f++)e+=b[f];a*=c;d[a]=this.geometry.morphTargetsRelative?1:1-e;d.set(b,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}
class Bm{constructor(){this.index=0;this.pool=[];this.list=[]}push(a,b){var c=this.pool;const d=this.list;this.index>=c.length&&c.push({start:-1,count:-1,z:-1});c=c[this.index];d.push(c);this.index++;c.start=a.start;c.count=a.count;c.z=b}reset(){this.index=this.list.length=0}}const yd=new lb,Bj=new lb,Cm=new lb,Cj=new lb,mh=new Ee,Sf=new xc,Sd=new qc,Xe=new I,nh=new Bm,uc=new dc,Tf=[];class Dj extends dc{get maxGeometryCount(){return this._maxGeometryCount}constructor(a,b,c=2*b,d){super(new tb,d);
this.sortObjects=this.perObjectFrustumCulled=this.isBatchedMesh=!0;this.customSort=this.boundingSphere=this.boundingBox=null;this._drawRanges=[];this._reservedRanges=[];this._visibility=[];this._active=[];this._bounds=[];this._maxGeometryCount=a;this._maxVertexCount=b;this._maxIndexCount=c;this._geometryInitialized=!1;this._geometryCount=0;this._multiDrawCounts=new Int32Array(a);this._multiDrawStarts=new Int32Array(a);this._multiDrawCount=0;this._visibilityChanged=!0;this._matricesTexture=null;this._initMatricesTexture()}_initMatricesTexture(){let a=
Math.sqrt(4*this._maxGeometryCount);a=4*Math.ceil(a/4);a=Math.max(a,4);const b=new Float32Array(a*a*4);this._matricesTexture=new xd(b,a,a,1023,1015)}_initializeGeometry(a){const b=this.geometry;var c=this._maxVertexCount;const d=this._maxGeometryCount,e=this._maxIndexCount;if(!1===this._geometryInitialized){for(const g in a.attributes){const k=a.getAttribute(g),{array:h,itemSize:l,normalized:n}=k;var f=new h.constructor(c*l);f=new k.constructor(f,l,n);f.setUsage(k.usage);b.setAttribute(g,f)}null!==
a.getIndex()&&(a=65536<c?new Uint32Array(e):new Uint16Array(e),b.setIndex(new Nb(a,1)));c=65536<d?new Uint32Array(c):new Uint16Array(c);b.setAttribute("batchId",new Nb(c,1));this._geometryInitialized=!0}}_validateGeometry(a){if(a.getAttribute("batchId"))throw Error('BatchedMesh: Geometry cannot use attribute "batchId"');const b=this.geometry;if(!!a.getIndex()!==!!b.getIndex())throw Error('BatchedMesh: All geometries must consistently have "index".');for(const c in b.attributes){if("batchId"===c)continue;
if(!a.hasAttribute(c))throw Error(`BatchedMesh: Added geometry missing "${c}". All geometries must have consistent attributes.`);const d=a.getAttribute(c),e=b.getAttribute(c);if(d.itemSize!==e.itemSize||d.normalized!==e.normalized)throw Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.");}}setCustomSort(a){this.customSort=a;return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new xc);const a=this._geometryCount,b=this.boundingBox,c=this._active;
b.makeEmpty();for(let d=0;d<a;d++)!1!==c[d]&&(this.getMatrixAt(d,yd),this.getBoundingBoxAt(d,Sf).applyMatrix4(yd),b.union(Sf))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qc);const a=this._geometryCount,b=this.boundingSphere,c=this._active;b.makeEmpty();for(let d=0;d<a;d++)!1!==c[d]&&(this.getMatrixAt(d,yd),this.getBoundingSphereAt(d,Sd).applyMatrix4(yd),b.union(Sd))}addGeometry(a,b=-1,c=-1){this._initializeGeometry(a);this._validateGeometry(a);if(this._geometryCount>=
this._maxGeometryCount)throw Error("BatchedMesh: Maximum geometry count reached.");const d={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};var e=null,f=this._reservedRanges,g=this._drawRanges;const k=this._bounds;0!==this._geometryCount&&(e=f[f.length-1]);d.vertexCount=-1===b?a.getAttribute("position").count:b;d.vertexStart=null===e?0:e.vertexStart+e.vertexCount;var h=a.getIndex();if(b=null!==h)d.indexCount=-1===c?h.count:c,d.indexStart=null===e?0:e.indexStart+e.indexCount;if(-1!==d.indexStart&&
d.indexStart+d.indexCount>this._maxIndexCount||d.vertexStart+d.vertexCount>this._maxVertexCount)throw Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");c=this._active;e=this._matricesTexture;h=this._matricesTexture.image.data;this._visibility.push(!0);c.push(!0);c=this._geometryCount;this._geometryCount++;Cm.toArray(h,16*c);e.needsUpdate=!0;f.push(d);g.push({start:b?d.indexStart:d.vertexStart,count:-1});k.push({boxInitialized:!1,box:new xc,sphereInitialized:!1,sphere:new qc});
f=this.geometry.getAttribute("batchId");for(g=0;g<d.vertexCount;g++)f.setX(d.vertexStart+g,c);f.needsUpdate=!0;this.setGeometryAt(c,a);return c}setGeometryAt(a,b){if(a>=this._geometryCount)throw Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(b);var c=this.geometry;const d=null!==c.getIndex();var e=c.getIndex();const f=b.getIndex(),g=this._reservedRanges[a];if(d&&f.count>g.indexCount||b.attributes.position.count>g.vertexCount)throw Error("BatchedMesh: Reserved space not large enough for provided geometry.");
const k=g.vertexStart;var h=g.vertexCount;for(const n in c.attributes){if("batchId"===n)continue;var l=b.getAttribute(n);const m=c.getAttribute(n);Ll(l,m,k);const p=l.itemSize;for(let v=l.count,t=h;v<t;v++){l=k+v;for(let x=0;x<p;x++)m.setComponent(l,x,0)}m.needsUpdate=!0}if(d){c=g.indexStart;for(h=0;h<f.count;h++)e.setX(c+h,k+f.getX(h));for(let n=f.count,m=g.indexCount;n<m;n++)e.setX(c+n,k);e.needsUpdate=!0}e=this._bounds[a];null!==b.boundingBox?(e.box.copy(b.boundingBox),e.boxInitialized=!0):e.boxInitialized=
!1;null!==b.boundingSphere?(e.sphere.copy(b.boundingSphere),e.sphereInitialized=!0):e.sphereInitialized=!1;e=this._drawRanges[a];b=b.getAttribute("position");e.count=d?f.count:b.count;this._visibilityChanged=!0;return a}deleteGeometry(a){const b=this._active;if(a>=b.length||!1===b[a])return this;b[a]=!1;this._visibilityChanged=!0;return this}getBoundingBoxAt(a,b){if(!1===this._active[a])return null;const c=this._bounds[a],d=c.box;var e=this.geometry;if(!1===c.boxInitialized){d.makeEmpty();const f=
e.index;e=e.attributes.position;a=this._drawRanges[a];for(let g=a.start,k=a.start+a.count;g<k;g++)a=g,f&&(a=f.getX(a)),d.expandByPoint(Xe.fromBufferAttribute(e,a));c.boxInitialized=!0}b.copy(d);return b}getBoundingSphereAt(a,b){if(!1===this._active[a])return null;const c=this._bounds[a],d=c.sphere;var e=this.geometry;if(!1===c.sphereInitialized){d.makeEmpty();this.getBoundingBoxAt(a,Sf);Sf.getCenter(d.center);const g=e.index;e=e.attributes.position;var f=this._drawRanges[a];a=0;for(let k=f.start,
h=f.start+f.count;k<h;k++)f=k,g&&(f=g.getX(f)),Xe.fromBufferAttribute(e,f),a=Math.max(a,d.center.distanceToSquared(Xe));d.radius=Math.sqrt(a);c.sphereInitialized=!0}b.copy(d);return b}setMatrixAt(a,b){const c=this._active,d=this._matricesTexture;if(a>=this._geometryCount||!1===c[a])return this;b.toArray(this._matricesTexture.image.data,16*a);d.needsUpdate=!0;return this}getMatrixAt(a,b){const c=this._active;return a>=this._geometryCount||!1===c[a]?null:b.fromArray(this._matricesTexture.image.data,
16*a)}setVisibleAt(a,b){const c=this._visibility,d=this._active;if(a>=this._geometryCount||!1===d[a]||c[a]===b)return this;c[a]=b;this._visibilityChanged=!0;return this}getVisibleAt(a){const b=this._active;return a>=this._geometryCount||!1===b[a]?!1:this._visibility[a]}raycast(a,b){const c=this._visibility,d=this._active,e=this._drawRanges,f=this._geometryCount,g=this.matrixWorld;var k=this.geometry;uc.material=this.material;uc.geometry.index=k.index;uc.geometry.attributes=k.attributes;null===uc.geometry.boundingBox&&
(uc.geometry.boundingBox=new xc);null===uc.geometry.boundingSphere&&(uc.geometry.boundingSphere=new qc);for(k=0;k<f;k++)if(c[k]&&d[k]){var h=e[k];uc.geometry.setDrawRange(h.start,h.count);this.getMatrixAt(k,uc.matrixWorld).premultiply(g);this.getBoundingBoxAt(k,uc.geometry.boundingBox);this.getBoundingSphereAt(k,uc.geometry.boundingSphere);uc.raycast(a,Tf);for(let l=0,n=Tf.length;l<n;l++)h=Tf[l],h.object=this,h.batchId=k,b.push(h);Tf.length=0}uc.material=null;uc.geometry.index=null;uc.geometry.attributes=
{};uc.geometry.setDrawRange(0,Infinity)}copy(a){super.copy(a);this.geometry=a.geometry.clone();this.perObjectFrustumCulled=a.perObjectFrustumCulled;this.sortObjects=a.sortObjects;this.boundingBox=null!==a.boundingBox?a.boundingBox.clone():null;this.boundingSphere=null!==a.boundingSphere?a.boundingSphere.clone():null;this._drawRanges=a._drawRanges.map(b=>({...b}));this._reservedRanges=a._reservedRanges.map(b=>({...b}));this._visibility=a._visibility.slice();this._active=a._active.slice();this._bounds=
a._bounds.map(b=>({boxInitialized:b.boxInitialized,box:b.box.clone(),sphereInitialized:b.sphereInitialized,sphere:b.sphere.clone()}));this._maxGeometryCount=a._maxGeometryCount;this._maxVertexCount=a._maxVertexCount;this._maxIndexCount=a._maxIndexCount;this._geometryInitialized=a._geometryInitialized;this._geometryCount=a._geometryCount;this._multiDrawCounts=a._multiDrawCounts.slice();this._multiDrawStarts=a._multiDrawStarts.slice();this._matricesTexture=a._matricesTexture.clone();this._matricesTexture.image.data=
this._matricesTexture.image.slice();return this}dispose(){this.geometry.dispose();this._matricesTexture.dispose();this._matricesTexture=null;return this}onBeforeRender(a,b,c,d,e){if(this._visibilityChanged||this.perObjectFrustumCulled||this.sortObjects){b=d.getIndex();b=null===b?1:b.array.BYTES_PER_ELEMENT;var f=this._active,g=this._visibility;d=this._multiDrawStarts;var k=this._multiDrawCounts,h=this._drawRanges,l=this.perObjectFrustumCulled;l&&(Cj.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse).multiply(this.matrixWorld),
mh.setFromProjectionMatrix(Cj,a.coordinateSystem));a=0;if(this.sortObjects){Bj.copy(this.matrixWorld).invert();Xe.setFromMatrixPosition(c.matrixWorld).applyMatrix4(Bj);for(let m=0,p=g.length;m<p;m++)if(g[m]&&f[m]){this.getMatrixAt(m,yd);this.getBoundingSphereAt(m,Sd).applyMatrix4(yd);var n=!1;l&&(n=!mh.intersectsSphere(Sd));n||(n=Xe.distanceTo(Sd.center),nh.push(h[m],n))}f=nh.list;g=this.customSort;null===g?f.sort(e.transparent?Kl:Jl):g.call(this,f,c);for(let m=0,p=f.length;m<p;m++)c=f[m],d[a]=c.start*
b,k[a]=c.count,a++;nh.reset()}else for(let m=0,p=g.length;m<p;m++)g[m]&&f[m]&&(c=!1,l&&(this.getMatrixAt(m,yd),this.getBoundingSphereAt(m,Sd).applyMatrix4(yd),c=!mh.intersectsSphere(Sd)),c||(c=h[m],d[a]=c.start*b,k[a]=c.count,a++));this._multiDrawCount=a;this._visibilityChanged=!1}}onBeforeShadow(a,b,c,d,e,f){this.onBeforeRender(a,null,d,e,f)}}class Ac extends sc{constructor(a){super();this.isLineBasicMaterial=!0;this.type="LineBasicMaterial";this.color=new Ya(16777215);this.map=null;this.linewidth=
1;this.linejoin=this.linecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;this.fog=a.fog;return this}}const Ej=new I,Fj=new I,Gj=new lb,oh=new me,Ye=new qc;class zd extends Gb{constructor(a=new tb,b=new Ac){super();this.isLine=!0;this.type="Line";this.geometry=a;this.material=b;this.updateMorphTargets()}copy(a,b){super.copy(a,b);this.material=Array.isArray(a.material)?
a.material.slice():a.material;this.geometry=a.geometry;return this}computeLineDistances(){const a=this.geometry;if(null===a.index){const b=a.attributes.position,c=[0];for(let d=1,e=b.count;d<e;d++)Ej.fromBufferAttribute(b,d-1),Fj.fromBufferAttribute(b,d),c[d]=c[d-1],c[d]+=Ej.distanceTo(Fj);a.setAttribute("lineDistance",new eb(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,b){var c=this.geometry,d=this.matrixWorld,
e=a.params.Line.threshold,f=c.drawRange;null===c.boundingSphere&&c.computeBoundingSphere();Ye.copy(c.boundingSphere);Ye.applyMatrix4(d);Ye.radius+=e;if(!1!==a.ray.intersectsSphere(Ye)){Gj.copy(d).invert();oh.copy(a.ray).applyMatrix4(Gj);d=e/((this.scale.x+this.scale.y+this.scale.z)/3);d*=d;e=new I;var g=new I,k=new I,h=new I,l=this.isLineSegments?2:1,n=c.index;c=c.attributes.position;if(null!==n){var m=Math.max(0,f.start);f=Math.min(n.count,f.start+f.count);for(let p=m,v=f-1;p<v;p+=l)f=n.getX(p),
m=n.getX(p+1),e.fromBufferAttribute(c,f),g.fromBufferAttribute(c,m),oh.distanceSqToSegment(e,g,h,k)>d||(h.applyMatrix4(this.matrixWorld),f=a.ray.origin.distanceTo(h),f<a.near||f>a.far||b.push({distance:f,point:k.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else{n=Math.max(0,f.start);f=Math.min(c.count,f.start+f.count);for(let p=n,v=f-1;p<v;p+=l)e.fromBufferAttribute(c,p),g.fromBufferAttribute(c,p+1),oh.distanceSqToSegment(e,g,h,k)>d||(h.applyMatrix4(this.matrixWorld),
f=a.ray.origin.distanceTo(h),f<a.near||f>a.far||b.push({distance:f,point:k.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}}}updateMorphTargets(){var a=this.geometry.morphAttributes,b=Object.keys(a);if(0<b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let c=0,d=a.length;c<d;c++)b=a[c].name||String(c),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=c}}}const Hj=new I,Ij=new I;class bd extends zd{constructor(a,
b){super(a,b);this.isLineSegments=!0;this.type="LineSegments"}computeLineDistances(){const a=this.geometry;if(null===a.index){const b=a.attributes.position,c=[];for(let d=0,e=b.count;d<e;d+=2)Hj.fromBufferAttribute(b,d),Ij.fromBufferAttribute(b,d+1),c[d]=0===d?0:c[d-1],c[d+1]=c[d]+Hj.distanceTo(Ij);a.setAttribute("lineDistance",new eb(c,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Jj extends zd{constructor(a,
b){super(a,b);this.isLineLoop=!0;this.type="LineLoop"}}class ph extends sc{constructor(a){super();this.isPointsMaterial=!0;this.type="PointsMaterial";this.color=new Ya(16777215);this.alphaMap=this.map=null;this.size=1;this.fog=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}const Kj=new lb,wg=new me,Ze=new qc,Uf=new I;class Lj extends Gb{constructor(a=
new tb,b=new ph){super();this.isPoints=!0;this.type="Points";this.geometry=a;this.material=b;this.updateMorphTargets()}copy(a,b){super.copy(a,b);this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}raycast(a,b){var c=this.geometry;const d=this.matrixWorld;var e=a.params.Points.threshold,f=c.drawRange;null===c.boundingSphere&&c.computeBoundingSphere();Ze.copy(c.boundingSphere);Ze.applyMatrix4(d);Ze.radius+=e;if(!1!==a.ray.intersectsSphere(Ze)){Kj.copy(d).invert();
wg.copy(a.ray).applyMatrix4(Kj);e/=(this.scale.x+this.scale.y+this.scale.z)/3;e*=e;var g=c.index;c=c.attributes.position;if(null!==g){const k=Math.max(0,f.start);f=Math.min(g.count,f.start+f.count);for(let h=k,l=f;h<l;h++)f=g.getX(h),Uf.fromBufferAttribute(c,f),xi(Uf,f,e,d,a,b,this)}else{g=Math.max(0,f.start);f=Math.min(c.count,f.start+f.count);for(let k=g,h=f;k<h;k++)Uf.fromBufferAttribute(c,k),xi(Uf,k,e,d,a,b,this)}}}updateMorphTargets(){var a=this.geometry.morphAttributes,b=Object.keys(a);if(0<
b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let c=0,d=a.length;c<d;c++)b=a[c].name||String(c),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=c}}}class Dm extends cc{constructor(a,b,c,d,e,f,g,k,h){function l(){n.needsUpdate=!0;a.requestVideoFrameCallback(l)}super(a,b,c,d,e,f,g,k,h);this.isVideoTexture=!0;this.minFilter=void 0!==f?f:1006;this.magFilter=void 0!==e?e:1006;this.generateMipmaps=!1;const n=this;"requestVideoFrameCallback"in
a&&a.requestVideoFrameCallback(l)}clone(){return(new this.constructor(this.image)).copy(this)}update(){const a=this.image;!1==="requestVideoFrameCallback"in a&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Em extends cc{constructor(a,b){super({width:a,height:b});this.isFramebufferTexture=!0;this.minFilter=this.magFilter=1003;this.generateMipmaps=!1;this.needsUpdate=!0}}class Vf extends cc{constructor(a,b,c,d,e,f,g,k,h,l,n,m){super(null,f,g,k,h,l,d,e,n,m);this.isCompressedTexture=
!0;this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}}class Fm extends Vf{constructor(a,b,c,d,e,f){super(a,b,c,e,f);this.isCompressedArrayTexture=!0;this.image.depth=d;this.wrapR=1001}}class Gm extends Vf{constructor(a,b,c){super(void 0,a[0].width,a[0].height,b,c,301);this.isCubeTexture=this.isCompressedCubeTexture=!0;this.image=a}}class Hm extends cc{constructor(a,b,c,d,e,f,g,k,h){super(a,b,c,d,e,f,g,k,h);this.needsUpdate=this.isCanvasTexture=!0}}class Wc{constructor(){this.type=
"Curve";this.arcLengthDivisions=200}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.");return null}getPointAt(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)}getPoints(a=5){const b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return b}getSpacedPoints(a=5){const b=[];for(let c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===
a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const b=[];let c,d=this.getPoint(0),e=0;b.push(0);for(let f=1;f<=a;f++)c=this.getPoint(f/a),e+=c.distanceTo(d),b.push(e),d=c;return this.cacheArcLengths=b}updateArcLengths(){this.needsUpdate=!0;this.getLengths()}getUtoTmapping(a,b){const c=this.getLengths(),d=c.length;b=b?b:a*c[d-1];var e=0;let f=d-1,g;for(;e<=f;)if(a=Math.floor(e+(f-e)/2),g=c[a]-b,0>g)e=a+1;else if(0<g)f=a-1;else{f=a;break}a=f;if(c[a]===b)return a/(d-1);e=c[a];
return(a+(b-e)/(c[a+1]-e))/(d-1)}getTangent(a,b){var c=a-1E-4;a+=1E-4;0>c&&(c=0);1<a&&(a=1);c=this.getPoint(c);a=this.getPoint(a);b=b||(c.isVector2?new xa:new I);b.copy(a).sub(c).normalize();return b}getTangentAt(a,b){a=this.getUtoTmapping(a);return this.getTangent(a,b)}computeFrenetFrames(a,b){var c=new I;const d=[],e=[],f=[];var g=new I;const k=new lb;for(var h=0;h<=a;h++)d[h]=this.getTangentAt(h/a,new I);e[0]=new I;f[0]=new I;h=Number.MAX_VALUE;const l=Math.abs(d[0].x),n=Math.abs(d[0].y),m=Math.abs(d[0].z);
l<=h&&(h=l,c.set(1,0,0));n<=h&&(h=n,c.set(0,1,0));m<=h&&c.set(0,0,1);g.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],g);f[0].crossVectors(d[0],e[0]);for(c=1;c<=a;c++)e[c]=e[c-1].clone(),f[c]=f[c-1].clone(),g.crossVectors(d[c-1],d[c]),g.length()>Number.EPSILON&&(g.normalize(),h=Math.acos(ib(d[c-1].dot(d[c]),-1,1)),e[c].applyMatrix4(k.makeRotationAxis(g,h))),f[c].crossVectors(d[c],e[c]);if(!0===b)for(b=Math.acos(ib(e[0].dot(e[a]),-1,1)),b/=a,0<d[0].dot(g.crossVectors(e[0],e[a]))&&(b=-b),g=
1;g<=a;g++)e[g].applyMatrix4(k.makeRotationAxis(d[g],b*g)),f[g].crossVectors(d[g],e[g]);return{tangents:d,normals:e,binormals:f}}clone(){return(new this.constructor).copy(this)}copy(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}toJSON(){const a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a}fromJSON(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}}class Wf extends Wc{constructor(a=0,b=
0,c=1,d=1,e=0,f=2*Math.PI,g=!1,k=0){super();this.isEllipseCurve=!0;this.type="EllipseCurve";this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=e;this.aEndAngle=f;this.aClockwise=g;this.aRotation=k}getPoint(a,b=new xa){for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==this.aClockwise||e||(d=d===c?-c:d-c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);
0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,f)}copy(a){super.copy(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this}toJSON(){const a=super.toJSON();a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;
a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a}fromJSON(a){super.fromJSON(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this}}class Mj extends Wf{constructor(a,b,c,d,e,f){super(a,b,c,c,d,e,f);this.isArcCurve=!0;this.type="ArcCurve"}}const Xf=new I,qh=new xg,rh=new xg,sh=new xg;class Nj extends Wc{constructor(a=
[],b=!1,c="centripetal",d=.5){super();this.isCatmullRomCurve3=!0;this.type="CatmullRomCurve3";this.points=a;this.closed=b;this.curveType=c;this.tension=d}getPoint(a,b=new I){var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e=Math.floor(a);a-=e;this.closed?e+=0<e?0:(Math.floor(Math.abs(e)/d)+1)*d:0===a&&e===d-1&&(e=d-2,a=1);let f;this.closed||0<e?f=c[(e-1)%d]:(Xf.subVectors(c[0],c[1]).add(c[0]),f=Xf);const g=c[e%d],k=c[(e+1)%d];this.closed||e+2<d?c=c[(e+2)%d]:(Xf.subVectors(c[d-1],c[d-2]).add(c[d-
1]),c=Xf);if("centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25;d=Math.pow(f.distanceToSquared(g),h);e=Math.pow(g.distanceToSquared(k),h);h=Math.pow(k.distanceToSquared(c),h);1E-4>e&&(e=1);1E-4>d&&(d=e);1E-4>h&&(h=e);qh.initNonuniformCatmullRom(f.x,g.x,k.x,c.x,d,e,h);rh.initNonuniformCatmullRom(f.y,g.y,k.y,c.y,d,e,h);sh.initNonuniformCatmullRom(f.z,g.z,k.z,c.z,d,e,h)}else"catmullrom"===this.curveType&&(qh.initCatmullRom(f.x,g.x,k.x,c.x,this.tension),
rh.initCatmullRom(f.y,g.y,k.y,c.y,this.tension),sh.initCatmullRom(f.z,g.z,k.z,c.z,this.tension));b.set(qh.calc(a),rh.calc(a),sh.calc(a));return b}copy(a){super.copy(a);this.points=[];for(let b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this}toJSON(){const a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;
a.tension=this.tension;return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let b=0,c=a.points.length;b<c;b++){const d=a.points[b];this.points.push((new I).fromArray(d))}this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this}}class th extends Wc{constructor(a=new xa,b=new xa,c=new xa,d=new xa){super();this.isCubicBezierCurve=!0;this.type="CubicBezierCurve";this.v0=a;this.v1=b;this.v2=c;this.v3=d}getPoint(a,b=new xa){const c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set(He(a,
c.x,d.x,e.x,f.x),He(a,c.y,d.y,e.y,f.y));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class Oj extends Wc{constructor(a=new I,b=new I,c=new I,d=new I){super();
this.isCubicBezierCurve3=!0;this.type="CubicBezierCurve3";this.v0=a;this.v1=b;this.v2=c;this.v3=d}getPoint(a,b=new I){const c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set(He(a,c.x,d.x,e.x,f.x),He(a,c.y,d.y,e.y,f.y),He(a,c.z,d.z,e.z,f.z));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);
this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class uh extends Wc{constructor(a=new xa,b=new xa){super();this.isLineCurve=!0;this.type="LineCurve";this.v1=a;this.v2=b}getPoint(a,b=new xa){1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new xa){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,
b)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class Pj extends Wc{constructor(a=new I,b=new I){super();this.isLineCurve3=!0;this.type="LineCurve3";this.v1=a;this.v2=b}getPoint(a,b=new I){1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b}getPointAt(a,
b){return this.getPoint(a,b)}getTangent(a,b=new I){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class vh extends Wc{constructor(a=new xa,b=new xa,c=new xa){super();this.isQuadraticBezierCurve=!0;this.type=
"QuadraticBezierCurve";this.v0=a;this.v1=b;this.v2=c}getPoint(a,b=new xa){const c=this.v0,d=this.v1,e=this.v2;b.set(Ge(a,c.x,d.x,e.x),Ge(a,c.y,d.y,e.y));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class wh extends Wc{constructor(a=
new I,b=new I,c=new I){super();this.isQuadraticBezierCurve3=!0;this.type="QuadraticBezierCurve3";this.v0=a;this.v1=b;this.v2=c}getPoint(a,b=new I){const c=this.v0,d=this.v1,e=this.v2;b.set(Ge(a,c.x,d.x,e.x),Ge(a,c.y,d.y,e.y),Ge(a,c.z,d.z,e.z));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);
this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class xh extends Wc{constructor(a=[]){super();this.isSplineCurve=!0;this.type="SplineCurve";this.points=a}getPoint(a,b=new xa){var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;const e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];b.set(yi(d,e.x,f.x,g.x,c.x),yi(d,e.y,f.y,g.y,c.y));return b}copy(a){super.copy(a);this.points=[];for(let b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());
return this}toJSON(){const a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let b=0,c=a.points.length;b<c;b++){const d=a.points[b];this.points.push((new xa).fromArray(d))}return this}}var Yf=Object.freeze({__proto__:null,ArcCurve:Mj,CatmullRomCurve3:Nj,CubicBezierCurve:th,CubicBezierCurve3:Oj,EllipseCurve:Wf,LineCurve:uh,LineCurve3:Pj,QuadraticBezierCurve:vh,QuadraticBezierCurve3:wh,
SplineCurve:xh});class Qj extends Wc{constructor(){super();this.type="CurvePath";this.curves=[];this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Yf[!0===a.isVector2?"LineCurve":"LineCurve3"](b,a));return this}getPoint(a,b){var c=a*this.getLength(),d=this.getCurveLengths();for(a=0;a<d.length;){if(d[a]>=c)return c=d[a]-c,a=this.curves[a],d=a.getLength(),a.getPointAt(0===d?0:1-
c/d,b);a++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let b=0;for(let c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a}getSpacedPoints(a=40){const b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&
b.push(b[0]);return b}getPoints(a=12){const b=[];let c;for(let e=0,f=this.curves;e<f.length;e++){var d=f[e];d=d.getPoints(d.isEllipseCurve?2*a:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?a*d.points.length:a);for(let g=0;g<d.length;g++){const k=d[g];c&&c.equals(k)||(b.push(k),c=k)}}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b}copy(a){super.copy(a);this.curves=[];for(let b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;
return this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose;a.curves=[];for(let b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a}fromJSON(a){super.fromJSON(a);this.autoClose=a.autoClose;this.curves=[];for(let b=0,c=a.curves.length;b<c;b++){const d=a.curves[b];this.curves.push((new Yf[d.type]).fromJSON(d))}return this}}class $e extends Qj{constructor(a){super();this.type="Path";this.currentPoint=new xa;a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,
a[0].y);for(let b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y);return this}moveTo(a,b){this.currentPoint.set(a,b);return this}lineTo(a,b){const c=new uh(this.currentPoint.clone(),new xa(a,b));this.curves.push(c);this.currentPoint.set(a,b);return this}quadraticCurveTo(a,b,c,d){a=new vh(this.currentPoint.clone(),new xa(a,b),new xa(c,d));this.curves.push(a);this.currentPoint.set(c,d);return this}bezierCurveTo(a,b,c,d,e,f){a=new th(this.currentPoint.clone(),new xa(a,b),new xa(c,d),new xa(e,f));this.curves.push(a);
this.currentPoint.set(e,f);return this}splineThru(a){var b=[this.currentPoint.clone()].concat(a);b=new xh(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1]);return this}arc(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f);return this}absarc(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f);return this}ellipse(a,b,c,d,e,f,g,k){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,k);return this}absellipse(a,b,c,d,e,f,g,k){a=new Wf(a,b,c,d,e,f,g,k);0<
this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a);return this}copy(a){super.copy(a);this.currentPoint.copy(a.currentPoint);return this}toJSON(){const a=super.toJSON();a.currentPoint=this.currentPoint.toArray();return a}fromJSON(a){super.fromJSON(a);this.currentPoint.fromArray(a.currentPoint);return this}}class Zf extends tb{constructor(a=[new xa(0,-.5),new xa(.5,0),new xa(0,.5)],b=12,c=0,d=2*Math.PI){super();
this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b);d=ib(d,0,2*Math.PI);const e=[],f=[],g=[];var k=[];const h=[];var l=1/b,n=new I,m=new xa,p=new I,v=new I,t=new I;let x;for(let u=0;u<=a.length-1;u++)switch(u){case 0:var C=a[u+1].x-a[u].x;x=a[u+1].y-a[u].y;p.x=1*x;p.y=-C;p.z=0*x;t.copy(p);p.normalize();k.push(p.x,p.y,p.z);break;case a.length-1:k.push(t.x,t.y,t.z);break;default:C=a[u+1].x-a[u].x,x=a[u+1].y-a[u].y,p.x=1*x,p.y=-C,p.z=0*x,v.copy(p),p.x+=
t.x,p.y+=t.y,p.z+=t.z,p.normalize(),k.push(p.x,p.y,p.z),t.copy(v)}for(p=0;p<=b;p++)for(t=c+p*l*d,v=Math.sin(t),t=Math.cos(t),C=0;C<=a.length-1;C++)n.x=a[C].x*v,n.y=a[C].y,n.z=a[C].x*t,f.push(n.x,n.y,n.z),m.x=p/b,m.y=C/(a.length-1),g.push(m.x,m.y),h.push(k[3*C]*v,k[3*C+1],k[3*C]*t);for(c=0;c<b;c++)for(d=0;d<a.length-1;d++)k=d+c*a.length,l=k+a.length,n=k+a.length+1,m=k+1,e.push(k,l,m),e.push(n,m,l);this.setIndex(e);this.setAttribute("position",new eb(f,3));this.setAttribute("uv",new eb(g,2));this.setAttribute("normal",
new eb(h,3))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Zf(a.points,a.segments,a.phiStart,a.phiLength)}}class yh extends Zf{constructor(a=1,b=1,c=4,d=8){const e=new $e;e.absarc(0,-b/2,a,1.5*Math.PI,0);e.absarc(0,b/2,a,0,.5*Math.PI);super(e.getPoints(c),d);this.type="CapsuleGeometry";this.parameters={radius:a,length:b,capSegments:c,radialSegments:d}}static fromJSON(a){return new yh(a.radius,a.length,a.capSegments,a.radialSegments)}}
class zh extends tb{constructor(a=1,b=32,c=0,d=2*Math.PI){super();this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};b=Math.max(3,b);const e=[],f=[],g=[],k=[],h=new I,l=new xa;f.push(0,0,0);g.push(0,0,1);k.push(.5,.5);for(let n=0,m=3;n<=b;n++,m+=3){const p=c+n/b*d;h.x=a*Math.cos(p);h.y=a*Math.sin(p);f.push(h.x,h.y,h.z);g.push(0,0,1);l.x=(f[m]/a+1)/2;l.y=(f[m+1]/a+1)/2;k.push(l.x,l.y)}for(a=1;a<=b;a++)e.push(a,a+1,0);this.setIndex(e);this.setAttribute("position",
new eb(f,3));this.setAttribute("normal",new eb(g,3));this.setAttribute("uv",new eb(k,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new zh(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class af extends tb{constructor(a=1,b=1,c=1,d=32,e=1,f=!1,g=0,k=2*Math.PI){function h(D){const aa=t;var J=new xa,K=new I;let U=0;var W=!0===D?a:b;const R=!0===D?1:-1;for(var fa=1;fa<=d;fa++)m.push(0,C*R,0),p.push(0,R,0),v.push(.5,.5),t++;fa=t;for(let na=
0;na<=d;na++){var ea=na/d*k+g;const Ea=Math.cos(ea);ea=Math.sin(ea);K.x=W*ea;K.y=C*R;K.z=W*Ea;m.push(K.x,K.y,K.z);p.push(0,R,0);J.x=.5*Ea+.5;J.y=.5*ea*R+.5;v.push(J.x,J.y);t++}for(J=0;J<d;J++)K=aa+J,W=fa+J,!0===D?n.push(W,W+1,K):n.push(W+1,W,K),U+=3;l.addGroup(u,U,!0===D?1:2);u+=U}super();this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:k};const l=this;d=Math.floor(d);e=Math.floor(e);const n=[],
m=[],p=[],v=[];let t=0;const x=[],C=c/2;let u=0;(function(){var D=new I,aa=new I;let J=0;var K=(b-a)/c;for(var U=0;U<=e;U++){var W=[];const fa=U/e,ea=fa*(b-a)+a;for(let na=0;na<=d;na++){const Ea=na/d;var R=Ea*k+g;const ca=Math.sin(R);R=Math.cos(R);aa.x=ea*ca;aa.y=-fa*c+C;aa.z=ea*R;m.push(aa.x,aa.y,aa.z);D.set(ca,K,R).normalize();p.push(D.x,D.y,D.z);v.push(Ea,1-fa);W.push(t++)}x.push(W)}for(D=0;D<d;D++)for(aa=0;aa<e;aa++)K=x[aa+1][D],U=x[aa+1][D+1],W=x[aa][D+1],n.push(x[aa][D],K,W),n.push(K,U,W),J+=
6;l.addGroup(u,J,0);u+=J})();!1===f&&(0<a&&h(!0),0<b&&h(!1));this.setIndex(n);this.setAttribute("position",new eb(m,3));this.setAttribute("normal",new eb(p,3));this.setAttribute("uv",new eb(v,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new af(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Ah extends af{constructor(a=1,b=1,c=32,d=1,e=!1,f=0,g=2*Math.PI){super(0,a,
b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}static fromJSON(a){return new Ah(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Td extends tb{constructor(a=[],b=[],c=1,d=0){function e(l){k.push(l.x,l.y,l.z)}function f(l,n){l*=3;n.x=a[l+0];n.y=a[l+1];n.z=a[l+2]}function g(l,n,m,p){0>p&&1===l.x&&(h[n]=l.x-1);0===m.x&&0===m.z&&(h[n]=p/2/Math.PI+.5)}super();
this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};const k=[],h=[];(function(l){const n=new I,m=new I,p=new I;for(let C=0;C<b.length;C+=3){f(b[C+0],n);f(b[C+1],m);f(b[C+2],p);const u=l+1,D=[];for(var v=0;v<=u;v++){D[v]=[];var t=n.clone().lerp(p,v/u),x=m.clone().lerp(p,v/u);const aa=u-v;for(let J=0;J<=aa;J++)D[v][J]=0===J&&v===u?t:t.clone().lerp(x,J/aa)}for(v=0;v<u;v++)for(t=0;t<2*(u-v)-1;t++)x=Math.floor(t/2),0===t%2?(e(D[v][x+1]),e(D[v+1][x]),e(D[v][x])):(e(D[v][x+
1]),e(D[v+1][x+1]),e(D[v+1][x]))}})(d);(function(l){const n=new I;for(let m=0;m<k.length;m+=3)n.x=k[m+0],n.y=k[m+1],n.z=k[m+2],n.normalize().multiplyScalar(l),k[m+0]=n.x,k[m+1]=n.y,k[m+2]=n.z})(c);(function(){var l=new I;for(var n=0;n<k.length;n+=3)l.x=k[n+0],l.y=k[n+1],l.z=k[n+2],h.push(Math.atan2(l.z,-l.x)/2/Math.PI+.5,1-(Math.atan2(-l.y,Math.sqrt(l.x*l.x+l.z*l.z))/Math.PI+.5));l=new I;n=new I;var m=new I,p=new I,v=new xa;const t=new xa,x=new xa;for(let C=0,u=0;C<k.length;C+=9,u+=6){l.set(k[C+0],
k[C+1],k[C+2]);n.set(k[C+3],k[C+4],k[C+5]);m.set(k[C+6],k[C+7],k[C+8]);v.set(h[u+0],h[u+1]);t.set(h[u+2],h[u+3]);x.set(h[u+4],h[u+5]);p.copy(l).add(n).add(m).divideScalar(3);const D=Math.atan2(p.z,-p.x);g(v,u+0,l,D);g(t,u+2,n,D);g(x,u+4,m,D)}for(l=0;l<h.length;l+=6)n=h[l+0],m=h[l+2],p=h[l+4],v=Math.min(n,m,p),.9<Math.max(n,m,p)&&.1>v&&(.2>n&&(h[l+0]+=1),.2>m&&(h[l+2]+=1),.2>p&&(h[l+4]+=1))})();this.setAttribute("position",new eb(k,3));this.setAttribute("normal",new eb(k.slice(),3));this.setAttribute("uv",
new eb(h,2));0===d?this.computeVertexNormals():this.normalizeNormals()}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Td(a.vertices,a.indices,a.radius,a.details)}}class Bh extends Td{constructor(a=1,b=0){const c=(1+Math.sqrt(5))/2,d=1/c;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,
4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new Bh(a.radius,a.detail)}}const $f=new I,ag=new I,Ch=new I,bg=new Gc;class Rj extends tb{constructor(a=null,b=1){super();this.type="EdgesGeometry";this.parameters={geometry:a,thresholdAngle:b};
if(null!==a){const d=Math.pow(10,4);b=Math.cos(Kd*b);const e=a.getIndex();a=a.getAttribute("position");const f=e?e.count:a.count,g=[0,0,0],k=["a","b","c"],h=Array(3),l={},n=[];for(let m=0;m<f;m+=3){e?(g[0]=e.getX(m),g[1]=e.getX(m+1),g[2]=e.getX(m+2)):(g[0]=m,g[1]=m+1,g[2]=m+2);const {a:p,b:v,c:t}=bg;p.fromBufferAttribute(a,g[0]);v.fromBufferAttribute(a,g[1]);t.fromBufferAttribute(a,g[2]);bg.getNormal(Ch);h[0]=`${Math.round(p.x*d)},${Math.round(p.y*d)},${Math.round(p.z*d)}`;h[1]=`${Math.round(v.x*
d)},${Math.round(v.y*d)},${Math.round(v.z*d)}`;h[2]=`${Math.round(t.x*d)},${Math.round(t.y*d)},${Math.round(t.z*d)}`;if(h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let x=0;3>x;x++){const C=(x+1)%3;var c=h[x];const u=h[C],D=bg[k[x]],aa=bg[k[C]],J=`${c}_${u}`;c=`${u}_${c}`;c in l&&l[c]?(Ch.dot(l[c].normal)<=b&&(n.push(D.x,D.y,D.z),n.push(aa.x,aa.y,aa.z)),l[c]=null):J in l||(l[J]={index0:g[x],index1:g[C],normal:Ch.clone()})}}for(const m in l)if(l[m]){const {index0:p,index1:v}=l[m];$f.fromBufferAttribute(a,
p);ag.fromBufferAttribute(a,v);n.push($f.x,$f.y,$f.z);n.push(ag.x,ag.y,ag.z)}this.setAttribute("position",new eb(n,3))}}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}}class Ud extends $e{constructor(a){super(a);this.uuid=pa();this.type="Shape";this.holes=[]}getPointsHoles(a){const b=[];for(let c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a);
this.holes=[];for(let b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid;a.holes=[];for(let b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a}fromJSON(a){super.fromJSON(a);this.uuid=a.uuid;this.holes=[];for(let b=0,c=a.holes.length;b<c;b++){const d=a.holes[b];this.holes.push((new $e).fromJSON(d))}return this}}const Im={triangulate:function(a,b,c=2){var d=b&&b.length;const e=d?b[0]*c:a.length;var f=
zi(a,0,e,c,!0);const g=[];if(!f||f.next===f.prev)return g;let k,h;var l;if(d){var n=f;f=[];var m;d=0;for(m=b.length;d<m;d++){var p=b[d]*c;var v=d<m-1?b[d+1]*c:a.length;var t=zi(a,p,v,c,!1);t===t.next&&(t.steiner=!0);p=f;v=p.push;var x=t,C=t;do{if(x.x<C.x||x.x===C.x&&x.y<C.y)C=x;x=x.next}while(x!==t);v.call(p,C)}f.sort(Nl);for(d=0;d<f.length;d++){m=void 0;b=f[d];b:{p=n;v=-Infinity;t=b.x;x=b.y;do{if(x<=p.y&&x>=p.next.y&&p.next.y!==p.y&&(C=p.x+(x-p.y)*(p.next.x-p.x)/(p.next.y-p.y),C<=t&&C>v&&(v=C,m=
p.x<p.next.x?p:p.next,C===t)))break b;p=p.next}while(p!==n);if(m){var u=m,D=m.x,aa=m.y,J=Infinity;p=m;do{if(t>=p.x&&p.x>=D&&t!==p.x&&ee(x<aa?t:v,x,D,aa,x<aa?v:t,x,p.x,p.y)){C=Math.abs(x-p.y)/(t-p.x);var K;if((K=Ke(p,b))&&!(K=C<J)&&(K=C===J)&&!(K=p.x>m.x)&&(K=p.x===m.x)){K=m;var U=p;K=0>Yb(K.prev,K,U.prev)&&0>Yb(U.next,K,K.next)}K&&(m=p,J=C)}p=p.next}while(p!==u)}else m=null}m&&(b=Ci(m,b),Gd(b,b.next),n=Gd(m,m.next))}f=n}if(a.length>80*c){k=l=a[0];h=d=a[1];for(m=c;m<e;m+=c)b=a[m],n=a[m+1],b<k&&(k=
b),n<h&&(h=n),b>l&&(l=b),n>d&&(d=n);l=Math.max(l-k,d-h);l=0!==l?32767/l:0}Je(f,g,c,k,h,l,0);return g}};class kd{static area(a){const b=a.length;let c=0;for(let d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c}static isClockWise(a){return 0>kd.area(a)}static triangulateShape(a,b){var c=[];const d=[],e=[];Di(a);Ei(c,a);a=a.length;b.forEach(Di);for(let f=0;f<b.length;f++)d.push(a),a+=b[f].length,Ei(c,b[f]);b=Im.triangulate(c,d);for(c=0;c<b.length;c+=3)e.push(b.slice(c,c+3));return e}}class Dh extends tb{constructor(a=
new Ud([new xa(.5,.5),new xa(-.5,.5),new xa(-.5,-.5),new xa(.5,-.5)]),b={}){function c(g){function k(E,O,M){O||console.error("THREE.ExtrudeGeometry: vec does not exist");return E.clone().addScaledVector(O,M)}function h(E,O,M){var ra=E.x-O.x;var Pa=E.y-O.y;var Fa=M.x-E.x;var oa=M.y-E.y,H=ra*ra+Pa*Pa;if(Math.abs(ra*oa-Pa*Fa)>Number.EPSILON){const sa=Math.sqrt(H),ia=Math.sqrt(Fa*Fa+oa*oa);H=O.x-Pa/sa;O=O.y+ra/sa;oa=((M.x-oa/ia-H)*oa-(M.y+Fa/ia-O)*Fa)/(ra*oa-Pa*Fa);Fa=H+ra*oa-E.x;ra=O+Pa*oa-E.y;Pa=Fa*
Fa+ra*ra;if(2>=Pa)return new xa(Fa,ra);Pa=Math.sqrt(Pa/2)}else E=!1,ra>Number.EPSILON?Fa>Number.EPSILON&&(E=!0):ra<-Number.EPSILON?Fa<-Number.EPSILON&&(E=!0):Math.sign(Pa)===Math.sign(oa)&&(E=!0),E?(Fa=-Pa,Pa=Math.sqrt(H)):(Fa=ra,ra=Pa,Pa=Math.sqrt(H/2));return new xa(Fa/Pa,ra/Pa)}function l(E,O){let M=E.length;for(;0<=--M;){const Fa=M;let oa=M-1;0>oa&&(oa=E.length-1);for(let H=0,sa=C+2*U;H<sa;H++){var ra=$a*H,Pa=$a*(H+1);const ia=O+oa+ra,Ka=O+oa+Pa;Pa=O+Fa+Pa;p(O+Fa+ra);p(ia);p(Pa);p(ia);p(Ka);p(Pa);
ra=e.length/3;ra=R.generateSideWallUV(d,e,ra-6,ra-3,ra-2,ra-1);v(ra[0]);v(ra[1]);v(ra[3]);v(ra[1]);v(ra[2]);v(ra[3])}}}function n(E,O,M){t.push(E);t.push(O);t.push(M)}function m(E,O,M){p(E);p(O);p(M);E=e.length/3;E=R.generateTopUV(d,e,E-3,E-2,E-1);v(E[0]);v(E[1]);v(E[2])}function p(E){e.push(t[3*E]);e.push(t[3*E+1]);e.push(t[3*E+2])}function v(E){f.push(E.x);f.push(E.y)}const t=[];var x=void 0!==b.curveSegments?b.curveSegments:12;const C=void 0!==b.steps?b.steps:1,u=void 0!==b.depth?b.depth:1;let D=
void 0!==b.bevelEnabled?b.bevelEnabled:!0,aa=void 0!==b.bevelThickness?b.bevelThickness:.2,J=void 0!==b.bevelSize?b.bevelSize:aa-.1,K=void 0!==b.bevelOffset?b.bevelOffset:0,U=void 0!==b.bevelSegments?b.bevelSegments:3;var W=b.extrudePath;const R=void 0!==b.UVGenerator?b.UVGenerator:Jm;let fa,ea=!1;if(W){fa=W.getSpacedPoints(C);ea=!0;D=!1;var na=W.computeFrenetFrames(C,!1);var Ea=new I;var ca=new I;var Ga=new I}D||(K=J=aa=U=0);g=g.extractPoints(x);W=g.shape;const ta=g.holes;if(!kd.isClockWise(W)){W=
W.reverse();for(let E=0,O=ta.length;E<O;E++)g=ta[E],kd.isClockWise(g)&&(ta[E]=g.reverse())}const Sa=kd.triangulateShape(W,ta),cb=W;for(let E=0,O=ta.length;E<O;E++)W=W.concat(ta[E]);const $a=W.length,Ha=Sa.length;g=[];for(let E=0,O=cb.length,M=O-1,ra=E+1;E<O;E++,M++,ra++)M===O&&(M=0),ra===O&&(ra=0),g[E]=h(cb[E],cb[M],cb[ra]);x=[];let Ba=g.concat();for(let E=0,O=ta.length;E<O;E++){var Ia=ta[E];var Xa=[];for(let M=0,ra=Ia.length,Pa=ra-1,Fa=M+1;M<ra;M++,Pa++,Fa++)Pa===ra&&(Pa=0),Fa===ra&&(Fa=0),Xa[M]=
h(Ia[M],Ia[Pa],Ia[Fa]);x.push(Xa);Ba=Ba.concat(Xa)}for(Ia=0;Ia<U;Ia++){Xa=Ia/U;var z=aa*Math.cos(Xa*Math.PI/2),A=J*Math.sin(Xa*Math.PI/2)+K;for(let E=0,O=cb.length;E<O;E++)Xa=k(cb[E],g[E],A),n(Xa.x,Xa.y,-z);for(let E=0,O=ta.length;E<O;E++){const M=ta[E];Xa=x[E];for(let ra=0,Pa=M.length;ra<Pa;ra++){const Fa=k(M[ra],Xa[ra],A);n(Fa.x,Fa.y,-z)}}}Xa=J+K;for(Ia=0;Ia<$a;Ia++)z=D?k(W[Ia],Ba[Ia],Xa):W[Ia],ea?(ca.copy(na.normals[0]).multiplyScalar(z.x),Ea.copy(na.binormals[0]).multiplyScalar(z.y),Ga.copy(fa[0]).add(ca).add(Ea),
n(Ga.x,Ga.y,Ga.z)):n(z.x,z.y,0);for(Ia=1;Ia<=C;Ia++)for(z=0;z<$a;z++)A=D?k(W[z],Ba[z],Xa):W[z],ea?(ca.copy(na.normals[Ia]).multiplyScalar(A.x),Ea.copy(na.binormals[Ia]).multiplyScalar(A.y),Ga.copy(fa[Ia]).add(ca).add(Ea),n(Ga.x,Ga.y,Ga.z)):n(A.x,A.y,u/C*Ia);for(na=U-1;0<=na;na--){ca=na/U;Ea=aa*Math.cos(ca*Math.PI/2);ca=J*Math.sin(ca*Math.PI/2)+K;for(let E=0,O=cb.length;E<O;E++)Ga=k(cb[E],g[E],ca),n(Ga.x,Ga.y,u+Ea);for(let E=0,O=ta.length;E<O;E++){Ga=ta[E];Xa=x[E];for(let M=0,ra=Ga.length;M<ra;M++)W=
k(Ga[M],Xa[M],ca),ea?n(W.x,W.y+fa[C-1].y,fa[C-1].x+Ea):n(W.x,W.y,u+Ea)}}(function(){const E=e.length/3;if(D){var O=0*$a;for(var M=0;M<Ha;M++){var ra=Sa[M];m(ra[2]+O,ra[1]+O,ra[0]+O)}O=$a*(C+2*U);for(M=0;M<Ha;M++)ra=Sa[M],m(ra[0]+O,ra[1]+O,ra[2]+O)}else{for(O=0;O<Ha;O++)M=Sa[O],m(M[2],M[1],M[0]);for(O=0;O<Ha;O++)M=Sa[O],m(M[0]+$a*C,M[1]+$a*C,M[2]+$a*C)}d.addGroup(E,e.length/3-E,0)})();(function(){const E=e.length/3;let O=0;l(cb,O);O+=cb.length;for(let M=0,ra=ta.length;M<ra;M++){const Pa=ta[M];l(Pa,
O);O+=Pa.length}d.addGroup(E,e.length/3-E,1)})()}super();this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];const d=this,e=[],f=[];for(let g=0,k=a.length;g<k;g++)c(a[g]);this.setAttribute("position",new eb(e,3));this.setAttribute("uv",new eb(f,2));this.computeVertexNormals()}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),b=this.parameters.shapes,c=this.parameters.options;a.shapes=[];if(Array.isArray(b))for(let d=
0,e=b.length;d<e;d++)a.shapes.push(b[d].uuid);else a.shapes.push(b.uuid);a.options=Object.assign({},c);void 0!==c.extrudePath&&(a.options.extrudePath=c.extrudePath.toJSON());return a}static fromJSON(a,b){const c=[];for(let d=0,e=a.shapes.length;d<e;d++)c.push(b[a.shapes[d]]);b=a.options.extrudePath;void 0!==b&&(a.options.extrudePath=(new Yf[b.type]).fromJSON(b));return new Dh(c,a.options)}}const Jm={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];const f=b[3*e];e=b[3*e+1];return[new xa(b[3*
c],b[3*c+1]),new xa(a,d),new xa(f,e)]},generateSideWallUV:function(a,b,c,d,e,f){a=b[3*c];const g=b[3*c+1];c=b[3*c+2];const k=b[3*d],h=b[3*d+1];d=b[3*d+2];const l=b[3*e],n=b[3*e+1];e=b[3*e+2];const m=b[3*f],p=b[3*f+1];b=b[3*f+2];return Math.abs(g-h)<Math.abs(a-k)?[new xa(a,1-c),new xa(k,1-d),new xa(l,1-e),new xa(m,1-b)]:[new xa(g,1-c),new xa(h,1-d),new xa(n,1-e),new xa(p,1-b)]}};class Eh extends Td{constructor(a=1,b=0){const c=(1+Math.sqrt(5))/2;super([-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,
-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new Eh(a.radius,a.detail)}}class cg extends Td{constructor(a=1,b=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new cg(a.radius,
a.detail)}}class Fh extends tb{constructor(a=.5,b=1,c=32,d=1,e=0,f=2*Math.PI){super();this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};c=Math.max(3,c);d=Math.max(1,d);const g=[],k=[],h=[],l=[];var n=a;a=(b-a)/d;var m=new I,p=new xa;for(let v=0;v<=d;v++){for(let t=0;t<=c;t++){const x=e+t/c*f;m.x=n*Math.cos(x);m.y=n*Math.sin(x);k.push(m.x,m.y,m.z);h.push(0,0,1);p.x=(m.x/b+1)/2;p.y=(m.y/b+1)/2;l.push(p.x,p.y)}n+=a}for(b=0;b<
d;b++)for(e=b*(c+1),f=0;f<c;f++)n=f+e,a=n+c+1,m=n+c+2,p=n+1,g.push(n,a,p),g.push(a,m,p);this.setIndex(g);this.setAttribute("position",new eb(k,3));this.setAttribute("normal",new eb(h,3));this.setAttribute("uv",new eb(l,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Fh(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}class Gh extends tb{constructor(a=new Ud([new xa(0,.5),new xa(-.5,-.5),new xa(.5,
-.5)]),b=12){function c(l){const n=e.length/3;var m=l.extractPoints(b);l=m.shape;var p=m.holes;!1===kd.isClockWise(l)&&(l=l.reverse());for(let v=0,t=p.length;v<t;v++)m=p[v],!0===kd.isClockWise(m)&&(p[v]=m.reverse());m=kd.triangulateShape(l,p);for(let v=0,t=p.length;v<t;v++)l=l.concat(p[v]);for(let v=0,t=l.length;v<t;v++)p=l[v],e.push(p.x,p.y,0),f.push(0,0,1),g.push(p.x,p.y);for(let v=0,t=m.length;v<t;v++)l=m[v],d.push(l[0]+n,l[1]+n,l[2]+n),h+=3}super();this.type="ShapeGeometry";this.parameters={shapes:a,
curveSegments:b};const d=[],e=[],f=[],g=[];let k=0,h=0;if(!1===Array.isArray(a))c(a);else for(let l=0;l<a.length;l++)c(a[l]),this.addGroup(k,h,l),k+=h,h=0;this.setIndex(d);this.setAttribute("position",new eb(e,3));this.setAttribute("normal",new eb(f,3));this.setAttribute("uv",new eb(g,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),b=this.parameters.shapes;a.shapes=[];if(Array.isArray(b))for(let c=0,d=b.length;c<d;c++)a.shapes.push(b[c].uuid);
else a.shapes.push(b.uuid);return a}static fromJSON(a,b){const c=[];for(let d=0,e=a.shapes.length;d<e;d++)c.push(b[a.shapes[d]]);return new Gh(c,a.curveSegments)}}class dg extends tb{constructor(a=1,b=32,c=16,d=0,e=2*Math.PI,f=0,g=Math.PI){super();this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};b=Math.max(3,Math.floor(b));c=Math.max(2,Math.floor(c));const k=Math.min(f+g,Math.PI);var h=0;const l=[];var n=new I;
const m=new I,p=[],v=[],t=[],x=[];for(let C=0;C<=c;C++){const u=[],D=C/c;let aa=0;0===C&&0===f?aa=.5/b:C===c&&k===Math.PI&&(aa=-.5/b);for(let J=0;J<=b;J++){const K=J/b;n.x=-a*Math.cos(d+K*e)*Math.sin(f+D*g);n.y=a*Math.cos(f+D*g);n.z=a*Math.sin(d+K*e)*Math.sin(f+D*g);v.push(n.x,n.y,n.z);m.copy(n).normalize();t.push(m.x,m.y,m.z);x.push(K+aa,1-D);u.push(h++)}l.push(u)}for(a=0;a<c;a++)for(d=0;d<b;d++)e=l[a][d+1],g=l[a][d],h=l[a+1][d],n=l[a+1][d+1],(0!==a||0<f)&&p.push(e,g,n),(a!==c-1||k<Math.PI)&&p.push(g,
h,n);this.setIndex(p);this.setAttribute("position",new eb(v,3));this.setAttribute("normal",new eb(t,3));this.setAttribute("uv",new eb(x,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new dg(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class Hh extends Td{constructor(a=1,b=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronGeometry";this.parameters=
{radius:a,detail:b}}static fromJSON(a){return new Hh(a.radius,a.detail)}}class Ih extends tb{constructor(a=1,b=.4,c=12,d=48,e=2*Math.PI){super();this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};c=Math.floor(c);d=Math.floor(d);const f=[],g=[],k=[],h=[];var l=new I,n=new I;const m=new I;for(let p=0;p<=c;p++)for(let v=0;v<=d;v++){const t=v/d*e,x=p/c*Math.PI*2;n.x=(a+b*Math.cos(x))*Math.cos(t);n.y=(a+b*Math.cos(x))*Math.sin(t);n.z=b*Math.sin(x);g.push(n.x,
n.y,n.z);l.x=a*Math.cos(t);l.y=a*Math.sin(t);m.subVectors(n,l).normalize();k.push(m.x,m.y,m.z);h.push(v/d);h.push(p/c)}for(a=1;a<=c;a++)for(b=1;b<=d;b++)e=(d+1)*(a-1)+b-1,l=(d+1)*(a-1)+b,n=(d+1)*a+b,f.push((d+1)*a+b-1,e,n),f.push(e,l,n);this.setIndex(f);this.setAttribute("position",new eb(g,3));this.setAttribute("normal",new eb(k,3));this.setAttribute("uv",new eb(h,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Ih(a.radius,a.tube,
a.radialSegments,a.tubularSegments,a.arc)}}class Jh extends tb{constructor(a=1,b=.4,c=64,d=8,e=2,f=3){function g(J,K,U,W,R){const fa=Math.sin(J);K=U/K*J;U=Math.cos(K);R.x=W*(2+U)*.5*Math.cos(J);R.y=W*(2+U)*fa*.5;R.z=W*Math.sin(K)*.5}super();this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};c=Math.floor(c);d=Math.floor(d);const k=[],h=[],l=[],n=[];var m=new I;const p=new I,v=new I,t=new I,x=new I,C=new I,u=new I;for(let J=0;J<=c;++J){var D=J/
c*e*Math.PI*2;g(D,e,f,a,v);g(D+.01,e,f,a,t);C.subVectors(t,v);u.addVectors(t,v);x.crossVectors(C,u);u.crossVectors(x,C);x.normalize();u.normalize();for(D=0;D<=d;++D){var aa=D/d*Math.PI*2;const K=-b*Math.cos(aa);aa=b*Math.sin(aa);m.x=v.x+(K*u.x+aa*x.x);m.y=v.y+(K*u.y+aa*x.y);m.z=v.z+(K*u.z+aa*x.z);h.push(m.x,m.y,m.z);p.subVectors(m,v).normalize();l.push(p.x,p.y,p.z);n.push(J/c);n.push(D/d)}}for(a=1;a<=c;a++)for(b=1;b<=d;b++)e=(d+1)*a+(b-1),f=(d+1)*a+b,m=(d+1)*(a-1)+b,k.push((d+1)*(a-1)+(b-1),e,m),
k.push(e,f,m);this.setIndex(k);this.setAttribute("position",new eb(h,3));this.setAttribute("normal",new eb(l,3));this.setAttribute("uv",new eb(n,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Jh(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)}}class Kh extends tb{constructor(a=new wh(new I(-1,-1,0),new I(-1,1,0),new I(1,1,0)),b=64,c=1,d=8,e=!1){function f(x){n=a.getPointAt(x/b,n);const C=g.normals[x];x=g.binormals[x];
for(let D=0;D<=d;D++){var u=D/d*Math.PI*2;const aa=Math.sin(u);u=-Math.cos(u);h.x=u*C.x+aa*x.x;h.y=u*C.y+aa*x.y;h.z=u*C.z+aa*x.z;h.normalize();p.push(h.x,h.y,h.z);k.x=n.x+c*h.x;k.y=n.y+c*h.y;k.z=n.z+c*h.z;m.push(k.x,k.y,k.z)}}super();this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};const g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;this.binormals=g.binormals;const k=new I,h=new I,l=new xa;let n=new I;const m=[],
p=[],v=[],t=[];(function(){for(var x=0;x<b;x++)f(x);f(!1===e?b:0);for(x=0;x<=b;x++)for(var C=0;C<=d;C++)l.x=x/b,l.y=C/d,v.push(l.x,l.y);for(x=1;x<=b;x++)for(C=1;C<=d;C++){const u=(d+1)*x+(C-1),D=(d+1)*x+C,aa=(d+1)*(x-1)+C;t.push((d+1)*(x-1)+(C-1),u,aa);t.push(u,D,aa)}})();this.setIndex(t);this.setAttribute("position",new eb(m,3));this.setAttribute("normal",new eb(p,3));this.setAttribute("uv",new eb(v,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=
super.toJSON();a.path=this.parameters.path.toJSON();return a}static fromJSON(a){return new Kh((new Yf[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class Sj extends tb{constructor(a=null){super();this.type="WireframeGeometry";this.parameters={geometry:a};if(null!==a){const f=[],g=new Set,k=new I,h=new I;if(null!==a.index){var b=a.attributes.position,c=a.index;a=a.groups;0===a.length&&(a=[{start:0,count:c.count,materialIndex:0}]);for(let l=0,n=a.length;l<n;++l){var d=
a[l],e=d.start;d=d.count;for(let m=e,p=e+d;m<p;m+=3)for(e=0;3>e;e++){d=c.getX(m+e);const v=c.getX(m+(e+1)%3);k.fromBufferAttribute(b,d);h.fromBufferAttribute(b,v);!0===Fi(k,h,g)&&(f.push(k.x,k.y,k.z),f.push(h.x,h.y,h.z))}}}else{b=a.attributes.position;for(let l=0,n=b.count/3;l<n;l++)for(c=0;3>c;c++)a=3*l+(c+1)%3,k.fromBufferAttribute(b,3*l+c),h.fromBufferAttribute(b,a),!0===Fi(k,h,g)&&(f.push(k.x,k.y,k.z),f.push(h.x,h.y,h.z))}this.setAttribute("position",new eb(f,3))}}copy(a){super.copy(a);this.parameters=
Object.assign({},a.parameters);return this}}var Tj=Object.freeze({__proto__:null,BoxGeometry:ae,CapsuleGeometry:yh,CircleGeometry:zh,ConeGeometry:Ah,CylinderGeometry:af,DodecahedronGeometry:Bh,EdgesGeometry:Rj,ExtrudeGeometry:Dh,IcosahedronGeometry:Eh,LatheGeometry:Zf,OctahedronGeometry:cg,PlaneGeometry:De,PolyhedronGeometry:Td,RingGeometry:Fh,ShapeGeometry:Gh,SphereGeometry:dg,TetrahedronGeometry:Hh,TorusGeometry:Ih,TorusKnotGeometry:Jh,TubeGeometry:Kh,WireframeGeometry:Sj});class Uj extends sc{constructor(a){super();
this.isShadowMaterial=!0;this.type="ShadowMaterial";this.color=new Ya(0);this.fog=this.transparent=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.fog=a.fog;return this}}class Vj extends Mc{constructor(a){super(a);this.isRawShaderMaterial=!0;this.type="RawShaderMaterial"}}class Lh extends sc{constructor(a){super();this.isMeshStandardMaterial=!0;this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new Ya(16777215);this.roughness=1;this.metalness=0;this.lightMap=
this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Ya(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapRotation=new Kc;this.envMapIntensity=1;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=
this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;
this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.envMapIntensity=a.envMapIntensity;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=
a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class Wj extends Lh{constructor(a){super();this.isMeshPhysicalMaterial=!0;this.defines={STANDARD:"",PHYSICAL:""};this.type="MeshPhysicalMaterial";this.anisotropyRotation=0;this.clearcoatMap=this.anisotropyMap=null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=null;this.clearcoatNormalScale=new xa(1,1);this.clearcoatNormalMap=null;this.ior=1.5;Object.defineProperty(this,"reflectivity",
{get:function(){return ib(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(b){this.ior=(1+.4*b)/(1-.4*b)}});this.iridescenceMap=null;this.iridescenceIOR=1.3;this.iridescenceThicknessRange=[100,400];this.iridescenceThicknessMap=null;this.sheenColor=new Ya(0);this.sheenColorMap=null;this.sheenRoughness=1;this.transmissionMap=this.sheenRoughnessMap=null;this.thickness=0;this.thicknessMap=null;this.attenuationDistance=Infinity;this.attenuationColor=new Ya(1,1,1);this.specularIntensity=1;this.specularIntensityMap=
null;this.specularColor=new Ya(1,1,1);this.specularColorMap=null;this._transmission=this._sheen=this._iridescence=this._clearcoat=this._anisotropy=0;this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){0<this._anisotropy!==0<a&&this.version++;this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){0<this._clearcoat!==0<a&&this.version++;this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){0<this._iridescence!==0<a&&this.version++;
this._iridescence=a}get sheen(){return this._sheen}set sheen(a){0<this._sheen!==0<a&&this.version++;this._sheen=a}get transmission(){return this._transmission}set transmission(a){0<this._transmission!==0<a&&this.version++;this._transmission=a}copy(a){super.copy(a);this.defines={STANDARD:"",PHYSICAL:""};this.anisotropy=a.anisotropy;this.anisotropyRotation=a.anisotropyRotation;this.anisotropyMap=a.anisotropyMap;this.clearcoat=a.clearcoat;this.clearcoatMap=a.clearcoatMap;this.clearcoatRoughness=a.clearcoatRoughness;
this.clearcoatRoughnessMap=a.clearcoatRoughnessMap;this.clearcoatNormalMap=a.clearcoatNormalMap;this.clearcoatNormalScale.copy(a.clearcoatNormalScale);this.ior=a.ior;this.iridescence=a.iridescence;this.iridescenceMap=a.iridescenceMap;this.iridescenceIOR=a.iridescenceIOR;this.iridescenceThicknessRange=[...a.iridescenceThicknessRange];this.iridescenceThicknessMap=a.iridescenceThicknessMap;this.sheen=a.sheen;this.sheenColor.copy(a.sheenColor);this.sheenColorMap=a.sheenColorMap;this.sheenRoughness=a.sheenRoughness;
this.sheenRoughnessMap=a.sheenRoughnessMap;this.transmission=a.transmission;this.transmissionMap=a.transmissionMap;this.thickness=a.thickness;this.thicknessMap=a.thicknessMap;this.attenuationDistance=a.attenuationDistance;this.attenuationColor.copy(a.attenuationColor);this.specularIntensity=a.specularIntensity;this.specularIntensityMap=a.specularIntensityMap;this.specularColor.copy(a.specularColor);this.specularColorMap=a.specularColorMap;return this}}class Xj extends sc{constructor(a){super();this.isMeshPhongMaterial=
!0;this.type="MeshPhongMaterial";this.color=new Ya(16777215);this.specular=new Ya(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Ya(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=
new Kc;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;
this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class Yj extends sc{constructor(a){super();this.isMeshToonMaterial=!0;this.defines={TOON:""};this.type="MeshToonMaterial";this.color=new Ya(16777215);this.lightMap=this.gradientMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=
1;this.emissive=new Ya(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.gradientMap=a.gradientMap;this.lightMap=
a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=
a.alphaMap;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.fog=a.fog;return this}}class Zj extends sc{constructor(a){super();this.isMeshNormalMaterial=!0;this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=
1;this.flatShading=!1;this.setValues(a)}copy(a){super.copy(a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.flatShading=a.flatShading;return this}}class ak extends sc{constructor(a){super();this.isMeshLambertMaterial=
!0;this.type="MeshLambertMaterial";this.color=new Ya(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Ya(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Kc;this.combine=0;this.reflectivity=
1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=
a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;
this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class bk extends sc{constructor(a){super();this.isMeshMatcapMaterial=!0;this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new Ya(16777215);this.bumpMap=this.map=this.matcap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=
null;this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={MATCAP:""};this.color.copy(a.color);this.matcap=a.matcap;this.map=a.map;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=a.alphaMap;this.flatShading=a.flatShading;this.fog=a.fog;
return this}}class ck extends Ac{constructor(a){super();this.isLineDashedMaterial=!0;this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}copy(a){super.copy(a);this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this}}const Km={convertArray:Hd,isTypedArray:Gi,getKeyframeOrder:Hi,sortedArray:Ag,flattenJSON:Bg,subclip:function(a,b,c,d,e=30){a=a.clone();a.name=b;b=[];for(let g=0;g<a.tracks.length;++g){const k=a.tracks[g],h=k.getValueSize(),
l=[],n=[];for(let m=0;m<k.times.length;++m){var f=k.times[m]*e;if(!(f<c||f>=d))for(l.push(k.times[m]),f=0;f<h;++f)n.push(k.values[m*h+f])}0!==l.length&&(k.times=Hd(l,k.times.constructor),k.values=Hd(n,k.values.constructor),b.push(k))}a.tracks=b;c=Infinity;for(d=0;d<a.tracks.length;++d)c>a.tracks[d].times[0]&&(c=a.tracks[d].times[0]);for(d=0;d<a.tracks.length;++d)a.tracks[d].shift(-1*c);a.resetDuration();return a},makeClipAdditive:function(a,b=0,c=a,d=30){0>=d&&(d=30);const e=c.tracks.length;b/=d;
for(d=0;d<e;++d){const l=c.tracks[d],n=l.ValueTypeName;if("bool"===n||"string"===n)continue;const m=a.tracks.find(function(t){return t.name===l.name&&t.ValueTypeName===n});if(void 0===m)continue;var f=0,g=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=g/3);let p=0;const v=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=v/3);var k=l.times.length-1;if(b<=l.times[0])f=l.values.slice(f,g-f);else if(b>=l.times[k])k=k*g+f,f=l.values.slice(k,
k+g-f);else{k=l.createInterpolant();var h=f;f=g-f;k.evaluate(b);f=k.resultBuffer.slice(h,f)}"quaternion"===n&&(new Cc).fromArray(f).normalize().conjugate().toArray(f);g=m.times.length;for(k=0;k<g;++k)if(h=k*v+p,"quaternion"===n)Cc.multiplyQuaternionsFlat(m.values,h,f,0,m.values,h);else{const t=v-2*p;for(let x=0;x<t;++x)m.values[h+x]-=f[x]}}a.blendMode=2501;return a}};class bf{constructor(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=
b;this.valueSize=c;this.settings=null;this.DefaultSettings_={}}evaluate(a){const b=this.parameterPositions;let c=this._cachedIndex;var d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.copySampleValue_(c-1)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}e=b.length;break c}if(a>=e)break a;else{d=b[1];a<d&&(c=2,e=d);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.copySampleValue_(0);if(c===f)break;d=e;e=b[--c-1];if(a>=
e)break b}e=c;c=0}}for(;c<e;)d=c+e>>>1,a<b[d]?e=d:c=d+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===d)return this._cachedIndex=c=b.length,this.copySampleValue_(c-1)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(let e=0;e!==d;++e)b[e]=c[a+e];return b}interpolate_(){throw Error("call to abstract method");
}intervalChanged_(){}}class dk extends bf{constructor(a,b,c,d){super(a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0;this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,b,c){var d=this.parameterPositions;let e=a-2,f=a+1,g=d[e],k=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===k)switch(this.getSettings_().endingEnd){case 2401:f=a;k=2*
c-b;break;case 2402:f=1;k=c+d[1]-d[0];break;default:f=a-1,k=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=a/(k-c);this._offsetPrev=e*d;this._offsetNext=f*d}interpolate_(a,b,c,d){const e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;const k=a-g,h=this._offsetPrev,l=this._offsetNext;var n=this._weightPrev,m=this._weightNext,p=(c-b)/(d-b);c=p*p;d=c*p;b=-n*d+2*n*c-n*p;n=(1+n)*d+(-1.5-2*n)*c+(-.5+n)*p+1;p=(-1-m)*d+(1.5+m)*c+.5*p;m=m*d-m*c;for(c=0;c!==g;++c)e[c]=
b*f[h+c]+n*f[k+c]+p*f[a+c]+m*f[l+c];return e}}class Mh extends bf{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){const e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;const k=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[k+d]*c+f[a+d]*b;return e}}class ek extends bf{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a){return this.copySampleValue_(a-1)}}class Xc{constructor(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||
0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=Hd(b,this.TimeBufferType);this.values=Hd(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}static toJSON(a){var b=a.constructor;if(b.toJSON!==this.toJSON)b=b.toJSON(a);else{b={name:a.name,times:Hd(a.times,Array),values:Hd(a.values,Array)};const c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b}InterpolantFactoryMethodDiscrete(a){return new ek(this.times,
this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new Mh(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new dk(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+
this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=b;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==
a){const b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]+=a}return this}scale(a){if(1!==a){const b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]*=a}return this}trim(a,b){const c=this.times,d=c.length;let e=0,f=d-1;for(;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),a=this.getValueSize(),this.times=c.slice(e,f),this.values=this.values.slice(e*a,f*a);return this}validate(){let a=!0;var b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",
this),a=!1);var c=this.times;b=this.values;const d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let e=null;for(let f=0;f!==d;f++){const g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&Gi(b))for(let f=0,g=b.length;f!==g;++f)if(c=b[f],isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",
this,f,c);a=!1;break}return a}optimize(){const a=this.times.slice(),b=this.values.slice(),c=this.getValueSize(),d=2302===this.getInterpolation(),e=a.length-1;let f=1;for(let l=1;l<e;++l){var g=!1,k=a[l];if(k!==a[l+1]&&(1!==l||k!==a[0]))if(d)g=!0;else{k=l*c;var h=k-c;const n=k+c;for(let m=0;m!==c;++m){const p=b[k+m];if(p!==b[h+m]||p!==b[n+m]){g=!0;break}}}if(g){if(l!==f)for(a[f]=a[l],g=l*c,k=f*c,h=0;h!==c;++h)b[k+h]=b[g+h];++f}}if(0<e){a[f]=a[e];for(let l=e*c,n=f*c,m=0;m!==c;++m)b[n+m]=b[l+m];++f}f!==
a.length?(this.times=a.slice(0,f),this.values=b.slice(0,f*c)):(this.times=a,this.values=b);return this}clone(){var a=this.times.slice();const b=this.values.slice();a=new this.constructor(this.name,a,b);a.createInterpolant=this.createInterpolant;return a}}Xc.prototype.TimeBufferType=Float32Array;Xc.prototype.ValueBufferType=Float32Array;Xc.prototype.DefaultInterpolation=2301;class Id extends Xc{}Id.prototype.ValueTypeName="bool";Id.prototype.ValueBufferType=Array;Id.prototype.DefaultInterpolation=
2300;Id.prototype.InterpolantFactoryMethodLinear=void 0;Id.prototype.InterpolantFactoryMethodSmooth=void 0;class Cg extends Xc{}Cg.prototype.ValueTypeName="color";class Le extends Xc{}Le.prototype.ValueTypeName="number";class fk extends bf{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){const e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;b=(c-b)/(d-b);a*=g;for(c=a+g;a!==c;a+=4)Cc.slerpFlat(e,0,f,a-g,f,a,b);return e}}class fe extends Xc{InterpolantFactoryMethodLinear(a){return new fk(this.times,
this.values,this.getValueSize(),a)}}fe.prototype.ValueTypeName="quaternion";fe.prototype.DefaultInterpolation=2301;fe.prototype.InterpolantFactoryMethodSmooth=void 0;class Jd extends Xc{}Jd.prototype.ValueTypeName="string";Jd.prototype.ValueBufferType=Array;Jd.prototype.DefaultInterpolation=2300;Jd.prototype.InterpolantFactoryMethodLinear=void 0;Jd.prototype.InterpolantFactoryMethodSmooth=void 0;class Me extends Xc{}Me.prototype.ValueTypeName="vector";class cf{constructor(a,b=-1,c,d=2500){this.name=
a;this.tracks=c;this.duration=b;this.blendMode=d;this.uuid=pa();0>this.duration&&this.resetDuration()}static parse(a){var b=[];const c=a.tracks,d=1/(a.fps||1);for(let k=0,h=c.length;k!==h;++k){var e=b,f=e.push;{var g=c[k];if(void 0===g.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");const l=Ol(g.type);if(void 0===g.times){const n=[],m=[];Bg(g.keys,n,m,"value");g.times=n;g.values=m}g=void 0!==l.parse?l.parse(g):new l(g.name,g.times,g.values,g.interpolation)}f.call(e,g.scale(d))}b=
new this(a.name,a.duration,b,a.blendMode);b.uuid=a.uuid;return b}static toJSON(a){const b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid,blendMode:a.blendMode};for(let d=0,e=c.length;d!==e;++d)b.push(Xc.toJSON(c[d]));return a}static CreateFromMorphTargetSequence(a,b,c,d){const e=b.length,f=[];for(let g=0;g<e;g++){let k=[],h=[];k.push((g+e-1)%e,g,(g+1)%e);h.push(0,1,0);const l=Hi(k);k=Ag(k,1,l);h=Ag(h,1,l);d||0!==k[0]||(k.push(e),h.push(h[0]));f.push((new Le(".morphTargetInfluences["+
b[g].name+"]",k,h)).scale(1/c))}return new this(a,-1,f)}static findByName(a,b){let c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null}static CreateClipsFromMorphTargetSequences(a,b,c){const d={},e=/^([\w-]*?)([\d]+)$/;for(let g=0,k=a.length;g<k;g++){const h=a[g];var f=h.name.match(e);if(f&&1<f.length){f=f[1];let l=d[f];l||(d[f]=l=[]);l.push(h)}}a=[];for(const g in d)a.push(this.CreateFromMorphTargetSequence(g,d[g],
b,c));return a}static parseAnimation(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const c=function(n,m,p,v,t){if(0!==p.length){const x=[],C=[];Bg(p,x,C,v);0!==x.length&&t.push(new n(m,x,C))}},d=[],e=a.name||"default",f=a.fps||30,g=a.blendMode;var k=a.length||-1;a=a.hierarchy||[];for(let n=0;n<a.length;n++){const m=a[n].keys;if(m&&0!==m.length)if(m[0].morphTargets){k={};var h=void 0;for(h=0;h<m.length;h++)if(m[h].morphTargets)for(var l=0;l<m[h].morphTargets.length;l++)k[m[h].morphTargets[l]]=
-1;for(const p in k){l=[];const v=[];for(let t=0;t!==m[h].morphTargets.length;++t){const x=m[h];l.push(x.time);v.push(x.morphTarget===p?1:0)}d.push(new Le(".morphTargetInfluence["+p+"]",l,v))}k=k.length*f}else h=".bones["+b[n].name+"]",c(Me,h+".position",m,"pos",d),c(fe,h+".quaternion",m,"rot",d),c(Me,h+".scale",m,"scl",d)}return 0===d.length?null:new this(e,k,d,g)}resetDuration(){var a=this.tracks;let b=0;for(let c=0,d=a.length;c!==d;++c)a=this.tracks[c],b=Math.max(b,a.times[a.times.length-1]);this.duration=
b;return this}trim(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this}validate(){let a=!0;for(let b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a}optimize(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}clone(){const a=[];for(let b=0;b<this.tracks.length;b++)a.push(this.tracks[b].clone());return new this.constructor(this.name,this.duration,a,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const ld=
{enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Nh{constructor(a,b,c){const d=this;let e=!1,f=0,g=0,k=void 0;const h=[];this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(l){g++;if(!1===e&&void 0!==d.onStart)d.onStart(l,f,g);e=!0};this.itemEnd=function(l){f++;if(void 0!==d.onProgress)d.onProgress(l,
f,g);if(f===g&&(e=!1,void 0!==d.onLoad))d.onLoad()};this.itemError=function(l){if(void 0!==d.onError)d.onError(l)};this.resolveURL=function(l){return k?k(l):l};this.setURLModifier=function(l){k=l;return this};this.addHandler=function(l,n){h.push(l,n);return this};this.removeHandler=function(l){l=h.indexOf(l);-1!==l&&h.splice(l,2);return this};this.getHandler=function(l){for(let n=0,m=h.length;n<m;n+=2){const p=h[n],v=h[n+1];p.global&&(p.lastIndex=0);if(p.test(l))return v}return null}}}const gk=new Nh;
class Dc{constructor(a){this.manager=void 0!==a?a:gk;this.crossOrigin="anonymous";this.withCredentials=!1;this.resourcePath=this.path="";this.requestHeader={}}load(){}loadAsync(a,b){const c=this;return new Promise(function(d,e){c.load(a,d,b,e)})}parse(){}setCrossOrigin(a){this.crossOrigin=a;return this}setWithCredentials(a){this.withCredentials=a;return this}setPath(a){this.path=a;return this}setResourcePath(a){this.resourcePath=a;return this}setRequestHeader(a){this.requestHeader=a;return this}}
Dc.DEFAULT_MATERIAL_NAME="__DEFAULT";const md={};class Lm extends Error{constructor(a,b){super(a);this.response=b}}class nd extends Dc{constructor(a){super(a)}load(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const e=ld.get(a);if(void 0!==e)return this.manager.itemStart(a),setTimeout(()=>{b&&b(e);this.manager.itemEnd(a)},0),e;if(void 0!==md[a])md[a].push({onLoad:b,onProgress:c,onError:d});else{md[a]=[];md[a].push({onLoad:b,onProgress:c,onError:d});c=
new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});var f=this.mimeType,g=this.responseType;fetch(c).then(k=>{if(200===k.status||0===k.status){0===k.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");if("undefined"===typeof ReadableStream||void 0===k.body||void 0===k.body.getReader)return k;const h=md[a],l=k.body.getReader(),n=(k=k.headers.get("Content-Length")||k.headers.get("X-File-Size"))?parseInt(k):0,m=0!==n;let p=0;
k=new ReadableStream({start(v){function t(){l.read().then(({done:x,value:C})=>{if(x)v.close();else{p+=C.byteLength;x=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:n});for(let u=0,D=h.length;u<D;u++){const aa=h[u];if(aa.onProgress)aa.onProgress(x)}v.enqueue(C);t()}})}t()}});return new Response(k)}throw new Lm(`fetch for "${k.url}" responded with ${k.status}: ${k.statusText}`,k);}).then(k=>{switch(g){case "arraybuffer":return k.arrayBuffer();case "blob":return k.blob();case "document":return k.text().then(n=>
(new DOMParser).parseFromString(n,f));case "json":return k.json();default:if(void 0===f)return k.text();var h=/charset="?([^;"\s]*)"?/i.exec(f);h=h&&h[1]?h[1].toLowerCase():void 0;const l=new TextDecoder(h);return k.arrayBuffer().then(n=>l.decode(n))}}).then(k=>{ld.add(a,k);const h=md[a];delete md[a];for(let l=0,n=h.length;l<n;l++){const m=h[l];if(m.onLoad)m.onLoad(k)}}).catch(k=>{const h=md[a];if(void 0===h)throw this.manager.itemError(a),k;delete md[a];for(let l=0,n=h.length;l<n;l++){const m=h[l];
if(m.onError)m.onError(k)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)});this.manager.itemStart(a)}}setResponseType(a){this.responseType=a;return this}setMimeType(a){this.mimeType=a;return this}}class Mm extends Dc{constructor(a){super(a)}load(a,b,c,d){const e=this,f=new nd(this.manager);f.setPath(this.path);f.setRequestHeader(this.requestHeader);f.setWithCredentials(this.withCredentials);f.load(a,function(g){try{b(e.parse(JSON.parse(g)))}catch(k){d?d(k):console.error(k),e.manager.itemError(a)}},
c,d)}parse(a){const b=[];for(let c=0;c<a.length;c++){const d=cf.parse(a[c]);b.push(d)}return b}}class Nm extends Dc{constructor(a){super(a)}load(a,b,c,d){function e(n){h.load(a[n],function(m){m=f.parse(m,!0);g[n]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps};l+=1;6===l&&(1===m.mipmapCount&&(k.minFilter=1006),k.image=g,k.format=m.format,k.needsUpdate=!0,b&&b(k))},c,d)}const f=this,g=[],k=new Vf,h=new nd(this.manager);h.setPath(this.path);h.setResponseType("arraybuffer");h.setRequestHeader(this.requestHeader);
h.setWithCredentials(f.withCredentials);let l=0;if(Array.isArray(a))for(let n=0,m=a.length;n<m;++n)e(n);else h.load(a,function(n){n=f.parse(n,!0);if(n.isCubemap){const m=n.mipmaps.length/n.mipmapCount;for(let p=0;p<m;p++){g[p]={mipmaps:[]};for(let v=0;v<n.mipmapCount;v++)g[p].mipmaps.push(n.mipmaps[p*n.mipmapCount+v]),g[p].format=n.format,g[p].width=n.width,g[p].height=n.height}k.image=g}else k.image.width=n.width,k.image.height=n.height,k.mipmaps=n.mipmaps;1===n.mipmapCount&&(k.minFilter=1006);k.format=
n.format;k.needsUpdate=!0;b&&b(k)},c,d);return k}}class df extends Dc{constructor(a){super(a)}load(a,b,c,d){function e(){g();ld.add(a,this);b&&b(this);k.manager.itemEnd(a)}function f(n){g();d&&d(n);k.manager.itemError(a);k.manager.itemEnd(a)}function g(){l.removeEventListener("load",e,!1);l.removeEventListener("error",f,!1)}void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const k=this,h=ld.get(a);if(void 0!==h)return k.manager.itemStart(a),setTimeout(function(){b&&b(h);k.manager.itemEnd(a)},
0),h;const l=Wb("img");l.addEventListener("load",e,!1);l.addEventListener("error",f,!1);"data:"!==a.slice(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin);k.manager.itemStart(a);l.src=a;return l}}class Om extends Dc{constructor(a){super(a)}load(a,b,c,d){function e(h){g.load(a[h],function(l){f.images[h]=l;k++;6===k&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}const f=new Re;f.colorSpace="srgb";const g=new df(this.manager);g.setCrossOrigin(this.crossOrigin);g.setPath(this.path);let k=0;for(c=
0;c<a.length;++c)e(c);return f}}class Pm extends Dc{constructor(a){super(a)}load(a,b,c,d){const e=this,f=new xd,g=new nd(this.manager);g.setResponseType("arraybuffer");g.setRequestHeader(this.requestHeader);g.setPath(this.path);g.setWithCredentials(e.withCredentials);g.load(a,function(k){let h;try{h=e.parse(k)}catch(l){if(void 0!==d)d(l);else{console.error(l);return}}void 0!==h.image?f.image=h.image:void 0!==h.data&&(f.image.width=h.width,f.image.height=h.height,f.image.data=h.data);f.wrapS=void 0!==
h.wrapS?h.wrapS:1001;f.wrapT=void 0!==h.wrapT?h.wrapT:1001;f.magFilter=void 0!==h.magFilter?h.magFilter:1006;f.minFilter=void 0!==h.minFilter?h.minFilter:1006;f.anisotropy=void 0!==h.anisotropy?h.anisotropy:1;void 0!==h.colorSpace&&(f.colorSpace=h.colorSpace);void 0!==h.flipY&&(f.flipY=h.flipY);void 0!==h.format&&(f.format=h.format);void 0!==h.type&&(f.type=h.type);void 0!==h.mipmaps&&(f.mipmaps=h.mipmaps,f.minFilter=1008);1===h.mipmapCount&&(f.minFilter=1006);void 0!==h.generateMipmaps&&(f.generateMipmaps=
h.generateMipmaps);f.needsUpdate=!0;b&&b(f,h)},c,d);return f}}class Qm extends Dc{constructor(a){super(a)}load(a,b,c,d){const e=new cc,f=new df(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(g){e.image=g;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e}}class Ad extends Gb{constructor(a,b=1){super();this.isLight=!0;this.type="Light";this.color=new Ya(a);this.intensity=b}dispose(){}copy(a,b){super.copy(a,b);this.color.copy(a.color);this.intensity=a.intensity;
return this}toJSON(a){a=super.toJSON(a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}}class hk extends Ad{constructor(a,
b,c){super(a,c);this.isHemisphereLight=!0;this.type="HemisphereLight";this.position.copy(Gb.DEFAULT_UP);this.updateMatrix();this.groundColor=new Ya(b)}copy(a,b){super.copy(a,b);this.groundColor.copy(a.groundColor);return this}}const Oh=new lb,ik=new I,jk=new I;class Ph{constructor(a){this.camera=a;this.normalBias=this.bias=0;this.radius=1;this.blurSamples=8;this.mapSize=new xa(512,512);this.mapPass=this.map=null;this.matrix=new lb;this.autoUpdate=!0;this.needsUpdate=!1;this._frustum=new Ee;this._frameExtents=
new xa(1,1);this._viewportCount=1;this._viewports=[new Mb(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const b=this.camera,c=this.matrix;ik.setFromMatrixPosition(a.matrixWorld);b.position.copy(ik);jk.setFromMatrixPosition(a.target.matrixWorld);b.lookAt(jk);b.updateMatrixWorld();Oh.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Oh);c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);c.multiply(Oh)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&
this.map.dispose();this.mapPass&&this.mapPass.dispose()}copy(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this}clone(){return(new this.constructor).copy(this)}toJSON(){const a={};0!==this.bias&&(a.bias=this.bias);0!==this.normalBias&&(a.normalBias=this.normalBias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;
return a}}class Rm extends Ph{constructor(){super(new lc(50,1,.5,500));this.isSpotLightShadow=!0;this.focus=1}updateMatrices(a){const b=this.camera,c=2*ge*a.angle*this.focus,d=this.mapSize.width/this.mapSize.height,e=a.distance||b.far;if(c!==b.fov||d!==b.aspect||e!==b.far)b.fov=c,b.aspect=d,b.far=e,b.updateProjectionMatrix();super.updateMatrices(a)}copy(a){super.copy(a);this.focus=a.focus;return this}}class kk extends Ad{constructor(a,b,c=0,d=Math.PI/3,e=0,f=2){super(a,b);this.isSpotLight=!0;this.type=
"SpotLight";this.position.copy(Gb.DEFAULT_UP);this.updateMatrix();this.target=new Gb;this.distance=c;this.angle=d;this.penumbra=e;this.decay=f;this.map=null;this.shadow=new Rm}get power(){return this.intensity*Math.PI}set power(a){this.intensity=a/Math.PI}dispose(){this.shadow.dispose()}copy(a,b){super.copy(a,b);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}const lk=new lb,ef=new I,Qh=
new I;class Sm extends Ph{constructor(){super(new lc(90,1,.5,500));this.isPointLightShadow=!0;this._frameExtents=new xa(4,2);this._viewportCount=6;this._viewports=[new Mb(2,1,1,1),new Mb(0,1,1,1),new Mb(3,1,1,1),new Mb(1,1,1,1),new Mb(3,0,1,1),new Mb(1,0,1,1)];this._cubeDirections=[new I(1,0,0),new I(-1,0,0),new I(0,0,1),new I(0,0,-1),new I(0,1,0),new I(0,-1,0)];this._cubeUps=[new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,1,0),new I(0,0,1),new I(0,0,-1)]}updateMatrices(a,b=0){const c=this.camera,
d=this.matrix,e=a.distance||c.far;e!==c.far&&(c.far=e,c.updateProjectionMatrix());ef.setFromMatrixPosition(a.matrixWorld);c.position.copy(ef);Qh.copy(c.position);Qh.add(this._cubeDirections[b]);c.up.copy(this._cubeUps[b]);c.lookAt(Qh);c.updateMatrixWorld();d.makeTranslation(-ef.x,-ef.y,-ef.z);lk.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);this._frustum.setFromProjectionMatrix(lk)}}class mk extends Ad{constructor(a,b,c=0,d=2){super(a,b);this.isPointLight=!0;this.type="PointLight";this.distance=
c;this.decay=d;this.shadow=new Sm}get power(){return 4*this.intensity*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,b){super.copy(a,b);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this}}class Tm extends Ph{constructor(){super(new Hf(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=!0}}class nk extends Ad{constructor(a,b){super(a,b);this.isDirectionalLight=!0;this.type="DirectionalLight";this.position.copy(Gb.DEFAULT_UP);
this.updateMatrix();this.target=new Gb;this.shadow=new Tm}dispose(){this.shadow.dispose()}copy(a){super.copy(a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}class ok extends Ad{constructor(a,b){super(a,b);this.isAmbientLight=!0;this.type="AmbientLight"}}class pk extends Ad{constructor(a,b,c=10,d=10){super(a,b);this.isRectAreaLight=!0;this.type="RectAreaLight";this.width=c;this.height=d}get power(){return this.intensity*this.width*this.height*Math.PI}set power(a){this.intensity=
a/(this.width*this.height*Math.PI)}copy(a){super.copy(a);this.width=a.width;this.height=a.height;return this}toJSON(a){a=super.toJSON(a);a.object.width=this.width;a.object.height=this.height;return a}}class qk{constructor(){this.isSphericalHarmonics3=!0;this.coefficients=[];for(let a=0;9>a;a++)this.coefficients.push(new I)}set(a){for(let b=0;9>b;b++)this.coefficients[b].copy(a[b]);return this}zero(){for(let a=0;9>a;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,b){const c=a.x,d=a.y;a=a.z;
const e=this.coefficients;b.copy(e[0]).multiplyScalar(.282095);b.addScaledVector(e[1],.488603*d);b.addScaledVector(e[2],.488603*a);b.addScaledVector(e[3],.488603*c);b.addScaledVector(e[4],1.092548*c*d);b.addScaledVector(e[5],1.092548*d*a);b.addScaledVector(e[6],.315392*(3*a*a-1));b.addScaledVector(e[7],1.092548*c*a);b.addScaledVector(e[8],.546274*(c*c-d*d));return b}getIrradianceAt(a,b){const c=a.x,d=a.y;a=a.z;const e=this.coefficients;b.copy(e[0]).multiplyScalar(.886227);b.addScaledVector(e[1],1.023328*
d);b.addScaledVector(e[2],1.023328*a);b.addScaledVector(e[3],1.023328*c);b.addScaledVector(e[4],.858086*c*d);b.addScaledVector(e[5],.858086*d*a);b.addScaledVector(e[6],.743125*a*a-.247708);b.addScaledVector(e[7],.858086*c*a);b.addScaledVector(e[8],.429043*(c*c-d*d));return b}add(a){for(let b=0;9>b;b++)this.coefficients[b].add(a.coefficients[b]);return this}addScaledSH(a,b){for(let c=0;9>c;c++)this.coefficients[c].addScaledVector(a.coefficients[c],b);return this}scale(a){for(let b=0;9>b;b++)this.coefficients[b].multiplyScalar(a);
return this}lerp(a,b){for(let c=0;9>c;c++)this.coefficients[c].lerp(a.coefficients[c],b);return this}equals(a){for(let b=0;9>b;b++)if(!this.coefficients[b].equals(a.coefficients[b]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(a,b=0){const c=this.coefficients;for(let d=0;9>d;d++)c[d].fromArray(a,b+3*d);return this}toArray(a=[],b=0){const c=this.coefficients;for(let d=0;9>d;d++)c[d].toArray(a,b+3*d);return a}static getBasisAt(a,
b){const c=a.x,d=a.y;a=a.z;b[0]=.282095;b[1]=.488603*d;b[2]=.488603*a;b[3]=.488603*c;b[4]=1.092548*c*d;b[5]=1.092548*d*a;b[6]=.315392*(3*a*a-1);b[7]=1.092548*c*a;b[8]=.546274*(c*c-d*d)}}class rk extends Ad{constructor(a=new qk,b=1){super(void 0,b);this.isLightProbe=!0;this.sh=a}copy(a){super.copy(a);this.sh.copy(a.sh);return this}fromJSON(a){this.intensity=a.intensity;this.sh.fromArray(a.sh);return this}toJSON(a){a=super.toJSON(a);a.object.sh=this.sh.toArray();return a}}class Rh extends Dc{constructor(a){super(a);
this.textures={}}load(a,b,c,d){const e=this,f=new nd(e.manager);f.setPath(e.path);f.setRequestHeader(e.requestHeader);f.setWithCredentials(e.withCredentials);f.load(a,function(g){try{b(e.parse(JSON.parse(g)))}catch(k){d?d(k):console.error(k),e.manager.itemError(a)}},c,d)}parse(a){function b(f){void 0===c[f]&&console.warn("THREE.MaterialLoader: Undefined texture",f);return c[f]}const c=this.textures,d=Rh.createMaterialFromType(a.type);void 0!==a.uuid&&(d.uuid=a.uuid);void 0!==a.name&&(d.name=a.name);
void 0!==a.color&&void 0!==d.color&&d.color.setHex(a.color);void 0!==a.roughness&&(d.roughness=a.roughness);void 0!==a.metalness&&(d.metalness=a.metalness);void 0!==a.sheen&&(d.sheen=a.sheen);void 0!==a.sheenColor&&(d.sheenColor=(new Ya).setHex(a.sheenColor));void 0!==a.sheenRoughness&&(d.sheenRoughness=a.sheenRoughness);void 0!==a.emissive&&void 0!==d.emissive&&d.emissive.setHex(a.emissive);void 0!==a.specular&&void 0!==d.specular&&d.specular.setHex(a.specular);void 0!==a.specularIntensity&&(d.specularIntensity=
a.specularIntensity);void 0!==a.specularColor&&void 0!==d.specularColor&&d.specularColor.setHex(a.specularColor);void 0!==a.shininess&&(d.shininess=a.shininess);void 0!==a.clearcoat&&(d.clearcoat=a.clearcoat);void 0!==a.clearcoatRoughness&&(d.clearcoatRoughness=a.clearcoatRoughness);void 0!==a.iridescence&&(d.iridescence=a.iridescence);void 0!==a.iridescenceIOR&&(d.iridescenceIOR=a.iridescenceIOR);void 0!==a.iridescenceThicknessRange&&(d.iridescenceThicknessRange=a.iridescenceThicknessRange);void 0!==
a.transmission&&(d.transmission=a.transmission);void 0!==a.thickness&&(d.thickness=a.thickness);void 0!==a.attenuationDistance&&(d.attenuationDistance=a.attenuationDistance);void 0!==a.attenuationColor&&void 0!==d.attenuationColor&&d.attenuationColor.setHex(a.attenuationColor);void 0!==a.anisotropy&&(d.anisotropy=a.anisotropy);void 0!==a.anisotropyRotation&&(d.anisotropyRotation=a.anisotropyRotation);void 0!==a.fog&&(d.fog=a.fog);void 0!==a.flatShading&&(d.flatShading=a.flatShading);void 0!==a.blending&&
(d.blending=a.blending);void 0!==a.combine&&(d.combine=a.combine);void 0!==a.side&&(d.side=a.side);void 0!==a.shadowSide&&(d.shadowSide=a.shadowSide);void 0!==a.opacity&&(d.opacity=a.opacity);void 0!==a.transparent&&(d.transparent=a.transparent);void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest);void 0!==a.alphaHash&&(d.alphaHash=a.alphaHash);void 0!==a.depthFunc&&(d.depthFunc=a.depthFunc);void 0!==a.depthTest&&(d.depthTest=a.depthTest);void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite);void 0!==a.colorWrite&&
(d.colorWrite=a.colorWrite);void 0!==a.blendSrc&&(d.blendSrc=a.blendSrc);void 0!==a.blendDst&&(d.blendDst=a.blendDst);void 0!==a.blendEquation&&(d.blendEquation=a.blendEquation);void 0!==a.blendSrcAlpha&&(d.blendSrcAlpha=a.blendSrcAlpha);void 0!==a.blendDstAlpha&&(d.blendDstAlpha=a.blendDstAlpha);void 0!==a.blendEquationAlpha&&(d.blendEquationAlpha=a.blendEquationAlpha);void 0!==a.blendColor&&void 0!==d.blendColor&&d.blendColor.setHex(a.blendColor);void 0!==a.blendAlpha&&(d.blendAlpha=a.blendAlpha);
void 0!==a.stencilWriteMask&&(d.stencilWriteMask=a.stencilWriteMask);void 0!==a.stencilFunc&&(d.stencilFunc=a.stencilFunc);void 0!==a.stencilRef&&(d.stencilRef=a.stencilRef);void 0!==a.stencilFuncMask&&(d.stencilFuncMask=a.stencilFuncMask);void 0!==a.stencilFail&&(d.stencilFail=a.stencilFail);void 0!==a.stencilZFail&&(d.stencilZFail=a.stencilZFail);void 0!==a.stencilZPass&&(d.stencilZPass=a.stencilZPass);void 0!==a.stencilWrite&&(d.stencilWrite=a.stencilWrite);void 0!==a.wireframe&&(d.wireframe=a.wireframe);
void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(d.rotation=a.rotation);void 0!==a.linewidth&&(d.linewidth=a.linewidth);void 0!==a.dashSize&&(d.dashSize=a.dashSize);void 0!==a.gapSize&&(d.gapSize=a.gapSize);void 0!==a.scale&&(d.scale=a.scale);void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset);void 0!==
a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.dithering&&(d.dithering=a.dithering);void 0!==a.alphaToCoverage&&(d.alphaToCoverage=a.alphaToCoverage);void 0!==a.premultipliedAlpha&&(d.premultipliedAlpha=a.premultipliedAlpha);void 0!==a.forceSinglePass&&(d.forceSinglePass=a.forceSinglePass);void 0!==a.visible&&(d.visible=a.visible);void 0!==a.toneMapped&&(d.toneMapped=a.toneMapped);void 0!==
a.userData&&(d.userData=a.userData);void 0!==a.vertexColors&&(d.vertexColors="number"===typeof a.vertexColors?0<a.vertexColors?!0:!1:a.vertexColors);if(void 0!==a.uniforms)for(var e in a.uniforms){const f=a.uniforms[e];d.uniforms[e]={};switch(f.type){case "t":d.uniforms[e].value=b(f.value);break;case "c":d.uniforms[e].value=(new Ya).setHex(f.value);break;case "v2":d.uniforms[e].value=(new xa).fromArray(f.value);break;case "v3":d.uniforms[e].value=(new I).fromArray(f.value);break;case "v4":d.uniforms[e].value=
(new Mb).fromArray(f.value);break;case "m3":d.uniforms[e].value=(new ob).fromArray(f.value);break;case "m4":d.uniforms[e].value=(new lb).fromArray(f.value);break;default:d.uniforms[e].value=f.value}}void 0!==a.defines&&(d.defines=a.defines);void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader);void 0!==a.glslVersion&&(d.glslVersion=a.glslVersion);if(void 0!==a.extensions)for(const f in a.extensions)d.extensions[f]=a.extensions[f];void 0!==
a.lights&&(d.lights=a.lights);void 0!==a.clipping&&(d.clipping=a.clipping);void 0!==a.size&&(d.size=a.size);void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(d.map=b(a.map));void 0!==a.matcap&&(d.matcap=b(a.matcap));void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap));void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap));void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale);void 0!==a.normalMap&&(d.normalMap=b(a.normalMap));void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType);
void 0!==a.normalScale&&(e=a.normalScale,!1===Array.isArray(e)&&(e=[e,e]),d.normalScale=(new xa).fromArray(e));void 0!==a.displacementMap&&(d.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap));void 0!==
a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(d.specularMap=b(a.specularMap));void 0!==a.specularIntensityMap&&(d.specularIntensityMap=b(a.specularIntensityMap));void 0!==a.specularColorMap&&(d.specularColorMap=b(a.specularColorMap));void 0!==a.envMap&&(d.envMap=b(a.envMap));void 0!==a.envMapRotation&&d.envMapRotation.fromArray(a.envMapRotation);void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity);void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity);
void 0!==a.refractionRatio&&(d.refractionRatio=a.refractionRatio);void 0!==a.lightMap&&(d.lightMap=b(a.lightMap));void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(d.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap));void 0!==a.clearcoatMap&&(d.clearcoatMap=b(a.clearcoatMap));void 0!==a.clearcoatRoughnessMap&&(d.clearcoatRoughnessMap=b(a.clearcoatRoughnessMap));void 0!==
a.clearcoatNormalMap&&(d.clearcoatNormalMap=b(a.clearcoatNormalMap));void 0!==a.clearcoatNormalScale&&(d.clearcoatNormalScale=(new xa).fromArray(a.clearcoatNormalScale));void 0!==a.iridescenceMap&&(d.iridescenceMap=b(a.iridescenceMap));void 0!==a.iridescenceThicknessMap&&(d.iridescenceThicknessMap=b(a.iridescenceThicknessMap));void 0!==a.transmissionMap&&(d.transmissionMap=b(a.transmissionMap));void 0!==a.thicknessMap&&(d.thicknessMap=b(a.thicknessMap));void 0!==a.anisotropyMap&&(d.anisotropyMap=
b(a.anisotropyMap));void 0!==a.sheenColorMap&&(d.sheenColorMap=b(a.sheenColorMap));void 0!==a.sheenRoughnessMap&&(d.sheenRoughnessMap=b(a.sheenRoughnessMap));return d}setTextures(a){this.textures=a;return this}static createMaterialFromType(a){return new {ShadowMaterial:Uj,SpriteMaterial:gh,RawShaderMaterial:Vj,ShaderMaterial:Mc,PointsMaterial:ph,MeshPhysicalMaterial:Wj,MeshStandardMaterial:Lh,MeshPhongMaterial:Xj,MeshToonMaterial:Yj,MeshNormalMaterial:Zj,MeshLambertMaterial:ak,MeshDepthMaterial:ug,
MeshDistanceMaterial:vg,MeshBasicMaterial:vd,MeshMatcapMaterial:bk,LineDashedMaterial:ck,LineBasicMaterial:Ac,Material:sc}[a]}}class Sh{static decodeText(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);let b="";for(let c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);try{return decodeURIComponent(escape(b))}catch(c){return b}}static extractUrlBase(a){const b=a.lastIndexOf("/");return-1===b?"./":a.slice(0,b+1)}static resolveURL(a,b){if("string"!==typeof a||""===a)return"";
/^https?:\/\//i.test(b)&&/^\//.test(a)&&(b=b.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));return/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:b+a}}class sk extends tb{constructor(){super();this.isInstancedBufferGeometry=!0;this.type="InstancedBufferGeometry";this.instanceCount=Infinity}copy(a){super.copy(a);this.instanceCount=a.instanceCount;return this}toJSON(){const a=super.toJSON();a.instanceCount=this.instanceCount;a.isInstancedBufferGeometry=!0;return a}}class tk extends Dc{constructor(a){super(a)}load(a,
b,c,d){const e=this,f=new nd(e.manager);f.setPath(e.path);f.setRequestHeader(e.requestHeader);f.setWithCredentials(e.withCredentials);f.load(a,function(g){try{b(e.parse(JSON.parse(g)))}catch(k){d?d(k):console.error(k),e.manager.itemError(a)}},c,d)}parse(a){function b(m,p){if(void 0!==c[p])return c[p];const v=m.interleavedBuffers[p];var t=v.buffer;void 0!==d[t]?t=d[t]:(m=(new Uint32Array(m.arrayBuffers[t])).buffer,t=d[t]=m);t=new he[v.type](t);t=new Mf(t,v.stride);t.uuid=v.uuid;return c[p]=t}const c=
{},d={},e=a.isInstancedBufferGeometry?new sk:new tb;var f=a.data.index;void 0!==f&&(f=new he[f.type](f.array),e.setIndex(new Nb(f,1)));f=a.data.attributes;for(var g in f){var k=f[g],h=void 0;k.isInterleavedBufferAttribute?(h=b(a.data,k.data),h=new xe(h,k.itemSize,k.offset,k.normalized)):(h=new he[k.type](k.array),h=new (k.isInstancedBufferAttribute?Be:Nb)(h,k.itemSize,k.normalized));void 0!==k.name&&(h.name=k.name);void 0!==k.usage&&h.setUsage(k.usage);e.setAttribute(g,h)}if(g=a.data.morphAttributes)for(var l in g){f=
g[l];k=[];for(let m=0,p=f.length;m<p;m++){h=f[m];var n=void 0;h.isInterleavedBufferAttribute?(n=b(a.data,h.data),n=new xe(n,h.itemSize,h.offset,h.normalized)):(n=new he[h.type](h.array),n=new Nb(n,h.itemSize,h.normalized));void 0!==h.name&&(n.name=h.name);k.push(n)}e.morphAttributes[l]=k}a.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);l=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==l)for(let m=0,p=l.length;m!==p;++m)g=l[m],e.addGroup(g.start,g.count,g.materialIndex);l=a.data.boundingSphere;
void 0!==l&&(g=new I,void 0!==l.center&&g.fromArray(l.center),e.boundingSphere=new qc(g,l.radius));a.name&&(e.name=a.name);a.userData&&(e.userData=a.userData);return e}}class Um extends Dc{constructor(a){super(a)}load(a,b,c,d){const e=this;var f=""===this.path?Sh.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||f;f=new nd(this.manager);f.setPath(this.path);f.setRequestHeader(this.requestHeader);f.setWithCredentials(this.withCredentials);f.load(a,function(g){let k=null;try{k=JSON.parse(g)}catch(h){void 0!==
d&&d(h);console.error("THREE:ObjectLoader: Can't parse "+a+".",h.message);return}g=k.metadata;void 0===g||void 0===g.type||"geometry"===g.type.toLowerCase()?(void 0!==d&&d(Error("THREE.ObjectLoader: Can't load "+a)),console.error("THREE.ObjectLoader: Can't load "+a)):e.parse(k,b)},c,d)}async loadAsync(a,b){var c=""===this.path?Sh.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||c;c=new nd(this.manager);c.setPath(this.path);c.setRequestHeader(this.requestHeader);c.setWithCredentials(this.withCredentials);
b=await c.loadAsync(a,b);b=JSON.parse(b);c=b.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+a);return await this.parseAsync(b)}parse(a,b){const c=this.parseAnimations(a.animations);var d=this.parseShapes(a.shapes);const e=this.parseGeometries(a.geometries,d);d=this.parseImages(a.images,function(){void 0!==b&&b(k)});const f=this.parseTextures(a.textures,d),g=this.parseMaterials(a.materials,f),k=this.parseObject(a.object,e,g,
f,c);a=this.parseSkeletons(a.skeletons,k);this.bindSkeletons(k,a);if(void 0!==b){a=!1;for(const h in d)if(d[h].data instanceof HTMLImageElement){a=!0;break}!1===a&&b(k)}return k}async parseAsync(a){var b=this.parseAnimations(a.animations),c=this.parseShapes(a.shapes);c=this.parseGeometries(a.geometries,c);var d=await this.parseImagesAsync(a.images);d=this.parseTextures(a.textures,d);const e=this.parseMaterials(a.materials,d);b=this.parseObject(a.object,c,e,d,b);a=this.parseSkeletons(a.skeletons,b);
this.bindSkeletons(b,a);return b}parseShapes(a){const b={};if(void 0!==a)for(let c=0,d=a.length;c<d;c++){const e=(new Ud).fromJSON(a[c]);b[e.uuid]=e}return b}parseSkeletons(a,b){const c={},d={};b.traverse(function(e){e.isBone&&(d[e.uuid]=e)});if(void 0!==a)for(let e=0,f=a.length;e<f;e++)b=(new lh).fromJSON(a[e],d),c[b.uuid]=b;return c}parseGeometries(a,b){const c={};if(void 0!==a){const d=new tk;for(let e=0,f=a.length;e<f;e++){let g;const k=a[e];switch(k.type){case "BufferGeometry":case "InstancedBufferGeometry":g=
d.parse(k);break;default:k.type in Tj?g=Tj[k.type].fromJSON(k,b):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${k.type}"`)}g.uuid=k.uuid;void 0!==k.name&&(g.name=k.name);void 0!==k.userData&&(g.userData=k.userData);c[k.uuid]=g}}return c}parseMaterials(a,b){const c={},d={};if(void 0!==a){const e=new Rh;e.setTextures(b);for(let f=0,g=a.length;f<g;f++)b=a[f],void 0===c[b.uuid]&&(c[b.uuid]=e.parse(b)),d[b.uuid]=c[b.uuid]}return d}parseAnimations(a){const b={};if(void 0!==a)for(let c=0;c<
a.length;c++){const d=cf.parse(a[c]);b[d.uuid]=d}return b}parseImages(a,b){function c(h){e.manager.itemStart(h);return g.load(h,function(){e.manager.itemEnd(h)},void 0,function(){e.manager.itemError(h);e.manager.itemEnd(h)})}function d(h){return"string"===typeof h?(h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:e.resourcePath+h,c(h)):h.data?{data:new he[h.type](h.data),width:h.width,height:h.height}:null}const e=this,f={};let g;if(void 0!==a&&0<a.length){b=new Nh(b);g=new df(b);g.setCrossOrigin(this.crossOrigin);
for(let h=0,l=a.length;h<l;h++){b=a[h];var k=b.url;if(Array.isArray(k)){const n=[];for(let m=0,p=k.length;m<p;m++){const v=d(k[m]);null!==v&&(v instanceof HTMLImageElement?n.push(v):n.push(new xd(v.data,v.width,v.height)))}f[b.uuid]=new Ld(n)}else k=d(b.url),f[b.uuid]=new Ld(k)}}return f}async parseImagesAsync(a){async function b(g){return"string"===typeof g?(g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(g)?g:c.resourcePath+g,await e.loadAsync(g)):g.data?{data:new he[g.type](g.data),width:g.width,height:g.height}:
null}const c=this,d={};let e;if(void 0!==a&&0<a.length){e=new df(this.manager);e.setCrossOrigin(this.crossOrigin);for(let g=0,k=a.length;g<k;g++){const h=a[g];var f=h.url;if(Array.isArray(f)){const l=[];for(let n=0,m=f.length;n<m;n++){const p=await b(f[n]);null!==p&&(p instanceof HTMLImageElement?l.push(p):l.push(new xd(p.data,p.width,p.height)))}d[h.uuid]=new Ld(l)}else f=await b(h.url),d[h.uuid]=new Ld(f)}}return d}parseTextures(a,b){function c(e,f){if("number"===typeof e)return e;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
e);return f[e]}const d={};if(void 0!==a)for(let e=0,f=a.length;e<f;e++){const g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);const k=b[g.image],h=k.data;let l;Array.isArray(h)?(l=new Re,6===h.length&&(l.needsUpdate=!0)):(l=h&&h.data?new xd:new cc,h&&(l.needsUpdate=!0));l.source=k;l.uuid=g.uuid;void 0!==g.name&&(l.name=g.name);void 0!==g.mapping&&(l.mapping=c(g.mapping,Vm));
void 0!==g.channel&&(l.channel=g.channel);void 0!==g.offset&&l.offset.fromArray(g.offset);void 0!==g.repeat&&l.repeat.fromArray(g.repeat);void 0!==g.center&&l.center.fromArray(g.center);void 0!==g.rotation&&(l.rotation=g.rotation);void 0!==g.wrap&&(l.wrapS=c(g.wrap[0],uk),l.wrapT=c(g.wrap[1],uk));void 0!==g.format&&(l.format=g.format);void 0!==g.internalFormat&&(l.internalFormat=g.internalFormat);void 0!==g.type&&(l.type=g.type);void 0!==g.colorSpace&&(l.colorSpace=g.colorSpace);void 0!==g.minFilter&&
(l.minFilter=c(g.minFilter,vk));void 0!==g.magFilter&&(l.magFilter=c(g.magFilter,vk));void 0!==g.anisotropy&&(l.anisotropy=g.anisotropy);void 0!==g.flipY&&(l.flipY=g.flipY);void 0!==g.generateMipmaps&&(l.generateMipmaps=g.generateMipmaps);void 0!==g.premultiplyAlpha&&(l.premultiplyAlpha=g.premultiplyAlpha);void 0!==g.unpackAlignment&&(l.unpackAlignment=g.unpackAlignment);void 0!==g.compareFunction&&(l.compareFunction=g.compareFunction);void 0!==g.userData&&(l.userData=g.userData);d[g.uuid]=l}return d}parseObject(a,
b,c,d,e){function f(m){void 0===b[m]&&console.warn("THREE.ObjectLoader: Undefined geometry",m);return b[m]}function g(m){if(void 0!==m){if(Array.isArray(m)){const p=[];for(let v=0,t=m.length;v<t;v++){const x=m[v];void 0===c[x]&&console.warn("THREE.ObjectLoader: Undefined material",x);p.push(c[x])}return p}void 0===c[m]&&console.warn("THREE.ObjectLoader: Undefined material",m);return c[m]}}function k(m){void 0===d[m]&&console.warn("THREE.ObjectLoader: Undefined texture",m);return d[m]}switch(a.type){case "Scene":var h=
new lj;void 0!==a.background&&(Number.isInteger(a.background)?h.background=new Ya(a.background):h.background=k(a.background));void 0!==a.environment&&(h.environment=k(a.environment));void 0!==a.fog&&("Fog"===a.fog.type?h.fog=new fh(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(h.fog=new eh(a.fog.color,a.fog.density)),""!==a.fog.name&&(h.fog.name=a.fog.name));void 0!==a.backgroundBlurriness&&(h.backgroundBlurriness=a.backgroundBlurriness);void 0!==a.backgroundIntensity&&(h.backgroundIntensity=
a.backgroundIntensity);void 0!==a.backgroundRotation&&h.backgroundRotation.fromArray(a.backgroundRotation);void 0!==a.environmentRotation&&h.environmentRotation.fromArray(a.environmentRotation);break;case "PerspectiveCamera":h=new lc(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(h.focus=a.focus);void 0!==a.zoom&&(h.zoom=a.zoom);void 0!==a.filmGauge&&(h.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(h.filmOffset=a.filmOffset);void 0!==a.view&&(h.view=Object.assign({},a.view));break;case "OrthographicCamera":h=
new Hf(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(h.zoom=a.zoom);void 0!==a.view&&(h.view=Object.assign({},a.view));break;case "AmbientLight":h=new ok(a.color,a.intensity);break;case "DirectionalLight":h=new nk(a.color,a.intensity);break;case "PointLight":h=new mk(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":h=new pk(a.color,a.intensity,a.width,a.height);break;case "SpotLight":h=new kk(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":h=
new hk(a.color,a.groundColor,a.intensity);break;case "LightProbe":h=(new rk).fromJSON(a);break;case "SkinnedMesh":var l=f(a.geometry);h=g(a.material);h=new wj(l,h);void 0!==a.bindMode&&(h.bindMode=a.bindMode);void 0!==a.bindMatrix&&h.bindMatrix.fromArray(a.bindMatrix);void 0!==a.skeleton&&(h.skeleton=a.skeleton);break;case "Mesh":l=f(a.geometry);h=g(a.material);h=new dc(l,h);break;case "InstancedMesh":l=f(a.geometry);h=g(a.material);var n=a.instanceMatrix;const m=a.instanceColor;h=new Aj(l,h,a.count);
h.instanceMatrix=new Be(new Float32Array(n.array),16);void 0!==m&&(h.instanceColor=new Be(new Float32Array(m.array),m.itemSize));break;case "BatchedMesh":l=f(a.geometry);h=g(a.material);h=new Dj(a.maxGeometryCount,a.maxVertexCount,a.maxIndexCount,h);h.geometry=l;h.perObjectFrustumCulled=a.perObjectFrustumCulled;h.sortObjects=a.sortObjects;h._drawRanges=a.drawRanges;h._reservedRanges=a.reservedRanges;h._visibility=a.visibility;h._active=a.active;h._bounds=a.bounds.map(p=>{const v=new xc;v.min.fromArray(p.boxMin);
v.max.fromArray(p.boxMax);const t=new qc;t.radius=p.sphereRadius;t.center.fromArray(p.sphereCenter);return{boxInitialized:p.boxInitialized,box:v,sphereInitialized:p.sphereInitialized,sphere:t}});h._maxGeometryCount=a.maxGeometryCount;h._maxVertexCount=a.maxVertexCount;h._maxIndexCount=a.maxIndexCount;h._geometryInitialized=a.geometryInitialized;h._geometryCount=a.geometryCount;h._matricesTexture=k(a.matricesTexture.uuid);break;case "LOD":h=new qj;break;case "Line":h=new zd(f(a.geometry),g(a.material));
break;case "LineLoop":h=new Jj(f(a.geometry),g(a.material));break;case "LineSegments":h=new bd(f(a.geometry),g(a.material));break;case "PointCloud":case "Points":h=new Lj(f(a.geometry),g(a.material));break;case "Sprite":h=new oj(g(a.material));break;case "Group":h=new te;break;case "Bone":h=new kh;break;default:h=new Gb}h.uuid=a.uuid;void 0!==a.name&&(h.name=a.name);void 0!==a.matrix?(h.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(h.matrixAutoUpdate=a.matrixAutoUpdate),h.matrixAutoUpdate&&
h.matrix.decompose(h.position,h.quaternion,h.scale)):(void 0!==a.position&&h.position.fromArray(a.position),void 0!==a.rotation&&h.rotation.fromArray(a.rotation),void 0!==a.quaternion&&h.quaternion.fromArray(a.quaternion),void 0!==a.scale&&h.scale.fromArray(a.scale));void 0!==a.up&&h.up.fromArray(a.up);void 0!==a.castShadow&&(h.castShadow=a.castShadow);void 0!==a.receiveShadow&&(h.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(h.shadow.bias=a.shadow.bias),void 0!==a.shadow.normalBias&&
(h.shadow.normalBias=a.shadow.normalBias),void 0!==a.shadow.radius&&(h.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&h.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(h.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(h.visible=a.visible);void 0!==a.frustumCulled&&(h.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(h.renderOrder=a.renderOrder);void 0!==a.userData&&(h.userData=a.userData);void 0!==a.layers&&(h.layers.mask=a.layers);if(void 0!==
a.children)for(l=a.children,n=0;n<l.length;n++)h.add(this.parseObject(l[n],b,c,d,e));if(void 0!==a.animations)for(l=a.animations,n=0;n<l.length;n++)h.animations.push(e[l[n]]);if("LOD"===a.type)for(void 0!==a.autoUpdate&&(h.autoUpdate=a.autoUpdate),a=a.levels,e=0;e<a.length;e++)l=a[e],n=h.getObjectByProperty("uuid",l.object),void 0!==n&&h.addLevel(n,l.distance,l.hysteresis);return h}bindSkeletons(a,b){0!==Object.keys(b).length&&a.traverse(function(c){if(!0===c.isSkinnedMesh&&void 0!==c.skeleton){const d=
b[c.skeleton];void 0===d?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",c.skeleton):c.bind(d,c.bindMatrix)}})}}const Vm={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306},uk={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},vk={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,
LinearMipmapLinearFilter:1008};class Wm extends Dc{constructor(a){super(a);this.isImageBitmapLoader=!0;"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.options={premultiplyAlpha:"none"}}setOptions(a){this.options=a;return this}load(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);const e=this,
f=ld.get(a);if(void 0!==f){e.manager.itemStart(a);if(f.then){f.then(g=>{b&&b(g);e.manager.itemEnd(a)}).catch(g=>{d&&d(g)});return}setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0);return f}c={};c.credentials="anonymous"===this.crossOrigin?"same-origin":"include";c.headers=this.requestHeader;c=fetch(a,c).then(function(g){return g.blob()}).then(function(g){return createImageBitmap(g,Object.assign(e.options,{colorSpaceConversion:"none"}))}).then(function(g){ld.add(a,g);b&&b(g);e.manager.itemEnd(a);
return g}).catch(function(g){d&&d(g);ld.remove(a);e.manager.itemError(a);e.manager.itemEnd(a)});ld.add(a,c);e.manager.itemStart(a)}}let eg;class Th{static getContext(){void 0===eg&&(eg=new (window.AudioContext||window.webkitAudioContext));return eg}static setContext(a){eg=a}}class Xm extends Dc{constructor(a){super(a)}load(a,b,c,d){function e(k){d?d(k):console.error(k);f.manager.itemError(a)}const f=this,g=new nd(this.manager);g.setResponseType("arraybuffer");g.setPath(this.path);g.setRequestHeader(this.requestHeader);
g.setWithCredentials(this.withCredentials);g.load(a,function(k){try{const h=k.slice(0);Th.getContext().decodeAudioData(h,function(l){b(l)}).catch(e)}catch(h){e(h)}},c,d)}}const wk=new lb,xk=new lb,Vd=new lb;class Ym{constructor(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new lc;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new lc;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1;this._cache={focus:null,fov:null,aspect:null,near:null,
far:null,zoom:null,eyeSep:null}}update(a){const b=this._cache;if(b.focus!==a.focus||b.fov!==a.fov||b.aspect!==a.aspect*this.aspect||b.near!==a.near||b.far!==a.far||b.zoom!==a.zoom||b.eyeSep!==this.eyeSep){b.focus=a.focus;b.fov=a.fov;b.aspect=a.aspect*this.aspect;b.near=a.near;b.far=a.far;b.zoom=a.zoom;b.eyeSep=this.eyeSep;Vd.copy(a.projectionMatrix);var c=b.eyeSep/2;const d=c*b.near/b.focus,e=b.near*Math.tan(Kd*b.fov*.5)/b.zoom;let f;xk.elements[12]=-c;wk.elements[12]=c;c=-e*b.aspect+d;f=e*b.aspect+
d;Vd.elements[0]=2*b.near/(f-c);Vd.elements[8]=(f+c)/(f-c);this.cameraL.projectionMatrix.copy(Vd);c=-e*b.aspect-d;f=e*b.aspect-d;Vd.elements[0]=2*b.near/(f-c);Vd.elements[8]=(f+c)/(f-c);this.cameraR.projectionMatrix.copy(Vd)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(xk);this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(wk)}}class yk{constructor(a=!0){this.autoStart=a;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}start(){this.oldTime=this.startTime=Ii();this.elapsedTime=
0;this.running=!0}stop(){this.getElapsedTime();this.autoStart=this.running=!1}getElapsedTime(){this.getDelta();return this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const b=Ii();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}}const Wd=new I,zk=new Cc,Zm=new I,Xd=new I;class $m extends Gb{constructor(){super();this.type="AudioListener";this.context=Th.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);
this.filter=null;this.timeDelta=0;this._clock=new yk}getInput(){return this.gain}removeFilter(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this}getFilter(){return this.filter}setFilter(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);
this.filter.connect(this.context.destination);return this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}updateMatrixWorld(a){super.updateMatrixWorld(a);a=this.context.listener;const b=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(Wd,zk,Zm);Xd.set(0,0,-1).applyQuaternion(zk);if(a.positionX){const c=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(Wd.x,
c);a.positionY.linearRampToValueAtTime(Wd.y,c);a.positionZ.linearRampToValueAtTime(Wd.z,c);a.forwardX.linearRampToValueAtTime(Xd.x,c);a.forwardY.linearRampToValueAtTime(Xd.y,c);a.forwardZ.linearRampToValueAtTime(Xd.z,c);a.upX.linearRampToValueAtTime(b.x,c);a.upY.linearRampToValueAtTime(b.y,c);a.upZ.linearRampToValueAtTime(b.z,c)}else a.setPosition(Wd.x,Wd.y,Wd.z),a.setOrientation(Xd.x,Xd.y,Xd.z,b.x,b.y,b.z)}}class Ak extends Gb{constructor(a){super();this.type="Audio";this.listener=a;this.context=
a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.detune=0;this.loop=!1;this.offset=this.loopEnd=this.loopStart=0;this.duration=void 0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.source=null;this.sourceType="empty";this._progress=this._startedAt=0;this._connected=!1;this.filters=[]}getOutput(){return this.gain}setNodeSource(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();
return this}setMediaElementSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this}setMediaStreamSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaStreamNode";this.source=this.context.createMediaStreamSource(a);this.connect();return this}setBuffer(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this}play(a=0){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");
else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+a,a=this.context.createBufferSource(),a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1===
this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,null!==this.source&&(this.source.stop(),
this.source.onended=null),this.isPlaying=!1,this}connect(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());this._connected=!0;return this}disconnect(){if(!1!==this._connected){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-
1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());this._connected=!1;return this}}getFilters(){return this.filters}setFilters(a){a||(a=[]);!0===this._connected?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice();return this}setDetune(a){this.detune=a;!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01);return this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(a){return this.setFilters(a?
[a]:[])}setPlaybackRate(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(a){this.loopStart=a;return this}setLoopEnd(a){this.loopEnd=a;return this}getVolume(){return this.gain.gain.value}setVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}}const Yd=new I,Bk=new Cc,an=new I,Zd=new I;class bn extends Ak{constructor(a){super(a);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}connect(){super.connect();
this.panner.connect(this.gain)}disconnect(){super.disconnect();this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(a){this.panner.refDistance=a;return this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(a){this.panner.rolloffFactor=a;return this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(a){this.panner.distanceModel=a;return this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(a){this.panner.maxDistance=
a;return this}setDirectionalCone(a,b,c){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=c;return this}updateMatrixWorld(a){super.updateMatrixWorld(a);if(!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(Yd,Bk,an),Zd.set(0,0,1).applyQuaternion(Bk),a=this.panner,a.positionX){const b=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Yd.x,b);a.positionY.linearRampToValueAtTime(Yd.y,b);a.positionZ.linearRampToValueAtTime(Yd.z,
b);a.orientationX.linearRampToValueAtTime(Zd.x,b);a.orientationY.linearRampToValueAtTime(Zd.y,b);a.orientationZ.linearRampToValueAtTime(Zd.z,b)}else a.setPosition(Yd.x,Yd.y,Yd.z),a.setOrientation(Zd.x,Zd.y,Zd.z)}}class cn{constructor(a,b=2048){this.analyser=a.context.createAnalyser();this.analyser.fftSize=b;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}getFrequencyData(){this.analyser.getByteFrequencyData(this.data);return this.data}getAverageFrequency(){let a=
0;const b=this.getFrequencyData();for(let c=0;c<b.length;c++)a+=b[c];return a/b.length}}class Ck{constructor(a,b,c){this.binding=a;this.valueSize=c;let d;switch(b){case "quaternion":a=this._slerp;b=this._slerpAdditive;d=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*c);this._workIndex=5;break;case "string":case "bool":b=a=this._select;d=this._setAdditiveIdentityOther;this.buffer=Array(5*c);break;default:a=this._lerp,b=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=
new Float64Array(5*c)}this._mixBufferRegion=a;this._mixBufferRegionAdditive=b;this._setIdentity=d;this._origIndex=3;this._addIndex=4;this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}accumulate(a,b){const c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=e}accumulateAdditive(a){const b=this.buffer,c=this.valueSize,d=c*this._addIndex;
0===this.cumulativeWeightAdditive&&this._setIdentity();this._mixBufferRegionAdditive(b,d,0,a,c);this.cumulativeWeightAdditive+=a}apply(a){const b=this.valueSize,c=this.buffer;a=a*b+b;const d=this.cumulativeWeight,e=this.cumulativeWeightAdditive,f=this.binding;this.cumulativeWeightAdditive=this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,b*this._origIndex,1-d,b);0<e&&this._mixBufferRegionAdditive(c,a,this._addIndex*b,1,b);for(let g=b,k=b+b;g!==k;++g)if(c[g]!==c[g+b]){f.setValue(c,a);break}}saveOriginalState(){const a=
this.buffer,b=this.valueSize,c=b*this._origIndex;this.binding.getValue(a,c);for(let d=b,e=c;d!==e;++d)a[d]=a[c+d%b];this._setIdentity();this.cumulativeWeightAdditive=this.cumulativeWeight=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){var a=this._addIndex*this.valueSize;const b=a+this.valueSize;for(;a<b;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const a=
this._origIndex*this.valueSize,b=this._addIndex*this.valueSize;for(let c=0;c<this.valueSize;c++)this.buffer[b+c]=this.buffer[a+c]}_select(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]}_slerp(a,b,c,d){Cc.slerpFlat(a,b,a,b,a,c,d)}_slerpAdditive(a,b,c,d,e){e*=this._workIndex;Cc.multiplyQuaternionsFlat(a,e,a,b,a,c);Cc.slerpFlat(a,b,a,b,a,e,d)}_lerp(a,b,c,d,e){const f=1-d;for(let g=0;g!==e;++g){const k=b+g;a[k]=a[k]*f+a[c+g]*d}}_lerpAdditive(a,b,c,d,e){for(let f=0;f!==e;++f){const g=b+f;a[g]+=a[c+
f]*d}}}const dn=RegExp("[\\[\\]\\.:\\/]","g"),en=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),fn=/(WCOD+)?/.source.replace("WCOD","[^\\[\\]:\\/]"),gn=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),hn=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),jn=new RegExp("^"+en+fn+gn+hn+"$"),kn=["material","materials","bones","map"];class ln{constructor(a,b,c){c=c||Fb.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}getValue(a,b){this.bind();
const c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)}setValue(a,b){const c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)}bind(){const a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()}unbind(){const a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}}class Fb{constructor(a,b,c){this.path=b;this.parsedPath=c||Fb.parseTrackName(b);
this.node=Fb.findNode(a,this.parsedPath.nodeName);this.rootNode=a;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}static create(a,b,c){return a&&a.isAnimationObjectGroup?new Fb.Composite(a,b,c):new Fb(a,b,c)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(dn,"")}static parseTrackName(a){var b=jn.exec(a);if(null===b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};
const c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){const d=b.nodeName.substring(c+1);-1!==kn.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}static findNode(a,b){if(void 0===b||""===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){const c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){const c=
function(d){for(let f=0;f<d.length;f++){var e=d[f];if(e.name===b||e.uuid===b||(e=c(e.children)))return e}return null};if(a=c(a.children))return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,b){a[b]=this.targetObject[this.propertyName]}_getValue_array(a,b){const c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)a[b++]=c[d]}_getValue_arrayElement(a,b){a[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,b){this.resolvedProperty.toArray(a,b)}_setValue_direct(a,
b){this.targetObject[this.propertyName]=a[b]}_setValue_direct_setNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,b){const c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++]}_setValue_array_setNeedsUpdate(a,b){const c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=
!0}_setValue_array_setMatrixWorldNeedsUpdate(a,b){const c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,b){this.resolvedProperty[this.propertyIndex]=a[b]}_setValue_arrayElement_setNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0}_setValue_fromArray(a,b){this.resolvedProperty.fromArray(a,b)}_setValue_fromArray_setNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,b){this.bind();this.getValue(a,b)}_setValue_unbound(a,b){this.bind();this.setValue(a,b)}bind(){let a=this.node;var b=this.parsedPath,c=b.objectName;const d=b.propertyName;let e=
b.propertyIndex;a||(this.node=a=Fb.findNode(this.rootNode,b.nodeName));this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=
a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;case "map":if("map"in a){a=a.map;break}if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",
this);return}a=a.material.map;break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);else{b=this.Versioning.None;this.targetObject=
a;void 0!==a.needsUpdate?b=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
this);return}void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.warn("THREE.PropertyBinding: No target node found for track: "+
this.path+".")}unbind(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}}Fb.Composite=ln;Fb.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Fb.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Fb.prototype.GetterByBindingType=[Fb.prototype._getValue_direct,Fb.prototype._getValue_array,Fb.prototype._getValue_arrayElement,Fb.prototype._getValue_toArray];Fb.prototype.SetterByBindingTypeAndVersioning=[[Fb.prototype._setValue_direct,
Fb.prototype._setValue_direct_setNeedsUpdate,Fb.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fb.prototype._setValue_array,Fb.prototype._setValue_array_setNeedsUpdate,Fb.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fb.prototype._setValue_arrayElement,Fb.prototype._setValue_arrayElement_setNeedsUpdate,Fb.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fb.prototype._setValue_fromArray,Fb.prototype._setValue_fromArray_setNeedsUpdate,Fb.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];
class mn{constructor(){this.isAnimationObjectGroup=!0;this.uuid=pa();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;const a={};this._indicesByUUID=a;for(let c=0,d=arguments.length;c!==d;++c)a[arguments[c].uuid]=c;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};const b=this;this.stats={objects:{get total(){return b._objects.length},get inUse(){return this.total-b.nCachedObjects_}},get bindingsPerObject(){return b._bindings.length}}}add(){const a=
this._objects,b=this._indicesByUUID,c=this._paths,d=this._parsedPaths,e=this._bindings,f=e.length;let g=void 0,k=a.length,h=this.nCachedObjects_;for(let m=0,p=arguments.length;m!==p;++m){const v=arguments[m];var l=v.uuid;let t=b[l];if(void 0===t){t=k++;b[l]=t;a.push(v);for(let x=0,C=f;x!==C;++x)e[x].push(new Fb(v,c[x],d[x]))}else if(t<h){g=a[t];const x=--h;var n=a[x];b[n.uuid]=t;a[t]=n;b[l]=x;a[x]=v;for(let C=0,u=f;C!==u;++C)l=e[C],n=l[t],l[t]=l[x],void 0===n&&(n=new Fb(v,c[C],d[C])),l[x]=n}else a[t]!==
g&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length;let e=this.nCachedObjects_;for(let k=0,h=arguments.length;k!==h;++k){var f=arguments[k],g=f.uuid;const l=b[g];if(void 0!==l&&l>=e){const n=e++,m=a[n];b[m.uuid]=l;a[l]=m;b[g]=n;a[n]=f;for(let p=0,v=d;p!==v;++p)f=c[p],g=f[l],f[l]=f[n],
f[n]=g}}this.nCachedObjects_=e}uncache(){const a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length;let e=this.nCachedObjects_,f=a.length;for(let n=0,m=arguments.length;n!==m;++n){var g=arguments[n].uuid;const p=b[g];if(void 0!==p)if(delete b[g],p<e){g=--e;var k=a[g],h=--f,l=a[h];b[k.uuid]=p;a[p]=k;b[l.uuid]=g;a[g]=l;a.pop();for(let v=0,t=d;v!==t;++v)k=c[v],l=k[h],k[p]=k[g],k[g]=l,k.pop()}else{g=--f;h=a[g];0<g&&(b[h.uuid]=p);a[p]=h;a.pop();for(let v=0,t=d;v!==t;++v)h=c[v],h[p]=h[g],h.pop()}}this.nCachedObjects_=
e}subscribe_(a,b){const c=this._bindingsIndicesByPath;let d=c[a];const e=this._bindings;if(void 0!==d)return e[d];const f=this._paths,g=this._parsedPaths,k=this._objects,h=this.nCachedObjects_,l=Array(k.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);for(let n=h,m=k.length;n!==m;++n)l[n]=new Fb(k[n],a,b);return l}unsubscribe_(a){const b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){const d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,k=f[g];b[a[g]]=c;f[c]=k;f.pop();e[c]=
e[g];e.pop();d[c]=d[g];d.pop()}}}class Dk{constructor(a,b,c=null,d=b.blendMode){this._mixer=a;this._clip=b;this._localRoot=c;this.blendMode=d;a=b.tracks;b=a.length;c=Array(b);d={endingStart:2400,endingEnd:2400};for(let e=0;e!==b;++e){const f=a[e].createInterpolant(null);c[e]=f;f.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;
this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}play(){this._mixer._activateAction(this);return this}stop(){this._mixer._deactivateAction(this);return this.reset()}reset(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()}isRunning(){return this.enabled&&
!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(a){this._startTime=a;return this}setLoop(a,b){this.loop=a;this.repetitions=b;return this}setEffectiveWeight(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(a){return this._scheduleFading(a,0,1)}fadeOut(a){return this._scheduleFading(a,1,0)}crossFadeFrom(a,
b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;const d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this}crossFadeTo(a,b,c){return a.crossFadeFrom(this,b,c)}stopFading(){const a=this._weightInterpolant;null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this}setEffectiveTimeScale(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(a){this.timeScale=
this._clip.duration/a;return this.stopWarping()}syncWith(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()}halt(a){return this.warp(this._effectiveTimeScale,0,a)}warp(a,b,c){var d=this._mixer;const e=d.time,f=this.timeScale;var g=this._timeScaleInterpolant;null===g&&(this._timeScaleInterpolant=g=d._lendControlInterpolant());d=g.parameterPositions;g=g.sampleValues;d[0]=e;d[1]=e+c;g[0]=a/f;g[1]=b/f;return this}stopWarping(){const a=this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=
null,this._mixer._takeBackControlInterpolant(a));return this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(a,b,c,d){if(this.enabled){var e=this._startTime;null!==e&&(b=(a-e)*c,0>b||0===c?b=0:(this._startTime=null,b*=c));b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a)switch(b=this._interpolants,e=this._propertyBindings,this.blendMode){case 2501:for(let f=0,g=b.length;f!==g;++f)b[f].evaluate(c),
e[f].accumulateAdditive(a);break;default:for(let f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)}_updateWeight(a){let b=0;if(this.enabled){b=this.weight;const c=this._weightInterpolant;if(null!==c){const d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b}_updateTimeScale(a){let b=0;if(!this.paused){b=this.timeScale;const c=this._timeScaleInterpolant;if(null!==c){const d=c.evaluate(a)[0];
b*=d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b}_updateTime(a){const b=this._clip.duration;var c=this.loop;let d=this.time+a,e=this._loopCount;const f=2202===c;if(0===a)return-1===e?d:f&&1===(e&1)?b-d:d;if(2200===c)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),d>=b)d=b;else if(0>d)d=0;else{this.time=d;break a}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this.time=d;this._mixer.dispatchEvent({type:"finished",
action:this,direction:0>a?-1:1})}else{-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f));if(d>=b||0>d){c=Math.floor(d/b);d-=b*c;e+=Math.abs(c);const g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=d=0<a?b:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this.time=d,this._mixer.dispatchEvent({type:"loop",
action:this,loopDelta:c}))}else this.time=d;if(f&&1===(e&1))return b-d}return d}_setEndings(a,b,c){const d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(a,b,c){var d=this._mixer;const e=d.time;var f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}}
const nn=new Float32Array(1);class on extends dd{constructor(a){super();this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}_bindAction(a,b){const c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;const g=c.uuid;var k=this._bindingsByRootAndName;let h=k[g];void 0===h&&(h={},k[g]=h);for(k=0;k!==e;++k){const l=d[k],n=l.name;let m=h[n];if(void 0!==m)++m.referenceCount;else{m=f[k];if(void 0!==m){null===m._cacheIndex&&(++m.referenceCount,
this._addInactiveBinding(m,g,n));continue}m=new Ck(Fb.create(c,n,b&&b._propertyBindings[k].binding.parsedPath),l.ValueTypeName,l.getValueSize());++m.referenceCount;this._addInactiveBinding(m,g,n)}f[k]=m;a[k].resultBuffer=m.buffer}}_activateAction(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid;const d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;for(let d=0,e=b.length;d!==
e;++d)c=b[d],0===c.useCount++&&(this._lendBinding(c),c.saveOriginalState());this._lendAction(a)}}_deactivateAction(a){if(this._isActiveAction(a)){const b=a._propertyBindings;for(let c=0,d=b.length;c!==d;++c){const e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}}_initMemoryManager(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];
this._nActiveControlInterpolants=0;const a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}}_isActiveAction(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions}_addInactiveAction(a,b,c){const d=this._actions,e=this._actionsByClip;
let f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);f.actionByRoot[c]=a}_removeInactiveAction(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;c=this._actionsByClip;d=c[b];const e=d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||
this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)}_removeInactiveBindingsForAction(a){a=a._propertyBindings;for(let b=0,c=a.length;b!==c;++b){const d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}}_lendAction(a){const b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e}_takeBackAction(a){const b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=
c;b[c]=e}_addInactiveBinding(a,b,c){const d=this._bindingsByRootAndName,e=this._bindings;let f=d[b];void 0===f&&(f={},d[b]=f);f[c]=a;a._cacheIndex=e.length;e.push(a)}_removeInactiveBinding(a){const b=this._bindings;var c=a.binding;const d=c.rootNode.uuid;c=c.path;const e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex;g._cacheIndex=a;b[a]=g;b.pop();delete f[c];0===Object.keys(f).length&&delete e[d]}_lendBinding(a){const b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,
e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e}_takeBackBinding(a){const b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e}_lendControlInterpolant(){const a=this._controlInterpolants,b=this._nActiveControlInterpolants++;let c=a[b];void 0===c&&(c=new Mh(new Float32Array(2),new Float32Array(2),1,nn),c.__cacheIndex=b,a[b]=c);return c}_takeBackControlInterpolant(a){const b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,
e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=c;b[c]=e}clipAction(a,b,c){var d=b||this._root;const e=d.uuid;d="string"===typeof a?cf.findByName(d,a):a;a=null!==d?d.uuid:a;const f=this._actionsByClip[a];var g=null;void 0===c&&(c=null!==d?d.blendMode:2500);if(void 0!==f){g=f.actionByRoot[e];if(void 0!==g&&g.blendMode===c)return g;g=f.knownActions[0];null===d&&(d=g._clip)}if(null===d)return null;b=new Dk(this,d,b,c);this._bindAction(b,g);this._addInactiveAction(b,a,e);return b}existingAction(a,b){var c=
b||this._root;b=c.uuid;c="string"===typeof a?cf.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a?a.actionByRoot[b]||null:null}stopAllAction(){const a=this._actions;var b=this._nActiveActions;for(--b;0<=b;--b)a[b].stop();return this}update(a){a*=this.timeScale;var b=this._actions,c=this._nActiveActions;const d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1;for(let g=0;g!==c;++g)b[g]._update(d,a,e,f);a=this._bindings;b=this._nActiveBindings;for(c=0;c!==b;++c)a[c].apply(f);return this}setTime(a){this.time=
0;for(let b=0;b<this._actions.length;b++)this._actions[b].time=0;return this.update(a)}getRoot(){return this._root}uncacheClip(a){const b=this._actions;a=a.uuid;const c=this._actionsByClip;var d=c[a];if(void 0!==d){d=d.knownActions;for(let e=0,f=d.length;e!==f;++e){const g=d[e];this._deactivateAction(g);const k=g._cacheIndex,h=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;h._cacheIndex=k;b[k]=h;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}}uncacheRoot(a){a=a.uuid;const b=
this._actionsByClip;for(var c in b){const d=b[c].actionByRoot[a];void 0!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}c=this._bindingsByRootAndName[a];if(void 0!==c)for(const d in c)a=c[d],a.restoreOriginalState(),this._removeInactiveBinding(a)}uncacheAction(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}}class Ek{constructor(a){this.value=a}clone(){return new Ek(void 0===this.value.clone?this.value:this.value.clone())}}let pn=
0;class qn extends dd{constructor(){super();this.isUniformsGroup=!0;Object.defineProperty(this,"id",{value:pn++});this.name="";this.usage=35044;this.uniforms=[]}add(a){this.uniforms.push(a);return this}remove(a){a=this.uniforms.indexOf(a);-1!==a&&this.uniforms.splice(a,1);return this}setName(a){this.name=a;return this}setUsage(a){this.usage=a;return this}dispose(){this.dispatchEvent({type:"dispose"});return this}copy(a){this.name=a.name;this.usage=a.usage;a=a.uniforms;this.uniforms.length=0;for(let b=
0,c=a.length;b<c;b++){const d=Array.isArray(a[b])?a[b]:[a[b]];for(let e=0;e<d.length;e++)this.uniforms.push(d[e].clone())}return this}clone(){return(new this.constructor).copy(this)}}class rn extends Mf{constructor(a,b,c=1){super(a,b);this.isInstancedInterleavedBuffer=!0;this.meshPerAttribute=c}copy(a){super.copy(a);this.meshPerAttribute=a.meshPerAttribute;return this}clone(a){a=super.clone(a);a.meshPerAttribute=this.meshPerAttribute;return a}toJSON(a){a=super.toJSON(a);a.isInstancedInterleavedBuffer=
!0;a.meshPerAttribute=this.meshPerAttribute;return a}}class sn{constructor(a,b,c,d,e){this.isGLBufferAttribute=!0;this.name="";this.buffer=a;this.type=b;this.itemSize=c;this.elementSize=d;this.count=e;this.version=0}set needsUpdate(a){!0===a&&this.version++}setBuffer(a){this.buffer=a;return this}setType(a,b){this.type=a;this.elementSize=b;return this}setItemSize(a){this.itemSize=a;return this}setCount(a){this.count=a;return this}}const Fk=new lb;class tn{constructor(a,b,c=0,d=Infinity){this.ray=new me(a,
b);this.near=c;this.far=d;this.camera=null;this.layers=new nf;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,b){this.ray.set(a,b)}setFromCamera(a,b){b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize(),this.camera=b):b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld),
this.camera=b):console.error("THREE.Raycaster: Unsupported camera type: "+b.type)}setFromXRController(a){Fk.identity().extractRotation(a.matrixWorld);this.ray.origin.setFromMatrixPosition(a.matrixWorld);this.ray.direction.set(0,0,-1).applyMatrix4(Fk);return this}intersectObject(a,b=!0,c=[]){Dg(a,this,c,b);c.sort(Ji);return c}intersectObjects(a,b=!0,c=[]){for(let d=0,e=a.length;d<e;d++)Dg(a[d],this,c,b);c.sort(Ji);return c}}class un{constructor(a=1,b=0,c=0){this.radius=a;this.phi=b;this.theta=c;return this}set(a,
b,c){this.radius=a;this.phi=b;this.theta=c;return this}copy(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this}makeSafe(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,c){this.radius=Math.sqrt(a*a+b*b+c*c);0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a,c),this.phi=Math.acos(ib(b/this.radius,-1,1)));return this}clone(){return(new this.constructor).copy(this)}}
class vn{constructor(a=1,b=0,c=0){this.radius=a;this.theta=b;this.y=c;return this}set(a,b,c){this.radius=a;this.theta=b;this.y=c;return this}copy(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,c){this.radius=Math.sqrt(a*a+c*c);this.theta=Math.atan2(a,c);this.y=b;return this}clone(){return(new this.constructor).copy(this)}}const Gk=new xa;class wn{constructor(a=new xa(Infinity,Infinity),
b=new xa(-Infinity,-Infinity)){this.isBox2=!0;this.min=a;this.max=b}set(a,b){this.min.copy(a);this.max.copy(b);return this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){b=Gk.copy(b).multiplyScalar(.5);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=Infinity;this.max.x=
this.max.y=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}containsPoint(a){return a.x<this.min.x||
a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,Gk).distanceTo(a)}intersect(a){this.min.max(a.min);
this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);this.max.max(a.max);return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const Hk=new I,fg=new I;class xn{constructor(a=new I,b=new I){this.start=a;this.end=b}set(a,b){this.start.copy(a);this.end.copy(b);return this}copy(a){this.start.copy(a.start);this.end.copy(a.end);return this}getCenter(a){return a.addVectors(this.start,
this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,b){return this.delta(b).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,b){Hk.subVectors(a,this.start);fg.subVectors(this.end,this.start);a=fg.dot(fg);a=fg.dot(Hk)/a;b&&(a=ib(a,0,1));return a}closestPointToPoint(a,b,c){a=this.closestPointToPointParameter(a,b);return this.delta(c).multiplyScalar(a).add(this.start)}applyMatrix4(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Ik=new I;class yn extends Gb{constructor(a,b){super();this.light=a;this.matrixAutoUpdate=!1;this.color=b;this.type="SpotLightHelper";a=new tb;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let c=0,d=1,e=32;c<e;c++,d++){const f=c/e*Math.PI*2,g=d/e*Math.PI*2;b.push(Math.cos(f),Math.sin(f),1,Math.cos(g),Math.sin(g),1)}a.setAttribute("position",
new eb(b,3));b=new Ac({fog:!1,toneMapped:!1});this.cone=new bd(a,b);this.add(this.cone);this.update()}dispose(){this.cone.geometry.dispose();this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.light.target.updateWorldMatrix(!0,!1);this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld);this.matrixWorld.copy(this.light.matrixWorld);const a=this.light.distance?
this.light.distance:1E3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,b,a);Ik.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(Ik);void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Bd=new I,gg=new lb,Uh=new lb;class zn extends bd{constructor(a){const b=Ki(a),c=new tb;var d=[];const e=[],f=new Ya(0,0,1),g=new Ya(0,1,0);for(let k=0;k<b.length;k++){const h=b[k];h.parent&&h.parent.isBone&&(d.push(0,0,0),d.push(0,
0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.setAttribute("position",new eb(d,3));c.setAttribute("color",new eb(e,3));d=new Ac({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(c,d);this.isSkeletonHelper=!0;this.type="SkeletonHelper";this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}updateMatrixWorld(a){const b=this.bones,c=this.geometry,d=c.getAttribute("position");Uh.copy(this.root.matrixWorld).invert();for(let e=0,f=0;e<b.length;e++){const g=
b[e];g.parent&&g.parent.isBone&&(gg.multiplyMatrices(Uh,g.matrixWorld),Bd.setFromMatrixPosition(gg),d.setXYZ(f,Bd.x,Bd.y,Bd.z),gg.multiplyMatrices(Uh,g.parent.matrixWorld),Bd.setFromMatrixPosition(gg),d.setXYZ(f+1,Bd.x,Bd.y,Bd.z),f+=2)}c.getAttribute("position").needsUpdate=!0;super.updateMatrixWorld(a)}dispose(){this.geometry.dispose();this.material.dispose()}}class An extends dc{constructor(a,b,c){b=new dg(b,4,2);const d=new vd({wireframe:!0,fog:!1,toneMapped:!1});super(b,d);this.light=a;this.color=
c;this.type="PointLightHelper";this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}dispose(){this.geometry.dispose();this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Bn=new I,Jk=new Ya,Kk=new Ya;class Cn extends Gb{constructor(a,b,c){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;this.type="HemisphereLightHelper";
a=new cg(b);a.rotateY(.5*Math.PI);this.material=new vd({wireframe:!0,fog:!1,toneMapped:!1});void 0===this.color&&(this.material.vertexColors=!0);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.setAttribute("color",new Nb(b,3));this.add(new dc(a,this.material));this.update()}dispose(){this.children[0].geometry.dispose();this.children[0].material.dispose()}update(){const a=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const b=a.geometry.getAttribute("color");
Jk.copy(this.light.color);Kk.copy(this.light.groundColor);for(let c=0,d=b.count;c<d;c++){const e=c<d/2?Jk:Kk;b.setXYZ(c,e.r,e.g,e.b)}b.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1);a.lookAt(Bn.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Dn extends bd{constructor(a=10,b=10,c=4473924,d=8947848){c=new Ya(c);d=new Ya(d);const e=b/2,f=a/b,g=a/2;a=[];const k=[];for(let h=0,l=0,n=-g;h<=b;h++,n+=f){a.push(-g,0,n,g,0,n);a.push(n,0,-g,n,0,g);const m=h===e?c:d;m.toArray(k,l);l+=3;m.toArray(k,
l);l+=3;m.toArray(k,l);l+=3;m.toArray(k,l);l+=3}b=new tb;b.setAttribute("position",new eb(a,3));b.setAttribute("color",new eb(k,3));c=new Ac({vertexColors:!0,toneMapped:!1});super(b,c);this.type="GridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}class En extends bd{constructor(a=10,b=16,c=8,d=64,e=4473924,f=8947848){e=new Ya(e);f=new Ya(f);var g=[];const k=[];if(1<b)for(var h=0;h<b;h++){var l=h/b*2*Math.PI,n=Math.sin(l)*a;l=Math.cos(l)*a;g.push(0,0,0);g.push(n,0,l);n=h&1?e:f;
k.push(n.r,n.g,n.b);k.push(n.r,n.g,n.b)}for(b=0;b<c;b++)for(h=b&1?e:f,n=a-a/c*b,l=0;l<d;l++){var m=l/d*2*Math.PI;let p=Math.sin(m)*n;m=Math.cos(m)*n;g.push(p,0,m);k.push(h.r,h.g,h.b);m=(l+1)/d*2*Math.PI;p=Math.sin(m)*n;m=Math.cos(m)*n;g.push(p,0,m);k.push(h.r,h.g,h.b)}a=new tb;a.setAttribute("position",new eb(g,3));a.setAttribute("color",new eb(k,3));g=new Ac({vertexColors:!0,toneMapped:!1});super(a,g);this.type="PolarGridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}const Lk=
new I,hg=new I,Mk=new I;class Fn extends Gb{constructor(a,b,c){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;this.type="DirectionalLightHelper";void 0===b&&(b=1);a=new tb;a.setAttribute("position",new eb([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new Ac({fog:!1,toneMapped:!1});this.lightPlane=new zd(a,b);this.add(this.lightPlane);a=new tb;a.setAttribute("position",new eb([0,0,0,0,0,1],3));this.targetLine=new zd(a,b);this.add(this.targetLine);this.update()}dispose(){this.lightPlane.geometry.dispose();
this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.light.target.updateWorldMatrix(!0,!1);Lk.setFromMatrixPosition(this.light.matrixWorld);hg.setFromMatrixPosition(this.light.target.matrixWorld);Mk.subVectors(hg,Lk);this.lightPlane.lookAt(hg);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),
this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(hg);this.targetLine.scale.z=Mk.length()}}const sf=new I,$b=new Ff;class Gn extends bd{constructor(a){function b(n,m){c(n);c(m)}function c(n){f.push(0,0,0);g.push(0,0,0);void 0===k[n]&&(k[n]=[]);k[n].push(f.length/3-1)}var d=new tb,e=new Ac({color:16777215,vertexColors:!0,toneMapped:!1});const f=[],g=[],k={};b("n1","n2");b("n2","n4");b("n4","n3");b("n3","n1");b("f1","f2");b("f2","f4");b("f4","f3");b("f3","f1");b("n1","f1");
b("n2","f2");b("n3","f3");b("n4","f4");b("p","n1");b("p","n2");b("p","n3");b("p","n4");b("u1","u2");b("u2","u3");b("u3","u1");b("c","t");b("p","c");b("cn1","cn2");b("cn3","cn4");b("cf1","cf2");b("cf3","cf4");d.setAttribute("position",new eb(f,3));d.setAttribute("color",new eb(g,3));super(d,e);this.type="CameraHelper";this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=k;this.update();a=new Ya(16755200);
d=new Ya(16711680);e=new Ya(43775);const h=new Ya(16777215),l=new Ya(3355443);this.setColors(a,d,e,h,l)}setColors(a,b,c,d,e){const f=this.geometry.getAttribute("color");f.setXYZ(0,a.r,a.g,a.b);f.setXYZ(1,a.r,a.g,a.b);f.setXYZ(2,a.r,a.g,a.b);f.setXYZ(3,a.r,a.g,a.b);f.setXYZ(4,a.r,a.g,a.b);f.setXYZ(5,a.r,a.g,a.b);f.setXYZ(6,a.r,a.g,a.b);f.setXYZ(7,a.r,a.g,a.b);f.setXYZ(8,a.r,a.g,a.b);f.setXYZ(9,a.r,a.g,a.b);f.setXYZ(10,a.r,a.g,a.b);f.setXYZ(11,a.r,a.g,a.b);f.setXYZ(12,a.r,a.g,a.b);f.setXYZ(13,a.r,a.g,
a.b);f.setXYZ(14,a.r,a.g,a.b);f.setXYZ(15,a.r,a.g,a.b);f.setXYZ(16,a.r,a.g,a.b);f.setXYZ(17,a.r,a.g,a.b);f.setXYZ(18,a.r,a.g,a.b);f.setXYZ(19,a.r,a.g,a.b);f.setXYZ(20,a.r,a.g,a.b);f.setXYZ(21,a.r,a.g,a.b);f.setXYZ(22,a.r,a.g,a.b);f.setXYZ(23,a.r,a.g,a.b);f.setXYZ(24,b.r,b.g,b.b);f.setXYZ(25,b.r,b.g,b.b);f.setXYZ(26,b.r,b.g,b.b);f.setXYZ(27,b.r,b.g,b.b);f.setXYZ(28,b.r,b.g,b.b);f.setXYZ(29,b.r,b.g,b.b);f.setXYZ(30,b.r,b.g,b.b);f.setXYZ(31,b.r,b.g,b.b);f.setXYZ(32,c.r,c.g,c.b);f.setXYZ(33,c.r,c.g,c.b);
f.setXYZ(34,c.r,c.g,c.b);f.setXYZ(35,c.r,c.g,c.b);f.setXYZ(36,c.r,c.g,c.b);f.setXYZ(37,c.r,c.g,c.b);f.setXYZ(38,d.r,d.g,d.b);f.setXYZ(39,d.r,d.g,d.b);f.setXYZ(40,e.r,e.g,e.b);f.setXYZ(41,e.r,e.g,e.b);f.setXYZ(42,e.r,e.g,e.b);f.setXYZ(43,e.r,e.g,e.b);f.setXYZ(44,e.r,e.g,e.b);f.setXYZ(45,e.r,e.g,e.b);f.setXYZ(46,e.r,e.g,e.b);f.setXYZ(47,e.r,e.g,e.b);f.setXYZ(48,e.r,e.g,e.b);f.setXYZ(49,e.r,e.g,e.b);f.needsUpdate=!0}update(){const a=this.geometry,b=this.pointMap;$b.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);
bc("c",b,a,$b,0,0,-1);bc("t",b,a,$b,0,0,1);bc("n1",b,a,$b,-1,-1,-1);bc("n2",b,a,$b,1,-1,-1);bc("n3",b,a,$b,-1,1,-1);bc("n4",b,a,$b,1,1,-1);bc("f1",b,a,$b,-1,-1,1);bc("f2",b,a,$b,1,-1,1);bc("f3",b,a,$b,-1,1,1);bc("f4",b,a,$b,1,1,1);bc("u1",b,a,$b,.7,1.1,-1);bc("u2",b,a,$b,-.7,1.1,-1);bc("u3",b,a,$b,0,2,-1);bc("cf1",b,a,$b,-1,0,1);bc("cf2",b,a,$b,1,0,1);bc("cf3",b,a,$b,0,-1,1);bc("cf4",b,a,$b,0,1,1);bc("cn1",b,a,$b,-1,0,-1);bc("cn2",b,a,$b,1,0,-1);bc("cn3",b,a,$b,0,-1,-1);bc("cn4",b,a,$b,0,1,-1);a.getAttribute("position").needsUpdate=
!0}dispose(){this.geometry.dispose();this.material.dispose()}}const ig=new xc;class Hn extends bd{constructor(a,b=16776960){const c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(24),e=new tb;e.setIndex(new Nb(c,1));e.setAttribute("position",new Nb(d,3));super(e,new Ac({color:b,toneMapped:!1}));this.object=a;this.type="BoxHelper";this.matrixAutoUpdate=!1;this.update()}update(a){void 0!==a&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==
this.object&&ig.setFromObject(this.object);if(!ig.isEmpty()){a=ig.min;var b=ig.max,c=this.geometry.attributes.position,d=c.array;d[0]=b.x;d[1]=b.y;d[2]=b.z;d[3]=a.x;d[4]=b.y;d[5]=b.z;d[6]=a.x;d[7]=a.y;d[8]=b.z;d[9]=b.x;d[10]=a.y;d[11]=b.z;d[12]=b.x;d[13]=b.y;d[14]=a.z;d[15]=a.x;d[16]=b.y;d[17]=a.z;d[18]=a.x;d[19]=a.y;d[20]=a.z;d[21]=b.x;d[22]=a.y;d[23]=a.z;c.needsUpdate=!0;this.geometry.computeBoundingSphere()}}setFromObject(a){this.object=a;this.update();return this}copy(a,b){super.copy(a,b);this.object=
a.object;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class In extends bd{constructor(a,b=16776960){const c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new tb;d.setIndex(new Nb(c,1));d.setAttribute("position",new eb([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));super(d,new Ac({color:b,toneMapped:!1}));this.box=a;this.type="Box3Helper";this.geometry.computeBoundingSphere()}updateMatrixWorld(a){const b=this.box;b.isEmpty()||(b.getCenter(this.position),
b.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(a))}dispose(){this.geometry.dispose();this.material.dispose()}}class Jn extends zd{constructor(a,b=1,c=16776960){const d=new tb;d.setAttribute("position",new eb([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3));d.computeBoundingSphere();super(d,new Ac({color:c,toneMapped:!1}));this.type="PlaneHelper";this.plane=a;this.size=b;a=new tb;a.setAttribute("position",new eb([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],
3));a.computeBoundingSphere();this.add(new dc(a,new vd({color:c,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,0,0);this.scale.set(.5*this.size,.5*this.size,1);this.lookAt(this.plane.normal);this.translateZ(-this.plane.constant);super.updateMatrixWorld(a)}dispose(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()}}const Nk=new I;let jg,Vh;class Kn extends Gb{constructor(a=new I(0,
0,1),b=new I(0,0,0),c=1,d=16776960,e=.2*c,f=.2*e){super();this.type="ArrowHelper";void 0===jg&&(jg=new tb,jg.setAttribute("position",new eb([0,0,0,0,1,0],3)),Vh=new af(0,.5,1,5,1),Vh.translate(0,-.5,0));this.position.copy(b);this.line=new zd(jg,new Ac({color:d,toneMapped:!1}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new dc(Vh,new vd({color:d,toneMapped:!1}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}setDirection(a){.99999<a.y?
this.quaternion.set(0,0,0,1):-.99999>a.y?this.quaternion.set(1,0,0,0):(Nk.set(a.z,0,-a.x).normalize(),this.quaternion.setFromAxisAngle(Nk,Math.acos(a.y)))}setLength(a,b=.2*a,c=.2*b){this.line.scale.set(1,Math.max(1E-4,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()}setColor(a){this.line.material.color.set(a);this.cone.material.color.set(a)}copy(a){super.copy(a,!1);this.line.copy(a.line);this.cone.copy(a.cone);return this}dispose(){this.line.geometry.dispose();
this.line.material.dispose();this.cone.geometry.dispose();this.cone.material.dispose()}}class Ln extends bd{constructor(a=1){var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new tb;a.setAttribute("position",new eb(b,3));a.setAttribute("color",new eb([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new Ac({vertexColors:!0,toneMapped:!1});super(a,b);this.type="AxesHelper"}setColors(a,b,c){const d=new Ya,e=this.geometry.attributes.color.array;d.set(a);d.toArray(e,0);d.toArray(e,3);d.set(b);d.toArray(e,6);
d.toArray(e,9);d.set(c);d.toArray(e,12);d.toArray(e,15);this.geometry.attributes.color.needsUpdate=!0;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class Mn{constructor(){this.type="ShapePath";this.color=new Ya;this.subPaths=[];this.currentPath=null}moveTo(a,b){this.currentPath=new $e;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,b);return this}lineTo(a,b){this.currentPath.lineTo(a,b);return this}quadraticCurveTo(a,b,c,d){this.currentPath.quadraticCurveTo(a,
b,c,d);return this}bezierCurveTo(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f);return this}splineThru(a){this.currentPath.splineThru(a);return this}toShapes(a){function b(t){const x=[];for(let C=0,u=t.length;C<u;C++){const D=t[C],aa=new Ud;aa.curves=D.curves;x.push(aa)}return x}function c(t,x){const C=x.length;let u=!1;for(let aa=C-1,J=0;J<C;aa=J++){var D=x[aa];let K=x[J],U=K.x-D.x,W=K.y-D.y;if(Math.abs(W)>Number.EPSILON){if(0>W&&(D=x[J],U=-U,K=x[aa],W=-W),!(t.y<D.y||t.y>K.y))if(t.y===
D.y){if(t.x===D.x)return!0}else{D=W*(t.x-D.x)-U*(t.y-D.y);if(0===D)return!0;0>D||(u=!u)}}else if(t.y===D.y&&(K.x<=t.x&&t.x<=D.x||D.x<=t.x&&t.x<=K.x))return!0}return u}var d=kd.isClockWise,e=this.subPaths;if(0===e.length)return[];const f=[];if(1===e.length){var g=e[0];var k=new Ud;k.curves=g.curves;f.push(k);return f}var h=!d(e[0].getPoints());h=a?!h:h;k=[];const l=[];let n=[];var m=0;let p;l[m]=void 0;n[m]=[];for(let t=0,x=e.length;t<x;t++){g=e[t];p=g.getPoints();var v=d(p);(v=a?!v:v)?(!h&&l[m]&&
m++,l[m]={s:new Ud,p},l[m].s.curves=g.curves,h&&m++,n[m]=[]):n[m].push({h:g,p:p[0]})}if(!l[0])return b(e);if(1<l.length){g=!1;a=0;for(let t=0,x=l.length;t<x;t++)k[t]=[];for(let t=0,x=l.length;t<x;t++)for(d=n[t],e=0;e<d.length;e++){v=d[e];h=!0;for(m=0;m<l.length;m++)c(v.p,l[m].p)&&(t!==m&&a++,h?(h=!1,k[m].push(v)):g=!0);h&&k[t].push(v)}0<a&&!1===g&&(n=k)}for(let t=0,x=l.length;t<x;t++){k=l[t].s;f.push(k);g=n[t];for(let C=0,u=g.length;C<u;C++)k.holes.push(g[C].h)}return f}}class Nn extends Oc{constructor(a=
1,b=1,c=1,d={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.');super(a,b,{...d,count:c});this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"162"}}));"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):
window.__THREE__="162");r.ACESFilmicToneMapping=4;r.AddEquation=100;r.AddOperation=2;r.AdditiveAnimationBlendMode=2501;r.AdditiveBlending=2;r.AgXToneMapping=6;r.AlphaFormat=1021;r.AlwaysCompare=519;r.AlwaysDepth=1;r.AlwaysStencilFunc=519;r.AmbientLight=ok;r.AnimationAction=Dk;r.AnimationClip=cf;r.AnimationLoader=Mm;r.AnimationMixer=on;r.AnimationObjectGroup=mn;r.AnimationUtils=Km;r.ArcCurve=Mj;r.ArrayCamera=fj;r.ArrowHelper=Kn;r.AttachedBindMode="attached";r.Audio=Ak;r.AudioAnalyser=cn;r.AudioContext=
Th;r.AudioListener=$m;r.AudioLoader=Xm;r.AxesHelper=Ln;r.BackSide=1;r.BasicDepthPacking=3200;r.BasicShadowMap=0;r.BatchedMesh=Dj;r.Bone=kh;r.BooleanKeyframeTrack=Id;r.Box2=wn;r.Box3=xc;r.Box3Helper=In;r.BoxGeometry=ae;r.BoxHelper=Hn;r.BufferAttribute=Nb;r.BufferGeometry=tb;r.BufferGeometryLoader=tk;r.ByteType=1010;r.Cache=ld;r.Camera=Ff;r.CameraHelper=Gn;r.CanvasTexture=Hm;r.CapsuleGeometry=yh;r.CatmullRomCurve3=Nj;r.CineonToneMapping=3;r.CircleGeometry=zh;r.ClampToEdgeWrapping=1001;r.Clock=yk;r.Color=
Ya;r.ColorKeyframeTrack=Cg;r.ColorManagement=Kb;r.CompressedArrayTexture=Fm;r.CompressedCubeTexture=Gm;r.CompressedTexture=Vf;r.CompressedTextureLoader=Nm;r.ConeGeometry=Ah;r.ConstantAlphaFactor=213;r.ConstantColorFactor=211;r.CubeCamera=bj;r.CubeReflectionMapping=301;r.CubeRefractionMapping=302;r.CubeTexture=Re;r.CubeTextureLoader=Om;r.CubeUVReflectionMapping=306;r.CubicBezierCurve=th;r.CubicBezierCurve3=Oj;r.CubicInterpolant=dk;r.CullFaceBack=1;r.CullFaceFront=2;r.CullFaceFrontBack=3;r.CullFaceNone=
0;r.Curve=Wc;r.CurvePath=Qj;r.CustomBlending=5;r.CustomToneMapping=5;r.CylinderGeometry=af;r.Cylindrical=vn;r.Data3DTexture=Fg;r.DataArrayTexture=lf;r.DataTexture=xd;r.DataTextureLoader=Pm;r.DataUtils=dm;r.DecrementStencilOp=7683;r.DecrementWrapStencilOp=34056;r.DefaultLoadingManager=gk;r.DepthFormat=1026;r.DepthStencilFormat=1027;r.DepthTexture=Yg;r.DetachedBindMode="detached";r.DirectionalLight=nk;r.DirectionalLightHelper=Fn;r.DiscreteInterpolant=ek;r.DisplayP3ColorSpace="display-p3";r.DodecahedronGeometry=
Bh;r.DoubleSide=2;r.DstAlphaFactor=206;r.DstColorFactor=208;r.DynamicCopyUsage=35050;r.DynamicDrawUsage=35048;r.DynamicReadUsage=35049;r.EdgesGeometry=Rj;r.EllipseCurve=Wf;r.EqualCompare=514;r.EqualDepth=4;r.EqualStencilFunc=514;r.EquirectangularReflectionMapping=303;r.EquirectangularRefractionMapping=304;r.Euler=Kc;r.EventDispatcher=dd;r.ExtrudeGeometry=Dh;r.FileLoader=nd;r.Float16BufferAttribute=jm;r.Float32BufferAttribute=eb;r.FloatType=1015;r.Fog=fh;r.FogExp2=eh;r.FramebufferTexture=Em;r.FrontSide=
0;r.Frustum=Ee;r.GLBufferAttribute=sn;r.GLSL1="100";r.GLSL3="300 es";r.GreaterCompare=516;r.GreaterDepth=6;r.GreaterEqualCompare=518;r.GreaterEqualDepth=5;r.GreaterEqualStencilFunc=518;r.GreaterStencilFunc=516;r.GridHelper=Dn;r.Group=te;r.HalfFloatType=1016;r.HemisphereLight=hk;r.HemisphereLightHelper=Cn;r.IcosahedronGeometry=Eh;r.ImageBitmapLoader=Wm;r.ImageLoader=df;r.ImageUtils=kg;r.IncrementStencilOp=7682;r.IncrementWrapStencilOp=34055;r.InstancedBufferAttribute=Be;r.InstancedBufferGeometry=sk;
r.InstancedInterleavedBuffer=rn;r.InstancedMesh=Aj;r.Int16BufferAttribute=hm;r.Int32BufferAttribute=im;r.Int8BufferAttribute=em;r.IntType=1013;r.InterleavedBuffer=Mf;r.InterleavedBufferAttribute=xe;r.Interpolant=bf;r.InterpolateDiscrete=2300;r.InterpolateLinear=2301;r.InterpolateSmooth=2302;r.InvertStencilOp=5386;r.KeepStencilOp=7680;r.KeyframeTrack=Xc;r.LOD=qj;r.LatheGeometry=Zf;r.Layers=nf;r.LessCompare=513;r.LessDepth=2;r.LessEqualCompare=515;r.LessEqualDepth=3;r.LessEqualStencilFunc=515;r.LessStencilFunc=
513;r.Light=Ad;r.LightProbe=rk;r.Line=zd;r.Line3=xn;r.LineBasicMaterial=Ac;r.LineCurve=uh;r.LineCurve3=Pj;r.LineDashedMaterial=ck;r.LineLoop=Jj;r.LineSegments=bd;r.LinearDisplayP3ColorSpace="display-p3-linear";r.LinearFilter=1006;r.LinearInterpolant=Mh;r.LinearMipMapLinearFilter=1008;r.LinearMipMapNearestFilter=1007;r.LinearMipmapLinearFilter=1008;r.LinearMipmapNearestFilter=1007;r.LinearSRGBColorSpace="srgb-linear";r.LinearToneMapping=1;r.LinearTransfer="linear";r.Loader=Dc;r.LoaderUtils=Sh;r.LoadingManager=
Nh;r.LoopOnce=2200;r.LoopPingPong=2202;r.LoopRepeat=2201;r.LuminanceAlphaFormat=1025;r.LuminanceFormat=1024;r.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};r.Material=sc;r.MaterialLoader=Rh;r.MathUtils=Pl;r.Matrix3=ob;r.Matrix4=lb;r.MaxEquation=104;r.Mesh=dc;r.MeshBasicMaterial=vd;r.MeshDepthMaterial=ug;r.MeshDistanceMaterial=vg;r.MeshLambertMaterial=ak;r.MeshMatcapMaterial=bk;r.MeshNormalMaterial=Zj;r.MeshPhongMaterial=Xj;r.MeshPhysicalMaterial=Wj;r.MeshStandardMaterial=Lh;r.MeshToonMaterial=
Yj;r.MinEquation=103;r.MirroredRepeatWrapping=1002;r.MixOperation=1;r.MultiplyBlending=4;r.MultiplyOperation=0;r.NearestFilter=1003;r.NearestMipMapLinearFilter=1005;r.NearestMipMapNearestFilter=1004;r.NearestMipmapLinearFilter=1005;r.NearestMipmapNearestFilter=1004;r.NeutralToneMapping=7;r.NeverCompare=512;r.NeverDepth=0;r.NeverStencilFunc=512;r.NoBlending=0;r.NoColorSpace="";r.NoToneMapping=0;r.NormalAnimationBlendMode=2500;r.NormalBlending=1;r.NotEqualCompare=517;r.NotEqualDepth=7;r.NotEqualStencilFunc=
517;r.NumberKeyframeTrack=Le;r.Object3D=Gb;r.ObjectLoader=Um;r.ObjectSpaceNormalMap=1;r.OctahedronGeometry=cg;r.OneFactor=201;r.OneMinusConstantAlphaFactor=214;r.OneMinusConstantColorFactor=212;r.OneMinusDstAlphaFactor=207;r.OneMinusDstColorFactor=209;r.OneMinusSrcAlphaFactor=205;r.OneMinusSrcColorFactor=203;r.OrthographicCamera=Hf;r.P3Primaries="p3";r.PCFShadowMap=1;r.PCFSoftShadowMap=2;r.PMREMGenerator=lg;r.Path=$e;r.PerspectiveCamera=lc;r.Plane=od;r.PlaneGeometry=De;r.PlaneHelper=Jn;r.PointLight=
mk;r.PointLightHelper=An;r.Points=Lj;r.PointsMaterial=ph;r.PolarGridHelper=En;r.PolyhedronGeometry=Td;r.PositionalAudio=bn;r.PropertyBinding=Fb;r.PropertyMixer=Ck;r.QuadraticBezierCurve=vh;r.QuadraticBezierCurve3=wh;r.Quaternion=Cc;r.QuaternionKeyframeTrack=fe;r.QuaternionLinearInterpolant=fk;r.RED_GREEN_RGTC2_Format=36285;r.RED_RGTC1_Format=36283;r.REVISION="162";r.RGBADepthPacking=3201;r.RGBAFormat=1023;r.RGBAIntegerFormat=1033;r.RGBA_ASTC_10x10_Format=37819;r.RGBA_ASTC_10x5_Format=37816;r.RGBA_ASTC_10x6_Format=
37817;r.RGBA_ASTC_10x8_Format=37818;r.RGBA_ASTC_12x10_Format=37820;r.RGBA_ASTC_12x12_Format=37821;r.RGBA_ASTC_4x4_Format=37808;r.RGBA_ASTC_5x4_Format=37809;r.RGBA_ASTC_5x5_Format=37810;r.RGBA_ASTC_6x5_Format=37811;r.RGBA_ASTC_6x6_Format=37812;r.RGBA_ASTC_8x5_Format=37813;r.RGBA_ASTC_8x6_Format=37814;r.RGBA_ASTC_8x8_Format=37815;r.RGBA_BPTC_Format=36492;r.RGBA_ETC2_EAC_Format=37496;r.RGBA_PVRTC_2BPPV1_Format=35843;r.RGBA_PVRTC_4BPPV1_Format=35842;r.RGBA_S3TC_DXT1_Format=33777;r.RGBA_S3TC_DXT3_Format=
33778;r.RGBA_S3TC_DXT5_Format=33779;r.RGB_BPTC_SIGNED_Format=36494;r.RGB_BPTC_UNSIGNED_Format=36495;r.RGB_ETC1_Format=36196;r.RGB_ETC2_Format=37492;r.RGB_PVRTC_2BPPV1_Format=35841;r.RGB_PVRTC_4BPPV1_Format=35840;r.RGB_S3TC_DXT1_Format=33776;r.RGFormat=1030;r.RGIntegerFormat=1031;r.RawShaderMaterial=Vj;r.Ray=me;r.Raycaster=tn;r.Rec709Primaries="rec709";r.RectAreaLight=pk;r.RedFormat=1028;r.RedIntegerFormat=1029;r.ReinhardToneMapping=2;r.RenderTarget=Oi;r.RepeatWrapping=1E3;r.ReplaceStencilOp=7681;
r.ReverseSubtractEquation=102;r.RingGeometry=Fh;r.SIGNED_RED_GREEN_RGTC2_Format=36286;r.SIGNED_RED_RGTC1_Format=36284;r.SRGBColorSpace="srgb";r.SRGBTransfer="srgb";r.Scene=lj;r.ShaderChunk=pb;r.ShaderLib=Nc;r.ShaderMaterial=Mc;r.ShadowMaterial=Uj;r.Shape=Ud;r.ShapeGeometry=Gh;r.ShapePath=Mn;r.ShapeUtils=kd;r.ShortType=1011;r.Skeleton=lh;r.SkeletonHelper=zn;r.SkinnedMesh=wj;r.Source=Ld;r.Sphere=qc;r.SphereGeometry=dg;r.Spherical=un;r.SphericalHarmonics3=qk;r.SplineCurve=xh;r.SpotLight=kk;r.SpotLightHelper=
yn;r.Sprite=oj;r.SpriteMaterial=gh;r.SrcAlphaFactor=204;r.SrcAlphaSaturateFactor=210;r.SrcColorFactor=202;r.StaticCopyUsage=35046;r.StaticDrawUsage=35044;r.StaticReadUsage=35045;r.StereoCamera=Ym;r.StreamCopyUsage=35042;r.StreamDrawUsage=35040;r.StreamReadUsage=35041;r.StringKeyframeTrack=Jd;r.SubtractEquation=101;r.SubtractiveBlending=3;r.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};r.TangentSpaceNormalMap=0;r.TetrahedronGeometry=Hh;r.Texture=cc;r.TextureLoader=Qm;r.TorusGeometry=Ih;r.TorusKnotGeometry=
Jh;r.Triangle=Gc;r.TriangleFanDrawMode=2;r.TriangleStripDrawMode=1;r.TrianglesDrawMode=0;r.TubeGeometry=Kh;r.UVMapping=300;r.Uint16BufferAttribute=ng;r.Uint32BufferAttribute=mg;r.Uint8BufferAttribute=fm;r.Uint8ClampedBufferAttribute=gm;r.Uniform=Ek;r.UniformsGroup=qn;r.UniformsLib=Ra;r.UniformsUtils=ri;r.UnsignedByteType=1009;r.UnsignedInt248Type=1020;r.UnsignedIntType=1014;r.UnsignedShort4444Type=1017;r.UnsignedShort5551Type=1018;r.UnsignedShortType=1012;r.VSMShadowMap=3;r.Vector2=xa;r.Vector3=I;
r.Vector4=Mb;r.VectorKeyframeTrack=Me;r.VideoTexture=Dm;r.WebGL1Renderer=kj;r.WebGL3DRenderTarget=Ul;r.WebGLArrayRenderTarget=Tl;r.WebGLCoordinateSystem=2E3;r.WebGLCubeRenderTarget=$h;r.WebGLMultipleRenderTargets=Nn;r.WebGLRenderTarget=Oc;r.WebGLRenderer=gj;r.WebGLUtils=vi;r.WebGPUCoordinateSystem=2001;r.WireframeGeometry=Sj;r.WrapAroundEnding=2402;r.ZeroCurvatureEnding=2400;r.ZeroFactor=200;r.ZeroSlopeEnding=2401;r.ZeroStencilOp=0;r._SRGBAFormat=1035;r.createCanvasElement=Y};
shadow$provide[1]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},CopyShader:{enumerable:!0,get:function(){return pa}}});const pa={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv \x3d uv;\n\t\t\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel \x3d texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor \x3d opacity * texel;\n\n\n\t\t}"}};
shadow$provide[2]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},FullScreenQuad:{enumerable:!0,get:function(){return wa}},Pass:{enumerable:!0,get:function(){return ib}}});var pa=qb(0);class ib{constructor(){this.needsSwap=this.enabled=this.isPass=!0;this.renderToScreen=this.clear=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Ma=new pa.OrthographicCamera(-1,1,1,-1,0,1);class ua extends pa.BufferGeometry{constructor(){super();
this.setAttribute("position",new pa.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3));this.setAttribute("uv",new pa.Float32BufferAttribute([0,2,0,0,2,0],2))}}const Ua=new ua;class wa{constructor(qa){this._mesh=new pa.Mesh(Ua,qa)}dispose(){this._mesh.geometry.dispose()}render(qa){qa.render(this._mesh,Ma)}get material(){return this._mesh.material}set material(qa){this._mesh.material=qa}}};
shadow$provide[3]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},ShaderPass:{enumerable:!0,get:function(){return Ma}}});var pa=qb(0),ib=qb(2);class Ma extends ib.Pass{constructor(ua,Ua){super();this.textureID=void 0!==Ua?Ua:"tDiffuse";ua instanceof pa.ShaderMaterial?(this.uniforms=ua.uniforms,this.material=ua):ua&&(this.uniforms=pa.UniformsUtils.clone(ua.uniforms),this.material=new pa.ShaderMaterial({name:void 0!==ua.name?ua.name:"unspecified",defines:Object.assign({},
ua.defines),uniforms:this.uniforms,vertexShader:ua.vertexShader,fragmentShader:ua.fragmentShader}));this.fsQuad=new ib.FullScreenQuad(this.material)}render(ua,Ua,wa){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=wa.texture);this.fsQuad.material=this.material;this.renderToScreen?ua.setRenderTarget(null):(ua.setRenderTarget(Ua),this.clear&&ua.clear(ua.autoClearColor,ua.autoClearDepth,ua.autoClearStencil));this.fsQuad.render(ua)}dispose(){this.material.dispose();this.fsQuad.dispose()}}
};
shadow$provide[4]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},ClearMaskPass:{enumerable:!0,get:function(){return ib}},MaskPass:{enumerable:!0,get:function(){return pa}}});ac=qb(2);class pa extends ac.Pass{constructor(Ma,ua){super();this.scene=Ma;this.camera=ua;this.clear=!0;this.inverse=this.needsSwap=!1}render(Ma,ua,Ua){const wa=Ma.getContext(),qa=Ma.state;qa.buffers.color.setMask(!1);qa.buffers.depth.setMask(!1);qa.buffers.color.setLocked(!0);qa.buffers.depth.setLocked(!0);
let Qa,Tb;this.inverse?(Qa=0,Tb=1):(Qa=1,Tb=0);qa.buffers.stencil.setTest(!0);qa.buffers.stencil.setOp(wa.REPLACE,wa.REPLACE,wa.REPLACE);qa.buffers.stencil.setFunc(wa.ALWAYS,Qa,4294967295);qa.buffers.stencil.setClear(Tb);qa.buffers.stencil.setLocked(!0);Ma.setRenderTarget(Ua);this.clear&&Ma.clear();Ma.render(this.scene,this.camera);Ma.setRenderTarget(ua);this.clear&&Ma.clear();Ma.render(this.scene,this.camera);qa.buffers.color.setLocked(!1);qa.buffers.depth.setLocked(!1);qa.buffers.color.setMask(!0);
qa.buffers.depth.setMask(!0);qa.buffers.stencil.setLocked(!1);qa.buffers.stencil.setFunc(wa.EQUAL,1,4294967295);qa.buffers.stencil.setOp(wa.KEEP,wa.KEEP,wa.KEEP);qa.buffers.stencil.setLocked(!0)}}class ib extends ac.Pass{constructor(){super();this.needsSwap=!1}render(Ma){Ma.state.buffers.stencil.setLocked(!1);Ma.state.buffers.stencil.setTest(!1)}}};
shadow$provide[5]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},EffectComposer:{enumerable:!0,get:function(){return Ua}}});var pa=qb(0),ib=qb(1),Ma=qb(3),ua=qb(4);class Ua{constructor(wa,qa){this.renderer=wa;this._pixelRatio=wa.getPixelRatio();void 0===qa?(wa=wa.getSize(new pa.Vector2),this._width=wa.width,this._height=wa.height,qa=new pa.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:pa.HalfFloatType}),qa.texture.name="EffectComposer.rt1"):
(this._width=qa.width,this._height=qa.height);this.renderTarget1=qa;this.renderTarget2=qa.clone();this.renderTarget2.texture.name="EffectComposer.rt2";this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;this.renderToScreen=!0;this.passes=[];this.copyPass=new Ma.ShaderPass(ib.CopyShader);this.copyPass.material.blending=pa.NoBlending;this.clock=new pa.Clock}swapBuffers(){const wa=this.readBuffer;this.readBuffer=this.writeBuffer;this.writeBuffer=wa}addPass(wa){this.passes.push(wa);
wa.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(wa,qa){this.passes.splice(qa,0,wa);wa.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(wa){wa=this.passes.indexOf(wa);-1!==wa&&this.passes.splice(wa,1)}isLastEnabledPass(wa){for(wa+=1;wa<this.passes.length;wa++)if(this.passes[wa].enabled)return!1;return!0}render(wa){void 0===wa&&(wa=this.clock.getDelta());const qa=this.renderer.getRenderTarget();let Qa=!1;for(let Tb=0,Wb=this.passes.length;Tb<
Wb;Tb++){const Y=this.passes[Tb];if(!1!==Y.enabled){Y.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(Tb);Y.render(this.renderer,this.writeBuffer,this.readBuffer,wa,Qa);if(Y.needsSwap){if(Qa){const Wa=this.renderer.getContext(),Na=this.renderer.state.buffers.stencil;Na.setFunc(Wa.NOTEQUAL,1,4294967295);this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,wa);Na.setFunc(Wa.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==ua.MaskPass&&(Y instanceof ua.MaskPass?Qa=!0:Y instanceof
ua.ClearMaskPass&&(Qa=!1))}}this.renderer.setRenderTarget(qa)}reset(wa){void 0===wa&&(wa=this.renderer.getSize(new pa.Vector2),this._pixelRatio=this.renderer.getPixelRatio(),this._width=wa.width,this._height=wa.height,wa=this.renderTarget1.clone(),wa.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio));this.renderTarget1.dispose();this.renderTarget2.dispose();this.renderTarget1=wa;this.renderTarget2=wa.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2}setSize(wa,
qa){this._width=wa;this._height=qa;wa=this._width*this._pixelRatio;qa=this._height*this._pixelRatio;this.renderTarget1.setSize(wa,qa);this.renderTarget2.setSize(wa,qa);for(let Qa=0;Qa<this.passes.length;Qa++)this.passes[Qa].setSize(wa,qa)}setPixelRatio(wa){this._pixelRatio=wa;this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose();this.renderTarget2.dispose();this.copyPass.dispose()}}};
shadow$provide[6]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},OutputShader:{enumerable:!0,get:function(){return pa}}});const pa={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:"\n\t\tprecision highp float;\n\n\t\tuniform mat4 modelViewMatrix;\n\t\tuniform mat4 projectionMatrix;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv \x3d uv;\n\t\t\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",
fragmentShader:"\n\t\n\t\tprecision highp float;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include \x3ctonemapping_pars_fragment\x3e\n\t\t#include \x3ccolorspace_pars_fragment\x3e\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor \x3d texture2D( tDiffuse, vUv );\n\n\t\t\t// tone mapping\n\n\t\t\t#ifdef LINEAR_TONE_MAPPING\n\n\t\t\t\tgl_FragColor.rgb \x3d LinearToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb \x3d ReinhardToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb \x3d OptimizedCineonToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb \x3d ACESFilmicToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( AGX_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb \x3d AgXToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb \x3d NeutralToneMapping( gl_FragColor.rgb );\n\n\t\t\t#endif\n\n\t\t\t// color space\n\n\t\t\t#ifdef SRGB_TRANSFER\n\n\t\t\t\tgl_FragColor \x3d sRGBTransferOETF( gl_FragColor );\n\n\t\t\t#endif\n\n\t\t}"}};
shadow$provide[7]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},OutputPass:{enumerable:!0,get:function(){return ua}}});var pa=qb(0),ib=qb(2),Ma=qb(6);class ua extends ib.Pass{constructor(){super();const Ua=Ma.OutputShader;this.uniforms=pa.UniformsUtils.clone(Ua.uniforms);this.material=new pa.RawShaderMaterial({name:Ua.name,uniforms:this.uniforms,vertexShader:Ua.vertexShader,fragmentShader:Ua.fragmentShader});this.fsQuad=new ib.FullScreenQuad(this.material);this._toneMapping=
this._outputColorSpace=null}render(Ua,wa,qa){this.uniforms.tDiffuse.value=qa.texture;this.uniforms.toneMappingExposure.value=Ua.toneMappingExposure;if(this._outputColorSpace!==Ua.outputColorSpace||this._toneMapping!==Ua.toneMapping)this._outputColorSpace=Ua.outputColorSpace,this._toneMapping=Ua.toneMapping,this.material.defines={},pa.ColorManagement.getTransfer(this._outputColorSpace)===pa.SRGBTransfer&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===pa.LinearToneMapping?this.material.defines.LINEAR_TONE_MAPPING=
"":this._toneMapping===pa.ReinhardToneMapping?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===pa.CineonToneMapping?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===pa.ACESFilmicToneMapping?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===pa.AgXToneMapping?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===pa.NeutralToneMapping&&(this.material.defines.NEUTRAL_TONE_MAPPING=""),this.material.needsUpdate=!0;!0===this.renderToScreen?Ua.setRenderTarget(null):
(Ua.setRenderTarget(wa),this.clear&&Ua.clear(Ua.autoClearColor,Ua.autoClearDepth,Ua.autoClearStencil));this.fsQuad.render(Ua)}dispose(){this.material.dispose();this.fsQuad.dispose()}}};
shadow$provide[8]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},RenderPass:{enumerable:!0,get:function(){return ib}}});var pa=qb(0);ac=qb(2);class ib extends ac.Pass{constructor(Ma,ua,Ua=null,wa=null,qa=null){super();this.scene=Ma;this.camera=ua;this.overrideMaterial=Ua;this.clearColor=wa;this.clearAlpha=qa;this.clear=!0;this.needsSwap=this.clearDepth=!1;this._oldClearColor=new pa.Color}render(Ma,ua,Ua){ua=Ma.autoClear;Ma.autoClear=!1;let wa,qa;null!==this.overrideMaterial&&
(qa=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial);null!==this.clearColor&&(Ma.getClearColor(this._oldClearColor),Ma.setClearColor(this.clearColor));null!==this.clearAlpha&&(wa=Ma.getClearAlpha(),Ma.setClearAlpha(this.clearAlpha));1==this.clearDepth&&Ma.clearDepth();Ma.setRenderTarget(this.renderToScreen?null:Ua);!0===this.clear&&Ma.clear(Ma.autoClearColor,Ma.autoClearDepth,Ma.autoClearStencil);Ma.render(this.scene,this.camera);null!==this.clearColor&&Ma.setClearColor(this._oldClearColor);
null!==this.clearAlpha&&Ma.setClearAlpha(wa);null!==this.overrideMaterial&&(this.scene.overrideMaterial=qa);Ma.autoClear=ua}}};
shadow$provide[9]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},FilmShader:{enumerable:!0,get:function(){return pa}}});const pa={name:"FilmShader",uniforms:{tDiffuse:{value:null},time:{value:0},intensity:{value:.5},grayscale:{value:!1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv \x3d uv;\n\t\t\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include \x3ccommon\x3e\n\n\t\tuniform float intensity;\n\t\tuniform bool grayscale;\n\t\tuniform float time;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 base \x3d texture2D( tDiffuse, vUv );\n\n\t\t\tfloat noise \x3d rand( fract( vUv + time ) );\n\n\t\t\tvec3 color \x3d base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );\n\n\t\t\tcolor \x3d mix( base.rgb, color, intensity );\n\n\t\t\tif ( grayscale ) {\n\n\t\t\t\tcolor \x3d vec3( luminance( color ) ); // assuming linear-srgb\n\n\t\t\t}\n\n\t\t\tgl_FragColor \x3d vec4( color, base.a );\n\n\t\t}"}};
shadow$provide[10]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},FilmPass:{enumerable:!0,get:function(){return ua}}});var pa=qb(0),ib=qb(2),Ma=qb(9);class ua extends ib.Pass{constructor(Ua=.5,wa=!1){super();const qa=Ma.FilmShader;this.uniforms=pa.UniformsUtils.clone(qa.uniforms);this.material=new pa.ShaderMaterial({name:qa.name,uniforms:this.uniforms,vertexShader:qa.vertexShader,fragmentShader:qa.fragmentShader});this.uniforms.intensity.value=Ua;this.uniforms.grayscale.value=
wa;this.fsQuad=new ib.FullScreenQuad(this.material)}render(Ua,wa,qa,Qa){this.uniforms.tDiffuse.value=qa.texture;this.uniforms.time.value+=Qa;this.renderToScreen?Ua.setRenderTarget(null):(Ua.setRenderTarget(wa),this.clear&&Ua.clear());this.fsQuad.render(Ua)}dispose(){this.material.dispose();this.fsQuad.dispose()}}};
shadow$provide[11]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},RenderPixelatedPass:{enumerable:!0,get:function(){return Ma}}});var pa=qb(0),ib=qb(2);class Ma extends ib.Pass{constructor(ua,Ua,wa,qa={}){super();this.pixelSize=ua;this.resolution=new pa.Vector2;this.renderResolution=new pa.Vector2;this.pixelatedMaterial=this.createPixelatedMaterial();this.normalMaterial=new pa.MeshNormalMaterial;this.fsQuad=new ib.FullScreenQuad(this.pixelatedMaterial);this.scene=
Ua;this.camera=wa;this.normalEdgeStrength=qa.normalEdgeStrength||.3;this.depthEdgeStrength=qa.depthEdgeStrength||.4;this.beautyRenderTarget=new pa.WebGLRenderTarget;this.beautyRenderTarget.texture.minFilter=pa.NearestFilter;this.beautyRenderTarget.texture.magFilter=pa.NearestFilter;this.beautyRenderTarget.texture.type=pa.HalfFloatType;this.beautyRenderTarget.depthTexture=new pa.DepthTexture;this.normalRenderTarget=new pa.WebGLRenderTarget;this.normalRenderTarget.texture.minFilter=pa.NearestFilter;
this.normalRenderTarget.texture.magFilter=pa.NearestFilter;this.normalRenderTarget.texture.type=pa.HalfFloatType}dispose(){this.beautyRenderTarget.dispose();this.normalRenderTarget.dispose();this.pixelatedMaterial.dispose();this.normalMaterial.dispose();this.fsQuad.dispose()}setSize(ua,Ua){this.resolution.set(ua,Ua);this.renderResolution.set(ua/this.pixelSize|0,Ua/this.pixelSize|0);const {x:wa,y:qa}=this.renderResolution;this.beautyRenderTarget.setSize(wa,qa);this.normalRenderTarget.setSize(wa,qa);
this.fsQuad.material.uniforms.resolution.value.set(wa,qa,1/wa,1/qa)}setPixelSize(ua){this.pixelSize=ua;this.setSize(this.resolution.x,this.resolution.y)}render(ua,Ua){const wa=this.fsQuad.material.uniforms;wa.normalEdgeStrength.value=this.normalEdgeStrength;wa.depthEdgeStrength.value=this.depthEdgeStrength;ua.setRenderTarget(this.beautyRenderTarget);ua.render(this.scene,this.camera);const qa=this.scene.overrideMaterial;ua.setRenderTarget(this.normalRenderTarget);this.scene.overrideMaterial=this.normalMaterial;
ua.render(this.scene,this.camera);this.scene.overrideMaterial=qa;wa.tDiffuse.value=this.beautyRenderTarget.texture;wa.tDepth.value=this.beautyRenderTarget.depthTexture;wa.tNormal.value=this.normalRenderTarget.texture;this.renderToScreen?ua.setRenderTarget(null):(ua.setRenderTarget(Ua),this.clear&&ua.clear());this.fsQuad.render(ua)}createPixelatedMaterial(){return new pa.ShaderMaterial({uniforms:{tDiffuse:{value:null},tDepth:{value:null},tNormal:{value:null},resolution:{value:new pa.Vector4(this.renderResolution.x,
this.renderResolution.y,1/this.renderResolution.x,1/this.renderResolution.y)},normalEdgeStrength:{value:0},depthEdgeStrength:{value:0}},vertexShader:"\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUv \x3d uv;\n\t\t\t\t\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tuniform sampler2D tDiffuse;\n\t\t\t\tuniform sampler2D tDepth;\n\t\t\t\tuniform sampler2D tNormal;\n\t\t\t\tuniform vec4 resolution;\n\t\t\t\tuniform float normalEdgeStrength;\n\t\t\t\tuniform float depthEdgeStrength;\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tfloat getDepth(int x, int y) {\n\n\t\t\t\t\treturn texture2D( tDepth, vUv + vec2(x, y) * resolution.zw ).r;\n\n\t\t\t\t}\n\n\t\t\t\tvec3 getNormal(int x, int y) {\n\n\t\t\t\t\treturn texture2D( tNormal, vUv + vec2(x, y) * resolution.zw ).rgb * 2.0 - 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tfloat depthEdgeIndicator(float depth, vec3 normal) {\n\n\t\t\t\t\tfloat diff \x3d 0.0;\n\t\t\t\t\tdiff +\x3d clamp(getDepth(1, 0) - depth, 0.0, 1.0);\n\t\t\t\t\tdiff +\x3d clamp(getDepth(-1, 0) - depth, 0.0, 1.0);\n\t\t\t\t\tdiff +\x3d clamp(getDepth(0, 1) - depth, 0.0, 1.0);\n\t\t\t\t\tdiff +\x3d clamp(getDepth(0, -1) - depth, 0.0, 1.0);\n\t\t\t\t\treturn floor(smoothstep(0.01, 0.02, diff) * 2.) / 2.;\n\n\t\t\t\t}\n\n\t\t\t\tfloat neighborNormalEdgeIndicator(int x, int y, float depth, vec3 normal) {\n\n\t\t\t\t\tfloat depthDiff \x3d getDepth(x, y) - depth;\n\t\t\t\t\tvec3 neighborNormal \x3d getNormal(x, y);\n\n\t\t\t\t\t// Edge pixels should yield to faces who's normals are closer to the bias normal.\n\t\t\t\t\tvec3 normalEdgeBias \x3d vec3(1., 1., 1.); // This should probably be a parameter.\n\t\t\t\t\tfloat normalDiff \x3d dot(normal - neighborNormal, normalEdgeBias);\n\t\t\t\t\tfloat normalIndicator \x3d clamp(smoothstep(-.01, .01, normalDiff), 0.0, 1.0);\n\n\t\t\t\t\t// Only the shallower pixel should detect the normal edge.\n\t\t\t\t\tfloat depthIndicator \x3d clamp(sign(depthDiff * .25 + .0025), 0.0, 1.0);\n\n\t\t\t\t\treturn (1.0 - dot(normal, neighborNormal)) * depthIndicator * normalIndicator;\n\n\t\t\t\t}\n\n\t\t\t\tfloat normalEdgeIndicator(float depth, vec3 normal) {\n\n\t\t\t\t\tfloat indicator \x3d 0.0;\n\n\t\t\t\t\tindicator +\x3d neighborNormalEdgeIndicator(0, -1, depth, normal);\n\t\t\t\t\tindicator +\x3d neighborNormalEdgeIndicator(0, 1, depth, normal);\n\t\t\t\t\tindicator +\x3d neighborNormalEdgeIndicator(-1, 0, depth, normal);\n\t\t\t\t\tindicator +\x3d neighborNormalEdgeIndicator(1, 0, depth, normal);\n\n\t\t\t\t\treturn step(0.1, indicator);\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec4 texel \x3d texture2D( tDiffuse, vUv );\n\n\t\t\t\t\tfloat depth \x3d 0.0;\n\t\t\t\t\tvec3 normal \x3d vec3(0.0);\n\n\t\t\t\t\tif (depthEdgeStrength \x3e 0.0 || normalEdgeStrength \x3e 0.0) {\n\n\t\t\t\t\t\tdepth \x3d getDepth(0, 0);\n\t\t\t\t\t\tnormal \x3d getNormal(0, 0);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat dei \x3d 0.0;\n\t\t\t\t\tif (depthEdgeStrength \x3e 0.0)\n\t\t\t\t\t\tdei \x3d depthEdgeIndicator(depth, normal);\n\n\t\t\t\t\tfloat nei \x3d 0.0;\n\t\t\t\t\tif (normalEdgeStrength \x3e 0.0)\n\t\t\t\t\t\tnei \x3d normalEdgeIndicator(depth, normal);\n\n\t\t\t\t\tfloat Strength \x3d dei \x3e 0.0 ? (1.0 - depthEdgeStrength * dei) : (1.0 + normalEdgeStrength * nei);\n\n\t\t\t\t\tgl_FragColor \x3d texel * Strength;\n\n\t\t\t\t}\n\t\t\t"})}}
};
shadow$provide[12]=function(ac,qb,nc,r){function pa(Y){const Wa=new Uint8Array(512);for(var Na=0;256>Na;Na++)Wa[Na]=Na;for(Na=0;255>Na;Na++){const ma=Na+~~(Y()*(256-Na)),Q=Wa[Na];Wa[Na]=Wa[ma];Wa[ma]=Q}for(Y=256;512>Y;Y++)Wa[Y]=Wa[Y-256];return Wa}Object.defineProperty(r,"__esModule",{value:!0});r.buildPermutationTable=r.createNoise4D=r.createNoise3D=r.createNoise2D=void 0;const ib=.5*(Math.sqrt(3)-1),Ma=(3-Math.sqrt(3))/6,ua=1/3,Ua=1/6,wa=(Math.sqrt(5)-1)/4,qa=(5-Math.sqrt(5))/20,Qa=new Float64Array([1,
1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Tb=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),Wb=new Float64Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);r.createNoise2D=
function(Y=Math.random){const Wa=pa(Y),Na=(new Float64Array(Wa)).map(Q=>Qa[Q%12*2]),ma=(new Float64Array(Wa)).map(Q=>Qa[Q%12*2+1]);return function(Q,S){var Z=0,P=0,V=0,ha=(Q+S)*ib,Aa=Math.floor(Q+ha)|0,Ca=Math.floor(S+ha)|0;ha=(Aa+Ca)*Ma;var ya=Q-(Aa-ha);const La=S-(Ca-ha);let Za;if(ya>La){var Ja=1;Za=0}else Ja=0,Za=1;ha=ya-Ja+Ma;var va=La-Za+Ma;S=ya-1+2*Ma;Q=La-1+2*Ma;Aa&=255;Ca&=255;let za=.5-ya*ya-La*La;if(0<=za){var Va=Aa+Wa[Ca];Z=Na[Va];Va=ma[Va];za*=za;Z=za*za*(Z*ya+Va*La)}ya=.5-ha*ha-va*va;
0<=ya&&(Ja=Aa+Ja+Wa[Ca+Za],P=Na[Ja],Ja=ma[Ja],ya*=ya,P=ya*ya*(P*ha+Ja*va));ha=.5-S*S-Q*Q;0<=ha&&(va=Aa+1+Wa[Ca+1],V=Na[va],va=ma[va],ha*=ha,V=ha*ha*(V*S+va*Q));return 70*(Z+P+V)}};r.createNoise3D=function(Y=Math.random){const Wa=pa(Y),Na=(new Float64Array(Wa)).map(S=>Tb[S%12*3]),ma=(new Float64Array(Wa)).map(S=>Tb[S%12*3+1]),Q=(new Float64Array(Wa)).map(S=>Tb[S%12*3+2]);return function(S,Z,P){var V=(S+Z+P)*ua,ha=Math.floor(S+V)|0,Aa=Math.floor(Z+V)|0,Ca=Math.floor(P+V)|0;V=(ha+Aa+Ca)*Ua;var ya=S-
(ha-V);var La=Z-(Aa-V);const Za=P-(Ca-V);let Ja,va;var za;let Va,jb;if(ya>=La)if(La>=Za){var kb=1;va=Ja=0;Va=za=1;jb=0}else ya>=Za?(kb=1,va=Ja=0):(Ja=kb=0,va=1),za=1,Va=0,jb=1;else La<Za?(Ja=kb=0,va=1,za=0,jb=Va=1):ya<Za?(kb=0,Ja=1,za=va=0,jb=Va=1):(kb=0,Ja=1,va=0,Va=za=1,jb=0);var wb=ya-kb+Ua;var fb=La-Ja+Ua;const ub=Za-va+Ua;S=ya-za+2*Ua;var vb=La-Va+2*Ua;const Zb=Za-jb+2*Ua;P=ya-1+3*Ua;Z=La-1+3*Ua;V=Za-1+3*Ua;ha&=255;Aa&=255;Ca&=255;let Ob=.6-ya*ya-La*La-Za*Za;if(0>Ob)ya=0;else{const Hb=ha+Wa[Aa+
Wa[Ca]];Ob*=Ob;ya=Ob*Ob*(Na[Hb]*ya+ma[Hb]*La+Q[Hb]*Za)}La=.6-wb*wb-fb*fb-ub*ub;0>La?wb=0:(kb=ha+kb+Wa[Aa+Ja+Wa[Ca+va]],La*=La,wb=La*La*(Na[kb]*wb+ma[kb]*fb+Q[kb]*ub));fb=.6-S*S-vb*vb-Zb*Zb;0>fb?S=0:(za=ha+za+Wa[Aa+Va+Wa[Ca+jb]],fb*=fb,S=fb*fb*(Na[za]*S+ma[za]*vb+Q[za]*Zb));vb=.6-P*P-Z*Z-V*V;0>vb?P=0:(ha=ha+1+Wa[Aa+1+Wa[Ca+1]],vb*=vb,P=vb*vb*(Na[ha]*P+ma[ha]*Z+Q[ha]*V));return 32*(ya+wb+S+P)}};r.createNoise4D=function(Y=Math.random){const Wa=pa(Y),Na=(new Float64Array(Wa)).map(Z=>Wb[Z%32*4]),ma=(new Float64Array(Wa)).map(Z=>
Wb[Z%32*4+1]),Q=(new Float64Array(Wa)).map(Z=>Wb[Z%32*4+2]),S=(new Float64Array(Wa)).map(Z=>Wb[Z%32*4+3]);return function(Z,P,V,ha){var Aa=(Z+P+V+ha)*wa,Ca=Math.floor(Z+Aa)|0,ya=Math.floor(P+Aa)|0,La=Math.floor(V+Aa)|0,Za=Math.floor(ha+Aa)|0;Aa=(Ca+ya+La+Za)*qa;var Ja=Z-(Ca-Aa);var va=P-(ya-Aa);var za=V-(La-Aa);const Va=ha-(Za-Aa);ha=V=Aa=P=0;Ja>va?P++:Aa++;Ja>za?P++:V++;Ja>Va?P++:ha++;va>za?Aa++:V++;va>Va?Aa++:ha++;za>Va?V++:ha++;const jb=3<=P?1:0,kb=3<=Aa?1:0,wb=3<=V?1:0,fb=3<=ha?1:0;var ub=2<=
P?1:0;var vb=2<=Aa?1:0;const Zb=2<=V?1:0,Ob=2<=ha?1:0;Z=1<=P?1:0;var Hb=1<=Aa?1:0;const Sb=1<=V?1:0,ec=1<=ha?1:0,rb=Ja-jb+qa,Rb=va-kb+qa,vc=za-wb+qa,pc=Va-fb+qa,ic=Ja-ub+2*qa,Bc=va-vb+2*qa,Bb=za-Zb+2*qa,Cb=Va-Ob+2*qa,q=Ja-Z+3*qa,y=va-Hb+3*qa,F=za-Sb+3*qa,w=Va-ec+3*qa;ha=Ja-1+4*qa;V=va-1+4*qa;Aa=za-1+4*qa;P=Va-1+4*qa;Ca&=255;ya&=255;La&=255;Za&=255;let G=.6-Ja*Ja-va*va-za*za-Va*Va;if(0>G)Ja=0;else{const N=Ca+Wa[ya+Wa[La+Wa[Za]]];G*=G;Ja=G*G*(Na[N]*Ja+ma[N]*va+Q[N]*za+S[N]*Va)}va=.6-rb*rb-Rb*Rb-vc*
vc-pc*pc;0>va?va=0:(za=Ca+jb+Wa[ya+kb+Wa[La+wb+Wa[Za+fb]]],va*=va,va=va*va*(Na[za]*rb+ma[za]*Rb+Q[za]*vc+S[za]*pc));za=.6-ic*ic-Bc*Bc-Bb*Bb-Cb*Cb;0>za?ub=0:(ub=Ca+ub+Wa[ya+vb+Wa[La+Zb+Wa[Za+Ob]]],za*=za,ub=za*za*(Na[ub]*ic+ma[ub]*Bc+Q[ub]*Bb+S[ub]*Cb));vb=.6-q*q-y*y-F*F-w*w;0>vb?Z=0:(Z=Ca+Z+Wa[ya+Hb+Wa[La+Sb+Wa[Za+ec]]],vb*=vb,Z=vb*vb*(Na[Z]*q+ma[Z]*y+Q[Z]*F+S[Z]*w));Hb=.6-ha*ha-V*V-Aa*Aa-P*P;0>Hb?ha=0:(Ca=Ca+1+Wa[ya+1+Wa[La+1+Wa[Za+1]]],Hb*=Hb,ha=Hb*Hb*(Na[Ca]*ha+ma[Ca]*V+Q[Ca]*Aa+S[Ca]*P));return 27*
(Ja+va+ub+Z+ha)}};r.buildPermutationTable=pa};
shadow$provide[13]=function(ac,qb,nc,r){function pa(Q,S,Z=!0){function P(ha){if(ha.normalized||ha.isInterleavedBufferAttribute){const Aa=new Float32Array(ha.count*ha.itemSize);for(let Ca=0,ya=0;Ca<ha.count;Ca++)Aa[ya++]=ha.getX(Ca),Aa[ya++]=ha.getY(Ca),2<ha.itemSize&&(Aa[ya++]=ha.getZ(Ca));return Aa}return ha.array instanceof Float32Array?ha.array:new Float32Array(ha.array)}if(!S||!S.isReady)throw Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!Q.hasAttribute("position")||
!Q.hasAttribute("normal")||!Q.hasAttribute("uv"))throw Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');const V=Q.index?Q.toNonIndexed():Q;S=S.generateTangents(P(V.attributes.position),P(V.attributes.normal),P(V.attributes.uv));if(Z)for(Z=3;Z<S.length;Z+=4)S[Z]*=-1;V.setAttribute("tangent",new ma.BufferAttribute(S,4));Q!==V&&Q.copy(V);return Q}function ib(Q,S=!1){var Z=null!==Q[0].index,P=new Set(Object.keys(Q[0].attributes)),V=new Set(Object.keys(Q[0].morphAttributes)),
ha={};const Aa={};var Ca=Q[0].morphTargetsRelative;const ya=new ma.BufferGeometry;let La=0;for(let va=0;va<Q.length;++va){var Za=Q[va];let za=0;if(Z!==(null!==Za.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+va+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const Va in Za.attributes){if(!P.has(Va))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
va+'. All geometries must have compatible attributes; make sure "'+Va+'" attribute exists among all geometries, or in none of them.'),null;void 0===ha[Va]&&(ha[Va]=[]);ha[Va].push(Za.attributes[Va]);za++}if(za!==P.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+va+". Make sure all geometries have the same number of attributes."),null;if(Ca!==Za.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
va+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const Va in Za.morphAttributes){if(!V.has(Va))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+va+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===Aa[Va]&&(Aa[Va]=[]);Aa[Va].push(Za.morphAttributes[Va])}if(S){if(Z)Za=Za.index.count;else if(void 0!==Za.attributes.position)Za=Za.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+
va+". The geometry must have either an index or a position attribute"),null;ya.addGroup(La,Za,va);La+=Za}}if(Z){S=0;Z=[];for(P=0;P<Q.length;++P){V=Q[P].index;for(Ca=0;Ca<V.count;++Ca)Z.push(V.getX(Ca)+S);S+=Q[P].attributes.position.count}ya.setIndex(Z)}for(var Ja in ha){Q=Ma(ha[Ja]);if(!Q)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Ja+" attribute."),null;ya.setAttribute(Ja,Q)}for(const va in Aa){ha=Aa[va][0].length;if(0===ha)break;ya.morphAttributes=
ya.morphAttributes||{};ya.morphAttributes[va]=[];for(Ja=0;Ja<ha;++Ja){Q=[];for(S=0;S<Aa[va].length;++S)Q.push(Aa[va][S][Ja]);Q=Ma(Q);if(!Q)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+va+" morphAttribute."),null;ya.morphAttributes[va].push(Q)}}return ya}function Ma(Q){let S;let Z=-1;var P=0;for(var V=0;V<Q.length;++V){var ha=Q[V];if(void 0===Aa)var Aa=ha.array.constructor;if(Aa!==ha.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),
null;void 0===S&&(S=ha.itemSize);if(S!==ha.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===Ca)var Ca=ha.normalized;if(Ca!==ha.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;-1===Z&&(Z=ha.gpuType);if(Z!==ha.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),
null;P+=ha.count*S}Aa=new Aa(P);Ca=new ma.BufferAttribute(Aa,S,Ca);P=0;for(V=0;V<Q.length;++V){ha=Q[V];if(ha.isInterleavedBufferAttribute){const ya=P/S;for(let La=0,Za=ha.count;La<Za;La++)for(let Ja=0;Ja<S;Ja++){const va=ha.getComponent(La,Ja);Ca.setComponent(La+ya,Ja,va)}}else Aa.set(ha.array,P);P+=ha.count*S}void 0!==Z&&(Ca.gpuType=Z);return Ca}function ua(Q){return Q.isInstancedInterleavedBufferAttribute||Q.isInterleavedBufferAttribute?wa(Q):Q.isInstancedBufferAttribute?(new ma.InstancedBufferAttribute).copy(Q):
(new ma.BufferAttribute).copy(Q)}function Ua(Q){var S=0,Z=0;for(let Aa=0,Ca=Q.length;Aa<Ca;++Aa){var P=Q[Aa];if(void 0===V)var V=P.array.constructor;if(V!==P.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;S+=P.array.length;Z+=P.itemSize}V=new ma.InterleavedBuffer(new V(S),Z);S=0;Z=[];P=["getX","getY","getZ","getW"];const ha=["setX","setY","setZ","setW"];for(let Aa=0,Ca=Q.length;Aa<Ca;Aa++){const ya=Q[Aa],La=ya.itemSize,Za=ya.count,Ja=new ma.InterleavedBufferAttribute(V,
La,S,ya.normalized);Z.push(Ja);S+=La;for(let va=0;va<Za;va++)for(let za=0;za<La;za++)Ja[ha[za]](va,ya[P[za]](va))}return Z}function wa(Q){const S=Q.count,Z=Q.itemSize;var P=Q.normalized,V=new Q.data.array.constructor(S*Z);P=Q.isInstancedInterleavedBufferAttribute?new ma.InstancedBufferAttribute(V,Z,P,Q.meshPerAttribute):new ma.BufferAttribute(V,Z,P);for(V=0;V<S;V++)P.setX(V,Q.getX(V)),2<=Z&&P.setY(V,Q.getY(V)),3<=Z&&P.setZ(V,Q.getZ(V)),4<=Z&&P.setW(V,Q.getW(V));return P}function qa(Q){var S=Q.attributes;
Q=Q.morphTargets;const Z=new Map;for(const P in S){const V=S[P];V.isInterleavedBufferAttribute&&(Z.has(V)||Z.set(V,wa(V)),S[P]=Z.get(V))}for(const P in Q)S=Q[P],S.isInterleavedBufferAttribute&&(Z.has(S)||Z.set(S,wa(S)),Q[P]=Z.get(S))}function Qa(Q){let S=0;for(const Z in Q.attributes){const P=Q.getAttribute(Z);S+=P.count*P.itemSize*P.array.BYTES_PER_ELEMENT}Q=Q.getIndex();return S+=Q?Q.count*Q.itemSize*Q.array.BYTES_PER_ELEMENT:0}function Tb(Q,S=1E-4){S=Math.max(S,Number.EPSILON);var Z={},P=Q.getIndex(),
V=Q.getAttribute("position");const ha=P?P.count:V.count;V=0;const Aa=Object.keys(Q.attributes),Ca={},ya={},La=[],Za=["getX","getY","getZ","getW"],Ja=["setX","setY","setZ","setW"];for(let fb=0,ub=Aa.length;fb<ub;fb++){var va=Aa[fb],za=Q.attributes[va];Ca[va]=new ma.BufferAttribute(new za.array.constructor(za.count*za.itemSize),za.itemSize,za.normalized);(za=Q.morphAttributes[va])&&(ya[va]=new ma.BufferAttribute(new za.array.constructor(za.count*za.itemSize),za.itemSize,za.normalized))}va=Math.pow(10,
Math.log10(1/S));S=.5*S*va;for(za=0;za<ha;za++){const fb=P?P.getX(za):za;let ub="";for(let vb=0,Zb=Aa.length;vb<Zb;vb++){var Va=Q.getAttribute(Aa[vb]),jb=Va.itemSize;for(var kb=0;kb<jb;kb++)ub+=`${~~(Va[Za[kb]](fb)*va+S)},`}if(ub in Z)La.push(Z[ub]);else{for(let vb=0,Zb=Aa.length;vb<Zb;vb++){var wb=Aa[vb];Va=Q.getAttribute(wb);jb=Q.morphAttributes[wb];kb=Va.itemSize;const Ob=Ca[wb];wb=ya[wb];for(let Hb=0;Hb<kb;Hb++){const Sb=Za[Hb],ec=Ja[Hb];Ob[ec](V,Va[Sb](fb));if(jb)for(let rb=0,Rb=jb.length;rb<
Rb;rb++)wb[rb][ec](V,jb[rb][Sb](fb))}}Z[ub]=V;La.push(V);V++}}Z=Q.clone();for(const fb in Q.attributes)if(Q=Ca[fb],Z.setAttribute(fb,new ma.BufferAttribute(Q.array.slice(0,V*Q.itemSize),Q.itemSize,Q.normalized)),fb in ya)for(Q=0;Q<ya[fb].length;Q++)P=ya[fb][Q],Z.morphAttributes[fb][Q]=new ma.BufferAttribute(P.array.slice(0,V*P.itemSize),P.itemSize,P.normalized);Z.setIndex(La);return Z}function Wb(Q,S){if(S===ma.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),
Q;if(S===ma.TriangleFanDrawMode||S===ma.TriangleStripDrawMode){var Z=Q.getIndex();if(null===Z){var P=[];Z=Q.getAttribute("position");if(void 0!==Z){for(var V=0;V<Z.count;V++)P.push(V);Q.setIndex(P);Z=Q.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),Q}V=Z.count-2;P=[];if(S===ma.TriangleFanDrawMode)for(S=1;S<=V;S++)P.push(Z.getX(0)),P.push(Z.getX(S)),P.push(Z.getX(S+1));else for(S=0;S<V;S++)0===S%2?(P.push(Z.getX(S)),
P.push(Z.getX(S+1)),P.push(Z.getX(S+2))):(P.push(Z.getX(S+2)),P.push(Z.getX(S+1)),P.push(Z.getX(S)));P.length/3!==V&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");Q=Q.clone();Q.setIndex(P);Q.clearGroups();return Q}console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",S);return Q}function Y(Q){function S(vc,pc,ic,Bc,Bb,Cb,q,y){Z.fromBufferAttribute(pc,Bb);P.fromBufferAttribute(pc,Cb);V.fromBufferAttribute(pc,
q);pc=vc.morphTargetInfluences;if(ic&&pc){ya.set(0,0,0);La.set(0,0,0);Za.set(0,0,0);for(let F=0,w=ic.length;F<w;F++){const G=pc[F],N=ic[F];0!==G&&(ha.fromBufferAttribute(N,Bb),Aa.fromBufferAttribute(N,Cb),Ca.fromBufferAttribute(N,q),Bc?(ya.addScaledVector(ha,G),La.addScaledVector(Aa,G),Za.addScaledVector(Ca,G)):(ya.addScaledVector(ha.sub(Z),G),La.addScaledVector(Aa.sub(P),G),Za.addScaledVector(Ca.sub(V),G)))}Z.add(ya);P.add(La);V.add(Za)}vc.isSkinnedMesh&&(vc.applyBoneTransform(Bb,Z),vc.applyBoneTransform(Cb,
P),vc.applyBoneTransform(q,V));y[3*Bb]=Z.x;y[3*Bb+1]=Z.y;y[3*Bb+2]=Z.z;y[3*Cb]=P.x;y[3*Cb+1]=P.y;y[3*Cb+2]=P.z;y[3*q]=V.x;y[3*q+1]=V.y;y[3*q+2]=V.z}const Z=new ma.Vector3,P=new ma.Vector3,V=new ma.Vector3,ha=new ma.Vector3,Aa=new ma.Vector3,Ca=new ma.Vector3,ya=new ma.Vector3,La=new ma.Vector3,Za=new ma.Vector3;var Ja=Q.geometry,va=Q.material;let za,Va;var jb=Ja.index;const kb=Ja.attributes.position,wb=Ja.morphAttributes.position,fb=Ja.morphTargetsRelative,ub=Ja.attributes.normal,vb=Ja.morphAttributes.position,
Zb=Ja.groups,Ob=Ja.drawRange;let Hb,Sb;const ec=new Float32Array(kb.count*kb.itemSize);Ja=new Float32Array(ub.count*ub.itemSize);if(null!==jb)if(Array.isArray(va))for(va=0,Hb=Zb.length;va<Hb;va++){var rb=Zb[va];var Rb=Math.max(rb.start,Ob.start);for(Sb=rb=Math.min(rb.start+rb.count,Ob.start+Ob.count);Rb<Sb;Rb+=3)rb=jb.getX(Rb),za=jb.getX(Rb+1),Va=jb.getX(Rb+2),S(Q,kb,wb,fb,rb,za,Va,ec),S(Q,ub,vb,fb,rb,za,Va,Ja)}else for(Rb=Math.max(0,Ob.start),rb=Math.min(jb.count,Ob.start+Ob.count),va=Rb,Hb=rb;va<
Hb;va+=3)rb=jb.getX(va),za=jb.getX(va+1),Va=jb.getX(va+2),S(Q,kb,wb,fb,rb,za,Va,ec),S(Q,ub,vb,fb,rb,za,Va,Ja);else if(Array.isArray(va))for(va=0,Hb=Zb.length;va<Hb;va++)for(rb=Zb[va],Rb=Math.max(rb.start,Ob.start),Sb=rb=Math.min(rb.start+rb.count,Ob.start+Ob.count);Rb<Sb;Rb+=3)rb=Rb,za=Rb+1,Va=Rb+2,S(Q,kb,wb,fb,rb,za,Va,ec),S(Q,ub,vb,fb,rb,za,Va,Ja);else for(Rb=Math.max(0,Ob.start),rb=Math.min(kb.count,Ob.start+Ob.count),va=Rb,Hb=rb;va<Hb;va+=3)rb=va,za=va+1,Va=va+2,S(Q,kb,wb,fb,rb,za,Va,ec),S(Q,
ub,vb,fb,rb,za,Va,Ja);Q=new ma.Float32BufferAttribute(ec,3);jb=new ma.Float32BufferAttribute(Ja,3);return{positionAttribute:kb,normalAttribute:ub,morphedPositionAttribute:Q,morphedNormalAttribute:jb}}function Wa(Q){if(0===Q.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),Q;let S=Q.groups;S=S.sort((Ca,ya)=>Ca.materialIndex!==ya.materialIndex?Ca.materialIndex-ya.materialIndex:Ca.start-ya.start);if(null===Q.getIndex()){var Z=Q.getAttribute("position"),
P=[];for(var V=0;V<Z.count;V+=3)P.push(V,V+1,V+2);Q.setIndex(P)}Z=Q.getIndex();P=[];for(V=0;V<S.length;V++){var ha=S[V],Aa=ha.start;for(ha=Aa+ha.count;Aa<ha;Aa++)P.push(Z.getX(Aa))}Q.dispose();Q.setIndex(P);Z=0;for(P=0;P<S.length;P++)V=S[P],V.start=Z,Z+=V.count;Z=S[0];Q.groups=[Z];for(P=1;P<S.length;P++)V=S[P],Z.materialIndex===V.materialIndex?Z.count+=V.count:(Z=V,Q.groups.push(Z));return Q}function Na(Q,S=Math.PI/3){function Z(kb){return`${~~(kb.x*P)},${~~(kb.y*P)},${~~(kb.z*P)}`}S=Math.cos(S);
const P=100*(1+1E-10),V=[new ma.Vector3,new ma.Vector3,new ma.Vector3],ha=new ma.Vector3,Aa=new ma.Vector3,Ca=new ma.Vector3,ya=new ma.Vector3;Q=Q.index?Q.toNonIndexed():Q;const La=Q.attributes.position,Za={};for(let kb=0,wb=La.count/3;kb<wb;kb++){var Ja=3*kb,va=V[0].fromBufferAttribute(La,Ja+0),za=V[1].fromBufferAttribute(La,Ja+1);Ja=V[2].fromBufferAttribute(La,Ja+2);ha.subVectors(Ja,za);Aa.subVectors(va,za);va=(new ma.Vector3).crossVectors(ha,Aa).normalize();for(za=0;3>za;za++)Ja=Z(V[za]),Ja in
Za||(Za[Ja]=[]),Za[Ja].push(va)}va=new Float32Array(3*La.count);va=new ma.BufferAttribute(va,3,!1);for(let kb=0,wb=La.count/3;kb<wb;kb++){za=3*kb;Ja=V[0].fromBufferAttribute(La,za+0);var Va=V[1].fromBufferAttribute(La,za+1),jb=V[2].fromBufferAttribute(La,za+2);ha.subVectors(jb,Va);Aa.subVectors(Ja,Va);Ca.crossVectors(ha,Aa).normalize();for(Ja=0;3>Ja;Ja++){Va=Z(V[Ja]);Va=Za[Va];ya.set(0,0,0);for(let fb=0,ub=Va.length;fb<ub;fb++)jb=Va[fb],Ca.dot(jb)>S&&ya.add(jb);ya.normalize();va.setXYZ(za+Ja,ya.x,
ya.y,ya.z)}}Q.setAttribute("normal",va);return Q}Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},computeMikkTSpaceTangents:{enumerable:!0,get:function(){return pa}},computeMorphedAttributes:{enumerable:!0,get:function(){return Y}},deepCloneAttribute:{enumerable:!0,get:function(){return ua}},deinterleaveAttribute:{enumerable:!0,get:function(){return wa}},deinterleaveGeometry:{enumerable:!0,get:function(){return qa}},estimateBytesUsed:{enumerable:!0,get:function(){return Qa}},interleaveAttributes:{enumerable:!0,
get:function(){return Ua}},mergeAttributes:{enumerable:!0,get:function(){return Ma}},mergeGeometries:{enumerable:!0,get:function(){return ib}},mergeGroups:{enumerable:!0,get:function(){return Wa}},mergeVertices:{enumerable:!0,get:function(){return Tb}},toCreasedNormals:{enumerable:!0,get:function(){return Na}},toTrianglesDrawMode:{enumerable:!0,get:function(){return Wb}}});var ma=qb(0)};
shadow$provide[14]=function(ac,qb,nc,r){function pa(){let q={};return{get:function(y){return q[y]},add:function(y,F){q[y]=F},remove:function(y){delete q[y]},removeAll:function(){q={}}}}function ib(q){void 0===q.DefaultMaterial&&(q.DefaultMaterial=new Y.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Y.FrontSide}));return q.DefaultMaterial}function Ma(q,y,F){for(const w in F.extensions)void 0===q[w]&&(y.userData.gltfExtensions=y.userData.gltfExtensions||
{},y.userData.gltfExtensions[w]=F.extensions[w])}function ua(q,y){void 0!==y.extras&&("object"===typeof y.extras?Object.assign(q.userData,y.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+y.extras))}function Ua(q,y,F){let w=!1,G=!1,N=!1;for(let hb=0,zb=y.length;hb<zb;hb++){var L=y[hb];void 0!==L.POSITION&&(w=!0);void 0!==L.NORMAL&&(G=!0);void 0!==L.COLOR_0&&(N=!0);if(w&&G&&N)break}if(!w&&!G&&!N)return Promise.resolve(q);L=[];const ba=[],da=[];for(let hb=0,zb=y.length;hb<
zb;hb++){var Da=y[hb];if(w){var Oa=void 0!==Da.POSITION?F.getDependency("accessor",Da.POSITION):q.attributes.position;L.push(Oa)}G&&(Oa=void 0!==Da.NORMAL?F.getDependency("accessor",Da.NORMAL):q.attributes.normal,ba.push(Oa));N&&(Da=void 0!==Da.COLOR_0?F.getDependency("accessor",Da.COLOR_0):q.attributes.color,da.push(Da))}return Promise.all([Promise.all(L),Promise.all(ba),Promise.all(da)]).then(function(hb){const zb=hb[0],xb=hb[1];hb=hb[2];w&&(q.morphAttributes.position=zb);G&&(q.morphAttributes.normal=
xb);N&&(q.morphAttributes.color=hb);q.morphTargetsRelative=!0;return q})}function wa(q){var y=(y=q.extensions&&q.extensions[ma.KHR_DRACO_MESH_COMPRESSION])?"draco:"+y.bufferView+":"+y.indices+":"+qa(y.attributes):q.indices+":"+qa(q.attributes)+":"+q.mode;if(void 0!==q.targets)for(let F=0,w=q.targets.length;F<w;F++)y+=":"+qa(q.targets[F]);return y}function qa(q){let y="";const F=Object.keys(q).sort();for(let w=0,G=F.length;w<G;w++)y+=F[w]+":"+q[F[w]]+";";return y}function Qa(q){switch(q){case Int8Array:return 1/
127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.");}}function Tb(q,y,F){var w=y.attributes;const G=new Y.Box3;if(void 0!==w.POSITION){w=F.json.accessors[w.POSITION];var N=w.min,L=w.max;if(void 0!==N&&void 0!==L){G.set(new Y.Vector3(N[0],N[1],N[2]),new Y.Vector3(L[0],L[1],L[2]));w.normalized&&(w=Qa(ec[w.componentType]),G.min.multiplyScalar(w),G.max.multiplyScalar(w));
y=y.targets;if(void 0!==y){w=new Y.Vector3;N=new Y.Vector3;for(let ba=0,da=y.length;ba<da;ba++)if(L=y[ba],void 0!==L.POSITION){L=F.json.accessors[L.POSITION];const Da=L.min,Oa=L.max;void 0!==Da&&void 0!==Oa?(N.setX(Math.max(Math.abs(Da[0]),Math.abs(Oa[0]))),N.setY(Math.max(Math.abs(Da[1]),Math.abs(Oa[1]))),N.setZ(Math.max(Math.abs(Da[2]),Math.abs(Oa[2]))),L.normalized&&(L=Qa(ec[L.componentType]),N.multiplyScalar(L)),w.max(N)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}G.expandByVector(w)}q.boundingBox=
G;F=new Y.Sphere;G.getCenter(F.center);F.radius=G.min.distanceTo(G.max)/2;q.boundingSphere=F}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function Wb(q,y,F){function w(ba,da){return F.getDependency("accessor",ba).then(function(Da){q.setAttribute(da,Da)})}const G=y.attributes,N=[];for(var L in G){const ba=pc[L]||L.toLowerCase();ba in q.attributes||N.push(w(G[L],ba))}void 0===y.indices||q.index||(L=F.getDependency("accessor",y.indices).then(function(ba){q.setIndex(ba)}),
N.push(L));Y.ColorManagement.workingColorSpace!==Y.LinearSRGBColorSpace&&"COLOR_0"in G&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Y.ColorManagement.workingColorSpace}" not supported.`);ua(q,y);Tb(q,y,F);return Promise.all(N).then(function(){return void 0!==y.targets?Ua(q,y.targets,F):q})}Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},GLTFLoader:{enumerable:!0,get:function(){return Na}}});var Y=qb(0),Wa=qb(13);class Na extends Y.Loader{constructor(q){super(q);
this.meshoptDecoder=this.ktx2Loader=this.dracoLoader=null;this.pluginCallbacks=[];this.register(function(y){return new P(y)});this.register(function(y){return new va(y)});this.register(function(y){return new za(y)});this.register(function(y){return new Va(y)});this.register(function(y){return new ha(y)});this.register(function(y){return new Aa(y)});this.register(function(y){return new Ca(y)});this.register(function(y){return new ya(y)});this.register(function(y){return new Z(y)});this.register(function(y){return new La(y)});
this.register(function(y){return new V(y)});this.register(function(y){return new Ja(y)});this.register(function(y){return new Za(y)});this.register(function(y){return new Q(y)});this.register(function(y){return new jb(y)});this.register(function(y){return new kb(y)})}load(q,y,F,w){const G=this;let N;if(""!==this.resourcePath)N=this.resourcePath;else if(""!==this.path){var L=Y.LoaderUtils.extractUrlBase(q);N=Y.LoaderUtils.resolveURL(L,this.path)}else N=Y.LoaderUtils.extractUrlBase(q);this.manager.itemStart(q);
const ba=function(da){w?w(da):console.error(da);G.manager.itemError(q);G.manager.itemEnd(q)};L=new Y.FileLoader(this.manager);L.setPath(this.path);L.setResponseType("arraybuffer");L.setRequestHeader(this.requestHeader);L.setWithCredentials(this.withCredentials);L.load(q,function(da){try{G.parse(da,N,function(Da){y(Da);G.manager.itemEnd(q)},ba)}catch(Da){ba(Da)}},F,ba)}setDRACOLoader(q){this.dracoLoader=q;return this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".');
}setKTX2Loader(q){this.ktx2Loader=q;return this}setMeshoptDecoder(q){this.meshoptDecoder=q;return this}register(q){-1===this.pluginCallbacks.indexOf(q)&&this.pluginCallbacks.push(q);return this}unregister(q){-1!==this.pluginCallbacks.indexOf(q)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(q),1);return this}parse(q,y,F,w){const G={},N={};var L=new TextDecoder;if("string"===typeof q)q=JSON.parse(q);else if(q instanceof ArrayBuffer)if("glTF"===L.decode(new Uint8Array(q,0,4))){try{G[ma.KHR_BINARY_GLTF]=
new wb(q)}catch(da){w&&w(da);return}q=JSON.parse(G[ma.KHR_BINARY_GLTF].content)}else q=JSON.parse(L.decode(q));if(void 0===q.asset||2>q.asset.version[0])w&&w(Error("THREE.GLTFLoader: Unsupported asset. glTF versions \x3e\x3d2.0 are supported."));else{y=new Cb(q,{path:y||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});y.fileLoader.setRequestHeader(this.requestHeader);for(L=0;L<this.pluginCallbacks.length;L++){var ba=
this.pluginCallbacks[L](y);ba.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name");N[ba.name]=ba;G[ba.name]=!0}if(q.extensionsUsed)for(L=0;L<q.extensionsUsed.length;++L){ba=q.extensionsUsed[L];const da=q.extensionsRequired||[];switch(ba){case ma.KHR_MATERIALS_UNLIT:G[ba]=new S;break;case ma.KHR_DRACO_MESH_COMPRESSION:G[ba]=new fb(q,this.dracoLoader);break;case ma.KHR_TEXTURE_TRANSFORM:G[ba]=new ub;break;case ma.KHR_MESH_QUANTIZATION:G[ba]=new vb;break;default:0<=da.indexOf(ba)&&
void 0===N[ba]&&console.warn('THREE.GLTFLoader: Unknown extension "'+ba+'".')}}y.setExtensions(G);y.setPlugins(N);y.parse(F,w)}}parseAsync(q,y){const F=this;return new Promise(function(w,G){F.parse(q,y,w,G)})}}const ma={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",
KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",
EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Q{constructor(q){this.parser=q;this.name=ma.KHR_LIGHTS_PUNCTUAL;this.cache={refs:{},uses:{}}}_markDefs(){const q=this.parser,y=this.parser.json.nodes||[];for(let F=0,w=y.length;F<w;F++){const G=y[F];G.extensions&&G.extensions[this.name]&&void 0!==G.extensions[this.name].light&&q._addNodeRef(this.cache,G.extensions[this.name].light)}}_loadLight(q){const y=this.parser,
F="light:"+q;var w=y.cache.get(F);if(w)return w;w=y.json;w=((w.extensions&&w.extensions[this.name]||{}).lights||[])[q];var G=new Y.Color(16777215);void 0!==w.color&&G.setRGB(w.color[0],w.color[1],w.color[2],Y.LinearSRGBColorSpace);const N=void 0!==w.range?w.range:0;switch(w.type){case "directional":G=new Y.DirectionalLight(G);G.target.position.set(0,0,-1);G.add(G.target);break;case "point":G=new Y.PointLight(G);G.distance=N;break;case "spot":G=new Y.SpotLight(G);G.distance=N;w.spot=w.spot||{};w.spot.innerConeAngle=
void 0!==w.spot.innerConeAngle?w.spot.innerConeAngle:0;w.spot.outerConeAngle=void 0!==w.spot.outerConeAngle?w.spot.outerConeAngle:Math.PI/4;G.angle=w.spot.outerConeAngle;G.penumbra=1-w.spot.innerConeAngle/w.spot.outerConeAngle;G.target.position.set(0,0,-1);G.add(G.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+w.type);}G.position.set(0,0,0);G.decay=2;ua(G,w);void 0!==w.intensity&&(G.intensity=w.intensity);G.name=y.createUniqueName(w.name||"light_"+q);w=Promise.resolve(G);
y.cache.add(F,w);return w}getDependency(q,y){if("light"===q)return this._loadLight(y)}createNodeAttachment(q){const y=this,F=this.parser;q=F.json.nodes[q];const w=(q.extensions&&q.extensions[this.name]||{}).light;return void 0===w?null:this._loadLight(w).then(function(G){return F._getNodeRef(y.cache,w,G)})}}class S{constructor(){this.name=ma.KHR_MATERIALS_UNLIT}getMaterialType(){return Y.MeshBasicMaterial}extendParams(q,y,F){const w=[];q.color=new Y.Color(1,1,1);q.opacity=1;if(y=y.pbrMetallicRoughness){if(Array.isArray(y.baseColorFactor)){const G=
y.baseColorFactor;q.color.setRGB(G[0],G[1],G[2],Y.LinearSRGBColorSpace);q.opacity=G[3]}void 0!==y.baseColorTexture&&w.push(F.assignTexture(q,"map",y.baseColorTexture,Y.SRGBColorSpace))}return Promise.all(w)}}class Z{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(q,y){q=this.parser.json.materials[q];if(!q.extensions||!q.extensions[this.name])return Promise.resolve();q=q.extensions[this.name].emissiveStrength;void 0!==q&&(y.emissiveIntensity=q);return Promise.resolve()}}
class P{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_CLEARCOAT}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){var F=this.parser,w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];w=w.extensions[this.name];void 0!==w.clearcoatFactor&&(y.clearcoat=w.clearcoatFactor);void 0!==w.clearcoatTexture&&q.push(F.assignTexture(y,"clearcoatMap",w.clearcoatTexture));
void 0!==w.clearcoatRoughnessFactor&&(y.clearcoatRoughness=w.clearcoatRoughnessFactor);void 0!==w.clearcoatRoughnessTexture&&q.push(F.assignTexture(y,"clearcoatRoughnessMap",w.clearcoatRoughnessTexture));void 0!==w.clearcoatNormalTexture&&(q.push(F.assignTexture(y,"clearcoatNormalMap",w.clearcoatNormalTexture)),void 0!==w.clearcoatNormalTexture.scale&&(F=w.clearcoatNormalTexture.scale,y.clearcoatNormalScale=new Y.Vector2(F,F)));return Promise.all(q)}}class V{constructor(q){this.parser=q;this.name=
ma.KHR_MATERIALS_IRIDESCENCE}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];w=w.extensions[this.name];void 0!==w.iridescenceFactor&&(y.iridescence=w.iridescenceFactor);void 0!==w.iridescenceTexture&&q.push(F.assignTexture(y,"iridescenceMap",w.iridescenceTexture));void 0!==w.iridescenceIor&&
(y.iridescenceIOR=w.iridescenceIor);void 0===y.iridescenceThicknessRange&&(y.iridescenceThicknessRange=[100,400]);void 0!==w.iridescenceThicknessMinimum&&(y.iridescenceThicknessRange[0]=w.iridescenceThicknessMinimum);void 0!==w.iridescenceThicknessMaximum&&(y.iridescenceThicknessRange[1]=w.iridescenceThicknessMaximum);void 0!==w.iridescenceThicknessTexture&&q.push(F.assignTexture(y,"iridescenceThicknessMap",w.iridescenceThicknessTexture));return Promise.all(q)}}class ha{constructor(q){this.parser=
q;this.name=ma.KHR_MATERIALS_SHEEN}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];y.sheenColor=new Y.Color(0,0,0);y.sheenRoughness=0;y.sheen=1;w=w.extensions[this.name];if(void 0!==w.sheenColorFactor){const G=w.sheenColorFactor;y.sheenColor.setRGB(G[0],G[1],G[2],Y.LinearSRGBColorSpace)}void 0!==
w.sheenRoughnessFactor&&(y.sheenRoughness=w.sheenRoughnessFactor);void 0!==w.sheenColorTexture&&q.push(F.assignTexture(y,"sheenColorMap",w.sheenColorTexture,Y.SRGBColorSpace));void 0!==w.sheenRoughnessTexture&&q.push(F.assignTexture(y,"sheenRoughnessMap",w.sheenRoughnessTexture));return Promise.all(q)}}class Aa{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_TRANSMISSION}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:
null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];w=w.extensions[this.name];void 0!==w.transmissionFactor&&(y.transmission=w.transmissionFactor);void 0!==w.transmissionTexture&&q.push(F.assignTexture(y,"transmissionMap",w.transmissionTexture));return Promise.all(q)}}class Ca{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_VOLUME}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&
q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){var F=this.parser,w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];w=w.extensions[this.name];y.thickness=void 0!==w.thicknessFactor?w.thicknessFactor:0;void 0!==w.thicknessTexture&&q.push(F.assignTexture(y,"thicknessMap",w.thicknessTexture));y.attenuationDistance=w.attenuationDistance||Infinity;F=w.attenuationColor||[1,1,1];y.attenuationColor=(new Y.Color).setRGB(F[0],F[1],F[2],
Y.LinearSRGBColorSpace);return Promise.all(q)}}class ya{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_IOR}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){q=this.parser.json.materials[q];if(!q.extensions||!q.extensions[this.name])return Promise.resolve();q=q.extensions[this.name];y.ior=void 0!==q.ior?q.ior:1.5;return Promise.resolve()}}class La{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_SPECULAR}getMaterialType(q){q=
this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();q=[];w=w.extensions[this.name];y.specularIntensity=void 0!==w.specularFactor?w.specularFactor:1;void 0!==w.specularTexture&&q.push(F.assignTexture(y,"specularIntensityMap",w.specularTexture));const G=w.specularColorFactor||[1,1,1];y.specularColor=(new Y.Color).setRGB(G[0],
G[1],G[2],Y.LinearSRGBColorSpace);void 0!==w.specularColorTexture&&q.push(F.assignTexture(y,"specularColorMap",w.specularColorTexture,Y.SRGBColorSpace));return Promise.all(q)}}class Za{constructor(q){this.parser=q;this.name=ma.EXT_MATERIALS_BUMP}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();
q=[];w=w.extensions[this.name];y.bumpScale=void 0!==w.bumpFactor?w.bumpFactor:1;void 0!==w.bumpTexture&&q.push(F.assignTexture(y,"bumpMap",w.bumpTexture));return Promise.all(q)}}class Ja{constructor(q){this.parser=q;this.name=ma.KHR_MATERIALS_ANISOTROPY}getMaterialType(q){q=this.parser.json.materials[q];return q.extensions&&q.extensions[this.name]?Y.MeshPhysicalMaterial:null}extendMaterialParams(q,y){const F=this.parser;var w=F.json.materials[q];if(!w.extensions||!w.extensions[this.name])return Promise.resolve();
q=[];w=w.extensions[this.name];void 0!==w.anisotropyStrength&&(y.anisotropy=w.anisotropyStrength);void 0!==w.anisotropyRotation&&(y.anisotropyRotation=w.anisotropyRotation);void 0!==w.anisotropyTexture&&q.push(F.assignTexture(y,"anisotropyMap",w.anisotropyTexture));return Promise.all(q)}}class va{constructor(q){this.parser=q;this.name=ma.KHR_TEXTURE_BASISU}loadTexture(q){const y=this.parser,F=y.json;var w=F.textures[q];if(!w.extensions||!w.extensions[this.name])return null;w=w.extensions[this.name];
const G=y.options.ktx2Loader;if(!G){if(F.extensionsRequired&&0<=F.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return y.loadTextureImage(q,w.source,G)}}class za{constructor(q){this.parser=q;this.name=ma.EXT_TEXTURE_WEBP;this.isSupported=null}loadTexture(q){const y=this.name,F=this.parser,w=F.json;var G=w.textures[q];if(!G.extensions||!G.extensions[y])return null;const N=G.extensions[y];G=w.images[N.source];
let L=F.textureLoader;G.uri&&(G=F.options.manager.getHandler(G.uri),null!==G&&(L=G));return this.detectSupport().then(function(ba){if(ba)return F.loadTextureImage(q,N.source,L);if(w.extensionsRequired&&0<=w.extensionsRequired.indexOf(y))throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return F.loadTexture(q)})}detectSupport(){this.isSupported||(this.isSupported=new Promise(function(q){const y=new Image;y.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";
y.onload=y.onerror=function(){q(1===y.height)}}));return this.isSupported}}class Va{constructor(q){this.parser=q;this.name=ma.EXT_TEXTURE_AVIF;this.isSupported=null}loadTexture(q){const y=this.name,F=this.parser,w=F.json;var G=w.textures[q];if(!G.extensions||!G.extensions[y])return null;const N=G.extensions[y];G=w.images[N.source];let L=F.textureLoader;G.uri&&(G=F.options.manager.getHandler(G.uri),null!==G&&(L=G));return this.detectSupport().then(function(ba){if(ba)return F.loadTextureImage(q,N.source,
L);if(w.extensionsRequired&&0<=w.extensionsRequired.indexOf(y))throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return F.loadTexture(q)})}detectSupport(){this.isSupported||(this.isSupported=new Promise(function(q){const y=new Image;y.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI\x3d";
y.onload=y.onerror=function(){q(1===y.height)}}));return this.isSupported}}class jb{constructor(q){this.name=ma.EXT_MESHOPT_COMPRESSION;this.parser=q}loadBufferView(q){const y=this.parser.json;q=y.bufferViews[q];if(q.extensions&&q.extensions[this.name]){const F=q.extensions[this.name];q=this.parser.getDependency("buffer",F.buffer);const w=this.parser.options.meshoptDecoder;if(!w||!w.supported){if(y.extensionsRequired&&0<=y.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");
return null}return q.then(function(G){const N=F.count,L=F.byteStride,ba=new Uint8Array(G,F.byteOffset||0,F.byteLength||0);return w.decodeGltfBufferAsync?w.decodeGltfBufferAsync(N,L,ba,F.mode,F.filter).then(function(da){return da.buffer}):w.ready.then(function(){const da=new ArrayBuffer(N*L);w.decodeGltfBuffer(new Uint8Array(da),N,L,ba,F.mode,F.filter);return da})})}return null}}class kb{constructor(q){this.name=ma.EXT_MESH_GPU_INSTANCING;this.parser=q}createNodeMesh(q){var y=this.parser.json,F=y.nodes[q];
if(!F.extensions||!F.extensions[this.name]||void 0===F.mesh)return null;y=y.meshes[F.mesh];for(var w of y.primitives)if(w.mode!==Sb.TRIANGLES&&w.mode!==Sb.TRIANGLE_STRIP&&w.mode!==Sb.TRIANGLE_FAN&&void 0!==w.mode)return null;F=F.extensions[this.name].attributes;w=[];const G={};for(const N in F)w.push(this.parser.getDependency("accessor",F[N]).then(L=>{G[N]=L;return G[N]}));if(1>w.length)return null;w.push(this.parser.createNodeMesh(q));return Promise.all(w).then(N=>{const L=N.pop();var ba=L.isGroup?
L.children:[L];N=N[0].count;const da=[];for(const Oa of ba){var Da=new Y.Matrix4;const hb=new Y.Vector3,zb=new Y.Quaternion,xb=new Y.Vector3(1,1,1);ba=new Y.InstancedMesh(Oa.geometry,Oa.material,N);for(let sb=0;sb<N;sb++)G.TRANSLATION&&hb.fromBufferAttribute(G.TRANSLATION,sb),G.ROTATION&&zb.fromBufferAttribute(G.ROTATION,sb),G.SCALE&&xb.fromBufferAttribute(G.SCALE,sb),ba.setMatrixAt(sb,Da.compose(hb,zb,xb));for(const sb in G)"_COLOR_0"===sb?(Da=G[sb],ba.instanceColor=new Y.InstancedBufferAttribute(Da.array,
Da.itemSize,Da.normalized)):"TRANSLATION"!==sb&&"ROTATION"!==sb&&"SCALE"!==sb&&Oa.geometry.setAttribute(sb,G[sb]);Y.Object3D.prototype.copy.call(ba,Oa);this.parser.assignFinalMaterial(ba);da.push(ba)}return L.isGroup?(L.clear(),L.add(...da),L):da[0]})}}class wb{constructor(q){this.name=ma.KHR_BINARY_GLTF;this.body=this.content=null;var y=new DataView(q,0,12);const F=new TextDecoder;this.header={magic:F.decode(new Uint8Array(q.slice(0,4))),version:y.getUint32(4,!0),length:y.getUint32(8,!0)};if("glTF"!==
this.header.magic)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");y=this.header.length-12;const w=new DataView(q,12);let G=0;for(;G<y;){const L=w.getUint32(G,!0);G+=4;var N=w.getUint32(G,!0);G+=4;1313821514===N?(N=new Uint8Array(q,12+G,L),this.content=F.decode(N)):5130562===N&&(N=12+G,this.body=q.slice(N,N+L));G+=L}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.");
}}class fb{constructor(q,y){if(!y)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ma.KHR_DRACO_MESH_COMPRESSION;this.json=q;this.dracoLoader=y;this.dracoLoader.preload()}decodePrimitive(q,y){const F=this.json,w=this.dracoLoader,G=q.extensions[this.name].bufferView,N=q.extensions[this.name].attributes,L={},ba={},da={};for(var Da in N){var Oa=pc[Da]||Da.toLowerCase();L[Oa]=N[Da]}for(const hb in q.attributes)Da=pc[hb]||hb.toLowerCase(),void 0!==N[hb]&&(Oa=F.accessors[q.attributes[hb]],
da[Da]=ec[Oa.componentType].name,ba[Da]=!0===Oa.normalized);return y.getDependency("bufferView",G).then(function(hb){return new Promise(function(zb,xb){w.decodeDracoFile(hb,function(sb){for(const hc in sb.attributes){const Pc=sb.attributes[hc],Ic=ba[hc];void 0!==Ic&&(Pc.normalized=Ic)}zb(sb)},L,da,Y.LinearSRGBColorSpace,xb)})})}}class ub{constructor(){this.name=ma.KHR_TEXTURE_TRANSFORM}extendTexture(q,y){if((void 0===y.texCoord||y.texCoord===q.channel)&&void 0===y.offset&&void 0===y.rotation&&void 0===
y.scale)return q;q=q.clone();void 0!==y.texCoord&&(q.channel=y.texCoord);void 0!==y.offset&&q.offset.fromArray(y.offset);void 0!==y.rotation&&(q.rotation=y.rotation);void 0!==y.scale&&q.repeat.fromArray(y.scale);q.needsUpdate=!0;return q}}class vb{constructor(){this.name=ma.KHR_MESH_QUANTIZATION}}class Zb extends Y.Interpolant{constructor(q,y,F,w){super(q,y,F,w)}copySampleValue_(q){const y=this.resultBuffer,F=this.sampleValues,w=this.valueSize;q=q*w*3+w;for(let G=0;G!==w;G++)y[G]=F[q+G];return y}interpolate_(q,
y,F,w){const G=this.resultBuffer,N=this.sampleValues,L=this.valueSize,ba=2*L;var da=3*L;w-=y;y=(F-y)/w;F=y*y;var Da=F*y;q*=da;da=q-da;const Oa=-2*Da+3*F;Da-=F;const hb=1-Oa;y=Da-F+y;for(F=0;F!==L;F++)G[F]=hb*N[da+F+L]+y*N[da+F+ba]*w+Oa*N[q+F+L]+Da*N[q+F]*w;return G}}const Ob=new Y.Quaternion;class Hb extends Zb{interpolate_(q,y,F,w){q=super.interpolate_(q,y,F,w);Ob.fromArray(q).normalize().toArray(q);return q}}const Sb={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,
FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ec={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rb={9728:Y.NearestFilter,9729:Y.LinearFilter,9984:Y.NearestMipmapNearestFilter,9985:Y.LinearMipmapNearestFilter,9986:Y.NearestMipmapLinearFilter,9987:Y.LinearMipmapLinearFilter},Rb={33071:Y.ClampToEdgeWrapping,33648:Y.MirroredRepeatWrapping,
10497:Y.RepeatWrapping},vc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},pc={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ic={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Bc={CUBICSPLINE:void 0,LINEAR:Y.InterpolateLinear,STEP:Y.InterpolateDiscrete},Bb=new Y.Matrix4;class Cb{constructor(q={},y={}){this.json=q;
this.extensions={};this.plugins={};this.options=y;this.cache=new pa;this.associations=new Map;this.primitiveCache={};this.nodeCache={};this.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};this.lightCache={refs:{},uses:{}};this.sourceCache={};this.textureCache={};this.nodeNamesUsed={};y=q=!1;let F=-1;"undefined"!==typeof navigator&&(q=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),F=(y=-1<navigator.userAgent.indexOf("Firefox"))?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:
-1);this.textureLoader="undefined"===typeof createImageBitmap||q||y&&98>F?new Y.TextureLoader(this.options.manager):new Y.ImageBitmapLoader(this.options.manager);this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.textureLoader.setRequestHeader(this.options.requestHeader);this.fileLoader=new Y.FileLoader(this.options.manager);this.fileLoader.setResponseType("arraybuffer");"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(q){this.extensions=
q}setPlugins(q){this.plugins=q}parse(q,y){const F=this,w=this.json,G=this.extensions;this.cache.removeAll();this.nodeCache={};this._invokeAll(function(N){return N._markDefs&&N._markDefs()});Promise.all(this._invokeAll(function(N){return N.beforeRoot&&N.beforeRoot()})).then(function(){return Promise.all([F.getDependencies("scene"),F.getDependencies("animation"),F.getDependencies("camera")])}).then(function(N){const L={scene:N[0][w.scene||0],scenes:N[0],animations:N[1],cameras:N[2],asset:w.asset,parser:F,
userData:{}};Ma(G,L,w);ua(L,w);return Promise.all(F._invokeAll(function(ba){return ba.afterRoot&&ba.afterRoot(L)})).then(function(){q(L)})}).catch(y)}_markDefs(){const q=this.json.nodes||[];var y=this.json.skins||[];const F=this.json.meshes||[];for(let w=0,G=y.length;w<G;w++){const N=y[w].joints;for(let L=0,ba=N.length;L<ba;L++)q[N[L]].isBone=!0}for(let w=0,G=q.length;w<G;w++)y=q[w],void 0!==y.mesh&&(this._addNodeRef(this.meshCache,y.mesh),void 0!==y.skin&&(F[y.mesh].isSkinnedMesh=!0)),void 0!==y.camera&&
this._addNodeRef(this.cameraCache,y.camera)}_addNodeRef(q,y){void 0!==y&&(void 0===q.refs[y]&&(q.refs[y]=q.uses[y]=0),q.refs[y]++)}_getNodeRef(q,y,F){if(1>=q.refs[y])return F;const w=F.clone(),G=(N,L)=>{const ba=this.associations.get(N);null!=ba&&this.associations.set(L,ba);for(const [da,Da]of N.children.entries())G(Da,L.children[da])};G(F,w);w.name+="_instance_"+q.uses[y]++;return w}_invokeOne(q){const y=Object.values(this.plugins);y.push(this);for(let F=0;F<y.length;F++){const w=q(y[F]);if(w)return w}return null}_invokeAll(q){const y=
Object.values(this.plugins);y.unshift(this);const F=[];for(let w=0;w<y.length;w++){const G=q(y[w]);G&&F.push(G)}return F}getDependency(q,y){const F=q+":"+y;let w=this.cache.get(F);if(!w){switch(q){case "scene":w=this.loadScene(y);break;case "node":w=this._invokeOne(function(G){return G.loadNode&&G.loadNode(y)});break;case "mesh":w=this._invokeOne(function(G){return G.loadMesh&&G.loadMesh(y)});break;case "accessor":w=this.loadAccessor(y);break;case "bufferView":w=this._invokeOne(function(G){return G.loadBufferView&&
G.loadBufferView(y)});break;case "buffer":w=this.loadBuffer(y);break;case "material":w=this._invokeOne(function(G){return G.loadMaterial&&G.loadMaterial(y)});break;case "texture":w=this._invokeOne(function(G){return G.loadTexture&&G.loadTexture(y)});break;case "skin":w=this.loadSkin(y);break;case "animation":w=this._invokeOne(function(G){return G.loadAnimation&&G.loadAnimation(y)});break;case "camera":w=this.loadCamera(y);break;default:if(w=this._invokeOne(function(G){return G!=this&&G.getDependency&&
G.getDependency(q,y)}),!w)throw Error("Unknown type: "+q);}this.cache.add(F,w)}return w}getDependencies(q){let y=this.cache.get(q);if(!y){const F=this;y=Promise.all((this.json[q+("mesh"===q?"es":"s")]||[]).map(function(w,G){return F.getDependency(q,G)}));this.cache.add(q,y)}return y}loadBuffer(q){const y=this.json.buffers[q],F=this.fileLoader;if(y.type&&"arraybuffer"!==y.type)throw Error("THREE.GLTFLoader: "+y.type+" buffer type is not supported.");if(void 0===y.uri&&0===q)return Promise.resolve(this.extensions[ma.KHR_BINARY_GLTF].body);
const w=this.options;return new Promise(function(G,N){F.load(Y.LoaderUtils.resolveURL(y.uri,w.path),G,void 0,function(){N(Error('THREE.GLTFLoader: Failed to load buffer "'+y.uri+'".'))})})}loadBufferView(q){const y=this.json.bufferViews[q];return this.getDependency("buffer",y.buffer).then(function(F){const w=y.byteOffset||0;return F.slice(w,w+(y.byteLength||0))})}loadAccessor(q){const y=this,F=this.json,w=this.json.accessors[q];if(void 0===w.bufferView&&void 0===w.sparse){q=vc[w.type];const G=!0===
w.normalized,N=new ec[w.componentType](w.count*q);return Promise.resolve(new Y.BufferAttribute(N,q,G))}q=[];void 0!==w.bufferView?q.push(this.getDependency("bufferView",w.bufferView)):q.push(null);void 0!==w.sparse&&(q.push(this.getDependency("bufferView",w.sparse.indices.bufferView)),q.push(this.getDependency("bufferView",w.sparse.values.bufferView)));return Promise.all(q).then(function(G){var N=G[0];const L=vc[w.type],ba=ec[w.componentType];var da=ba.BYTES_PER_ELEMENT,Da=w.byteOffset||0,Oa=void 0!==
w.bufferView?F.bufferViews[w.bufferView].byteStride:void 0;const hb=!0===w.normalized;if(Oa&&Oa!==da*L){var zb=Math.floor(Da/Oa);const xb="InterleavedBuffer:"+w.bufferView+":"+w.componentType+":"+zb+":"+w.count;let sb=y.cache.get(xb);sb||(zb=new ba(N,zb*Oa,w.count*Oa/da),sb=new Y.InterleavedBuffer(zb,Oa/da),y.cache.add(xb,sb));da=new Y.InterleavedBufferAttribute(sb,L,Da%Oa/da,hb)}else zb=null===N?new ba(w.count*L):new ba(N,Da,w.count*L),da=new Y.BufferAttribute(zb,L,hb);if(void 0!==w.sparse){Oa=w.sparse.values.byteOffset||
0;Da=new ec[w.sparse.indices.componentType](G[1],w.sparse.indices.byteOffset||0,w.sparse.count*vc.SCALAR);G=new ba(G[2],Oa,w.sparse.count*L);null!==N&&(da=new Y.BufferAttribute(da.array.slice(),da.itemSize,da.normalized));for(let xb=0,sb=Da.length;xb<sb;xb++)if(N=Da[xb],da.setX(N,G[xb*L]),2<=L&&da.setY(N,G[xb*L+1]),3<=L&&da.setZ(N,G[xb*L+2]),4<=L&&da.setW(N,G[xb*L+3]),5<=L)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.");}return da})}loadTexture(q){var y=this.json,
F=this.options;const w=y.textures[q].source,G=y.images[w];y=this.textureLoader;G.uri&&(F=F.manager.getHandler(G.uri),null!==F&&(y=F));return this.loadTextureImage(q,w,y)}loadTextureImage(q,y,F){const w=this,G=this.json,N=G.textures[q],L=G.images[y],ba=(L.uri||L.bufferView)+":"+N.sampler;if(this.textureCache[ba])return this.textureCache[ba];y=this.loadImageSource(y,F).then(function(da){da.flipY=!1;da.name=N.name||L.name||"";""===da.name&&"string"===typeof L.uri&&!1===L.uri.startsWith("data:image/")&&
(da.name=L.uri);const Da=(G.samplers||{})[N.sampler]||{};da.magFilter=rb[Da.magFilter]||Y.LinearFilter;da.minFilter=rb[Da.minFilter]||Y.LinearMipmapLinearFilter;da.wrapS=Rb[Da.wrapS]||Y.RepeatWrapping;da.wrapT=Rb[Da.wrapT]||Y.RepeatWrapping;w.associations.set(da,{textures:q});return da}).catch(function(){return null});return this.textureCache[ba]=y}loadImageSource(q,y){var F=this.json;const w=this.options;if(void 0!==this.sourceCache[q])return this.sourceCache[q].then(da=>da.clone());const G=F.images[q],
N=self.URL||self.webkitURL;let L=G.uri||"",ba=!1;if(void 0!==G.bufferView)L=this.getDependency("bufferView",G.bufferView).then(function(da){ba=!0;da=new Blob([da],{type:G.mimeType});return L=N.createObjectURL(da)});else if(void 0===G.uri)throw Error("THREE.GLTFLoader: Image "+q+" is missing URI and bufferView");F=Promise.resolve(L).then(function(da){return new Promise(function(Da,Oa){let hb=Da;!0===y.isImageBitmapLoader&&(hb=function(zb){zb=new Y.Texture(zb);zb.needsUpdate=!0;Da(zb)});y.load(Y.LoaderUtils.resolveURL(da,
w.path),hb,void 0,Oa)})}).then(function(da){!0===ba&&N.revokeObjectURL(L);var Da=da.userData,Oa;(Oa=G.mimeType)||(Oa=G.uri,Oa=0<Oa.search(/\.jpe?g($|\?)/i)||0===Oa.search(/^data:image\/jpeg/)?"image/jpeg":0<Oa.search(/\.webp($|\?)/i)||0===Oa.search(/^data:image\/webp/)?"image/webp":"image/png");Da.mimeType=Oa;return da}).catch(function(da){console.error("THREE.GLTFLoader: Couldn't load texture",L);throw da;});return this.sourceCache[q]=F}assignTexture(q,y,F,w){const G=this;return this.getDependency("texture",
F.index).then(function(N){if(!N)return null;void 0!==F.texCoord&&0<F.texCoord&&(N=N.clone(),N.channel=F.texCoord);if(G.extensions[ma.KHR_TEXTURE_TRANSFORM]){const L=void 0!==F.extensions?F.extensions[ma.KHR_TEXTURE_TRANSFORM]:void 0;if(L){const ba=G.associations.get(N);N=G.extensions[ma.KHR_TEXTURE_TRANSFORM].extendTexture(N,L);G.associations.set(N,ba)}}void 0!==w&&(N.colorSpace=w);return q[y]=N})}assignFinalMaterial(q){var y=q.geometry;let F=q.material;const w=void 0===y.attributes.tangent,G=void 0!==
y.attributes.color;y=void 0===y.attributes.normal;if(q.isPoints){var N="PointsMaterial:"+F.uuid,L=this.cache.get(N);L||(L=new Y.PointsMaterial,Y.Material.prototype.copy.call(L,F),L.color.copy(F.color),L.map=F.map,L.sizeAttenuation=!1,this.cache.add(N,L));F=L}else q.isLine&&(N="LineBasicMaterial:"+F.uuid,L=this.cache.get(N),L||(L=new Y.LineBasicMaterial,Y.Material.prototype.copy.call(L,F),L.color.copy(F.color),L.map=F.map,this.cache.add(N,L)),F=L);if(w||G||y)N="ClonedMaterial:"+F.uuid+":",w&&(N+="derivative-tangents:"),
G&&(N+="vertex-colors:"),y&&(N+="flat-shading:"),L=this.cache.get(N),L||(L=F.clone(),G&&(L.vertexColors=!0),y&&(L.flatShading=!0),w&&(L.normalScale&&(L.normalScale.y*=-1),L.clearcoatNormalScale&&(L.clearcoatNormalScale.y*=-1)),this.cache.add(N,L),this.associations.set(L,this.associations.get(F))),F=L;q.material=F}getMaterialType(){return Y.MeshStandardMaterial}loadMaterial(q){const y=this,F=this.extensions,w=this.json.materials[q];let G;const N={},L=[];if((w.extensions||{})[ma.KHR_MATERIALS_UNLIT]){var ba=
F[ma.KHR_MATERIALS_UNLIT];G=ba.getMaterialType();L.push(ba.extendParams(N,w,y))}else{ba=w.pbrMetallicRoughness||{};N.color=new Y.Color(1,1,1);N.opacity=1;if(Array.isArray(ba.baseColorFactor)){const da=ba.baseColorFactor;N.color.setRGB(da[0],da[1],da[2],Y.LinearSRGBColorSpace);N.opacity=da[3]}void 0!==ba.baseColorTexture&&L.push(y.assignTexture(N,"map",ba.baseColorTexture,Y.SRGBColorSpace));N.metalness=void 0!==ba.metallicFactor?ba.metallicFactor:1;N.roughness=void 0!==ba.roughnessFactor?ba.roughnessFactor:
1;void 0!==ba.metallicRoughnessTexture&&(L.push(y.assignTexture(N,"metalnessMap",ba.metallicRoughnessTexture)),L.push(y.assignTexture(N,"roughnessMap",ba.metallicRoughnessTexture)));G=this._invokeOne(function(da){return da.getMaterialType&&da.getMaterialType(q)});L.push(Promise.all(this._invokeAll(function(da){return da.extendMaterialParams&&da.extendMaterialParams(q,N)})))}!0===w.doubleSided&&(N.side=Y.DoubleSide);ba=w.alphaMode||"OPAQUE";"BLEND"===ba?(N.transparent=!0,N.depthWrite=!1):(N.transparent=
!1,"MASK"===ba&&(N.alphaTest=void 0!==w.alphaCutoff?w.alphaCutoff:.5));void 0!==w.normalTexture&&G!==Y.MeshBasicMaterial&&(L.push(y.assignTexture(N,"normalMap",w.normalTexture)),N.normalScale=new Y.Vector2(1,1),void 0!==w.normalTexture.scale&&(ba=w.normalTexture.scale,N.normalScale.set(ba,ba)));void 0!==w.occlusionTexture&&G!==Y.MeshBasicMaterial&&(L.push(y.assignTexture(N,"aoMap",w.occlusionTexture)),void 0!==w.occlusionTexture.strength&&(N.aoMapIntensity=w.occlusionTexture.strength));void 0!==w.emissiveFactor&&
G!==Y.MeshBasicMaterial&&(ba=w.emissiveFactor,N.emissive=(new Y.Color).setRGB(ba[0],ba[1],ba[2],Y.LinearSRGBColorSpace));void 0!==w.emissiveTexture&&G!==Y.MeshBasicMaterial&&L.push(y.assignTexture(N,"emissiveMap",w.emissiveTexture,Y.SRGBColorSpace));return Promise.all(L).then(function(){const da=new G(N);w.name&&(da.name=w.name);ua(da,w);y.associations.set(da,{materials:q});w.extensions&&Ma(F,da,w);return da})}createUniqueName(q){q=Y.PropertyBinding.sanitizeNodeName(q||"");if(q in this.nodeNamesUsed)return q+
"_"+ ++this.nodeNamesUsed[q];this.nodeNamesUsed[q]=0;return q}loadGeometries(q){function y(ba){return w[ma.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ba,F).then(function(da){return Wb(da,ba,F)})}const F=this,w=this.extensions,G=this.primitiveCache,N=[];for(let ba=0,da=q.length;ba<da;ba++){const Da=q[ba],Oa=wa(Da);var L=G[Oa];L?N.push(L.promise):(L=Da.extensions&&Da.extensions[ma.KHR_DRACO_MESH_COMPRESSION]?y(Da):Wb(new Y.BufferGeometry,Da,F),G[Oa]={primitive:Da,promise:L},N.push(L))}return Promise.all(N)}loadMesh(q){const y=
this,F=this.extensions,w=this.json.meshes[q],G=w.primitives,N=[];for(let L=0,ba=G.length;L<ba;L++){const da=void 0===G[L].material?ib(this.cache):this.getDependency("material",G[L].material);N.push(da)}N.push(y.loadGeometries(G));return Promise.all(N).then(function(L){var ba=L.slice(0,L.length-1);const da=L[L.length-1];L=[];for(let hb=0,zb=da.length;hb<zb;hb++){var Da=da[hb];const xb=G[hb];var Oa=void 0;Oa=ba[hb];if(xb.mode===Sb.TRIANGLES||xb.mode===Sb.TRIANGLE_STRIP||xb.mode===Sb.TRIANGLE_FAN||void 0===
xb.mode)Oa=!0===w.isSkinnedMesh?new Y.SkinnedMesh(Da,Oa):new Y.Mesh(Da,Oa),!0===Oa.isSkinnedMesh&&Oa.normalizeSkinWeights(),xb.mode===Sb.TRIANGLE_STRIP?Oa.geometry=(0,Wa.toTrianglesDrawMode)(Oa.geometry,Y.TriangleStripDrawMode):xb.mode===Sb.TRIANGLE_FAN&&(Oa.geometry=(0,Wa.toTrianglesDrawMode)(Oa.geometry,Y.TriangleFanDrawMode));else if(xb.mode===Sb.LINES)Oa=new Y.LineSegments(Da,Oa);else if(xb.mode===Sb.LINE_STRIP)Oa=new Y.Line(Da,Oa);else if(xb.mode===Sb.LINE_LOOP)Oa=new Y.LineLoop(Da,Oa);else if(xb.mode===
Sb.POINTS)Oa=new Y.Points(Da,Oa);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+xb.mode);if(0<Object.keys(Oa.geometry.morphAttributes).length){Da=Oa;Da.updateMorphTargets();if(void 0!==w.weights)for(let sb=0,hc=w.weights.length;sb<hc;sb++)Da.morphTargetInfluences[sb]=w.weights[sb];if(w.extras&&Array.isArray(w.extras.targetNames)){const sb=w.extras.targetNames;if(Da.morphTargetInfluences.length===sb.length){Da.morphTargetDictionary={};for(let hc=0,Pc=sb.length;hc<Pc;hc++)Da.morphTargetDictionary[sb[hc]]=
hc}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}Oa.name=y.createUniqueName(w.name||"mesh_"+q);ua(Oa,w);xb.extensions&&Ma(F,Oa,xb);y.assignFinalMaterial(Oa);L.push(Oa)}for(let hb=0,zb=L.length;hb<zb;hb++)y.associations.set(L[hb],{meshes:q,primitives:hb});if(1===L.length)return w.extensions&&Ma(F,L[0],w),L[0];ba=new Y.Group;w.extensions&&Ma(F,ba,w);y.associations.set(ba,{meshes:q});for(let hb=0,zb=L.length;hb<zb;hb++)ba.add(L[hb]);return ba})}loadCamera(q){let y;
q=this.json.cameras[q];const F=q[q.type];if(F)return"perspective"===q.type?y=new Y.PerspectiveCamera(Y.MathUtils.radToDeg(F.yfov),F.aspectRatio||1,F.znear||1,F.zfar||2E6):"orthographic"===q.type&&(y=new Y.OrthographicCamera(-F.xmag,F.xmag,F.ymag,-F.ymag,F.znear,F.zfar)),q.name&&(y.name=this.createUniqueName(q.name)),ua(y,q),Promise.resolve(y);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(q){const y=this.json.skins[q];q=[];for(let F=0,w=y.joints.length;F<w;F++)q.push(this._loadNodeShallow(y.joints[F]));
void 0!==y.inverseBindMatrices?q.push(this.getDependency("accessor",y.inverseBindMatrices)):q.push(null);return Promise.all(q).then(function(F){const w=F.pop(),G=[],N=[];for(let ba=0,da=F.length;ba<da;ba++){var L=F[ba];L?(G.push(L),L=new Y.Matrix4,null!==w&&L.fromArray(w.array,16*ba),N.push(L)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',y.joints[ba])}return new Y.Skeleton(G,N)})}loadAnimation(q){const y=this,F=this.json.animations[q],w=F.name?F.name:"animation_"+q;q=[];const G=
[],N=[],L=[],ba=[];for(let Da=0,Oa=F.channels.length;Da<Oa;Da++){var da=F.channels[Da];const hb=F.samplers[da.sampler];da=da.target;const zb=void 0!==F.parameters?F.parameters[hb.input]:hb.input,xb=void 0!==F.parameters?F.parameters[hb.output]:hb.output;void 0!==da.node&&(q.push(this.getDependency("node",da.node)),G.push(this.getDependency("accessor",zb)),N.push(this.getDependency("accessor",xb)),L.push(hb),ba.push(da))}return Promise.all([Promise.all(q),Promise.all(G),Promise.all(N),Promise.all(L),
Promise.all(ba)]).then(function(Da){const Oa=Da[0],hb=Da[1],zb=Da[2],xb=Da[3];Da=Da[4];const sb=[];for(let Ic=0,og=Oa.length;Ic<og;Ic++){var hc=Oa[Ic],Pc=hb[Ic];const pg=zb[Ic],qg=xb[Ic],rg=Da[Ic];if(void 0!==hc&&(hc.updateMatrix&&hc.updateMatrix(),hc=y._createAnimationTracks(hc,Pc,pg,qg,rg)))for(Pc=0;Pc<hc.length;Pc++)sb.push(hc[Pc])}return new Y.AnimationClip(w,void 0,sb)})}createNodeMesh(q){const y=this,F=this.json.nodes[q];return void 0===F.mesh?null:y.getDependency("mesh",F.mesh).then(function(w){w=
y._getNodeRef(y.meshCache,F.mesh,w);void 0!==F.weights&&w.traverse(function(G){if(G.isMesh)for(let N=0,L=F.weights.length;N<L;N++)G.morphTargetInfluences[N]=F.weights[N]});return w})}loadNode(q){var y=this.json.nodes[q];q=this._loadNodeShallow(q);const F=[],w=y.children||[];for(let G=0,N=w.length;G<N;G++)F.push(this.getDependency("node",w[G]));y=void 0===y.skin?Promise.resolve(null):this.getDependency("skin",y.skin);return Promise.all([q,Promise.all(F),y]).then(function(G){const N=G[0],L=G[1],ba=
G[2];null!==ba&&N.traverse(function(da){da.isSkinnedMesh&&da.bind(ba,Bb)});for(let da=0,Da=L.length;da<Da;da++)N.add(L[da]);return N})}_loadNodeShallow(q){const y=this.extensions,F=this;if(void 0!==this.nodeCache[q])return this.nodeCache[q];const w=this.json.nodes[q],G=w.name?F.createUniqueName(w.name):"",N=[],L=F._invokeOne(function(ba){return ba.createNodeMesh&&ba.createNodeMesh(q)});L&&N.push(L);void 0!==w.camera&&N.push(F.getDependency("camera",w.camera).then(function(ba){return F._getNodeRef(F.cameraCache,
w.camera,ba)}));F._invokeAll(function(ba){return ba.createNodeAttachment&&ba.createNodeAttachment(q)}).forEach(function(ba){N.push(ba)});this.nodeCache[q]=Promise.all(N).then(function(ba){let da;da=!0===w.isBone?new Y.Bone:1<ba.length?new Y.Group:1===ba.length?ba[0]:new Y.Object3D;if(da!==ba[0])for(let Da=0,Oa=ba.length;Da<Oa;Da++)da.add(ba[Da]);w.name&&(da.userData.name=w.name,da.name=G);ua(da,w);w.extensions&&Ma(y,da,w);void 0!==w.matrix?(ba=new Y.Matrix4,ba.fromArray(w.matrix),da.applyMatrix4(ba)):
(void 0!==w.translation&&da.position.fromArray(w.translation),void 0!==w.rotation&&da.quaternion.fromArray(w.rotation),void 0!==w.scale&&da.scale.fromArray(w.scale));F.associations.has(da)||F.associations.set(da,{});F.associations.get(da).nodes=q;return da});return this.nodeCache[q]}loadScene(q){var y=this.extensions;q=this.json.scenes[q];const F=this,w=new Y.Group;q.name&&(w.name=F.createUniqueName(q.name));ua(w,q);q.extensions&&Ma(y,w,q);y=q.nodes||[];q=[];for(let G=0,N=y.length;G<N;G++)q.push(F.getDependency("node",
y[G]));return Promise.all(q).then(function(G){for(let N=0,L=G.length;N<L;N++)w.add(G[N]);F.associations=(N=>{const L=new Map;for(const [ba,da]of F.associations)(ba instanceof Y.Material||ba instanceof Y.Texture)&&L.set(ba,da);N.traverse(ba=>{const da=F.associations.get(ba);null!=da&&L.set(ba,da)});return L})(w);return w})}_createAnimationTracks(q,y,F,w,G){const N=[];var L=q.name?q.name:q.uuid;const ba=[];ic[G.path]===ic.weights?q.traverse(function(da){da.morphTargetInfluences&&ba.push(da.name?da.name:
da.uuid)}):ba.push(L);switch(ic[G.path]){case ic.weights:q=Y.NumberKeyframeTrack;break;case ic.rotation:q=Y.QuaternionKeyframeTrack;break;case ic.position:case ic.scale:q=Y.VectorKeyframeTrack;break;default:switch(F.itemSize){case 1:q=Y.NumberKeyframeTrack;break;default:q=Y.VectorKeyframeTrack}}L=void 0!==w.interpolation?Bc[w.interpolation]:Y.InterpolateLinear;F=this._getArrayFromAccessor(F);for(let da=0,Da=ba.length;da<Da;da++){const Oa=new q(ba[da]+"."+ic[G.path],y.array,F,L);"CUBICSPLINE"===w.interpolation&&
this._createCubicSplineTrackInterpolant(Oa);N.push(Oa)}return N}_getArrayFromAccessor(q){let y=q.array;if(q.normalized){q=Qa(y.constructor);const F=new Float32Array(y.length);for(let w=0,G=y.length;w<G;w++)F[w]=y[w]*q;y=F}return y}_createCubicSplineTrackInterpolant(q){q.createInterpolant=function(y){return new (this instanceof Y.QuaternionKeyframeTrack?Hb:Zb)(this.times,this.values,this.getValueSize()/3,y)};q.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}};
shadow$provide[15]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},RGBELoader:{enumerable:!0,get:function(){return ib}}});var pa=qb(0);class ib extends pa.DataTextureLoader{constructor(Ma){super(Ma);this.type=pa.HalfFloatType}parse(Ma){const ua=function(Na,ma){switch(Na){case 1:throw Error("THREE.RGBELoader: Read Error: "+(ma||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(ma||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(ma||""));default:case 4:throw Error("THREE.RGBELoader: Memory Error: "+
(ma||""));}},Ua=function(Na,ma,Q){ma=ma?ma:1024;let S=Na.pos,Z,P=0,V="",ha=String.fromCharCode.apply(null,new Uint16Array(Na.subarray(S,S+128)));for(;0>(Z=ha.indexOf("\n"))&&P<ma&&S<Na.byteLength;)V+=ha,P+=ha.length,S+=128,ha+=String.fromCharCode.apply(null,new Uint16Array(Na.subarray(S,S+128)));return-1<Z?(!1!==Q&&(Na.pos+=P+Z+1),V+ha.slice(0,Z)):!1};var wa=function(Na,ma,Q,S){const Z=Math.pow(2,Na[ma+3]-128)/255;Q[S+0]=Na[ma+0]*Z;Q[S+1]=Na[ma+1]*Z;Q[S+2]=Na[ma+2]*Z;Q[S+3]=1},qa=function(Na,ma,Q,
S){const Z=Math.pow(2,Na[ma+3]-128)/255;Q[S+0]=pa.DataUtils.toHalfFloat(Math.min(Na[ma+0]*Z,65504));Q[S+1]=pa.DataUtils.toHalfFloat(Math.min(Na[ma+1]*Z,65504));Q[S+2]=pa.DataUtils.toHalfFloat(Math.min(Na[ma+2]*Z,65504));Q[S+3]=pa.DataUtils.toHalfFloat(1)},Qa=new Uint8Array(Ma);Qa.pos=0;Ma=function(Na){const ma=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,Q=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,S=/^\s*FORMAT=(\S+)\s*$/,Z=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,P={valid:0,string:"",comments:"",programtype:"RGBE",
format:"",gamma:1,exposure:1,width:0,height:0};let V,ha;(Na.pos>=Na.byteLength||!(V=Ua(Na)))&&ua(1,"no header found");(ha=V.match(/^#\?(\S+)/))||ua(3,"bad initial token");P.valid|=1;P.programtype=ha[1];for(P.string+=V+"\n";;){V=Ua(Na);if(!1===V)break;P.string+=V+"\n";if("#"===V.charAt(0))P.comments+=V+"\n";else{if(ha=V.match(ma))P.gamma=parseFloat(ha[1]);if(ha=V.match(Q))P.exposure=parseFloat(ha[1]);if(ha=V.match(S))P.valid|=2,P.format=ha[1];if(ha=V.match(Z))P.valid|=4,P.height=parseInt(ha[1],10),
P.width=parseInt(ha[2],10);if(P.valid&2&&P.valid&4)break}}P.valid&2||ua(3,"missing format specifier");P.valid&4||ua(3,"missing image size specifier");return P}(Qa);const Tb=Ma.width,Wb=Ma.height;Qa=function(Na,ma,Q){if(8>ma||32767<ma||2!==Na[0]||2!==Na[1]||Na[2]&128)return new Uint8Array(Na);ma!==(Na[2]<<8|Na[3])&&ua(3,"wrong scanline width");const S=new Uint8Array(4*ma*Q);S.length||ua(4,"unable to allocate buffer space");let Z=0,P=0;const V=4*ma,ha=new Uint8Array(4),Aa=new Uint8Array(V);for(;0<Q&&
P<Na.byteLength;){P+4>Na.byteLength&&ua(1);ha[0]=Na[P++];ha[1]=Na[P++];ha[2]=Na[P++];ha[3]=Na[P++];2==ha[0]&&2==ha[1]&&(ha[2]<<8|ha[3])==ma||ua(3,"bad rgbe scanline format");for(var Ca=0,ya=void 0;Ca<V&&P<Na.byteLength;){ya=Na[P++];var La=128<ya;La&&(ya-=128);(0===ya||Ca+ya>V)&&ua(3,"bad scanline data");if(La){La=Na[P++];for(let Za=0;Za<ya;Za++)Aa[Ca++]=La}else Aa.set(Na.subarray(P,P+ya),Ca),Ca+=ya,P+=ya}Ca=ma;for(ya=0;ya<Ca;ya++)La=0,S[Z]=Aa[ya+La],La+=ma,S[Z+1]=Aa[ya+La],La+=ma,S[Z+2]=Aa[ya+La],
La+=ma,S[Z+3]=Aa[ya+La],Z+=4;Q--}return S}(Qa.subarray(Qa.pos),Tb,Wb);let Y;switch(this.type){case pa.FloatType:Y=Qa.length/4;qa=new Float32Array(4*Y);for(var Wa=0;Wa<Y;Wa++)wa(Qa,4*Wa,qa,4*Wa);wa=qa;qa=pa.FloatType;break;case pa.HalfFloatType:Y=Qa.length/4;wa=new Uint16Array(4*Y);for(Wa=0;Wa<Y;Wa++)qa(Qa,4*Wa,wa,4*Wa);qa=pa.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type);}return{width:Tb,height:Wb,data:wa,header:Ma.string,gamma:Ma.gamma,exposure:Ma.exposure,
type:qa}}setDataType(Ma){this.type=Ma;return this}load(Ma,ua,Ua,wa){return super.load(Ma,function(qa,Qa){switch(qa.type){case pa.FloatType:case pa.HalfFloatType:qa.colorSpace=pa.LinearSRGBColorSpace,qa.minFilter=pa.LinearFilter,qa.magFilter=pa.LinearFilter,qa.generateMipmaps=!1,qa.flipY=!0}ua&&ua(qa,Qa)},Ua,wa)}}};
shadow$provide[16]=function(ac,qb,nc,r){Object.defineProperties(r,{__esModule:{enumerable:!0,value:!0},Water:{enumerable:!0,get:function(){return ib}}});var pa=qb(0);class ib extends pa.Mesh{constructor(Ma,ua={}){super(Ma);this.isWater=!0;const Ua=this;var wa=void 0!==ua.textureWidth?ua.textureWidth:512;const qa=void 0!==ua.textureHeight?ua.textureHeight:512,Qa=void 0!==ua.clipBias?ua.clipBias:0;Ma=void 0!==ua.alpha?ua.alpha:1;const Tb=void 0!==ua.time?ua.time:0,Wb=void 0!==ua.waterNormals?ua.waterNormals:
null,Y=void 0!==ua.sunDirection?ua.sunDirection:new pa.Vector3(.70707,.70707,0),Wa=new pa.Color(void 0!==ua.sunColor?ua.sunColor:16777215),Na=new pa.Color(void 0!==ua.waterColor?ua.waterColor:8355711),ma=void 0!==ua.eye?ua.eye:new pa.Vector3(0,0,0),Q=void 0!==ua.distortionScale?ua.distortionScale:20;var S=void 0!==ua.side?ua.side:pa.FrontSide;ua=void 0!==ua.fog?ua.fog:!1;const Z=new pa.Plane,P=new pa.Vector3,V=new pa.Vector3,ha=new pa.Vector3,Aa=new pa.Matrix4,Ca=new pa.Vector3(0,0,-1),ya=new pa.Vector4,
La=new pa.Vector3,Za=new pa.Vector3,Ja=new pa.Vector4,va=new pa.Matrix4,za=new pa.PerspectiveCamera,Va=new pa.WebGLRenderTarget(wa,qa);wa=pa.UniformsUtils.merge([pa.UniformsLib.fog,pa.UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new pa.Matrix4},sunColor:{value:new pa.Color(8355711)},sunDirection:{value:new pa.Vector3(.70707,.70707,0)},eye:{value:new pa.Vector3},waterColor:{value:new pa.Color(5592405)}}]);
S=new pa.ShaderMaterial({name:"MirrorShader",uniforms:pa.UniformsUtils.clone(wa),vertexShader:"\n\t\t\t\tuniform mat4 textureMatrix;\n\t\t\t\tuniform float time;\n\n\t\t\t\tvarying vec4 mirrorCoord;\n\t\t\t\tvarying vec4 worldPosition;\n\n\t\t\t\t#include \x3ccommon\x3e\n\t\t\t\t#include \x3cfog_pars_vertex\x3e\n\t\t\t\t#include \x3cshadowmap_pars_vertex\x3e\n\t\t\t\t#include \x3clogdepthbuf_pars_vertex\x3e\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tmirrorCoord \x3d modelMatrix * vec4( position, 1.0 );\n\t\t\t\t\tworldPosition \x3d mirrorCoord.xyzw;\n\t\t\t\t\tmirrorCoord \x3d textureMatrix * mirrorCoord;\n\t\t\t\t\tvec4 mvPosition \x3d  modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\tgl_Position \x3d projectionMatrix * mvPosition;\n\n\t\t\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t\t\t#include \x3cdefaultnormal_vertex\x3e\n\t\t\t\t#include \x3clogdepthbuf_vertex\x3e\n\t\t\t\t#include \x3cfog_vertex\x3e\n\t\t\t\t#include \x3cshadowmap_vertex\x3e\n\t\t\t}",
fragmentShader:"\n\t\t\t\tuniform sampler2D mirrorSampler;\n\t\t\t\tuniform float alpha;\n\t\t\t\tuniform float time;\n\t\t\t\tuniform float size;\n\t\t\t\tuniform float distortionScale;\n\t\t\t\tuniform sampler2D normalSampler;\n\t\t\t\tuniform vec3 sunColor;\n\t\t\t\tuniform vec3 sunDirection;\n\t\t\t\tuniform vec3 eye;\n\t\t\t\tuniform vec3 waterColor;\n\n\t\t\t\tvarying vec4 mirrorCoord;\n\t\t\t\tvarying vec4 worldPosition;\n\n\t\t\t\tvec4 getNoise( vec2 uv ) {\n\t\t\t\t\tvec2 uv0 \x3d ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n\t\t\t\t\tvec2 uv1 \x3d uv / 107.0-vec2( time / -19.0, time / 31.0 );\n\t\t\t\t\tvec2 uv2 \x3d uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n\t\t\t\t\tvec2 uv3 \x3d uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n\t\t\t\t\tvec4 noise \x3d texture2D( normalSampler, uv0 ) +\n\t\t\t\t\t\ttexture2D( normalSampler, uv1 ) +\n\t\t\t\t\t\ttexture2D( normalSampler, uv2 ) +\n\t\t\t\t\t\ttexture2D( normalSampler, uv3 );\n\t\t\t\t\treturn noise * 0.5 - 1.0;\n\t\t\t\t}\n\n\t\t\t\tvoid sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n\t\t\t\t\tvec3 reflection \x3d normalize( reflect( -sunDirection, surfaceNormal ) );\n\t\t\t\t\tfloat direction \x3d max( 0.0, dot( eyeDirection, reflection ) );\n\t\t\t\t\tspecularColor +\x3d pow( direction, shiny ) * sunColor * spec;\n\t\t\t\t\tdiffuseColor +\x3d max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n\t\t\t\t}\n\n\t\t\t\t#include \x3ccommon\x3e\n\t\t\t\t#include \x3cpacking\x3e\n\t\t\t\t#include \x3cbsdfs\x3e\n\t\t\t\t#include \x3cfog_pars_fragment\x3e\n\t\t\t\t#include \x3clogdepthbuf_pars_fragment\x3e\n\t\t\t\t#include \x3clights_pars_begin\x3e\n\t\t\t\t#include \x3cshadowmap_pars_fragment\x3e\n\t\t\t\t#include \x3cshadowmask_pars_fragment\x3e\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include \x3clogdepthbuf_fragment\x3e\n\t\t\t\t\tvec4 noise \x3d getNoise( worldPosition.xz * size );\n\t\t\t\t\tvec3 surfaceNormal \x3d normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n\t\t\t\t\tvec3 diffuseLight \x3d vec3(0.0);\n\t\t\t\t\tvec3 specularLight \x3d vec3(0.0);\n\n\t\t\t\t\tvec3 worldToEye \x3d eye-worldPosition.xyz;\n\t\t\t\t\tvec3 eyeDirection \x3d normalize( worldToEye );\n\t\t\t\t\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n\t\t\t\t\tfloat distance \x3d length(worldToEye);\n\n\t\t\t\t\tvec2 distortion \x3d surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\n\t\t\t\t\tvec3 reflectionSample \x3d vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );\n\n\t\t\t\t\tfloat theta \x3d max( dot( eyeDirection, surfaceNormal ), 0.0 );\n\t\t\t\t\tfloat rf0 \x3d 0.3;\n\t\t\t\t\tfloat reflectance \x3d rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n\t\t\t\t\tvec3 scatter \x3d max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n\t\t\t\t\tvec3 albedo \x3d mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);\n\t\t\t\t\tvec3 outgoingLight \x3d albedo;\n\t\t\t\t\tgl_FragColor \x3d vec4( outgoingLight, alpha );\n\n\t\t\t\t\t#include \x3ctonemapping_fragment\x3e\n\t\t\t\t\t#include \x3ccolorspace_fragment\x3e\n\t\t\t\t\t#include \x3cfog_fragment\x3e\t\n\t\t\t\t}",
lights:!0,side:S,fog:ua});S.uniforms.mirrorSampler.value=Va.texture;S.uniforms.textureMatrix.value=va;S.uniforms.alpha.value=Ma;S.uniforms.time.value=Tb;S.uniforms.normalSampler.value=Wb;S.uniforms.sunColor.value=Wa;S.uniforms.waterColor.value=Na;S.uniforms.sunDirection.value=Y;S.uniforms.distortionScale.value=Q;S.uniforms.eye.value=ma;Ua.material=S;Ua.onBeforeRender=function(jb,kb,wb){V.setFromMatrixPosition(Ua.matrixWorld);ha.setFromMatrixPosition(wb.matrixWorld);Aa.extractRotation(Ua.matrixWorld);
P.set(0,0,1);P.applyMatrix4(Aa);La.subVectors(V,ha);if(!(0<La.dot(P))){La.reflect(P).negate();La.add(V);Aa.extractRotation(wb.matrixWorld);Ca.set(0,0,-1);Ca.applyMatrix4(Aa);Ca.add(ha);Za.subVectors(V,Ca);Za.reflect(P).negate();Za.add(V);za.position.copy(La);za.up.set(0,1,0);za.up.applyMatrix4(Aa);za.up.reflect(P);za.lookAt(Za);za.far=wb.far;za.updateMatrixWorld();za.projectionMatrix.copy(wb.projectionMatrix);va.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);va.multiply(za.projectionMatrix);va.multiply(za.matrixWorldInverse);
Z.setFromNormalAndCoplanarPoint(P,V);Z.applyMatrix4(za.matrixWorldInverse);ya.set(Z.normal.x,Z.normal.y,Z.normal.z,Z.constant);var fb=za.projectionMatrix;Ja.x=(Math.sign(ya.x)+fb.elements[8])/fb.elements[0];Ja.y=(Math.sign(ya.y)+fb.elements[9])/fb.elements[5];Ja.z=-1;Ja.w=(1+fb.elements[10])/fb.elements[14];ya.multiplyScalar(2/ya.dot(Ja));fb.elements[2]=ya.x;fb.elements[6]=ya.y;fb.elements[10]=ya.z+1-Qa;fb.elements[14]=ya.w;ma.setFromMatrixPosition(wb.matrixWorld);fb=jb.getRenderTarget();var ub=jb.xr.enabled,
vb=jb.shadowMap.autoUpdate;Ua.visible=!1;jb.xr.enabled=!1;jb.shadowMap.autoUpdate=!1;jb.setRenderTarget(Va);jb.state.buffers.depth.setMask(!0);!1===jb.autoClear&&jb.clear();jb.render(kb,za);Ua.visible=!0;jb.xr.enabled=ub;jb.shadowMap.autoUpdate=vb;jb.setRenderTarget(fb);kb=wb.viewport;void 0!==kb&&jb.state.viewport(kb)}}}}};
'use strict';var h;/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var aa=this||self;function u(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function ba(a){return Object.prototype.hasOwnProperty.call(a,ca)&&a[ca]||(a[ca]=++ea)}var ca="closure_uid_"+(1E9*Math.random()>>>0),ea=0;function fa(a,b,c){return a.call.apply(a.bind,arguments)}
function ha(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ia(a,b,c){ia=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fa:ha;return ia.apply(null,arguments)};function ja(a){return/^[\s\xa0]*$/.test(a)};function ka(a){const b=[];let c=0;for(const d in a)b[c++]=d;return b};function la(){var a=aa.navigator;return a&&(a=a.userAgent)?a:""}function ma(a){return-1!=la().indexOf(a)};function oa(a,b){a.sort(b||pa)}function qa(a,b){const c=Array(a.length);for(let e=0;e<a.length;e++)c[e]={index:e,value:a[e]};const d=b||pa;oa(c,function(e,f){return d(e.value,f.value)||e.index-f.index});for(b=0;b<a.length;b++)a[b]=c[b].value}function pa(a,b){return a>b?1:a<b?-1:0};function ra(a,b){null!=a&&this.append.apply(this,arguments)}h=ra.prototype;h.pb="";h.set=function(a){this.pb=""+a};h.append=function(a,b,c){this.pb+=String(a);if(null!=b)for(let d=1;d<arguments.length;d++)this.pb+=arguments[d];return this};h.clear=function(){this.pb=""};h.toString=function(){return this.pb};var v={},sa=null;function ta(){return new w(null,5,[ua,!0,va,!0,wa,!1,xa,!1,ya,null],null)}function x(a){return null!=a&&!1!==a}function za(a){return a instanceof Array}function Aa(a){return null==a?!0:!1===a?!0:!1}function Da(a){return"string"===u(a)}function y(a,b){return a[u(null==b?null:b)]?!0:a._?!0:!1}function A(a,b){var c=null==b?null:b.constructor;return Error(["No protocol method ",a," defined for type ",x(x(c)?c.kd:c)?c.Ac:u(b),": ",b].join(""))}
function Ea(a){var b=a.Ac;return x(b)?b:B.j(a)}var Fa="undefined"!==typeof Symbol&&"function"===u(Symbol)?Symbol.iterator:"@@iterator",Ga={_RBRACE_:"}",_COLON_:":",_BANG_:"!",_QMARK_:"?",_BSLASH_:"\\\\",_SLASH_:"/",_PERCENT_:"%",_PLUS_:"+",_SHARP_:"#",_LBRACE_:"{",_BAR_:"|",_LBRACK_:"[",_EQ_:"\x3d",_:"-",_TILDE_:"~",_RBRACK_:"]",_GT_:"\x3e",_SINGLEQUOTE_:"'",_CIRCA_:"@",_AMPERSAND_:"\x26",_DOUBLEQUOTE_:'\\"',_CARET_:"^",_LT_:"\x3c",_STAR_:"*"},Ha=null;
function Ia(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function Ja(){}function Ka(){}function La(){}function Ma(a){if(null!=a&&null!=a.$)a=a.$(a);else{var b=Ma[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Ma._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("ICounted.-count",a);}return a}function Na(){}
function Oa(a){if(null!=a&&null!=a.fa)a=a.fa(a);else{var b=Oa[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Oa._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IEmptyableCollection.-empty",a);}return a}function Pa(){}function Qa(a,b){if(null!=a&&null!=a.ga)a=a.ga(a,b);else{var c=Qa[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Qa._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("ICollection.-conj",a);}return a}function Ta(){}
var Va=function(){function a(d,e,f){var g=Ua[u(null==d?null:d)];if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);g=Ua._;if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);throw A("IIndexed.-nth",d);}function b(d,e){var f=Ua[u(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=Ua._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw A("IIndexed.-nth",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.u=a;return c}(),Ua=function Ua(a){switch(arguments.length){case 2:return Ua.m(arguments[0],arguments[1]);case 3:return Ua.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Ua.m=function(a,b){return null!=a&&null!=a.W?a.W(a,b):Va(a,b)};Ua.u=function(a,b,c){return null!=a&&null!=a.ka?a.ka(a,b,c):Va(a,b,c)};Ua.M=3;
function Wa(a){if(null!=a&&null!=a.la)a=a.la(a);else{var b=Wa[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Wa._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("ISeq.-first",a);}return a}function Xa(a){if(null!=a&&null!=a.ma)a=a.ma(a);else{var b=Xa[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Xa._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("ISeq.-rest",a);}return a}function Ya(){}
function Za(a){if(null!=a&&null!=a.ha)a=a.ha(a);else{var b=Za[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Za._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("INext.-next",a);}return a}function $a(){}
var cb=function(){function a(d,e,f){var g=bb[u(null==d?null:d)];if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);g=bb._;if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);throw A("ILookup.-lookup",d);}function b(d,e){var f=bb[u(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=bb._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw A("ILookup.-lookup",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.u=a;return c}(),bb=function bb(a){switch(arguments.length){case 2:return bb.m(arguments[0],arguments[1]);case 3:return bb.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};bb.m=function(a,b){return null!=a&&null!=a.pa?a.pa(a,b):cb(a,b)};bb.u=function(a,b,c){return null!=a&&null!=a.X?a.X(a,b,c):cb(a,b,c)};bb.M=3;function db(){}
function eb(a,b){if(null!=a&&null!=a.Za)a=a.Za(a,b);else{var c=eb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=eb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IAssociative.-contains-key?",a);}return a}function fb(a,b,c){if(null!=a&&null!=a.Oa)a=a.Oa(a,b,c);else{var d=fb[u(null==a?null:a)];if(null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else if(d=fb._,null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else throw A("IAssociative.-assoc",a);}return a}
function gb(a,b){if(null!=a&&null!=a.lb)a=a.lb(a,b);else{var c=gb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=gb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IFind.-find",a);}return a}function hb(){}function ib(a,b){if(null!=a&&null!=a.hc)a=a.hc(a,b);else{var c=ib[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=ib._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IMap.-dissoc",a);}return a}
function jb(a){if(null!=a&&null!=a.uc)a=a.key;else{var b=jb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=jb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IMapEntry.-key",a);}return a}function kb(a){if(null!=a&&null!=a.vc)a=a.v;else{var b=kb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=kb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IMapEntry.-val",a);}return a}function lb(){}
function mb(a,b){if(null!=a&&null!=a.Kc)a=a.Kc(a,b);else{var c=mb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=mb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("ISet.-disjoin",a);}return a}function nb(a){if(null!=a&&null!=a.rb)a=a.rb(a);else{var b=nb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=nb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IStack.-peek",a);}return a}
function ob(a){if(null!=a&&null!=a.sb)a=a.sb(a);else{var b=ob[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=ob._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IStack.-pop",a);}return a}function pb(){}function C(a){if(null!=a&&null!=a.kb)a=a.kb(a);else{var b=C[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=C._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IDeref.-deref",a);}return a}function qb(){}
function rb(a){if(null!=a&&null!=a.P)a=a.P(a);else{var b=rb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=rb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IMeta.-meta",a);}return a}function sb(a,b){if(null!=a&&null!=a.R)a=a.R(a,b);else{var c=sb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=sb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IWithMeta.-with-meta",a);}return a}function ub(){}
var wb=function(){function a(d,e,f){var g=vb[u(null==d?null:d)];if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);g=vb._;if(null!=g)return g.u?g.u(d,e,f):g.call(null,d,e,f);throw A("IReduce.-reduce",d);}function b(d,e){var f=vb[u(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=vb._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw A("IReduce.-reduce",d);}var c=null;c=function(d,e,f){switch(arguments.length){case 2:return b.call(this,d,e);case 3:return a.call(this,d,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.m=b;c.u=a;return c}(),vb=function vb(a){switch(arguments.length){case 2:return vb.m(arguments[0],arguments[1]);case 3:return vb.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};vb.m=function(a,b){return null!=a&&null!=a.ia?a.ia(a,b):wb(a,b)};vb.u=function(a,b,c){return null!=a&&null!=a.ja?a.ja(a,b,c):wb(a,b,c)};vb.M=3;function xb(){}
function yb(a,b){if(null!=a&&null!=a.Mb)a=a.Mb(a,b,!0);else{var c=yb[u(null==a?null:a)];if(null!=c)a=c.u?c.u(a,b,!0):c.call(null,a,b,!0);else if(c=yb._,null!=c)a=c.u?c.u(a,b,!0):c.call(null,a,b,!0);else throw A("IKVReduce.-kv-reduce",a);}return a}function zb(a,b){if(null!=a&&null!=a.aa)a=a.aa(a,b);else{var c=zb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=zb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IEquiv.-equiv",a);}return a}
function Ab(a){if(null!=a&&null!=a.ba)a=a.ba(a);else{var b=Ab[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Ab._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IHash.-hash",a);}return a}function Eb(){}function Fb(a){if(null!=a&&null!=a.Y)a=a.Y(a);else{var b=Fb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Fb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("ISeqable.-seq",a);}return a}function Gb(){}function Hb(){}function Ib(){}
function Jb(a,b){if(null!=a&&null!=a.Lc)a=a.Lc(a,b);else{var c=Jb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Jb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IWriter.-write",a);}return a}function Kb(){}function Lb(a,b,c){if(null!=a&&null!=a.V)a=a.V(a,b,c);else{var d=Lb[u(null==a?null:a)];if(null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else if(d=Lb._,null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else throw A("IPrintWithWriter.-pr-writer",a);}return a}
function Mb(a){if(null!=a&&null!=a.Ab)a=a.Ab(a);else{var b=Mb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Mb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IEditableCollection.-as-transient",a);}return a}function Nb(a,b){if(null!=a&&null!=a.Cb)a=a.Cb(a,b);else{var c=Nb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Nb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("ITransientCollection.-conj!",a);}return a}
function Ob(a){if(null!=a&&null!=a.Rb)a=a.Rb(a);else{var b=Ob[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Ob._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("ITransientCollection.-persistent!",a);}return a}function Pb(a,b,c){if(null!=a&&null!=a.Bb)a=a.Bb(a,b,c);else{var d=Pb[u(null==a?null:a)];if(null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else if(d=Pb._,null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else throw A("ITransientAssociative.-assoc!",a);}return a}
function Qb(){}function Rb(a,b){if(null!=a&&null!=a.$a)a=a.$a(a,b);else{var c=Rb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Rb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IComparable.-compare",a);}return a}function Sb(a){if(null!=a&&null!=a.tc)a=a.tc(a);else{var b=Sb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Sb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IChunk.-drop-first",a);}return a}
function Tb(a){if(null!=a&&null!=a.Kb)a=a.Kb(a);else{var b=Tb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Tb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IChunkedSeq.-chunked-first",a);}return a}function Ub(a){if(null!=a&&null!=a.jb)a=a.jb(a);else{var b=Ub[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Ub._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IChunkedSeq.-chunked-rest",a);}return a}
function Vb(a){if(null!=a&&null!=a.Nb)a=a.Nb(a);else{var b=Vb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Vb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("INamed.-name",a);}return a}function Wb(a){if(null!=a&&null!=a.Ob)a=a.Ob(a);else{var b=Wb[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Wb._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("INamed.-namespace",a);}return a}
function Zb(a,b){if(null!=a&&null!=a.bd)a=a.bd(a,b);else{var c=Zb[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Zb._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IReset.-reset!",a);}return a}
var ac=function(){function a(f,g,k,l,m){var n=$b[u(null==f?null:f)];if(null!=n)return n.U?n.U(f,g,k,l,m):n.call(null,f,g,k,l,m);n=$b._;if(null!=n)return n.U?n.U(f,g,k,l,m):n.call(null,f,g,k,l,m);throw A("ISwap.-swap!",f);}function b(f,g,k,l){var m=$b[u(null==f?null:f)];if(null!=m)return m.H?m.H(f,g,k,l):m.call(null,f,g,k,l);m=$b._;if(null!=m)return m.H?m.H(f,g,k,l):m.call(null,f,g,k,l);throw A("ISwap.-swap!",f);}function c(f,g,k){var l=$b[u(null==f?null:f)];if(null!=l)return l.u?l.u(f,g,k):l.call(null,
f,g,k);l=$b._;if(null!=l)return l.u?l.u(f,g,k):l.call(null,f,g,k);throw A("ISwap.-swap!",f);}function d(f,g){var k=$b[u(null==f?null:f)];if(null!=k)return k.m?k.m(f,g):k.call(null,f,g);k=$b._;if(null!=k)return k.m?k.m(f,g):k.call(null,f,g);throw A("ISwap.-swap!",f);}var e=null;e=function(f,g,k,l,m){switch(arguments.length){case 2:return d.call(this,f,g);case 3:return c.call(this,f,g,k);case 4:return b.call(this,f,g,k,l);case 5:return a.call(this,f,g,k,l,m)}throw Error("Invalid arity: "+arguments.length);
};e.m=d;e.u=c;e.H=b;e.U=a;return e}(),$b=function $b(a){switch(arguments.length){case 2:return $b.m(arguments[0],arguments[1]);case 3:return $b.u(arguments[0],arguments[1],arguments[2]);case 4:return $b.H(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return $b.U(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};$b.m=function(a,b){return null!=a&&null!=a.ed?a.ed(a,b):ac(a,b)};
$b.u=function(a,b,c){return null!=a&&null!=a.fd?a.fd(a,b,c):ac(a,b,c)};$b.H=function(a,b,c,d){return null!=a&&null!=a.gd?a.gd(a,b,c,d):ac(a,b,c,d)};$b.U=function(a,b,c,d,e){return null!=a&&null!=a.hd?a.hd(a,b,c,d,e):ac(a,b,c,d,e)};$b.M=5;function bc(a,b){if(null!=a&&null!=a.ic)a=a.ic(a,b);else{var c=bc[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=bc._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IVolatile.-vreset!",a);}return a}function cc(){}
function dc(a){if(null!=a&&null!=a.Ma)a=a.Ma(a);else{var b=dc[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=dc._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IIterable.-iterator",a);}return a}function ec(a,b){if(null!=a&&null!=a.ab)a=a.ab(a,b);else{var c=ec[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=ec._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("IDrop.-drop",a);}return a}function fc(a){this.Bd=a;this.A=1073741824;this.I=0}
fc.prototype.Lc=function(a,b){return this.Bd.append(b)};function gc(a){var b=new ra;a.V(null,new fc(b),ta());return B.j(b)}var hc="undefined"!==typeof Math&&"undefined"!==typeof Math.imul?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function ic(a){a=hc(a|0,-862048943);return hc(a<<15|a>>>-15,461845907)}function jc(a,b){a=(a|0)^(b|0);return hc(a<<13|a>>>-13,5)+-430675100|0}
function kc(a,b){a=(a|0)^b;a=hc(a^a>>>16,-2048144789);a=hc(a^a>>>13,-1028477387);return a^a>>>16}function lc(a){a:{var b=1;for(var c=0;;)if(b<a.length)c=jc(c,ic(a.charCodeAt(b-1)|a.charCodeAt(b)<<16)),b+=2;else{b=c;break a}}return kc(1===(a.length&1)?b^ic(a.charCodeAt(a.length-1)):b,hc(2,a.length))}var mc={},nc=0;
function oc(a){255<nc&&(mc={},nc=0);if(null==a)return 0;var b=mc[a];if("number"===typeof b)a=b;else{a:if(null!=a)if(b=a.length,0<b)for(var c=0,d=0;;)if(c<b)d=hc(31,d)+a.charCodeAt(c),c+=1;else{b=d;break a}else b=0;else b=0;mc[a]=b;nc+=1;a=b}return a}
function pc(a){if(null!=a&&(a.A&4194304||v===a.Id))return a.ba(null)^0;if("number"===typeof a){if(isFinite(a)){if(Number.isSafeInteger(a))a=Math.floor(a)%2147483647;else{var b=new Float64Array(1);b[0]=a;b=b.buffer;a=(new DataView(b,0,4)).getInt32();b=(new DataView(b,4,4)).getInt32();a^=b}return a}switch(a){case Infinity:return 2146435072;case -Infinity:return-1048576;default:return 2146959360}}else return!0===a?a=1231:!1===a?a=1237:"string"===typeof a?(a=oc(a),a=0===a?a:kc(jc(0,ic(a)),4)):a=a instanceof
Date?a.valueOf()^0:null==a?0:Ab(a)^0,a}function qc(a,b){return a^b+2654435769+(a<<6)+(a>>2)}function rc(a,b){if(a.Wa===b.Wa)return 0;var c=Aa(a.ua);if(x(c?b.ua:c))return-1;if(x(a.ua)){if(Aa(b.ua))return 1;c=pa(a.ua,b.ua);return 0===c?pa(a.name,b.name):c}return pa(a.name,b.name)}function E(a,b,c,d,e){this.ua=a;this.name=b;this.Wa=c;this.zb=d;this.Ua=e;this.A=2154168321;this.I=4096}h=E.prototype;h.toString=function(){return this.Wa};h.aa=function(a,b){return b instanceof E?this.Wa===b.Wa:!1};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return F?F(a,this):sc.call(null,a,this)};h.m=function(a,b){return tc?tc(a,this,b):sc.call(null,a,this,b)};h.P=function(){return this.Ua};h.R=function(a,b){return new E(this.ua,this.name,this.Wa,this.zb,b)};
h.ba=function(){var a=this.zb;return null!=a?a:this.zb=a=qc(lc(this.name),oc(this.ua))};h.Nb=function(){return this.name};h.Ob=function(){return this.ua};h.V=function(a,b){return Jb(b,this.Wa)};var uc=function uc(a){switch(arguments.length){case 1:return uc.j(arguments[0]);case 2:return uc.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};
uc.j=function(a){for(;;){if(a instanceof E)return a;if("string"===typeof a){var b=a.indexOf("/");return 1>b?uc.m(null,a):uc.m(a.substring(0,b),a.substring(b+1,a.length))}if(a instanceof G)a=a.ya;else throw Error("no conversion to symbol");}};uc.m=function(a,b){var c=null!=a?[B.j(a),"/",B.j(b)].join(""):b;return new E(a,b,c,null,null)};uc.M=2;function vc(a){return null!=a?a.I&131072||v===a.Jd?!0:a.I?!1:y(cc,a):y(cc,a)}
function H(a){if(null==a)return null;if(null!=a&&(a.A&8388608||v===a.cd))return a.Y(null);if(za(a)||"string"===typeof a)return 0===a.length?null:new K(a,0,null);if(null!=a&&null!=a[Fa])return a=(null!==a&&Fa in a?a[Fa]:void 0).call(a),wc.j?wc.j(a):wc.call(null,a);if(y(Eb,a))return Fb(a);throw Error([B.j(a)," is not ISeqable"].join(""));}function M(a){if(null==a)return null;if(null!=a&&(a.A&64||v===a.Qb))return a.la(null);a=H(a);return null==a?null:Wa(a)}
function xc(a){return null!=a?null!=a&&(a.A&64||v===a.Qb)?a.ma(null):(a=H(a))?a.ma(null):yc:yc}function N(a){return null==a?null:null!=a&&(a.A&128||v===a.Pb)?a.ha(null):H(xc(a))}var O=function O(a){switch(arguments.length){case 1:return O.j(arguments[0]);case 2:return O.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return O.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};O.j=function(){return!0};
O.m=function(a,b){return null==a?null==b:a===b||zb(a,b)};O.C=function(a,b,c){for(;;)if(O.m(a,b))if(N(c))a=b,b=M(c),c=N(c);else return O.m(b,M(c));else return!1};O.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};O.M=2;function zc(a){this.s=a}zc.prototype.next=function(){if(null!=this.s){var a=M(this.s);this.s=N(this.s);return{value:a,done:!1}}return{value:null,done:!0}};function Ac(a){return new zc(H(a))}
function Bc(a,b){this.value=a;this.Gb=b;this.rc=null;this.A=8388672;this.I=0}Bc.prototype.Y=function(){return this};Bc.prototype.la=function(){return this.value};Bc.prototype.ma=function(){null==this.rc&&(this.rc=wc.j?wc.j(this.Gb):wc.call(null,this.Gb));return this.rc};function wc(a){var b=a.next();return x(b.done)?null:new Bc(b.value,a)}function Fc(a){var b=0,c=1;for(a=H(a);;)if(null!=a)b+=1,c=hc(31,c)+pc(M(a))|0,a=N(a);else return kc(jc(0,ic(c)),b)}var Gc=kc(jc(0,ic(1)),0);
function Hc(a){var b=0,c=0;for(a=H(a);;)if(null!=a)b+=1,c=c+pc(M(a))|0,a=N(a);else return kc(jc(0,ic(c)),b)}var Ic=kc(jc(0,ic(0)),0);La["null"]=!0;Ma["null"]=function(){return 0};Date.prototype.aa=function(a,b){return b instanceof Date&&this.valueOf()===b.valueOf()};Date.prototype.qb=v;Date.prototype.$a=function(a,b){if(b instanceof Date)return pa(this.valueOf(),b.valueOf());throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};zb.number=function(a,b){return a===b};Ja["function"]=!0;
qb["function"]=!0;rb["function"]=function(){return null};Ab._=function(a){return ba(a)};function Jc(a){return a+1}function Kc(a){this.v=a;this.A=32768;this.I=0}Kc.prototype.kb=function(){return this.v};function Lc(a){return a instanceof Kc}function Mc(a){return Lc(a)?Nc.j?Nc.j(a):Nc.call(null,a):a}function Nc(a){return C(a)}
function Oc(a,b){var c=a.$(null);if(0===c)return b.G?b.G():b.call(null);for(var d=a.W(null,0),e=1;;)if(e<c){var f=a.W(null,e);d=b.m?b.m(d,f):b.call(null,d,f);if(Lc(d))return C(d);e+=1}else return d}function Pc(a,b,c){var d=a.$(null),e=c;for(c=0;;)if(c<d){var f=a.W(null,c);e=b.m?b.m(e,f):b.call(null,e,f);if(Lc(e))return C(e);c+=1}else return e}
function Qc(a,b){var c=a.length;if(0===a.length)return b.G?b.G():b.call(null);for(var d=a[0],e=1;;)if(e<c){var f=a[e];d=b.m?b.m(d,f):b.call(null,d,f);if(Lc(d))return C(d);e+=1}else return d}function Rc(a,b,c){var d=a.length,e=c;for(c=0;;)if(c<d){var f=a[c];e=b.m?b.m(e,f):b.call(null,e,f);if(Lc(e))return C(e);c+=1}else return e}function Sc(a,b,c,d){for(var e=a.length;;)if(d<e){var f=a[d];c=b.m?b.m(c,f):b.call(null,c,f);if(Lc(c))return C(c);d+=1}else return c}
function Tc(a){return null!=a?a.A&2||v===a.Ic?!0:a.A?!1:y(La,a):y(La,a)}function Uc(a){return null!=a?a.A&16||v===a.Jc?!0:a.A?!1:y(Ta,a):y(Ta,a)}function P(a,b,c){var d=R.j?R.j(a):R.call(null,a);if(c>=d)return-1;!(0<c)&&0>c&&(c+=d,c=0>c?0:c);for(;;)if(c<d){if(O.m(Vc?Vc(a,c):Wc.call(null,a,c),b))return c;c+=1}else return-1}
function S(a,b,c){var d=R.j?R.j(a):R.call(null,a);if(0===d)return-1;0<c?(--d,c=d<c?d:c):c=0>c?d+c:c;for(;;)if(0<=c){if(O.m(Vc?Vc(a,c):Wc.call(null,a,c),b))return c;--c}else return-1}function Xc(a,b){this.o=a;this.i=b}Xc.prototype.qa=function(){return this.i<this.o.length};Xc.prototype.next=function(){var a=this.o[this.i];this.i+=1;return a};function K(a,b,c){this.o=a;this.i=b;this.D=c;this.A=166592766;this.I=401408}h=K.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R.j?R.j(this):R.call(null,this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.W=function(a,b){a=b+this.i;if(0<=a&&a<this.o.length)return this.o[a];throw Error("Index out of bounds");};h.ka=function(a,b,c){a=b+this.i;return 0<=a&&a<this.o.length?this.o[a]:c};
h.Ma=function(){return new Xc(this.o,this.i)};h.P=function(){return this.D};h.ha=function(){return this.i+1<this.o.length?new K(this.o,this.i+1,null):null};h.$=function(){var a=this.o.length-this.i;return 0>a?0:a};h.ba=function(){return Fc(this)};h.aa=function(a,b){return Yc.m?Yc.m(this,b):Yc.call(null,this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Sc(this.o,b,this.o[this.i],this.i+1)};h.ja=function(a,b,c){return Sc(this.o,b,c,this.i)};h.la=function(){return this.o[this.i]};
h.ma=function(){return this.i+1<this.o.length?new K(this.o,this.i+1,null):yc};h.Y=function(){return this.i<this.o.length?this:null};h.R=function(a,b){return b===this.D?this:new K(this.o,this.i,b)};h.ga=function(a,b){return T.m?T.m(b,this):T.call(null,b,this)};h.ab=function(a,b){return 0<b?this.i+b<this.o.length?new K(this.o,this.i+b,null):null:this};K.prototype[Fa]=function(){return Ac(this)};function Zc(a){return 0<a.length?new K(a,0,null):null}function $c(a){return M(N(a))}
function ad(a){for(;;){var b=N(a);if(null!=b)a=b;else return M(a)}}zb._=function(a,b){return a===b};var bd=function bd(a){switch(arguments.length){case 0:return bd.G();case 1:return bd.j(arguments[0]);case 2:return bd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return bd.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};bd.G=function(){return dd};bd.j=function(a){return a};
bd.m=function(a,b){return null!=a?Qa(a,b):new ed(null,b,null,1,null)};bd.C=function(a,b,c){for(;;)if(x(c))a=bd.m(a,b),b=M(c),c=N(c);else return bd.m(a,b)};bd.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};bd.M=2;
function R(a){if(null!=a)if(null!=a&&(a.A&2||v===a.Ic))a=a.$(null);else if(za(a))a=a.length;else if("string"===typeof a)a=a.length;else if(null!=a&&(a.A&8388608||v===a.cd))a:{a=H(a);for(var b=0;;){if(Tc(a)){a=b+Ma(a);break a}a=N(a);b+=1}}else a=Ma(a);else a=0;return a}function fd(a,b,c){for(;;){if(null==a)return c;if(0===b)return H(a)?M(a):c;if(Uc(a))return Ua(a,b,c);if(H(a))a=N(a),--b;else return c}}
function Wc(a){switch(arguments.length){case 2:return Vc(arguments[0],arguments[1]);case 3:return U(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}
function Vc(a,b){if("number"!==typeof b)throw Error("Index argument to nth must be a number");if(null==a)return a;if(null!=a&&(a.A&16||v===a.Jc))return a.W(null,b);if(za(a)){if(-1<b&&b<a.length)return a[b|0];throw Error("Index out of bounds");}if("string"===typeof a){if(-1<b&&b<a.length)return a.charAt(b|0);throw Error("Index out of bounds");}if(null!=a&&(a.A&64||v===a.Qb)||null!=a&&(a.A&16777216||v===a.xc)){if(0>b)throw Error("Index out of bounds");a:for(;;){if(null==a)throw Error("Index out of bounds");
if(0===b){if(H(a)){a=M(a);break a}throw Error("Index out of bounds");}if(Uc(a)){a=Ua(a,b);break a}if(H(a))a=N(a),--b;else throw Error("Index out of bounds");}return a}if(y(Ta,a))return Ua(a,b);throw Error(["nth not supported on this type ",B.j(Ea(null==a?null:a.constructor))].join(""));}
function U(a,b,c){if("number"!==typeof b)throw Error("Index argument to nth must be a number.");if(null==a)return c;if(null!=a&&(a.A&16||v===a.Jc))return a.ka(null,b,c);if(za(a))return-1<b&&b<a.length?a[b|0]:c;if("string"===typeof a)return-1<b&&b<a.length?a.charAt(b|0):c;if(null!=a&&(a.A&64||v===a.Qb)||null!=a&&(a.A&16777216||v===a.xc))return 0>b?c:fd(a,b,c);if(y(Ta,a))return Ua(a,b,c);throw Error(["nth not supported on this type ",B.j(Ea(null==a?null:a.constructor))].join(""));}
function sc(a){switch(arguments.length){case 2:return F(arguments[0],arguments[1]);case 3:return tc(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}function F(a,b){return null==a?null:null!=a&&(a.A&256||v===a.Yc)?a.pa(null,b):za(a)?null!=b&&b<a.length?a[b|0]:null:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):null:y($a,a)?bb(a,b):null}
function tc(a,b,c){return null!=a?null!=a&&(a.A&256||v===a.Yc)?a.X(null,b,c):za(a)?null!=b&&-1<b&&b<a.length?a[b|0]:c:"string"===typeof a?null!=b&&-1<b&&b<a.length?a.charAt(b|0):c:y($a,a)?bb(a,b,c):c:c}var V=function V(a){switch(arguments.length){case 3:return V.u(arguments[0],arguments[1],arguments[2]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return V.C(arguments[0],arguments[1],arguments[2],3<c.length?new K(c.slice(3),0,null):null)}};
V.u=function(a,b,c){return null!=a&&(a.A&512||v===a.Sc)?a.Oa(null,b,c):null!=a?fb(a,b,c):gd([b,c])};V.C=function(a,b,c,d){for(;;)if(a=V.u(a,b,c),x(d))b=M(d),c=$c(d),d=N(N(d));else return a};V.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);d=N(d);return this.C(b,a,c,d)};V.M=3;
var hd=function hd(a){switch(arguments.length){case 1:return hd.j(arguments[0]);case 2:return hd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return hd.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};hd.j=function(a){return a};hd.m=function(a,b){return null==a?null:ib(a,b)};hd.C=function(a,b,c){for(;;){if(null==a)return null;a=hd.m(a,b);if(x(c))b=M(c),c=N(c);else return a}};
hd.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};hd.M=2;function id(a){var b="function"===typeof a;return b?b:null!=a?v===a.Rc?!0:a.Nc?!1:y(Ja,a):y(Ja,a)}function jd(a,b){this.J=a;this.D=b;this.A=393217;this.I=0}h=jd.prototype;h.P=function(){return this.D};h.R=function(a,b){return new jd(this.J,b)};h.Rc=v;
h.call=function(a){switch(arguments.length-1){case 0:return this.G();case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);case 3:return this.u(arguments[1],arguments[2],arguments[3]);case 4:return this.H(arguments[1],arguments[2],arguments[3],arguments[4]);case 5:return this.U(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 6:return this.oa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);case 7:return this.Ka(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);case 8:return this.wa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);case 9:return this.La(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);case 10:return this.za(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10]);
case 11:return this.Aa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]);case 12:return this.Ba(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12]);case 13:return this.Ca(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],
arguments[11],arguments[12],arguments[13]);case 14:return this.Da(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14]);case 15:return this.Ea(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]);case 16:return this.Fa(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16]);case 17:return this.Ga(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17]);case 18:return this.Ha(arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18]);case 19:return this.Ia(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19]);case 20:return this.Ja(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19],arguments[20]);case 21:return this.Lb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],
arguments[18],arguments[19],arguments[20],arguments[21]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.G=function(){return this.J.G?this.J.G():this.J.call(null)};h.j=function(a){return this.J.j?this.J.j(a):this.J.call(null,a)};h.m=function(a,b){return this.J.m?this.J.m(a,b):this.J.call(null,a,b)};h.u=function(a,b,c){return this.J.u?this.J.u(a,b,c):this.J.call(null,a,b,c)};
h.H=function(a,b,c,d){return this.J.H?this.J.H(a,b,c,d):this.J.call(null,a,b,c,d)};h.U=function(a,b,c,d,e){return this.J.U?this.J.U(a,b,c,d,e):this.J.call(null,a,b,c,d,e)};h.oa=function(a,b,c,d,e,f){return this.J.oa?this.J.oa(a,b,c,d,e,f):this.J.call(null,a,b,c,d,e,f)};h.Ka=function(a,b,c,d,e,f,g){return this.J.Ka?this.J.Ka(a,b,c,d,e,f,g):this.J.call(null,a,b,c,d,e,f,g)};h.wa=function(a,b,c,d,e,f,g,k){return this.J.wa?this.J.wa(a,b,c,d,e,f,g,k):this.J.call(null,a,b,c,d,e,f,g,k)};
h.La=function(a,b,c,d,e,f,g,k,l){return this.J.La?this.J.La(a,b,c,d,e,f,g,k,l):this.J.call(null,a,b,c,d,e,f,g,k,l)};h.za=function(a,b,c,d,e,f,g,k,l,m){return this.J.za?this.J.za(a,b,c,d,e,f,g,k,l,m):this.J.call(null,a,b,c,d,e,f,g,k,l,m)};h.Aa=function(a,b,c,d,e,f,g,k,l,m,n){return this.J.Aa?this.J.Aa(a,b,c,d,e,f,g,k,l,m,n):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n)};h.Ba=function(a,b,c,d,e,f,g,k,l,m,n,p){return this.J.Ba?this.J.Ba(a,b,c,d,e,f,g,k,l,m,n,p):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p)};
h.Ca=function(a,b,c,d,e,f,g,k,l,m,n,p,q){return this.J.Ca?this.J.Ca(a,b,c,d,e,f,g,k,l,m,n,p,q):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q)};h.Da=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r){return this.J.Da?this.J.Da(a,b,c,d,e,f,g,k,l,m,n,p,q,r):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r)};h.Ea=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t){return this.J.Ea?this.J.Ea(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t)};
h.Fa=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z){return this.J.Fa?this.J.Fa(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z)};h.Ga=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D){return this.J.Ga?this.J.Ga(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D)};h.Ha=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I){return this.J.Ha?this.J.Ha(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I)};
h.Ia=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J){return this.J.Ia?this.J.Ia(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J)};h.Ja=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q){return this.J.Ja?this.J.Ja(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q):this.J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q)};
h.Lb=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da){return kd.Lb?kd.Lb(this.J,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,new K([Q,da],0,null)):kd.call(null,this.J,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da)};function ld(a,b){return"function"===typeof a?new jd(a,b):null==a?null:sb(a,b)}function md(a){var b=null!=a;return(b?null!=a?a.A&131072||v===a.wc||(a.A?0:y(qb,a)):y(qb,a):b)?rb(a):null}
var nd=function nd(a){switch(arguments.length){case 1:return nd.j(arguments[0]);case 2:return nd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return nd.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};nd.j=function(a){return a};nd.m=function(a,b){return null==a?null:mb(a,b)};nd.C=function(a,b,c){for(;;){if(null==a)return null;a=nd.m(a,b);if(x(c))b=M(c),c=N(c);else return a}};
nd.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};nd.M=2;function od(a){return null==a?!0:(null!=a?a.A&2||v===a.Ic||(a.A?0:y(La,a)):y(La,a))?0===Ma(a):Aa(H(a))}function pd(a){return null==a?!1:null!=a?a.A&4096||v===a.dd?!0:a.A?!1:y(lb,a):y(lb,a)}function qd(a){return null!=a?a.A&16777216||v===a.xc?!0:a.A?!1:y(Gb,a):y(Gb,a)}function rd(a){return null==a?!1:null!=a?a.A&1024||v===a.Zc?!0:a.A?!1:y(hb,a):y(hb,a)}
function sd(a){return null!=a?a.A&67108864||v===a.Md?!0:a.A?!1:y(Ib,a):y(Ib,a)}function td(a){return null!=a?a.A&16384||v===a.Nd?!0:a.A?!1:y(pb,a):y(pb,a)}function ud(a){return null!=a?a.I&512||v===a.Ed?!0:!1:!1}function vd(a,b,c,d,e){for(;;){if(0===e)return c;c[d]=a[b];d+=1;--e;b+=1}}var wd={};function xd(a){return null==a?!1:!1===a?!1:!0}function yd(a){return"number"===typeof a&&!isNaN(a)&&Infinity!==a&&parseFloat(a)===parseInt(a,10)}
function zd(a,b){return null!=a&&(a.A&512||v===a.Sc)?a.Za(null,b):y(db,a)?eb(a,b):tc(a,b,wd)===wd?!1:!0}
function Ad(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if("number"===typeof a){if("number"===typeof b)return pa(a,b);throw Error(["Cannot compare ",B.j(a)," to ",B.j(b)].join(""));}if(null!=a?a.I&2048||v===a.qb||(a.I?0:y(Qb,a)):y(Qb,a))return Rb(a,b);if("string"!==typeof a&&!za(a)&&!0!==a&&!1!==a||(null==a?null:a.constructor)!==(null==b?null:b.constructor))throw Error(["Cannot compare ",B.j(a)," to ",B.j(b)].join(""));return pa(a,b)}
function Bd(a,b){var c=R(a),d=R(b);if(c<d)a=-1;else if(c>d)a=1;else if(0===c)a=0;else a:for(d=0;;){var e=Ad(Vc(a,d),Vc(b,d));if(0===e&&d+1<c)d+=1;else{a=e;break a}}return a}function Cd(a){return O.m(a,Ad)?Ad:function(b,c){var d=a.m?a.m(b,c):a.call(null,b,c);return"number"===typeof d?d:x(d)?-1:x(a.m?a.m(c,b):a.call(null,c,b))?1:0}}function Dd(a,b){if(H(b)){var c=Ed.j?Ed.j(b):Ed.call(null,b);qa(c,Cd(a));return ld(H(c),md(b))}return yc}
function Fd(a,b){var c=H(b);return c?(b=M(c),c=N(c),Gd?Gd(a,b,c):Jd.call(null,a,b,c)):a.G?a.G():a.call(null)}function Kd(a,b,c){for(c=H(c);;)if(c){var d=M(c);b=a.m?a.m(b,d):a.call(null,b,d);if(Lc(b))return C(b);c=N(c)}else return b}function Ld(a,b){a=dc(a);if(x(a.qa()))for(var c=a.next();;)if(a.qa()){var d=a.next();c=b.m?b.m(c,d):b.call(null,c,d);if(Lc(c))return C(c)}else return c;else return b.G?b.G():b.call(null)}
function Md(a,b,c){for(a=dc(a);;)if(a.qa()){var d=a.next();c=b.m?b.m(c,d):b.call(null,c,d);if(Lc(c))return C(c)}else return c}function Jd(a){switch(arguments.length){case 2:return Nd(arguments[0],arguments[1]);case 3:return Gd(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}function Nd(a,b){return null!=b&&(b.A&524288||v===b.ad)?b.ia(null,a):za(b)?Qc(b,a):"string"===typeof b?Qc(b,a):y(ub,b)?vb(b,a):vc(b)?Ld(b,a):Fd(a,b)}
function Gd(a,b,c){return null!=c&&(c.A&524288||v===c.ad)?c.ja(null,a,b):za(c)?Rc(c,a,b):"string"===typeof c?Rc(c,a,b):y(ub,c)?vb(c,a,b):vc(c)?Md(c,a,b):Kd(a,b,c)}function Od(a,b){return(null!=b?b.A&1048576||v===b.Xc||(b.A?0:y(xb,b)):y(xb,b))?yb(b,a):Gd(function(c,d){var e=jb(d);d=kb(d);return a.u?a.u(c,e,d):a.call(null,c,e,d)},!0,b)}function Pd(a){return a}function Qd(a,b,c,d){a=a.j?a.j(b):a.call(null,b);c=Gd(a,c,d);return a.j?a.j(c):a.call(null,c)}
var Rd=function Rd(a){switch(arguments.length){case 0:return Rd.G();case 1:return Rd.j(arguments[0]);case 2:return Rd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Rd.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Rd.G=function(){return 0};Rd.j=function(a){return a};Rd.m=function(a,b){return a+b};Rd.C=function(a,b,c){return Gd(Rd,a+b,c)};
Rd.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};Rd.M=2;var Sd=function Sd(a){switch(arguments.length){case 0:return Sd.G();case 1:return Sd.j(arguments[0]);case 2:return Sd.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Sd.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Sd.G=function(){return 1};Sd.j=function(a){return a};Sd.m=function(a,b){return a*b};
Sd.C=function(a,b,c){return Gd(Sd,a*b,c)};Sd.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};Sd.M=2;var Td=function Td(a){switch(arguments.length){case 1:return Td.j(arguments[0]);case 2:return Td.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Td.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Td.j=function(a){return a};Td.m=function(a,b){return a>b?a:b};
Td.C=function(a,b,c){return Gd(Td,a>b?a:b,c)};Td.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};Td.M=2;function Ud(a){a=(a-a%2)/2;return 0<=a?Math.floor(a):Math.ceil(a)}function Vd(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}
var B=function B(a){switch(arguments.length){case 0:return B.G();case 1:return B.j(arguments[0]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return B.C(arguments[0],1<c.length?new K(c.slice(1),0,null):null)}};B.G=function(){return""};B.j=function(a){return null==a?"":[a].join("")};B.C=function(a,b){for(a=new ra(B.j(a));;)if(x(b))a=a.append(B.j(M(b))),b=N(b);else return a.toString()};B.N=function(a){var b=M(a);a=N(a);return this.C(b,a)};B.M=1;
function Yc(a,b){if(qd(b))if(Tc(a)&&Tc(b)&&R(a)!==R(b))a=!1;else a:for(a=H(a),b=H(b);;){if(null==a){a=null==b;break a}if(null!=b&&O.m(M(a),M(b)))a=N(a),b=N(b);else{a=!1;break a}}else a=null;return xd(a)}function ed(a,b,c,d,e){this.D=a;this.first=b;this.ib=c;this.count=d;this.F=e;this.A=65937646;this.I=8192}h=ed.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,this.count)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){return 1===this.count?null:this.ib};h.$=function(){return this.count};h.rb=function(){return this.first};h.sb=function(){return this.ma(null)};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return sb(yc,this.D)};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return this.first};h.ma=function(){return 1===this.count?yc:this.ib};h.Y=function(){return this};h.R=function(a,b){return b===this.D?this:new ed(b,this.first,this.ib,this.count,this.F)};h.ga=function(a,b){return new ed(this.D,b,this,this.count+1,null)};
ed.prototype[Fa]=function(){return Ac(this)};function Wd(a){this.D=a;this.A=65937614;this.I=8192}h=Wd.prototype;h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){return null};h.$=function(){return 0};h.rb=function(){return null};h.sb=function(){throw Error("Can't pop empty list");};h.ba=function(){return Gc};
h.aa=function(a,b){return(null!=b?b.A&33554432||v===b.Kd||(b.A?0:y(Hb,b)):y(Hb,b))||qd(b)?null==H(b):!1};h.fa=function(){return this};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return null};h.ma=function(){return yc};h.Y=function(){return null};h.R=function(a,b){return b===this.D?this:new Wd(b)};h.ga=function(a,b){return new ed(this.D,b,null,1,null)};var yc=new Wd(null);Wd.prototype[Fa]=function(){return Ac(this)};
var W=function W(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return W.C(0<c.length?new K(c.slice(0),0,null):null)};W.C=function(a){if(a instanceof K&&0===a.i)var b=a.o;else a:for(b=[];;)if(null!=a)b.push(Wa(a)),a=Za(a);else break a;a=b.length;for(var c=yc;;)if(0<a){var d=a-1;c=Qa(c,b[a-1]);a=d}else return c};W.M=0;W.N=function(a){return this.C(H(a))};function Xd(a,b,c,d){this.D=a;this.first=b;this.ib=c;this.F=d;this.A=65929452;this.I=8192}h=Xd.prototype;
h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){return null==this.ib?null:H(this.ib)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};
h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return this.first};h.ma=function(){return null==this.ib?yc:this.ib};h.Y=function(){return this};h.R=function(a,b){return b===this.D?this:new Xd(b,this.first,this.ib,this.F)};h.ga=function(a,b){return new Xd(null,b,this,null)};Xd.prototype[Fa]=function(){return Ac(this)};function T(a,b){return null==b?new ed(null,a,null,1,null):null!=b&&(b.A&64||v===b.Qb)?new Xd(null,a,b,null):new Xd(null,a,H(b),null)}
function Yd(a,b){if(a.ya===b.ya)return 0;var c=Aa(a.ua);if(x(c?b.ua:c))return-1;if(x(a.ua)){if(Aa(b.ua))return 1;c=pa(a.ua,b.ua);return 0===c?pa(a.name,b.name):c}return pa(a.name,b.name)}function G(a,b,c,d){this.ua=a;this.name=b;this.ya=c;this.zb=d;this.A=2153775105;this.I=4096}h=G.prototype;h.toString=function(){return[":",B.j(this.ya)].join("")};h.aa=function(a,b){return b instanceof G?this.ya===b.ya:!1};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return F(a,this)};h.m=function(a,b){return tc(a,this,b)};h.ba=function(){var a=this.zb;return null!=a?a:this.zb=a=qc(lc(this.name),oc(this.ua))+2654435769|0};h.Nb=function(){return this.name};h.Ob=function(){return this.ua};
h.V=function(a,b){return Jb(b,[":",B.j(this.ya)].join(""))};function Zd(a,b){return a===b?!0:a instanceof G&&b instanceof G?a.ya===b.ya:!1}function $d(a){if(null!=a&&(a.I&4096||v===a.$c))return a.Ob(null);throw Error(["Doesn't support namespace: ",B.j(a)].join(""));}function ae(a){return a instanceof G||a instanceof E}
var be=function be(a){switch(arguments.length){case 1:return be.j(arguments[0]);case 2:return be.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};be.j=function(a){if(a instanceof G)return a;if(a instanceof E)return new G($d(a),ce.j?ce.j(a):ce.call(null,a),a.Wa,null);if(O.m("/",a))return new G(null,a,a,null);if("string"===typeof a){var b=a.split("/");return 2===b.length?new G(b[0],b[1],a,null):new G(null,b[0],a,null)}return null};
be.m=function(a,b){a=a instanceof G?ce.j?ce.j(a):ce.call(null,a):a instanceof E?ce.j?ce.j(a):ce.call(null,a):a;b=b instanceof G?ce.j?ce.j(b):ce.call(null,b):b instanceof E?ce.j?ce.j(b):ce.call(null,b):b;return new G(a,b,[x(a)?[B.j(a),"/"].join(""):null,B.j(b)].join(""),null)};be.M=2;function de(a,b,c){this.D=a;this.Wb=b;this.s=null;this.F=c;this.A=32374988;this.I=1}h=de.prototype;h.toString=function(){return gc(this)};
function ee(a){null!=a.Wb&&(a.s=a.Wb.G?a.Wb.G():a.Wb.call(null),a.Wb=null);return a.s}h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){this.Y(null);return null==this.s?null:N(this.s)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};
h.fa=function(){return sb(yc,this.D)};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){this.Y(null);return null==this.s?null:M(this.s)};h.ma=function(){this.Y(null);return null!=this.s?xc(this.s):yc};h.Y=function(){ee(this);if(null==this.s)return null;for(var a=this.s;;)if(a instanceof de)a=ee(a);else return this.s=a,H(this.s)};h.R=function(a,b){var c=this;return b===this.D?c:new de(b,function(){return c.Y(null)},this.F)};
h.ga=function(a,b){return T(b,this)};de.prototype[Fa]=function(){return Ac(this)};function ue(a){this.T=a;this.end=0;this.A=2;this.I=0}ue.prototype.add=function(a){this.T[this.end]=a;return this.end+=1};ue.prototype.O=function(){var a=new ve(this.T,0,this.end);this.T=null;return a};ue.prototype.$=function(){return this.end};function we(a){return new ue(Array(a))}function ve(a,b,c){this.o=a;this.na=b;this.end=c;this.A=524306;this.I=0}h=ve.prototype;h.$=function(){return this.end-this.na};
h.W=function(a,b){return this.o[this.na+b]};h.ka=function(a,b,c){return 0<=b&&b<this.end-this.na?this.o[this.na+b]:c};h.tc=function(){if(this.na===this.end)throw Error("-drop-first of empty chunk");return new ve(this.o,this.na+1,this.end)};h.ia=function(a,b){return Sc(this.o,b,this.o[this.na],this.na+1)};h.ja=function(a,b,c){return Sc(this.o,b,c,this.na)};function xe(a,b,c,d){this.O=a;this.Sa=b;this.D=c;this.F=d;this.A=31850732;this.I=1536}h=xe.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){return 1<Ma(this.O)?new xe(Sb(this.O),this.Sa,null,null):null==this.Sa?null:Fb(this.Sa)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.la=function(){return Ua(this.O,0)};h.ma=function(){return 1<Ma(this.O)?new xe(Sb(this.O),this.Sa,null,null):null==this.Sa?yc:this.Sa};h.Y=function(){return this};h.Kb=function(){return this.O};h.jb=function(){return null==this.Sa?yc:this.Sa};h.R=function(a,b){return b===this.D?this:new xe(this.O,this.Sa,b,this.F)};h.ga=function(a,b){return T(b,this)};h.fc=function(){return null==this.Sa?null:this.Sa};xe.prototype[Fa]=function(){return Ac(this)};
function ye(a,b){return 0===Ma(a)?b:new xe(a,b,null,null)}function ze(a,b){a.add(b)}function Ed(a){var b=[];for(a=H(a);;)if(null!=a)b.push(M(a)),a=N(a);else return b}function Ae(a,b){if(Tc(b))return R(b);var c=0;for(b=H(b);;)if(null!=b&&c<a)c+=1,b=N(b);else return c}
var Be=function Be(a){if(null==a)return null;var c=N(a);return null==c?H(M(a)):T(M(a),Be.j?Be.j(c):Be.call(null,c))},Ce=function Ce(a){switch(arguments.length){case 0:return Ce.G();case 1:return Ce.j(arguments[0]);case 2:return Ce.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Ce.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Ce.G=function(){return new de(null,function(){return null},null)};
Ce.j=function(a){return new de(null,function(){return a},null)};Ce.m=function(a,b){return new de(null,function(){var c=H(a);return c?ud(c)?ye(Tb(c),Ce.m(Ub(c),b)):T(M(c),Ce.m(xc(c),b)):b},null)};Ce.C=function(a,b,c){return function g(e,f){return new de(null,function(){var k=H(e);return k?ud(k)?ye(Tb(k),g(Ub(k),f)):T(M(k),g(xc(k),f)):x(f)?g(M(f),N(f)):null},null)}(Ce.m(a,b),c)};Ce.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};Ce.M=2;
function De(a,b,c){var d=H(c);if(0===b)return a.G?a.G():a.call(null);c=Wa(d);var e=Xa(d);if(1===b)return a.j?a.j(c):a.call(null,c);d=Wa(e);var f=Xa(e);if(2===b)return a.m?a.m(c,d):a.call(null,c,d);e=Wa(f);var g=Xa(f);if(3===b)return a.u?a.u(c,d,e):a.call(null,c,d,e);f=Wa(g);var k=Xa(g);if(4===b)return a.H?a.H(c,d,e,f):a.call(null,c,d,e,f);g=Wa(k);var l=Xa(k);if(5===b)return a.U?a.U(c,d,e,f,g):a.call(null,c,d,e,f,g);k=Wa(l);var m=Xa(l);if(6===b)return a.oa?a.oa(c,d,e,f,g,k):a.call(null,c,d,e,f,g,k);
l=Wa(m);var n=Xa(m);if(7===b)return a.Ka?a.Ka(c,d,e,f,g,k,l):a.call(null,c,d,e,f,g,k,l);m=Wa(n);var p=Xa(n);if(8===b)return a.wa?a.wa(c,d,e,f,g,k,l,m):a.call(null,c,d,e,f,g,k,l,m);n=Wa(p);var q=Xa(p);if(9===b)return a.La?a.La(c,d,e,f,g,k,l,m,n):a.call(null,c,d,e,f,g,k,l,m,n);p=Wa(q);var r=Xa(q);if(10===b)return a.za?a.za(c,d,e,f,g,k,l,m,n,p):a.call(null,c,d,e,f,g,k,l,m,n,p);q=Wa(r);var t=Xa(r);if(11===b)return a.Aa?a.Aa(c,d,e,f,g,k,l,m,n,p,q):a.call(null,c,d,e,f,g,k,l,m,n,p,q);r=Wa(t);var z=Xa(t);
if(12===b)return a.Ba?a.Ba(c,d,e,f,g,k,l,m,n,p,q,r):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r);t=Wa(z);var D=Xa(z);if(13===b)return a.Ca?a.Ca(c,d,e,f,g,k,l,m,n,p,q,r,t):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t);z=Wa(D);var I=Xa(D);if(14===b)return a.Da?a.Da(c,d,e,f,g,k,l,m,n,p,q,r,t,z):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z);D=Wa(I);var J=Xa(I);if(15===b)return a.Ea?a.Ea(c,d,e,f,g,k,l,m,n,p,q,r,t,z,D):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D);I=Wa(J);var Q=Xa(J);if(16===b)return a.Fa?a.Fa(c,d,e,f,g,k,l,
m,n,p,q,r,t,z,D,I):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I);J=Wa(Q);var da=Xa(Q);if(17===b)return a.Ga?a.Ga(c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J);Q=Wa(da);var na=Xa(da);if(18===b)return a.Ha?a.Ha(c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q);da=Wa(na);na=Xa(na);if(19===b)return a.Ia?a.Ia(c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da);var Sa=Wa(na);Xa(na);if(20===b)return a.Ja?
a.Ja(c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da,Sa):a.call(null,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da,Sa);throw Error("Only up to 20 arguments supported on functions");}function Ee(a){return null!=a&&(a.A&128||v===a.Pb)?a.ha(null):H(xc(a))}function Fe(a,b,c){return null==c?a.j?a.j(b):a.call(a,b):Ge(a,b,Wa(c),Ee(c))}function Ge(a,b,c,d){return null==d?a.m?a.m(b,c):a.call(a,b,c):He(a,b,c,Wa(d),Ee(d))}function He(a,b,c,d,e){return null==e?a.u?a.u(b,c,d):a.call(a,b,c,d):Ie(a,b,c,d,Wa(e),Ee(e))}
function Ie(a,b,c,d,e,f){if(null==f)return a.H?a.H(b,c,d,e):a.call(a,b,c,d,e);var g=Wa(f),k=N(f);if(null==k)return a.U?a.U(b,c,d,e,g):a.call(a,b,c,d,e,g);f=Wa(k);var l=N(k);if(null==l)return a.oa?a.oa(b,c,d,e,g,f):a.call(a,b,c,d,e,g,f);k=Wa(l);var m=N(l);if(null==m)return a.Ka?a.Ka(b,c,d,e,g,f,k):a.call(a,b,c,d,e,g,f,k);l=Wa(m);var n=N(m);if(null==n)return a.wa?a.wa(b,c,d,e,g,f,k,l):a.call(a,b,c,d,e,g,f,k,l);m=Wa(n);var p=N(n);if(null==p)return a.La?a.La(b,c,d,e,g,f,k,l,m):a.call(a,b,c,d,e,g,f,k,
l,m);n=Wa(p);var q=N(p);if(null==q)return a.za?a.za(b,c,d,e,g,f,k,l,m,n):a.call(a,b,c,d,e,g,f,k,l,m,n);p=Wa(q);var r=N(q);if(null==r)return a.Aa?a.Aa(b,c,d,e,g,f,k,l,m,n,p):a.call(a,b,c,d,e,g,f,k,l,m,n,p);q=Wa(r);var t=N(r);if(null==t)return a.Ba?a.Ba(b,c,d,e,g,f,k,l,m,n,p,q):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q);r=Wa(t);var z=N(t);if(null==z)return a.Ca?a.Ca(b,c,d,e,g,f,k,l,m,n,p,q,r):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r);t=Wa(z);var D=N(z);if(null==D)return a.Da?a.Da(b,c,d,e,g,f,k,l,m,n,p,q,r,t):a.call(a,
b,c,d,e,g,f,k,l,m,n,p,q,r,t);z=Wa(D);var I=N(D);if(null==I)return a.Ea?a.Ea(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r,t,z);D=Wa(I);var J=N(I);if(null==J)return a.Fa?a.Fa(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D);I=Wa(J);var Q=N(J);if(null==Q)return a.Ga?a.Ga(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I);J=Wa(Q);var da=N(Q);if(null==da)return a.Ha?a.Ha(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J):a.call(a,b,c,d,e,g,f,
k,l,m,n,p,q,r,t,z,D,I,J);Q=Wa(da);var na=N(da);if(null==na)return a.Ia?a.Ia(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J,Q):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J,Q);da=Wa(na);na=N(na);if(null==na)return a.Ja?a.Ja(b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J,Q,da):a.call(a,b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J,Q,da);b=[b,c,d,e,g,f,k,l,m,n,p,q,r,t,z,D,I,J,Q,da];for(c=na;;)if(c)b.push(Wa(c)),c=N(c);else break;return a.apply(a,b)}
function kd(a){switch(arguments.length){case 2:return Je(arguments[0],arguments[1]);case 3:return Ke(arguments[0],arguments[1],arguments[2]);case 4:return Le(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return Me(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;return Ne(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],5<b.length?new K(b.slice(5),0,null):null)}}
function Je(a,b){if(a.N){var c=a.M,d=Ae(c+1,b);return d<=c?De(a,d,b):a.N(b)}b=H(b);return null==b?a.G?a.G():a.call(a):Fe(a,Wa(b),Ee(b))}function Ke(a,b,c){if(a.N){b=T(b,c);var d=a.M;c=Ae(d,c)+1;return c<=d?De(a,c,b):a.N(b)}return Fe(a,b,H(c))}function Le(a,b,c,d){return a.N?(b=T(b,T(c,d)),c=a.M,d=2+Ae(c-1,d),d<=c?De(a,d,b):a.N(b)):Ge(a,b,c,H(d))}function Me(a,b,c,d,e){return a.N?(b=T(b,T(c,T(d,e))),c=a.M,e=3+Ae(c-2,e),e<=c?De(a,e,b):a.N(b)):He(a,b,c,d,H(e))}
function Ne(a,b,c,d,e,f){return a.N?(f=Be(f),b=T(b,T(c,T(d,T(e,f)))),c=a.M,f=4+Ae(c-3,f),f<=c?De(a,f,b):a.N(b)):Ie(a,b,c,d,e,Be(f))}function Oe(a){return null!=a&&(a.A&64||v===a.Qb)?N(a)?gd(Ed(a)):H(a)?M(a):Pe:a}function Qe(a){return H(a)?a:null}function Re(a){this.pd=a;this.A=393216;this.I=0}h=Re.prototype;h.R=function(a,b){return new Re(b)};h.P=function(){return this.pd};h.qa=function(){return!1};h.next=function(){return Error("No such element")};h.remove=function(){return Error("Unsupported operation")};
function Se(a,b){for(;;){if(null==H(b))return!0;var c=M(b);c=a.j?a.j(c):a.call(null,c);if(x(c))b=N(b);else return!1}}function Te(a,b){for(;;)if(b=H(b)){var c=M(b);c=a.j?a.j(c):a.call(null,c);if(x(c))return c;b=N(b)}else return null}
function Ue(a){return function(){function b(g,k){return Aa(a.m?a.m(g,k):a.call(null,g,k))}function c(g){return Aa(a.j?a.j(g):a.call(null,g))}function d(){return Aa(a.G?a.G():a.call(null))}var e=null,f=function(){function g(l,m,n){var p=null;if(2<arguments.length){p=0;for(var q=Array(arguments.length-2);p<q.length;)q[p]=arguments[p+2],++p;p=new K(q,0,null)}return k.call(this,l,m,p)}function k(l,m,n){return Aa(Le(a,l,m,n))}g.M=2;g.N=function(l){var m=M(l);l=N(l);var n=M(l);l=xc(l);return k(m,n,l)};
g.C=k;return g}();e=function(g,k,l){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,g);case 2:return b.call(this,g,k);default:var m=null;if(2<arguments.length){m=0;for(var n=Array(arguments.length-2);m<n.length;)n[m]=arguments[m+2],++m;m=new K(n,0,null)}return f.C(g,k,m)}throw Error("Invalid arity: "+arguments.length);};e.M=2;e.N=f.N;e.G=d;e.j=c;e.m=b;e.C=f.C;return e}()}
function Ve(a){return function(){function b(c){if(0<arguments.length)for(var d=0,e=Array(arguments.length-0);d<e.length;)e[d]=arguments[d+0],++d;return a}b.M=0;b.N=function(c){H(c);return a};b.C=function(){return a};return b}()}
function We(a,b){return function(){function c(l,m,n){return a.H?a.H(b,l,m,n):a.call(null,b,l,m,n)}function d(l,m){return a.u?a.u(b,l,m):a.call(null,b,l,m)}function e(l){return a.m?a.m(b,l):a.call(null,b,l)}function f(){return a.j?a.j(b):a.call(null,b)}var g=null,k=function(){function l(n,p,q,r){var t=null;if(3<arguments.length){t=0;for(var z=Array(arguments.length-3);t<z.length;)z[t]=arguments[t+3],++t;t=new K(z,0,null)}return m.call(this,n,p,q,t)}function m(n,p,q,r){return Ne(a,b,n,p,q,Zc([r]))}
l.M=3;l.N=function(n){var p=M(n);n=N(n);var q=M(n);n=N(n);var r=M(n);n=xc(n);return m(p,q,r,n)};l.C=m;return l}();g=function(l,m,n,p){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,l);case 2:return d.call(this,l,m);case 3:return c.call(this,l,m,n);default:var q=null;if(3<arguments.length){q=0;for(var r=Array(arguments.length-3);q<r.length;)r[q]=arguments[q+3],++q;q=new K(r,0,null)}return k.C(l,m,n,q)}throw Error("Invalid arity: "+arguments.length);};g.M=3;g.N=k.N;g.G=
f;g.j=e;g.m=d;g.u=c;g.C=k.C;return g}()}
function Xe(a,b,c){return function(){function d(m,n,p){return a.U?a.U(b,c,m,n,p):a.call(null,b,c,m,n,p)}function e(m,n){return a.H?a.H(b,c,m,n):a.call(null,b,c,m,n)}function f(m){return a.u?a.u(b,c,m):a.call(null,b,c,m)}function g(){return a.m?a.m(b,c):a.call(null,b,c)}var k=null,l=function(){function m(p,q,r,t){var z=null;if(3<arguments.length){z=0;for(var D=Array(arguments.length-3);z<D.length;)D[z]=arguments[z+3],++z;z=new K(D,0,null)}return n.call(this,p,q,r,z)}function n(p,q,r,t){return Ne(a,
b,c,p,q,Zc([r,t]))}m.M=3;m.N=function(p){var q=M(p);p=N(p);var r=M(p);p=N(p);var t=M(p);p=xc(p);return n(q,r,t,p)};m.C=n;return m}();k=function(m,n,p,q){switch(arguments.length){case 0:return g.call(this);case 1:return f.call(this,m);case 2:return e.call(this,m,n);case 3:return d.call(this,m,n,p);default:var r=null;if(3<arguments.length){r=0;for(var t=Array(arguments.length-3);r<t.length;)t[r]=arguments[r+3],++r;r=new K(t,0,null)}return l.C(m,n,p,r)}throw Error("Invalid arity: "+arguments.length);
};k.M=3;k.N=l.N;k.G=g;k.j=f;k.m=e;k.u=d;k.C=l.C;return k}()}function Ye(a){this.state=a;this.Qc=this.Dd=this.D=null;this.I=16386;this.A=6455296}Ye.prototype.aa=function(a,b){return this===b};Ye.prototype.kb=function(){return this.state};Ye.prototype.P=function(){return this.D};Ye.prototype.ba=function(){return ba(this)};function Ze(a){return new Ye(a)}
function af(a,b){if(a instanceof Ye){var c=a.Dd;if(null!=c&&!x(c.j?c.j(b):c.call(null,b)))throw Error("Validator rejected reference state");c=a.state;a.state=b;if(null!=a.Qc)a:for(var d=H(a.Qc),e=null,f=0,g=0;;)if(g<f){var k=e.W(null,g),l=U(k,0,null);k=U(k,1,null);k.H?k.H(l,a,c,b):k.call(null,l,a,c,b);g+=1}else if(d=H(d))ud(d)?(e=Tb(d),d=Ub(d),l=e,f=R(e),e=l):(e=M(d),l=U(e,0,null),k=U(e,1,null),k.H?k.H(l,a,c,b):k.call(null,l,a,c,b),d=N(d),e=null,f=0),g=0;else break a;return b}return Zb(a,b)}
var df=function df(a){switch(arguments.length){case 2:return df.m(arguments[0],arguments[1]);case 3:return df.u(arguments[0],arguments[1],arguments[2]);case 4:return df.H(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return df.C(arguments[0],arguments[1],arguments[2],arguments[3],4<c.length?new K(c.slice(4),0,null):null)}};
df.m=function(a,b){if(a instanceof Ye){var c=a.state;b=b.j?b.j(c):b.call(null,c);a=af(a,b)}else a=$b(a,b);return a};df.u=function(a,b,c){if(a instanceof Ye){var d=a.state;b=b.m?b.m(d,c):b.call(null,d,c);a=af(a,b)}else a=$b(a,b,c);return a};df.H=function(a,b,c,d){if(a instanceof Ye){var e=a.state;b=b.u?b.u(e,c,d):b.call(null,e,c,d);a=af(a,b)}else a=$b(a,b,c,d);return a};df.C=function(a,b,c,d,e){return a instanceof Ye?af(a,Me(b,a.state,c,d,e)):$b(a,b,c,d,e)};
df.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);var e=N(d);d=M(e);e=N(e);return this.C(b,a,c,d,e)};df.M=4;function ef(a){this.state=a;this.A=32768;this.I=0}ef.prototype.ic=function(a,b){return this.state=b};ef.prototype.kb=function(){return this.state};
var ff=function ff(a){switch(arguments.length){case 1:return ff.j(arguments[0]);case 2:return ff.m(arguments[0],arguments[1]);case 3:return ff.u(arguments[0],arguments[1],arguments[2]);case 4:return ff.H(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return ff.C(arguments[0],arguments[1],arguments[2],arguments[3],4<c.length?new K(c.slice(4),0,null):null)}};
ff.j=function(a){return function(b){return function(){function c(k,l){l=a.j?a.j(l):a.call(null,l);return b.m?b.m(k,l):b.call(null,k,l)}function d(k){return b.j?b.j(k):b.call(null,k)}function e(){return b.G?b.G():b.call(null)}var f=null,g=function(){function k(m,n,p){var q=null;if(2<arguments.length){q=0;for(var r=Array(arguments.length-2);q<r.length;)r[q]=arguments[q+2],++q;q=new K(r,0,null)}return l.call(this,m,n,q)}function l(m,n,p){n=Ke(a,n,p);return b.m?b.m(m,n):b.call(null,m,n)}k.M=2;k.N=function(m){var n=
M(m);m=N(m);var p=M(m);m=xc(m);return l(n,p,m)};k.C=l;return k}();f=function(k,l,m){switch(arguments.length){case 0:return e.call(this);case 1:return d.call(this,k);case 2:return c.call(this,k,l);default:var n=null;if(2<arguments.length){n=0;for(var p=Array(arguments.length-2);n<p.length;)p[n]=arguments[n+2],++n;n=new K(p,0,null)}return g.C(k,l,n)}throw Error("Invalid arity: "+arguments.length);};f.M=2;f.N=g.N;f.G=e;f.j=d;f.m=c;f.C=g.C;return f}()}};
ff.m=function(a,b){return new de(null,function(){var c=H(b);if(c){if(ud(c)){for(var d=Tb(c),e=R(d),f=we(e),g=0;;)if(g<e)ze(f,function(){var k=Ua(d,g);return a.j?a.j(k):a.call(null,k)}()),g+=1;else break;return ye(f.O(),ff.m(a,Ub(c)))}return T(function(){var k=M(c);return a.j?a.j(k):a.call(null,k)}(),ff.m(a,xc(c)))}return null},null)};
ff.u=function(a,b,c){return new de(null,function(){var d=H(b),e=H(c);if(d&&e){var f=M(d);var g=M(e);f=a.m?a.m(f,g):a.call(null,f,g);d=T(f,ff.u(a,xc(d),xc(e)))}else d=null;return d},null)};ff.H=function(a,b,c,d){return new de(null,function(){var e=H(b),f=H(c),g=H(d);if(e&&f&&g){var k=M(e);var l=M(f),m=M(g);k=a.u?a.u(k,l,m):a.call(null,k,l,m);e=T(k,ff.H(a,xc(e),xc(f),xc(g)))}else e=null;return e},null)};
ff.C=function(a,b,c,d,e){return ff.m(function(f){return Je(a,f)},function k(g){return new de(null,function(){var l=ff.m(H,g);return Se(Pd,l)?T(ff.m(M,l),k(ff.m(xc,l))):null},null)}(bd.C(e,d,Zc([c,b]))))};ff.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);var e=N(d);d=M(e);e=N(e);return this.C(b,a,c,d,e)};ff.M=4;
var gf=function gf(a){switch(arguments.length){case 1:return gf.j(arguments[0]);case 2:return gf.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};
gf.j=function(a){return function(b){var c=new ef(a);return function(){function d(k,l){var m=C(c),n=c.ic(null,c.kb(null)-1);k=0<m?b.m?b.m(k,l):b.call(null,k,l):k;return 0<n?k:Lc(k)?k:new Kc(k)}function e(k){return b.j?b.j(k):b.call(null,k)}function f(){return b.G?b.G():b.call(null)}var g=null;g=function(k,l){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,k);case 2:return d.call(this,k,l)}throw Error("Invalid arity: "+arguments.length);};g.G=f;g.j=e;g.m=d;return g}()}};
gf.m=function(a,b){return new de(null,function(){if(0<a){var c=H(b);return c?T(M(c),gf.m(a-1,xc(c))):null}return null},null)};gf.M=2;function hf(a,b){if(null!=b&&(b.I&262144||v===b.Gd)){var c=0<a?b.ab(null,Math.ceil(a)):H(b);return x(c)?c:yc}return new de(null,function(){a:for(var d=a,e=b;;)if(e=H(e),0<d&&e)--d,e=xc(e);else break a;return e},null)}function jf(a,b,c,d){this.D=a;this.count=b;this.v=c;this.next=d;this.F=null;this.A=32374988;this.I=262145}h=jf.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,this.count)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){return null==this.next?1<this.count?this.next=new jf(null,this.count-1,this.v,null):-1===this.count?this:null:this.next};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){if(-1===this.count)for(var c=b.m?b.m(this.v,this.v):b.call(null,this.v,this.v);;){if(Lc(c))return C(c);c=b.m?b.m(c,this.v):b.call(null,c,this.v)}else for(a=1,c=this.v;;)if(a<this.count){c=b.m?b.m(c,this.v):b.call(null,c,this.v);if(Lc(c))return C(c);a+=1}else return c};
h.ja=function(a,b,c){if(-1===this.count)for(c=b.m?b.m(c,this.v):b.call(null,c,this.v);;){if(Lc(c))return C(c);c=b.m?b.m(c,this.v):b.call(null,c,this.v)}else for(a=0;;)if(a<this.count){c=b.m?b.m(c,this.v):b.call(null,c,this.v);if(Lc(c))return C(c);a+=1}else return c};h.la=function(){return this.v};h.ma=function(){return null==this.next?1<this.count?this.next=new jf(null,this.count-1,this.v,null):-1===this.count?this:yc:this.next};h.Y=function(){return this};
h.R=function(a,b){return b===this.D?this:new jf(b,this.count,this.v,this.next)};h.ga=function(a,b){return T(b,this)};h.ab=function(a,b){if(-1===this.count)return this;a=this.count-b;return 0<a?new jf(null,a,this.v,null):null};function kf(a){return 0<a?new jf(null,a,null,null):yc}
function lf(a,b){return new de(null,function(){var c=H(b);if(c){if(ud(c)){for(var d=Tb(c),e=R(d),f=we(e),g=0;;)if(g<e){var k=Ua(d,g);k=a.j?a.j(k):a.call(null,k);if(x(k)){k=f;var l=Ua(d,g);k.add(l)}g+=1}else break;return ye(f.O(),lf(a,Ub(c)))}d=M(c);c=xc(c);return x(a.j?a.j(d):a.call(null,d))?T(d,lf(a,c)):lf(a,c)}return null},null)}function mf(a,b){return lf(Ue(a),b)}
var nf=function nf(a){switch(arguments.length){case 0:return nf.G();case 1:return nf.j(arguments[0]);case 2:return nf.m(arguments[0],arguments[1]);case 3:return nf.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};nf.G=function(){return dd};nf.j=function(a){return a};nf.m=function(a,b){return null!=a?null!=a&&(a.I&4||v===a.Tc)?sb(Ob(Gd(Nb,Mb(a),b)),md(a)):Gd(Qa,a,b):Gd(bd,a,b)};
nf.u=function(a,b,c){if(null!=a&&(a.I&4||v===a.Tc)){var d=md(a);return Qd(b,function(){function e(g){return sb(Ob(g),d)}var f=null;f=function(g,k){switch(arguments.length){case 1:return e.call(this,g);case 2:return Nb(g,k)}throw Error("Invalid arity: "+arguments.length);};f.j=e;f.m=function(g,k){return Nb(g,k)};return f}(),Mb(a),c)}return Qd(b,bd,a,c)};nf.M=3;
var of=function of(a){switch(arguments.length){case 2:return of.m(arguments[0],arguments[1]);case 3:return of.u(arguments[0],arguments[1],arguments[2]);case 4:return of.H(arguments[0],arguments[1],arguments[2],arguments[3]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return of.C(arguments[0],arguments[1],arguments[2],arguments[3],4<c.length?new K(c.slice(4),0,null):null)}};
of.m=function(a,b){return Ob(Gd(function(c,d){d=a.j?a.j(d):a.call(null,d);return Nb(c,d)},Mb(dd),b))};of.u=function(a,b,c){return nf.m(dd,ff.u(a,b,c))};of.H=function(a,b,c,d){return nf.m(dd,ff.H(a,b,c,d))};of.C=function(a,b,c,d,e){return nf.m(dd,Ne(ff,a,b,c,d,Zc([e])))};of.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);var e=N(d);d=M(e);e=N(e);return this.C(b,a,c,d,e)};of.M=4;function pf(a,b){return Ob(Gd(function(c,d){return x(a.j?a.j(d):a.call(null,d))?Nb(c,d):c},Mb(dd),b))}
function qf(a,b,c,d){return new de(null,function(){var e=H(d);if(e){var f=gf.m(a,e);return a===R(f)?T(f,qf(a,b,c,hf(b,e))):new ed(null,gf.m(a,Ce.m(f,c)),null,1,null)}return null},null)}function rf(a,b){for(b=H(b);;){if(null==b)return a;a=F(a,M(b));b=N(b)}}
var sf=function sf(a,b,c){var e=H(b);b=M(e);var f=N(e);if(f){e=V.u;var g=F(a,b);c=sf.u?sf.u(g,f,c):sf.call(null,g,f,c);a=e.call(V,a,b,c)}else a=V.u(a,b,c);return a},tf=function tf(a){switch(arguments.length){case 3:return tf.u(arguments[0],arguments[1],arguments[2]);case 4:return tf.H(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return tf.U(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return tf.oa(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],
arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return tf.C(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],6<c.length?new K(c.slice(6),0,null):null)}};tf.u=function(a,b,c){var d=H(b);b=M(d);if(d=N(d))a=V.u(a,b,tf.u(F(a,b),d,c));else{d=V.u;var e=F(a,b);c=c.j?c.j(e):c.call(null,e);a=d.call(V,a,b,c)}return a};
tf.H=function(a,b,c,d){var e=H(b);b=M(e);if(e=N(e))a=V.u(a,b,tf.H(F(a,b),e,c,d));else{e=V.u;var f=F(a,b);c=c.m?c.m(f,d):c.call(null,f,d);a=e.call(V,a,b,c)}return a};tf.U=function(a,b,c,d,e){var f=H(b);b=M(f);if(f=N(f))a=V.u(a,b,tf.U(F(a,b),f,c,d,e));else{f=V.u;var g=F(a,b);c=c.u?c.u(g,d,e):c.call(null,g,d,e);a=f.call(V,a,b,c)}return a};
tf.oa=function(a,b,c,d,e,f){var g=H(b);b=M(g);if(g=N(g))a=V.u(a,b,tf.oa(F(a,b),g,c,d,e,f));else{g=V.u;var k=F(a,b);c=c.H?c.H(k,d,e,f):c.call(null,k,d,e,f);a=g.call(V,a,b,c)}return a};tf.C=function(a,b,c,d,e,f,g){var k=H(b);b=M(k);return(k=N(k))?V.u(a,b,Ne(tf,F(a,b),k,c,d,Zc([e,f,g]))):V.u(a,b,Ne(c,F(a,b),d,e,f,Zc([g])))};tf.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);var e=N(d);d=M(e);var f=N(e);e=M(f);var g=N(f);f=M(g);g=N(g);return this.C(b,a,c,d,e,f,g)};tf.M=6;
var uf=function uf(a){switch(arguments.length){case 3:return uf.u(arguments[0],arguments[1],arguments[2]);case 4:return uf.H(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return uf.U(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return uf.oa(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return uf.C(arguments[0],arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],6<c.length?new K(c.slice(6),0,null):null)}};uf.u=function(a,b,c){var d=V.u,e=F(a,b);c=c.j?c.j(e):c.call(null,e);return d.call(V,a,b,c)};uf.H=function(a,b,c,d){var e=V.u,f=F(a,b);c=c.m?c.m(f,d):c.call(null,f,d);return e.call(V,a,b,c)};uf.U=function(a,b,c,d,e){var f=V.u,g=F(a,b);c=c.u?c.u(g,d,e):c.call(null,g,d,e);return f.call(V,a,b,c)};uf.oa=function(a,b,c,d,e,f){var g=V.u,k=F(a,b);c=c.H?c.H(k,d,e,f):c.call(null,k,d,e,f);return g.call(V,a,b,c)};
uf.C=function(a,b,c,d,e,f,g){return V.u(a,b,Ne(c,F(a,b),d,e,f,Zc([g])))};uf.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);var e=N(d);d=M(e);var f=N(e);e=M(f);var g=N(f);f=M(g);g=N(g);return this.C(b,a,c,d,e,f,g)};uf.M=6;function vf(a,b){this.ca=a;this.o=b}function wf(a){return new vf(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}
function xf(a){return new vf(a.ca,Ia(a.o))}function yf(a){a=a.B;return 32>a?0:a-1>>>5<<5}function zf(a,b,c){for(;;){if(0===b)return c;var d=wf(a);d.o[0]=c;c=d;b-=5}}var Af=function Af(a,b,c,d){var f=xf(c),g=a.B-1>>>b&31;5===b?f.o[g]=d:(c=c.o[g],null!=c?(b-=5,a=Af.H?Af.H(a,b,c,d):Af.call(null,a,b,c,d)):a=zf(null,b-5,d),f.o[g]=a);return f};function Bf(a,b){if(b>=yf(a))return a.Z;var c=a.root;for(a=a.shift;;)if(0<a){var d=a-5;c=c.o[b>>>a&31];a=d}else return c.o}
function Cf(a,b){if(0<=b&&b<a.B)b=Bf(a,b);else throw a=a.B,Error(["No item ",B.j(b)," in vector of length ",B.j(a)].join(""));return b}
var Df=function Df(a,b,c,d,e){var g=xf(c);if(0===b)g.o[d&31]=e;else{var k=d>>>b&31;b-=5;c=c.o[k];a=Df.U?Df.U(a,b,c,d,e):Df.call(null,a,b,c,d,e);g.o[k]=a}return g},Ef=function Ef(a,b,c){var e=a.B-2>>>b&31;if(5<b){b-=5;var f=c.o[e];a=Ef.u?Ef.u(a,b,f):Ef.call(null,a,b,f);if(null==a&&0===e)return null;c=xf(c);c.o[e]=a;return c}if(0===e)return null;c=xf(c);c.o[e]=null;return c};function Ff(a,b,c){this.sc=this.i=0;this.o=a;this.Cd=b;this.start=0;this.end=c}Ff.prototype.qa=function(){return this.i<this.end};
Ff.prototype.next=function(){32===this.i-this.sc&&(this.o=Bf(this.Cd,this.i),this.sc+=32);var a=this.o[this.i&31];this.i+=1;return a};function Gf(a,b,c,d){return c<d?Hf(a,b,Vc(a,c),c+1,d):b.G?b.G():b.call(null)}function Hf(a,b,c,d,e){var f=c;c=d;for(d=Bf(a,d);;)if(c<e){var g=c&31;d=0===g?Bf(a,c):d;g=d[g];f=b.m?b.m(f,g):b.call(null,f,g);if(Lc(f))return C(f);c+=1}else return f}function X(a,b,c,d,e,f){this.D=a;this.B=b;this.shift=c;this.root=d;this.Z=e;this.F=f;this.A=167666463;this.I=401412}h=X.prototype;
h.lb=function(a,b){return 0<=b&&b<this.B?new If(b,Bf(this,b)[b&31]):null};h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return"number"===typeof b?this.ka(null,b,c):c};
h.Mb=function(a,b,c){a=0;for(var d=c;;)if(a<this.B){var e=Bf(this,a);c=e.length;a:for(var f=0;;)if(f<c){var g=f+a,k=e[f];d=b.u?b.u(d,g,k):b.call(null,d,g,k);if(Lc(d)){e=d;break a}f+=1}else{e=d;break a}if(Lc(e))return C(e);a+=c;d=e}else return d};h.W=function(a,b){return Cf(this,b)[b&31]};h.ka=function(a,b,c){return 0<=b&&b<this.B?Bf(this,b)[b&31]:c};
h.tb=function(a,b){if(0<=a&&a<this.B){if(yf(this)<=a){var c=Ia(this.Z);c[a&31]=b;return new X(this.D,this.B,this.shift,this.root,c,null)}return new X(this.D,this.B,this.shift,Df(this,this.shift,this.root,a,b),this.Z,null)}if(a===this.B)return this.ga(null,b);throw Error(["Index ",B.j(a)," out of bounds  [0,",B.j(this.B),"]"].join(""));};h.Ma=function(){var a=this.B;return new Ff(0<R(this)?Bf(this,0):null,this,a)};h.P=function(){return this.D};h.$=function(){return this.B};
h.rb=function(){return 0<this.B?this.W(null,this.B-1):null};h.sb=function(){if(0===this.B)throw Error("Can't pop empty vector");if(1===this.B)return sb(dd,this.D);if(1<this.B-yf(this))return new X(this.D,this.B-1,this.shift,this.root,this.Z.slice(0,-1),null);var a=Bf(this,this.B-2),b=Ef(this,this.shift,this.root);b=null==b?Y:b;var c=this.B-1;return 5<this.shift&&null==b.o[1]?new X(this.D,c,this.shift-5,b.o[0],a,null):new X(this.D,c,this.shift,b,a,null)};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){if(b instanceof X)if(this.B===R(b))for(a=this.Ma(null),b=b.Ma(null);;)if(a.qa()){var c=a.next(),d=b.next();if(!O.m(c,d))return!1}else return!0;else return!1;else return Yc(this,b)};h.Ab=function(){return new Jf(this.B,this.shift,Kf.j?Kf.j(this.root):Kf.call(null,this.root),Lf.j?Lf.j(this.Z):Lf.call(null,this.Z))};h.fa=function(){return sb(dd,this.D)};h.ia=function(a,b){return Gf(this,b,0,this.B)};
h.ja=function(a,b,c){a=0;for(var d=c;;)if(a<this.B){var e=Bf(this,a);c=e.length;a:for(var f=0;;)if(f<c){var g=e[f];d=b.m?b.m(d,g):b.call(null,d,g);if(Lc(d)){e=d;break a}f+=1}else{e=d;break a}if(Lc(e))return C(e);a+=c;d=e}else return d};h.Oa=function(a,b,c){if("number"===typeof b)return this.tb(b,c);throw Error("Vector's key for assoc must be a number.");};h.Za=function(a,b){return yd(b)?0<=b&&b<this.B:!1};
h.Y=function(){if(0===this.B)return null;if(32>=this.B)return new K(this.Z,0,null);a:{var a=this.root;for(var b=this.shift;;)if(0<b)b-=5,a=a.o[0];else{a=a.o;break a}}return Mf?Mf(this,a,0,0):Nf.call(null,this,a,0,0)};h.R=function(a,b){return b===this.D?this:new X(b,this.B,this.shift,this.root,this.Z,this.F)};
h.ga=function(a,b){if(32>this.B-yf(this)){a=this.Z.length;for(var c=Array(a+1),d=0;;)if(d<a)c[d]=this.Z[d],d+=1;else break;c[a]=b;return new X(this.D,this.B+1,this.shift,this.root,c,null)}a=(c=this.B>>>5>1<<this.shift)?this.shift+5:this.shift;c?(c=wf(null),c.o[0]=this.root,d=zf(null,this.shift,new vf(null,this.Z)),c.o[1]=d):c=Af(this,this.shift,this.root,new vf(null,this.Z));return new X(this.D,this.B+1,a,c,[b],null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){if("number"===typeof a)return this.W(null,a);throw Error("Key must be integer");};h.ab=function(a,b){if(b<this.B){a=b%32;var c=Bf(this,b);b-=a;return Mf?Mf(this,c,b,a):Nf.call(null,this,c,b,a)}return null};
var Y=new vf(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),dd=new X(null,0,5,Y,[],Gc);function Of(a,b){var c=a.length;a=b?a:Ia(a);if(32>c)return new X(null,c,5,Y,a,null);b=32;for(var d=(new X(null,32,5,Y,a.slice(0,32),null)).Ab(null);;)if(b<c){var e=b+1;d=Nb(d,a[b]);b=e}else return Ob(d)}X.prototype[Fa]=function(){return Ac(this)};
function Pf(a){return x(Qf.j?Qf.j(a):Qf.call(null,a))?new X(null,2,5,Y,[Rf.j?Rf.j(a):Rf.call(null,a),Wf.j?Wf.j(a):Wf.call(null,a)],null):td(a)?ld(a,null):za(a)?Of(a,!0):Ob(Gd(Nb,Mb(dd),a))}var Xf=function Xf(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Xf.C(0<c.length?new K(c.slice(0),0,null):null)};Xf.C=function(a){return a instanceof K&&0===a.i?Of(a.o,!za(a.o)):Pf(a)};Xf.M=0;Xf.N=function(a){return this.C(H(a))};
function Yf(a,b,c,d,e){this.ta=a;this.node=b;this.i=c;this.na=d;this.D=e;this.F=null;this.A=32375020;this.I=263680}h=Yf.prototype;h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){if(this.na+1<this.node.length){var a=this.ta;var b=this.node,c=this.i,d=this.na+1;a=Mf?Mf(a,b,c,d):Nf.call(null,a,b,c,d);return null==a?null:a}return this.fc()};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Gf(this.ta,b,this.i+this.na,R(this.ta))};h.ja=function(a,b,c){return Hf(this.ta,b,c,this.i+this.na,R(this.ta))};h.la=function(){return this.node[this.na]};h.ma=function(){if(this.na+1<this.node.length){var a=this.ta;var b=this.node,c=this.i,d=this.na+1;a=Mf?Mf(a,b,c,d):Nf.call(null,a,b,c,d);return null==a?yc:a}return this.jb(null)};h.Y=function(){return this};
h.Kb=function(){var a=this.node;return new ve(a,this.na,a.length)};h.jb=function(){var a=this.i+this.node.length;if(a<Ma(this.ta)){var b=this.ta,c=Bf(this.ta,a);return Mf?Mf(b,c,a,0):Nf.call(null,b,c,a,0)}return yc};h.R=function(a,b){return b===this.D?this:Zf?Zf(this.ta,this.node,this.i,this.na,b):Nf.call(null,this.ta,this.node,this.i,this.na,b)};h.ga=function(a,b){return T(b,this)};
h.ab=function(a,b){a=this.na+b;if(a<this.node.length)return Mf?Mf(this.ta,this.node,this.i,a):Nf.call(null,this.ta,this.node,this.i,a);var c=this.i+a;if(c<Ma(this.ta)){a=c%32;b=this.ta;var d=Bf(this.ta,c);c-=a;return Mf?Mf(b,d,c,a):Nf.call(null,b,d,c,a)}return null};h.fc=function(){var a=this.i+this.node.length;if(a<Ma(this.ta)){var b=this.ta,c=Bf(this.ta,a);return Mf?Mf(b,c,a,0):Nf.call(null,b,c,a,0)}return null};Yf.prototype[Fa]=function(){return Ac(this)};
function Nf(a){switch(arguments.length){case 3:var b=arguments[0],c=arguments[1],d=arguments[2];return new Yf(b,Cf(b,c),c,d,null);case 4:return Mf(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return Zf(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}function Mf(a,b,c,d){return new Yf(a,b,c,d,null)}function Zf(a,b,c,d,e){return new Yf(a,b,c,d,e)}
function $f(a,b){return a===b.ca?b:new vf(a,Ia(b.o))}function Kf(a){return new vf({},Ia(a.o))}function Lf(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];vd(a,0,b,0,a.length);return b}var ag=function ag(a,b,c,d){c=$f(a.root.ca,c);var f=a.B-1>>>b&31;if(5===b)a=d;else{var g=c.o[f];null!=g?(b-=5,a=ag.H?ag.H(a,b,g,d):ag.call(null,a,b,g,d)):a=zf(a.root.ca,b-5,d)}c.o[f]=a;return c};
function Jf(a,b,c,d){this.B=a;this.shift=b;this.root=c;this.Z=d;this.I=88;this.A=275}h=Jf.prototype;
h.Cb=function(a,b){if(this.root.ca){if(32>this.B-yf(this))this.Z[this.B&31]=b;else{a=new vf(this.root.ca,this.Z);var c=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];c[0]=b;this.Z=c;this.B>>>5>1<<this.shift?(b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],c=this.shift+5,
b[0]=this.root,b[1]=zf(this.root.ca,this.shift,a),this.root=new vf(this.root.ca,b),this.shift=c):this.root=ag(this,this.shift,this.root,a)}this.B+=1;return this}throw Error("conj! after persistent!");};h.Rb=function(){if(this.root.ca){this.root.ca=null;var a=this.B-yf(this),b=Array(a);vd(this.Z,0,b,0,a);return new X(null,this.B,this.shift,this.root,b,null)}throw Error("persistent! called twice");};
h.Bb=function(a,b,c){if("number"===typeof b)return bg(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
function bg(a,b,c){if(a.root.ca){if(0<=b&&b<a.B){if(yf(a)<=b)a.Z[b&31]=c;else{var d=function k(f,g){g=$f(a.root.ca,g);if(0===f)g.o[b&31]=c;else{var l=b>>>f&31;f=k(f-5,g.o[l]);g.o[l]=f}return g}(a.shift,a.root);a.root=d}return a}if(b===a.B)return a.Cb(null,c);throw Error(["Index ",B.j(b)," out of bounds for TransientVector of length",B.j(a.B)].join(""));}throw Error("assoc! after persistent!");}h.$=function(){if(this.root.ca)return this.B;throw Error("count after persistent!");};
h.W=function(a,b){if(this.root.ca)return Cf(this,b)[b&31];throw Error("nth after persistent!");};h.ka=function(a,b,c){return 0<=b&&b<this.B?this.W(null,b):c};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){if(this.root.ca)return"number"===typeof b?this.ka(null,b,c):c;throw Error("lookup after persistent!");};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};function cg(){this.A=2097152;this.I=0}cg.prototype.aa=function(){return!1};var dg=new cg;
function eg(a,b){return xd(rd(b)&&!sd(b)?R(a)===R(b)?(null!=a?a.A&1048576||v===a.Xc||(a.A?0:y(xb,a)):y(xb,a))?Od(function(c,d,e){return O.m(tc(b,d,dg),e)?!0:new Kc(!1)},a):Se(function(c){return O.m(tc(b,M(c),dg),$c(c))},a):null:null)}function fg(a){this.s=a}fg.prototype.next=function(){if(null!=this.s){var a=M(this.s),b=U(a,0,null);a=U(a,1,null);this.s=N(this.s);return{value:[b,a],done:!1}}return{value:null,done:!0}};function gg(a){this.s=a}
gg.prototype.next=function(){if(null!=this.s){var a=M(this.s);this.s=N(this.s);return{value:[a,a],done:!1}}return{value:null,done:!0}};
function hg(a,b){if(b instanceof G)a:{var c=a.length;b=b.ya;for(var d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof G&&b===a[d].ya){a=d;break a}d+=2}}else if("string"===typeof b||"number"===typeof b)a:for(c=a.length,d=0;;){if(c<=d){a=-1;break a}if(b===a[d]){a=d;break a}d+=2}else if(b instanceof E)a:for(c=a.length,b=b.Wa,d=0;;){if(c<=d){a=-1;break a}if(a[d]instanceof E&&b===a[d].Wa){a=d;break a}d+=2}else if(null==b)a:for(b=a.length,c=0;;){if(b<=c){a=-1;break a}if(null==a[c]){a=c;break a}c+=2}else a:for(c=
a.length,d=0;;){if(c<=d){a=-1;break a}if(O.m(b,a[d])){a=d;break a}d+=2}return a}function If(a,b){this.key=a;this.v=b;this.F=null;this.A=166619935;this.I=0}h=If.prototype;h.lb=function(a,b){switch(b){case 0:return new If(0,this.key);case 1:return new If(1,this.v);default:return null}};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.pa=function(a,b){return this.ka(null,b,null)};h.X=function(a,b,c){return this.ka(null,b,c)};h.W=function(a,b){if(0===b)return this.key;if(1===b)return this.v;throw Error("Index out of bounds");};
h.ka=function(a,b,c){return 0===b?this.key:1===b?this.v:c};h.tb=function(a,b){return(new X(null,2,5,Y,[this.key,this.v],null)).tb(a,b)};h.P=function(){return null};h.$=function(){return 2};h.uc=function(){return this.key};h.vc=function(){return this.v};h.rb=function(){return this.v};h.sb=function(){return new X(null,1,5,Y,[this.key],null)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return null};
h.ia=function(a,b){return Oc(this,b)};h.ja=function(a,b,c){return Pc(this,b,c)};h.Oa=function(a,b,c){return V.u(new X(null,2,5,Y,[this.key,this.v],null),b,c)};h.Za=function(a,b){return 0===b||1===b};h.Y=function(){return new K([this.key,this.v],0,null)};h.R=function(a,b){return ld(new X(null,2,5,Y,[this.key,this.v],null),b)};h.ga=function(a,b){return new X(null,3,5,Y,[this.key,this.v,b],null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.W(null,a)};h.m=function(a,b){return this.ka(null,a,b)};function Qf(a){return null!=a?a.A&2048||v===a.Ld?!0:!1:!1}function ig(a,b,c){this.o=a;this.i=b;this.Ua=c;this.A=32374990;this.I=262144}h=ig.prototype;
h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.Ua};h.ha=function(){return this.i<this.o.length-2?new ig(this.o,this.i+2,null):null};h.$=function(){return(this.o.length-this.i)/2};h.ba=function(){return Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return new If(this.o[this.i],this.o[this.i+1])};h.ma=function(){return this.i<this.o.length-2?new ig(this.o,this.i+2,null):yc};h.Y=function(){return this};h.R=function(a,b){return b===this.Ua?this:new ig(this.o,this.i,b)};h.ga=function(a,b){return T(b,this)};h.ab=function(a,b){return b<this.$(null)?new ig(this.o,this.i+2*b,null):null};
ig.prototype[Fa]=function(){return Ac(this)};function jg(a,b){this.o=a;this.i=0;this.B=b}jg.prototype.qa=function(){return this.i<this.B};jg.prototype.next=function(){var a=new If(this.o[this.i],this.o[this.i+1]);this.i+=2;return a};function w(a,b,c,d){this.D=a;this.B=b;this.o=c;this.F=d;this.A=16647951;this.I=401412}h=w.prototype;h.lb=function(a,b){a=hg(this.o,b);return-1===a?null:new If(this.o[a],this.o[a+1])};h.toString=function(){return gc(this)};
h.keys=function(){return Ac(kg.j?kg.j(this):kg.call(null,this))};h.entries=function(){return new fg(H(H(this)))};h.values=function(){return Ac(lg.j?lg.j(this):lg.call(null,this))};h.has=function(a){return zd(this,a)};h.get=function(a,b){return this.X(null,a,b)};
h.forEach=function(a){for(var b=H(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),g=U(f,0,null);f=U(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=H(b))ud(b)?(c=Tb(b),b=Ub(b),g=c,d=R(c),c=g):(c=M(b),g=U(c,0,null),f=U(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=N(b),c=null,d=0),e=0;else return null};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){a=hg(this.o,b);return-1===a?c:this.o[a+1]};
h.Mb=function(a,b,c){a=this.o.length;for(var d=0;;)if(d<a){var e=this.o[d],f=this.o[d+1];c=b.u?b.u(c,e,f):b.call(null,c,e,f);if(Lc(c))return C(c);d+=2}else return c};h.Ma=function(){return new jg(this.o,2*this.B)};h.P=function(){return this.D};h.$=function(){return this.B};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Hc(this)};
h.aa=function(a,b){if(rd(b)&&!sd(b))if(a=this.o.length,this.B===b.$(null))for(var c=0;;)if(c<a){var d=b.X(null,this.o[c],wd);if(d!==wd)if(O.m(this.o[c+1],d))c+=2;else return!1;else return!1}else return!0;else return!1;else return!1};h.Ab=function(){return new mg(this.o.length,Ia(this.o))};h.fa=function(){return sb(Pe,this.D)};h.ia=function(a,b){return Ld(this,b)};h.ja=function(a,b,c){return Md(this,b,c)};
h.hc=function(a,b){if(0<=hg(this.o,b)){a=this.o.length;var c=a-2;if(0===c)return this.fa(null);c=Array(c);for(var d=0,e=0;;){if(d>=a)return new w(this.D,this.B-1,c,null);O.m(b,this.o[d])?d+=2:(c[e]=this.o[d],c[e+1]=this.o[d+1],e+=2,d+=2)}}else return this};
h.Oa=function(a,b,c){a=hg(this.o,b);if(-1===a){if(this.B<ng){a=this.o;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new w(this.D,this.B+1,e,null)}return sb(fb(nf.m(og,this),b,c),this.D)}if(c===this.o[a+1])return this;b=Ia(this.o);b[a+1]=c;return new w(this.D,this.B,b,null)};h.Za=function(a,b){return-1!==hg(this.o,b)};h.Y=function(){var a=this.o;return 0<=a.length-2?new ig(a,0,null):null};
h.R=function(a,b){return b===this.D?this:new w(b,this.B,this.o,this.F)};h.ga=function(a,b){if(td(b))return this.Oa(null,Ua(b,0),Ua(b,1));a=this;for(b=H(b);;){if(null==b)return a;var c=M(b);if(td(c))a=fb(a,Ua(c,0),Ua(c,1)),b=N(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};h.ab=function(a,b){a=this.Y(null);return null==a?null:ec(a,b)};var Pe=new w(null,0,[],Ic),ng=8;
function pg(a,b){return a===b?!0:Zd(a,b)?!0:O.m(a,b)}function qg(a){for(var b=0,c=0;;)if(b<a.length){var d;a:for(d=0;;)if(d<b){var e=pg(a[b],a[d]);if(e){d=e;break a}d=2+d}else{d=!1;break a}c=d?c:c+2;b=2+b}else return c}function rg(a,b){var c=a.length-1,d=H(b);b=Array(c+2*R(d));a=vd(a,0,b,0,c);for(b=c;;)if(d){var e=M(d);a[b]=jb(e);a[b+1]=kb(e);b=2+c;d=N(d)}else return a}
function gd(a){var b=a.length,c=1===(b&1),d;if(!(d=c))a:for(d=0;;)if(d<a.length){var e;b:for(e=0;;)if(e<d){var f=pg(a[d],a[e]);if(f){e=f;break b}e=2+e}else{e=!1;break b}if(e){d=e;break a}d=2+d}else{d=!1;break a}return d?sg(a,c):new w(null,b/2,a,null)}
function sg(a,b){var c=b?rg(a,nf.m(Pe,a[a.length-1])):a;a=qg(c);var d=c.length;if(a<d){a=Array(a);for(var e=0,f=0;;)if(e<d)(function(){for(var g=0;;)if(g<f){var k=pg(c[e],c[g]);if(k)return k;g=2+g}else return!1})()?(b=f,e=2+e,f=b):(b=function(){for(var g=d-2;;)if(g>=e){if(pg(c[e],c[g]))return g;g-=2}else return g}(),a[f]=c[e],a[f+1]=c[b+1],b=2+f,e=2+e,f=b);else break;return new w(null,a.length/2,a,null)}return new w(null,c.length/2,c,null)}w.prototype[Fa]=function(){return Ac(this)};
function mg(a,b){this.Fb={};this.xb=a;this.o=b;this.A=259;this.I=56}h=mg.prototype;h.$=function(){if(this.Fb)return Ud(this.xb);throw Error("count after persistent!");};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){if(this.Fb)return a=hg(this.o,b),-1===a?c:this.o[a+1];throw Error("lookup after persistent!");};
h.Cb=function(a,b){if(this.Fb){if(Qf(b))return this.Bb(null,Rf.j?Rf.j(b):Rf.call(null,b),Wf.j?Wf.j(b):Wf.call(null,b));if(td(b))return this.Bb(null,b.j?b.j(0):b.call(null,0),b.j?b.j(1):b.call(null,1));a=H(b);for(b=this;;){var c=M(a);if(x(c))a=N(a),b=Pb(b,Rf.j?Rf.j(c):Rf.call(null,c),Wf.j?Wf.j(c):Wf.call(null,c));else return b}}else throw Error("conj! after persistent!");};h.Rb=function(){if(this.Fb)return this.Fb=!1,new w(null,Ud(this.xb),this.o,null);throw Error("persistent! called twice");};
h.Bb=function(a,b,c){if(this.Fb){a=hg(this.o,b);if(-1===a){if(this.xb+2<=2*ng)return this.xb+=2,this.o.push(b),this.o.push(c),this;a=tg.m?tg.m(this.xb,this.o):tg.call(null,this.xb,this.o);return Pb(a,b,c)}c!==this.o[a+1]&&(this.o[a+1]=c);return this}throw Error("assoc! after persistent!");};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};
h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.X(null,a,null)};h.m=function(a,b){return this.X(null,a,b)};function tg(a,b){for(var c=Mb(og),d=0;;)if(d<a)c=Pb(c,b[d],b[d+1]),d+=2;else return c}function ug(){this.v=!1}function vg(a,b,c){a=Ia(a);a[b]=c;return a}function wg(a,b){var c=Array(a.length-2);vd(a,0,c,0,2*b);vd(a,2*(b+1),c,2*b,c.length-2*b);return c}function xg(a,b,c,d){a=a.ub(b);a.o[c]=d;return a}
function yg(a,b,c){for(var d=a.length,e=0,f=c;;)if(e<d){c=a[e];if(null!=c){var g=a[e+1];c=b.u?b.u(f,c,g):b.call(null,f,c,g)}else c=a[e+1],c=null!=c?c.wb(b,f):f;if(Lc(c))return c;e+=2;f=c}else return f}function zg(a){this.o=a;this.i=0;this.Ta=this.ac=null}zg.prototype.advance=function(){for(var a=this.o.length;;)if(this.i<a){var b=this.o[this.i],c=this.o[this.i+1];null!=b?b=this.ac=new If(b,c):null!=c?(b=dc(c),b=b.qa()?this.Ta=b:!1):b=!1;this.i+=2;if(b)return!0}else return!1};
zg.prototype.qa=function(){var a=null!=this.ac;return a?a:(a=null!=this.Ta)?a:this.advance()};zg.prototype.next=function(){if(null!=this.ac){var a=this.ac;this.ac=null;return a}if(null!=this.Ta)return a=this.Ta.next(),this.Ta.qa()||(this.Ta=null),a;if(this.advance())return this.next();throw Error("No such element");};zg.prototype.remove=function(){return Error("Unsupported operation")};function Ag(a,b,c){this.ca=a;this.da=b;this.o=c;this.I=131072;this.A=0}h=Ag.prototype;
h.ub=function(a){if(a===this.ca)return this;var b=Vd(this.da),c=Array(0>b?4:2*(b+1));vd(this.o,0,c,0,2*b);return new Ag(a,this.da,c)};h.Zb=function(){return Bg?Bg(this.o):Cg.call(null,this.o)};h.wb=function(a,b){return yg(this.o,a,b)};h.mb=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.da&e))return d;var f=Vd(this.da&e-1);e=this.o[2*f];f=this.o[2*f+1];return null==e?f.mb(a+5,b,c,d):pg(c,e)?f:d};
h.Ra=function(a,b,c,d,e,f){var g=1<<(c>>>b&31),k=Vd(this.da&g-1);if(0===(this.da&g)){var l=Vd(this.da);if(2*l<this.o.length){a=this.ub(a);b=a.o;f.v=!0;c=2*(l-k);f=2*k+(c-1);for(l=2*(k+1)+(c-1);0!==c;)b[l]=b[f],--l,--c,--f;b[2*k]=d;b[2*k+1]=e;a.da|=g;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=Dg.Ra(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0===(this.da>>>
d&1)?d+=1:(k[d]=null!=this.o[e]?Dg.Ra(a,b+5,pc(this.o[e]),this.o[e],this.o[e+1],f):this.o[e+1],e+=2,d+=1);else break;return new Eg(a,l+1,k)}b=Array(2*(l+4));vd(this.o,0,b,0,2*k);b[2*k]=d;b[2*k+1]=e;vd(this.o,2*k,b,2*(k+1),2*(l-k));f.v=!0;a=this.ub(a);a.o=b;a.da|=g;return a}l=this.o[2*k];g=this.o[2*k+1];if(null==l)return l=g.Ra(a,b+5,c,d,e,f),l===g?this:xg(this,a,2*k+1,l);if(pg(d,l))return e===g?this:xg(this,a,2*k+1,e);f.v=!0;f=b+5;d=Fg?Fg(a,f,l,g,c,d,e):Gg.call(null,a,f,l,g,c,d,e);e=2*k;k=2*k+1;a=
this.ub(a);a.o[e]=null;a.o[k]=d;return a};
h.Qa=function(a,b,c,d,e){var f=1<<(b>>>a&31),g=Vd(this.da&f-1);if(0===(this.da&f)){var k=Vd(this.da);if(16<=k){g=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];g[b>>>a&31]=Dg.Qa(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0===(this.da>>>c&1)?c+=1:(g[c]=null!=this.o[d]?Dg.Qa(a+5,pc(this.o[d]),this.o[d],this.o[d+1],e):this.o[d+1],d+=2,c+=1);else break;return new Eg(null,k+1,g)}a=Array(2*(k+1));vd(this.o,
0,a,0,2*g);a[2*g]=c;a[2*g+1]=d;vd(this.o,2*g,a,2*(g+1),2*(k-g));e.v=!0;return new Ag(null,this.da|f,a)}var l=this.o[2*g];f=this.o[2*g+1];if(null==l)return k=f.Qa(a+5,b,c,d,e),k===f?this:new Ag(null,this.da,vg(this.o,2*g+1,k));if(pg(c,l))return d===f?this:new Ag(null,this.da,vg(this.o,2*g+1,d));e.v=!0;e=this.da;k=this.o;a+=5;a=Hg?Hg(a,l,f,b,c,d):Gg.call(null,a,l,f,b,c,d);c=2*g;g=2*g+1;d=Ia(k);d[c]=null;d[g]=a;return new Ag(null,e,d)};
h.Yb=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.da&e))return d;var f=Vd(this.da&e-1);e=this.o[2*f];f=this.o[2*f+1];return null==e?f.Yb(a+5,b,c,d):pg(c,e)?new If(e,f):d};
h.$b=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.da&d))return this;var e=Vd(this.da&d-1),f=this.o[2*e],g=this.o[2*e+1];return null==f?(a=g.$b(a+5,b,c),a===g?this:null!=a?new Ag(null,this.da,vg(this.o,2*e+1,a)):this.da===d?null:new Ag(null,this.da^d,wg(this.o,e))):pg(c,f)?this.da===d?null:new Ag(null,this.da^d,wg(this.o,e)):this};h.Ma=function(){return new zg(this.o)};var Dg=new Ag(null,0,[]);function Ig(a){this.o=a;this.i=0;this.Ta=null}
Ig.prototype.qa=function(){for(var a=this.o.length;;){if(null!=this.Ta&&this.Ta.qa())return!0;if(this.i<a){var b=this.o[this.i];this.i+=1;null!=b&&(this.Ta=dc(b))}else return!1}};Ig.prototype.next=function(){if(this.qa())return this.Ta.next();throw Error("No such element");};Ig.prototype.remove=function(){return Error("Unsupported operation")};function Eg(a,b,c){this.ca=a;this.B=b;this.o=c;this.I=131072;this.A=0}h=Eg.prototype;h.ub=function(a){return a===this.ca?this:new Eg(a,this.B,Ia(this.o))};
h.Zb=function(){return Jg?Jg(this.o):Kg.call(null,this.o)};h.wb=function(a,b){for(var c=this.o.length,d=0;;)if(d<c){var e=this.o[d];if(null!=e){b=e.wb(a,b);if(Lc(b))return b;d+=1}else d+=1}else return b};h.mb=function(a,b,c,d){var e=this.o[b>>>a&31];return null!=e?e.mb(a+5,b,c,d):d};h.Ra=function(a,b,c,d,e,f){var g=c>>>b&31,k=this.o[g];if(null==k)return a=xg(this,a,g,Dg.Ra(a,b+5,c,d,e,f)),a.B+=1,a;b=k.Ra(a,b+5,c,d,e,f);return b===k?this:xg(this,a,g,b)};
h.Qa=function(a,b,c,d,e){var f=b>>>a&31,g=this.o[f];if(null==g)return new Eg(null,this.B+1,vg(this.o,f,Dg.Qa(a+5,b,c,d,e)));a=g.Qa(a+5,b,c,d,e);return a===g?this:new Eg(null,this.B,vg(this.o,f,a))};h.Yb=function(a,b,c,d){var e=this.o[b>>>a&31];return null!=e?e.Yb(a+5,b,c,d):d};
h.$b=function(a,b,c){var d=b>>>a&31,e=this.o[d];if(null!=e){a=e.$b(a+5,b,c);if(a===e)d=this;else if(null==a)if(8>=this.B)a:{e=this.o;a=e.length;b=Array(2*(this.B-1));c=0;for(var f=1,g=0;;)if(c<a)c!==d&&null!=e[c]?(b[f]=e[c],f+=2,g|=1<<c,c+=1):c+=1;else{d=new Ag(null,g,b);break a}}else d=new Eg(null,this.B-1,vg(this.o,d,a));else d=new Eg(null,this.B,vg(this.o,d,a));return d}return this};h.Ma=function(){return new Ig(this.o)};
function Lg(a,b,c){b*=2;for(var d=0;;)if(d<b){if(pg(c,a[d]))return d;d+=2}else return-1}function Mg(a,b,c,d){this.ca=a;this.eb=b;this.B=c;this.o=d;this.I=131072;this.A=0}h=Mg.prototype;h.ub=function(a){if(a===this.ca)return this;var b=Array(2*(this.B+1));vd(this.o,0,b,0,2*this.B);return new Mg(a,this.eb,this.B,b)};h.Zb=function(){return Bg?Bg(this.o):Cg.call(null,this.o)};h.wb=function(a,b){return yg(this.o,a,b)};
h.mb=function(a,b,c,d){a=Lg(this.o,this.B,c);return 0>a?d:pg(c,this.o[a])?this.o[a+1]:d};
h.Ra=function(a,b,c,d,e,f){if(c===this.eb){b=Lg(this.o,this.B,d);if(-1===b){if(this.o.length>2*this.B)return b=2*this.B,c=2*this.B+1,a=this.ub(a),a.o[b]=d,a.o[c]=e,f.v=!0,a.B+=1,a;c=this.o.length;b=Array(c+2);vd(this.o,0,b,0,c);b[c]=d;b[c+1]=e;f.v=!0;d=this.B+1;a===this.ca?(this.o=b,this.B=d,a=this):a=new Mg(this.ca,this.eb,d,b);return a}return this.o[b+1]===e?this:xg(this,a,b+1,e)}return(new Ag(a,1<<(this.eb>>>b&31),[null,this,null,null])).Ra(a,b,c,d,e,f)};
h.Qa=function(a,b,c,d,e){return b===this.eb?(a=Lg(this.o,this.B,c),-1===a?(a=2*this.B,b=Array(a+2),vd(this.o,0,b,0,a),b[a]=c,b[a+1]=d,e.v=!0,new Mg(null,this.eb,this.B+1,b)):O.m(this.o[a+1],d)?this:new Mg(null,this.eb,this.B,vg(this.o,a+1,d))):(new Ag(null,1<<(this.eb>>>a&31),[null,this])).Qa(a,b,c,d,e)};h.Yb=function(a,b,c,d){a=Lg(this.o,this.B,c);return 0>a?d:pg(c,this.o[a])?new If(this.o[a],this.o[a+1]):d};
h.$b=function(a,b,c){a=Lg(this.o,this.B,c);return-1===a?this:1===this.B?null:new Mg(null,this.eb,this.B-1,wg(this.o,Ud(a)))};h.Ma=function(){return new zg(this.o)};function Gg(a){switch(arguments.length){case 6:return Hg(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 7:return Fg(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}
function Hg(a,b,c,d,e,f){var g=pc(b);if(g===d)return new Mg(null,g,2,[b,c,e,f]);var k=new ug;return Dg.Qa(a,g,b,c,k).Qa(a,d,e,f,k)}function Fg(a,b,c,d,e,f,g){var k=pc(c);if(k===e)return new Mg(null,k,2,[c,d,f,g]);var l=new ug;return Dg.Ra(a,b,k,c,d,l).Ra(a,b,e,f,g,l)}function Ng(a,b,c,d,e){this.D=a;this.nodes=b;this.i=c;this.s=d;this.F=e;this.A=32374988;this.I=0}h=Ng.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){if(null==this.s){var a=this.nodes,b=this.i+2;return Og?Og(a,b,null):Cg.call(null,a,b,null)}a=this.nodes;b=this.i;var c=N(this.s);return Og?Og(a,b,c):Cg.call(null,a,b,c)};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return null==this.s?new If(this.nodes[this.i],this.nodes[this.i+1]):M(this.s)};
h.ma=function(){var a=this,b=null==a.s?function(){var c=a.nodes,d=a.i+2;return Og?Og(c,d,null):Cg.call(null,c,d,null)}():function(){var c=a.nodes,d=a.i,e=N(a.s);return Og?Og(c,d,e):Cg.call(null,c,d,e)}();return null!=b?b:yc};h.Y=function(){return this};h.R=function(a,b){return b===this.D?this:new Ng(b,this.nodes,this.i,this.s,this.F)};h.ga=function(a,b){return T(b,this)};Ng.prototype[Fa]=function(){return Ac(this)};
function Cg(a){switch(arguments.length){case 1:return Bg(arguments[0]);case 3:return Og(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}function Bg(a){return Og(a,0,null)}function Og(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new Ng(null,a,b,null,null);var d=a[b+1];if(x(d)&&(d=d.Zb(),x(d)))return new Ng(null,a,b+2,d,null);b+=2}else return null;else return new Ng(null,a,b,c,null)}
function Pg(a,b,c,d,e){this.D=a;this.nodes=b;this.i=c;this.s=d;this.F=e;this.A=32374988;this.I=0}h=Pg.prototype;h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){var a=this.nodes,b=this.i,c=N(this.s);return Qg?Qg(a,b,c):Kg.call(null,a,b,c)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return M(this.s)};h.ma=function(){var a=this.nodes;var b=this.i,c=N(this.s);a=Qg?Qg(a,b,c):Kg.call(null,a,b,c);return null!=a?a:yc};h.Y=function(){return this};h.R=function(a,b){return b===this.D?this:new Pg(b,this.nodes,this.i,this.s,this.F)};h.ga=function(a,b){return T(b,this)};Pg.prototype[Fa]=function(){return Ac(this)};
function Kg(a){switch(arguments.length){case 1:return Jg(arguments[0]);case 3:return Qg(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}}function Jg(a){return Qg(a,0,null)}function Qg(a,b,c){if(null==c)for(c=a.length;;)if(b<c){var d=a[b];if(x(d)&&(d=d.Zb(),x(d)))return new Pg(null,a,b+1,d,null);b+=1}else return null;else return new Pg(null,a,b,c,null)}function Rg(a,b){this.sa=a;this.Oc=b;this.Cc=!1}
Rg.prototype.qa=function(){return!this.Cc||this.Oc.qa()};Rg.prototype.next=function(){if(this.Cc)return this.Oc.next();this.Cc=!0;return new If(null,this.sa)};Rg.prototype.remove=function(){return Error("Unsupported operation")};function Sg(a,b,c,d,e,f){this.D=a;this.B=b;this.root=c;this.ra=d;this.sa=e;this.F=f;this.A=16123663;this.I=139268}h=Sg.prototype;h.lb=function(a,b){return null==b?this.ra?new If(null,this.sa):null:null==this.root?null:this.root.Yb(0,pc(b),b,null)};h.toString=function(){return gc(this)};
h.keys=function(){return Ac(kg.j?kg.j(this):kg.call(null,this))};h.entries=function(){return new fg(H(H(this)))};h.values=function(){return Ac(lg.j?lg.j(this):lg.call(null,this))};h.has=function(a){return zd(this,a)};h.get=function(a,b){return this.X(null,a,b)};
h.forEach=function(a){for(var b=H(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),g=U(f,0,null);f=U(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=H(b))ud(b)?(c=Tb(b),b=Ub(b),g=c,d=R(c),c=g):(c=M(b),g=U(c,0,null),f=U(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=N(b),c=null,d=0),e=0;else return null};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return null==b?this.ra?this.sa:c:null==this.root?c:this.root.mb(0,pc(b),b,c)};
h.Mb=function(a,b,c){a=this.ra?b.u?b.u(c,null,this.sa):b.call(null,c,null,this.sa):c;return Lc(a)?C(a):null!=this.root?Mc(this.root.wb(b,a)):a};h.Ma=function(){var a=this.root?dc(this.root):new Re(Pe);return this.ra?new Rg(this.sa,a):a};h.P=function(){return this.D};h.$=function(){return this.B};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Hc(this)};h.aa=function(a,b){return eg(this,b)};h.Ab=function(){return new Tg(this.root,this.B,this.ra,this.sa)};h.fa=function(){return sb(og,this.D)};
h.hc=function(a,b){if(null==b)return this.ra?new Sg(this.D,this.B-1,this.root,!1,null,null):this;if(null==this.root)return this;a=this.root.$b(0,pc(b),b);return a===this.root?this:new Sg(this.D,this.B-1,a,this.ra,this.sa,null)};h.Oa=function(a,b,c){if(null==b)return this.ra&&c===this.sa?this:new Sg(this.D,this.ra?this.B:this.B+1,this.root,!0,c,null);a=new ug;b=(null==this.root?Dg:this.root).Qa(0,pc(b),b,c,a);return b===this.root?this:new Sg(this.D,a.v?this.B+1:this.B,b,this.ra,this.sa,null)};
h.Za=function(a,b){return null==b?this.ra:null==this.root?!1:this.root.mb(0,pc(b),b,wd)!==wd};h.Y=function(){if(0<this.B){var a=null!=this.root?this.root.Zb():null;return this.ra?T(new If(null,this.sa),a):a}return null};h.R=function(a,b){return b===this.D?this:new Sg(b,this.B,this.root,this.ra,this.sa,this.F)};
h.ga=function(a,b){if(td(b))return this.Oa(null,Ua(b,0),Ua(b,1));a=this;for(b=H(b);;){if(null==b)return a;var c=M(b);if(td(c))a=fb(a,Ua(c,0),Ua(c,1)),b=N(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};
h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};var og=new Sg(null,0,null,!1,null,Ic);Sg.prototype[Fa]=function(){return Ac(this)};function Tg(a,b,c,d){this.ca={};this.root=a;this.count=b;this.ra=c;this.sa=d;this.A=259;this.I=56}
function Ug(a,b,c){if(a.ca){if(null==b)a.sa!==c&&(a.sa=c),a.ra||(a.count+=1,a.ra=!0);else{var d=new ug;b=(null==a.root?Dg:a.root).Ra(a.ca,0,pc(b),b,c,d);b!==a.root&&(a.root=b);d.v&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}h=Tg.prototype;h.$=function(){if(this.ca)return this.count;throw Error("count after persistent!");};h.pa=function(a,b){return null==b?this.ra?this.sa:null:null==this.root?null:this.root.mb(0,pc(b),b)};
h.X=function(a,b,c){return null==b?this.ra?this.sa:c:null==this.root?c:this.root.mb(0,pc(b),b,c)};h.Cb=function(a,b){a:if(this.ca)if(Qf(b))a=Ug(this,Rf.j?Rf.j(b):Rf.call(null,b),Wf.j?Wf.j(b):Wf.call(null,b));else if(td(b))a=Ug(this,b.j?b.j(0):b.call(null,0),b.j?b.j(1):b.call(null,1));else for(a=H(b),b=this;;){var c=M(a);if(x(c))a=N(a),b=Ug(b,Rf.j?Rf.j(c):Rf.call(null,c),Wf.j?Wf.j(c):Wf.call(null,c));else{a=b;break a}}else throw Error("conj! after persistent");return a};
h.Rb=function(){if(this.ca){this.ca=null;var a=new Sg(null,this.count,this.root,this.ra,this.sa,null)}else throw Error("persistent! called twice");return a};h.Bb=function(a,b,c){return Ug(this,b,c)};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};
h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};function Vg(a,b,c){for(var d=b;;)if(null!=a)b=c?a.left:a.right,d=bd.m(d,a),a=b;else return d}function Wg(a,b,c,d,e){this.D=a;this.stack=b;this.ob=c;this.B=d;this.F=e;this.A=32374990;this.I=0}h=Wg.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.D};h.ha=function(){var a=M(this.stack);a=Vg(this.ob?a.right:a.left,N(this.stack),this.ob);return null==a?null:new Wg(null,a,this.ob,this.B-1,null)};h.$=function(){return 0>this.B?R(N(this))+1:this.B};
h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){var a=this.stack;return null==a?null:nb(a)};h.ma=function(){var a=M(this.stack);a=Vg(this.ob?a.right:a.left,N(this.stack),this.ob);return null!=a?new Wg(null,a,this.ob,this.B-1,null):yc};h.Y=function(){return this};
h.R=function(a,b){return b===this.D?this:new Wg(b,this.stack,this.ob,this.B,this.F)};h.ga=function(a,b){return T(b,this)};Wg.prototype[Fa]=function(){return Ac(this)};function Xg(a,b,c,d){return c instanceof Z?c.left instanceof Z?new Z(c.key,c.v,c.left.Xa(),new Yg(a,b,c.right,d)):c.right instanceof Z?new Z(c.right.key,c.right.v,new Yg(c.key,c.v,c.left,c.right.left),new Yg(a,b,c.right.right,d)):new Yg(a,b,c,d):new Yg(a,b,c,d)}
function Zg(a,b,c,d){return d instanceof Z?d.right instanceof Z?new Z(d.key,d.v,new Yg(a,b,c,d.left),d.right.Xa()):d.left instanceof Z?new Z(d.left.key,d.left.v,new Yg(a,b,c,d.left.left),new Yg(d.key,d.v,d.left.right,d.right)):new Yg(a,b,c,d):new Yg(a,b,c,d)}
function $g(a,b,c,d){if(c instanceof Z)return new Z(a,b,c.Xa(),d);if(d instanceof Yg)return Zg(a,b,c,d.cc());if(d instanceof Z&&d.left instanceof Yg)return new Z(d.left.key,d.left.v,new Yg(a,b,c,d.left.left),Zg(d.key,d.v,d.left.right,d.right.cc()));throw Error("red-black tree invariant violation");}
function ah(a,b,c,d){if(d instanceof Z)return new Z(a,b,c,d.Xa());if(c instanceof Yg)return Xg(a,b,c.cc(),d);if(c instanceof Z&&c.right instanceof Yg)return new Z(c.right.key,c.right.v,Xg(c.key,c.v,c.left.cc(),c.right.left),new Yg(a,b,c.right.right,d));throw Error("red-black tree invariant violation");}
var bh=function bh(a,b,c){var e=null!=a.left?function(){var k=a.left;return bh.u?bh.u(k,b,c):bh.call(null,k,b,c)}():c;if(Lc(e))return e;var f=function(){var k=a.key,l=a.v;return b.u?b.u(e,k,l):b.call(null,e,k,l)}();if(Lc(f))return f;if(null!=a.right){var g=a.right;return bh.u?bh.u(g,b,f):bh.call(null,g,b,f)}return f};function Yg(a,b,c,d){this.key=a;this.v=b;this.left=c;this.right=d;this.F=null;this.A=166619935;this.I=0}h=Yg.prototype;
h.lb=function(a,b){switch(b){case 0:return new If(0,this.key);case 1:return new If(1,this.v);default:return null}};h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();h.Ec=function(a){return a.Gc(this)};h.cc=function(){return new Z(this.key,this.v,this.left,this.right)};h.Xa=function(){return this};h.Dc=function(a){return a.Fc(this)};h.replace=function(a,b,c,d){return new Yg(a,b,c,d)};
h.Fc=function(a){return new Yg(a.key,a.v,this,a.right)};h.Gc=function(a){return new Yg(a.key,a.v,a.left,this)};h.wb=function(a,b){return bh(this,a,b)};h.pa=function(a,b){return this.ka(null,b,null)};h.X=function(a,b,c){return this.ka(null,b,c)};h.W=function(a,b){if(0===b)return this.key;if(1===b)return this.v;throw Error("Index out of bounds");};h.ka=function(a,b,c){return 0===b?this.key:1===b?this.v:c};h.tb=function(a,b){return(new X(null,2,5,Y,[this.key,this.v],null)).tb(a,b)};h.P=function(){return null};
h.$=function(){return 2};h.uc=function(){return this.key};h.vc=function(){return this.v};h.rb=function(){return this.v};h.sb=function(){return new X(null,1,5,Y,[this.key],null)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return null};h.ia=function(a,b){return Oc(this,b)};h.ja=function(a,b,c){return Pc(this,b,c)};h.Oa=function(a,b,c){return V.u(new X(null,2,5,Y,[this.key,this.v],null),b,c)};
h.Za=function(a,b){return 0===b||1===b};h.Y=function(){return new K([this.key,this.v],0,null)};h.R=function(a,b){return sb(new X(null,2,5,Y,[this.key,this.v],null),b)};h.ga=function(a,b){return new X(null,3,5,Y,[this.key,this.v,b],null)};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};
h.j=function(a){return this.W(null,a)};h.m=function(a,b){return this.ka(null,a,b)};Yg.prototype[Fa]=function(){return Ac(this)};function Z(a,b,c,d){this.key=a;this.v=b;this.left=c;this.right=d;this.F=null;this.A=166619935;this.I=0}h=Z.prototype;h.lb=function(a,b){switch(b){case 0:return new If(0,this.key);case 1:return new If(1,this.v);default:return null}};
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();h.Ec=function(a){return new Z(this.key,this.v,this.left,a)};h.cc=function(){throw Error("red-black tree invariant violation");};h.Xa=function(){return new Yg(this.key,this.v,this.left,this.right)};
h.Dc=function(a){return new Z(this.key,this.v,a,this.right)};h.replace=function(a,b,c,d){return new Z(a,b,c,d)};h.Fc=function(a){return this.left instanceof Z?new Z(this.key,this.v,this.left.Xa(),new Yg(a.key,a.v,this.right,a.right)):this.right instanceof Z?new Z(this.right.key,this.right.v,new Yg(this.key,this.v,this.left,this.right.left),new Yg(a.key,a.v,this.right.right,a.right)):new Yg(a.key,a.v,this,a.right)};
h.Gc=function(a){return this.right instanceof Z?new Z(this.key,this.v,new Yg(a.key,a.v,a.left,this.left),this.right.Xa()):this.left instanceof Z?new Z(this.left.key,this.left.v,new Yg(a.key,a.v,a.left,this.left.left),new Yg(this.key,this.v,this.left.right,this.right)):new Yg(a.key,a.v,a.left,this)};h.wb=function(a,b){return bh(this,a,b)};h.pa=function(a,b){return this.ka(null,b,null)};h.X=function(a,b,c){return this.ka(null,b,c)};
h.W=function(a,b){if(0===b)return this.key;if(1===b)return this.v;throw Error("Index out of bounds");};h.ka=function(a,b,c){return 0===b?this.key:1===b?this.v:c};h.tb=function(a,b){return(new X(null,2,5,Y,[this.key,this.v],null)).tb(a,b)};h.P=function(){return null};h.$=function(){return 2};h.uc=function(){return this.key};h.vc=function(){return this.v};h.rb=function(){return this.v};h.sb=function(){return new X(null,1,5,Y,[this.key],null)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return null};h.ia=function(a,b){return Oc(this,b)};h.ja=function(a,b,c){return Pc(this,b,c)};h.Oa=function(a,b,c){return V.u(new X(null,2,5,Y,[this.key,this.v],null),b,c)};h.Za=function(a,b){return 0===b||1===b};h.Y=function(){return new K([this.key,this.v],0,null)};h.R=function(a,b){return sb(new X(null,2,5,Y,[this.key,this.v],null),b)};h.ga=function(a,b){return new X(null,3,5,Y,[this.key,this.v,b],null)};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.W(null,a)};h.m=function(a,b){return this.ka(null,a,b)};Z.prototype[Fa]=function(){return Ac(this)};
var ch=function ch(a,b,c,d,e){if(null==b)return new Z(c,d,null,null);var g=function(){var k=b.key;return a.m?a.m(c,k):a.call(null,c,k)}();if(0===g)return e[0]=b,null;if(0>g)return g=function(){var k=b.left;return ch.U?ch.U(a,k,c,d,e):ch.call(null,a,k,c,d,e)}(),null!=g?b.Dc(g):null;g=function(){var k=b.right;return ch.U?ch.U(a,k,c,d,e):ch.call(null,a,k,c,d,e)}();return null!=g?b.Ec(g):null},dh=function dh(a,b){if(null==a)return b;if(null==b)return a;if(a instanceof Z){if(b instanceof Z){var d=function(){var e=
a.right,f=b.left;return dh.m?dh.m(e,f):dh.call(null,e,f)}();return d instanceof Z?new Z(d.key,d.v,new Z(a.key,a.v,a.left,d.left),new Z(b.key,b.v,d.right,b.right)):new Z(a.key,a.v,a.left,new Z(b.key,b.v,d,b.right))}return new Z(a.key,a.v,a.left,function(){var e=a.right;return dh.m?dh.m(e,b):dh.call(null,e,b)}())}if(b instanceof Z)return new Z(b.key,b.v,function(){var e=b.left;return dh.m?dh.m(a,e):dh.call(null,a,e)}(),b.right);d=function(){var e=a.right,f=b.left;return dh.m?dh.m(e,f):dh.call(null,
e,f)}();return d instanceof Z?new Z(d.key,d.v,new Yg(a.key,a.v,a.left,d.left),new Yg(b.key,b.v,d.right,b.right)):$g(a.key,a.v,a.left,new Yg(b.key,b.v,d,b.right))},eh=function eh(a,b,c,d){if(null!=b){var f=function(){var g=b.key;return a.m?a.m(c,g):a.call(null,c,g)}();if(0===f)return d[0]=b,dh(b.left,b.right);if(0>f)return f=function(){var g=b.left;return eh.H?eh.H(a,g,c,d):eh.call(null,a,g,c,d)}(),null!=f||null!=d[0]?b.left instanceof Yg?$g(b.key,b.v,f,b.right):new Z(b.key,b.v,f,b.right):null;f=function(){var g=
b.right;return eh.H?eh.H(a,g,c,d):eh.call(null,a,g,c,d)}();return null!=f||null!=d[0]?b.right instanceof Yg?ah(b.key,b.v,b.left,f):new Z(b.key,b.v,b.left,f):null}return null},fh=function fh(a,b,c,d){var f=b.key,g=a.m?a.m(c,f):a.call(null,c,f);return 0===g?b.replace(f,d,b.left,b.right):0>g?b.replace(f,b.v,function(){var k=b.left;return fh.H?fh.H(a,k,c,d):fh.call(null,a,k,c,d)}(),b.right):b.replace(f,b.v,b.left,function(){var k=b.right;return fh.H?fh.H(a,k,c,d):fh.call(null,a,k,c,d)}())};
function gh(a,b,c,d,e){this.Pa=a;this.nb=b;this.B=c;this.D=d;this.F=e;this.A=418776847;this.I=8192}h=gh.prototype;h.lb=function(a,b){return hh(this,b)};h.forEach=function(a){for(var b=H(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),g=U(f,0,null);f=U(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=H(b))ud(b)?(c=Tb(b),b=Ub(b),g=c,d=R(c),c=g):(c=M(b),g=U(c,0,null),f=U(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=N(b),c=null,d=0),e=0;else return null};h.get=function(a,b){return this.X(null,a,b)};
h.entries=function(){return new fg(H(H(this)))};h.toString=function(){return gc(this)};h.keys=function(){return Ac(kg.j?kg.j(this):kg.call(null,this))};h.values=function(){return Ac(lg.j?lg.j(this):lg.call(null,this))};function hh(a,b){for(var c=a.nb;;)if(null!=c){var d=c.key;d=a.Pa.m?a.Pa.m(b,d):a.Pa.call(null,b,d);if(0===d)return c;c=0>d?c.left:c.right}else return null}h.has=function(a){return zd(this,a)};h.pa=function(a,b){return this.X(null,b,null)};
h.X=function(a,b,c){a=hh(this,b);return null!=a?a.v:c};h.Mb=function(a,b,c){return null!=this.nb?Mc(bh(this.nb,b,c)):c};h.P=function(){return this.D};h.$=function(){return this.B};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Hc(this)};h.aa=function(a,b){return eg(this,b)};h.fa=function(){return new gh(this.Pa,null,0,this.D,0)};h.hc=function(a,b){a=[null];b=eh(this.Pa,this.nb,b,a);return null==b?null==Vc(a,0)?this:new gh(this.Pa,null,0,this.D,null):new gh(this.Pa,b.Xa(),this.B-1,this.D,null)};
h.Oa=function(a,b,c){a=[null];var d=ch(this.Pa,this.nb,b,c,a);return null==d?(a=Vc(a,0),O.m(c,a.v)?this:new gh(this.Pa,fh(this.Pa,this.nb,b,c),this.B,this.D,null)):new gh(this.Pa,d.Xa(),this.B+1,this.D,null)};h.Za=function(a,b){return null!=hh(this,b)};h.Y=function(){if(0<this.B){var a=this.B;a=new Wg(null,Vg(this.nb,null,!0),!0,a,null)}else a=null;return a};h.R=function(a,b){return b===this.D?this:new gh(this.Pa,this.nb,this.B,b,this.F)};
h.ga=function(a,b){if(td(b))return this.Oa(null,Ua(b,0),Ua(b,1));a=this;for(b=H(b);;){if(null==b)return a;var c=M(b);if(td(c))a=fb(a,Ua(c,0),Ua(c,1)),b=N(b);else throw Error("conj on a map takes map entries or seqables of map entries");}};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};
h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};var ih=new gh(Ad,null,0,null,Ic);gh.prototype[Fa]=function(){return Ac(this)};function jh(a){for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;a:for(b=H(0<b.length?new K(b.slice(0),0,null):null),d=ih;;)if(b)c=N(N(b)),d=V.u(d,M(b),$c(b)),b=c;else break a;return d}function kh(a,b){this.S=a;this.Ua=b;this.A=32374988;this.I=0}h=kh.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.Ua};h.ha=function(){var a=(null!=this.S?this.S.A&128||v===this.S.Pb||(this.S.A?0:y(Ya,this.S)):y(Ya,this.S))?this.S.ha(null):N(this.S);return null==a?null:new kh(a,null)};h.ba=function(){return Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return this.S.la(null).key};h.ma=function(){var a=(null!=this.S?this.S.A&128||v===this.S.Pb||(this.S.A?0:y(Ya,this.S)):y(Ya,this.S))?this.S.ha(null):N(this.S);return null!=a?new kh(a,null):yc};h.Y=function(){return this};h.R=function(a,b){return b===this.Ua?this:new kh(this.S,b)};h.ga=function(a,b){return T(b,this)};kh.prototype[Fa]=function(){return Ac(this)};
function kg(a){return(a=H(a))?new kh(a,null):null}function Rf(a){return jb(a)}function lh(a,b){this.S=a;this.Ua=b;this.A=32374988;this.I=0}h=lh.prototype;h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.P=function(){return this.Ua};h.ha=function(){var a=(null!=this.S?this.S.A&128||v===this.S.Pb||(this.S.A?0:y(Ya,this.S)):y(Ya,this.S))?this.S.ha(null):N(this.S);return null==a?null:new lh(a,null)};h.ba=function(){return Fc(this)};
h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};h.ja=function(a,b,c){return Kd(b,c,this)};h.la=function(){return this.S.la(null).v};h.ma=function(){var a=(null!=this.S?this.S.A&128||v===this.S.Pb||(this.S.A?0:y(Ya,this.S)):y(Ya,this.S))?this.S.ha(null):N(this.S);return null!=a?new lh(a,null):yc};h.Y=function(){return this};h.R=function(a,b){return b===this.Ua?this:new lh(this.S,b)};h.ga=function(a,b){return T(b,this)};lh.prototype[Fa]=function(){return Ac(this)};
function lg(a){return(a=H(a))?new lh(a,null):null}function Wf(a){return kb(a)}var mh=function mh(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return mh.C(0<c.length?new K(c.slice(0),0,null):null)};mh.C=function(a){return x(Te(Pd,a))?Nd(function(b,c){return bd.m(x(b)?b:Pe,c)},a):null};mh.M=0;mh.N=function(a){return this.C(H(a))};function nh(a,b){var c=Pe;for(b=H(b);;)if(b){var d=M(b),e=tc(a,d,oh);c=O.m(e,oh)?c:V.u(c,d,e);b=N(b)}else return sb(c,md(a))}
function rh(a){this.Gb=a}rh.prototype.qa=function(){return this.Gb.qa()};rh.prototype.next=function(){if(this.Gb.qa())return this.Gb.next().key;throw Error("No such element");};rh.prototype.remove=function(){return Error("Unsupported operation")};function sh(a,b,c){this.D=a;this.gb=b;this.F=c;this.A=15077647;this.I=139268}h=sh.prototype;h.toString=function(){return gc(this)};h.keys=function(){return Ac(H(this))};h.entries=function(){return new gg(H(H(this)))};h.values=function(){return Ac(H(this))};
h.has=function(a){return zd(this,a)};h.forEach=function(a){for(var b=H(this),c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e),g=U(f,0,null);f=U(f,1,null);a.m?a.m(f,g):a.call(null,f,g);e+=1}else if(b=H(b))ud(b)?(c=Tb(b),b=Ub(b),g=c,d=R(c),c=g):(c=M(b),g=U(c,0,null),f=U(c,1,null),a.m?a.m(f,g):a.call(null,f,g),b=N(b),c=null,d=0),e=0;else return null};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){a=gb(this.gb,b);return x(a)?jb(a):c};h.Ma=function(){return new rh(dc(this.gb))};h.P=function(){return this.D};
h.$=function(){return Ma(this.gb)};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Hc(this)};h.aa=function(a,b){if(a=pd(b))if(a=R(this)===R(b))try{return Od(function(c,d){return(c=zd(b,d))?c:new Kc(!1)},this.gb)}catch(c){if(c instanceof Error)return!1;throw c;}else return a;else return a};h.Ab=function(){return new th(Mb(this.gb))};h.fa=function(){return sb(xh,this.D)};h.Kc=function(a,b){return new sh(this.D,ib(this.gb,b),null)};h.Y=function(){return kg(this.gb)};
h.R=function(a,b){return b===this.D?this:new sh(b,this.gb,this.F)};h.ga=function(a,b){return new sh(this.D,V.u(this.gb,b,null),null)};h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return this.pa(null,a)};h.m=function(a,b){return this.X(null,a,b)};
var xh=new sh(null,Pe,Ic);sh.prototype[Fa]=function(){return Ac(this)};function th(a){this.yb=a;this.I=136;this.A=259}h=th.prototype;h.Cb=function(a,b){this.yb=Pb(this.yb,b,null);return this};h.Rb=function(){return new sh(null,Ob(this.yb),null)};h.$=function(){return R(this.yb)};h.pa=function(a,b){return this.X(null,b,null)};h.X=function(a,b,c){return bb(this.yb,b,wd)===wd?c:b};
h.call=function(a){switch(arguments.length-1){case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.j=function(a){return bb(this.yb,a,wd)===wd?null:a};h.m=function(a,b){return bb(this.yb,a,wd)===wd?b:a};
function yh(a){if(pd(a))return ld(a,null);a=H(a);if(null==a)return xh;if(a instanceof K&&0===a.i){a=a.o;for(var b=a.length,c=Mb(xh),d=0;;)if(d<b)Nb(c,a[d]),d+=1;else break;return Ob(c)}for(c=Mb(xh);;)if(null!=a)b=N(a),c=Nb(c,Wa(a)),a=b;else return Ob(c)}function zh(a){for(var b=dd;;)if(N(a))b=bd.m(b,M(a)),a=N(a);else return H(b)}function ce(a){if(null!=a&&(a.I&4096||v===a.$c))return a.Nb(null);if("string"===typeof a)return a;throw Error(["Doesn't support name: ",B.j(a)].join(""));}
function Ah(a,b){var c=Mb(Pe);a=H(a);for(b=H(b);;)if(a&&b){var d=M(a),e=M(b);c=Pb(c,d,e);a=N(a);b=N(b)}else return Ob(c)}var Bh=function Bh(a){switch(arguments.length){case 2:return Bh.m(arguments[0],arguments[1]);case 3:return Bh.u(arguments[0],arguments[1],arguments[2]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Bh.C(arguments[0],arguments[1],arguments[2],3<c.length?new K(c.slice(3),0,null):null)}};Bh.m=function(a,b){return b};
Bh.u=function(a,b,c){return(a.j?a.j(b):a.call(null,b))>(a.j?a.j(c):a.call(null,c))?b:c};Bh.C=function(a,b,c,d){return Gd(function(e,f){return Bh.u(a,e,f)},Bh.u(a,b,c),d)};Bh.N=function(a){var b=M(a),c=N(a);a=M(c);var d=N(c);c=M(d);d=N(d);return this.C(b,a,c,d)};Bh.M=3;function Ch(a,b,c){return new de(null,function(){var d=H(c);return d?T(gf.m(a,d),Ch(a,b,hf(b,d))):null},null)}function Dh(a,b,c){this.start=a;this.step=b;this.count=c;this.A=82;this.I=0}h=Dh.prototype;h.$=function(){return this.count};
h.la=function(){return this.start};h.W=function(a,b){return this.start+b*this.step};h.ka=function(a,b,c){return 0<=b&&b<this.count?this.start+b*this.step:c};h.tc=function(){if(1>=this.count)throw Error("-drop-first of empty chunk");return new Dh(this.start+this.step,this.step,this.count-1)};function Eh(a,b,c){this.i=a;this.end=b;this.step=c}Eh.prototype.qa=function(){return 0<this.step?this.i<this.end:this.i>this.end};Eh.prototype.next=function(){var a=this.i;this.i+=this.step;return a};
function Fh(a,b,c,d,e,f){this.D=a;this.start=b;this.end=c;this.step=d;this.B=e;this.F=f;this.A=32375006;this.I=402944}h=Fh.prototype;h.toString=function(){return gc(this)};h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();h.W=function(a,b){if(0<=b&&b<this.$(null))return this.start+b*this.step;if(0<=b&&this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};
h.ka=function(a,b,c){return 0<=b&&b<this.$(null)?this.start+b*this.step:0<=b&&this.start>this.end&&0===this.step?this.start:c};h.Ma=function(){return new Eh(this.start,this.end,this.step)};h.P=function(){return this.D};
h.ha=function(){return 0<this.step?this.start+this.step<this.end?new Fh(null,this.start+this.step,this.end,this.step,Math.ceil((this.end-(this.start+this.step))/this.step),null):null:this.start+this.step>this.end?new Fh(null,this.start+this.step,this.end,this.step,Math.ceil((this.end-(this.start+this.step))/this.step),null):null};h.$=function(){return this.B};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};
h.ia=function(a,b){return Oc(this,b)};h.ja=function(a,b,c){for(a=this.start;;)if(0<this.step?a<this.end:a>this.end){c=b.m?b.m(c,a):b.call(null,c,a);if(Lc(c))return C(c);a+=this.step}else return c};h.la=function(){return this.start};h.ma=function(){var a=this.ha(null);return null==a?yc:a};h.Y=function(){return this};h.Kb=function(){var a=this.B;return new Dh(this.start,this.step,32>a?a:32)};
h.jb=function(){if(32>=this.B)return yc;var a=this.start+32*this.step;return 0<this.step?this.end<=a?yc:new Fh(null,a,this.end,this.step,Math.ceil((this.end-a)/this.step),null):0>this.step?this.end>=a?yc:new Fh(null,a,this.end,this.step,Math.ceil((this.end-a)/this.step),null):this.end===a?yc:new jf(null,-1,a,null)};h.R=function(a,b){return b===this.D?this:new Fh(b,this.start,this.end,this.step,this.B,this.F)};h.ga=function(a,b){return T(b,this)};
h.ab=function(a,b){return 0<b?b<this.B?new Fh(null,this.start+this.step*b,this.end,this.step,this.B-b,null):null:this};h.fc=function(){return H(this.jb(null))};Fh.prototype[Fa]=function(){return Ac(this)};function Gh(a,b,c,d,e,f,g){this.D=a;this.start=b;this.end=c;this.step=d;this.O=e;this.ec=f;this.F=g;this.I=140800;this.A=32374988}h=Gh.prototype;h.toString=function(){return gc(this)};
h.indexOf=function(){var a=null;a=function(b,c){switch(arguments.length){case 1:return P(this,b,0);case 2:return P(this,b,c)}throw Error("Invalid arity: "+arguments.length);};a.j=function(b){return P(this,b,0)};a.m=function(b,c){return P(this,b,c)};return a}();
h.lastIndexOf=function(){function a(c){return S(this,c,R(this))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return S(this,c,d)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return S(this,c,d)};return b}();
function Hh(a){if(null==a.O){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];a:{var c=0;for(var d=a.start;;)if(32>c){if(b[c]=d,c+=1,d+=a.step,!(0<a.step?d<a.end:d>a.end)){c=a.O=new ve(b,0,c);break a}}else{c=d;break a}}null==a.O&&(a.O=new ve(b,0,32),(0<a.step?c<a.end:c>a.end)&&(a.ec=new Gh(null,c,a.end,a.step,null,null,null)))}}h.Ma=function(){return new Eh(this.start,this.end,this.step)};
h.P=function(){return this.D};h.ha=function(){return 0<this.step?this.start+this.step<this.end?new Gh(null,this.start+this.step,this.end,this.step,null,null,null):null:this.start+this.step>this.end?new Gh(null,this.start+this.step,this.end,this.step,null,null,null):null};h.ba=function(){var a=this.F;return null!=a?a:this.F=a=Fc(this)};h.aa=function(a,b){return Yc(this,b)};h.fa=function(){return yc};h.ia=function(a,b){return Fd(b,this)};
h.ja=function(a,b,c){for(a=this.start;;)if(0<this.step?a<this.end:a>this.end){c=b.m?b.m(c,a):b.call(null,c,a);if(Lc(c))return C(c);a+=this.step}else return c};h.la=function(){return this.start};h.ma=function(){var a=this.ha(null);return null==a?yc:a};h.Y=function(){return this};h.Kb=function(){Hh(this);return this.O};h.jb=function(){Hh(this);return null==this.ec?yc:this.ec};h.R=function(a,b){return b===this.D?this:new Gh(b,this.start,this.end,this.step,this.O,this.ec,this.F)};
h.ga=function(a,b){return T(b,this)};h.fc=function(){return H(this.jb(null))};Gh.prototype[Fa]=function(){return Ac(this)};function Ih(a,b){return b<=a?yc:yd(a)&&yd(b)&&yd(1)?new Fh(null,a,b,1,Math.ceil(b-a),null):new Gh(null,a,b,1,null,null,null)}
function Jh(){return function(){function a(g,k,l){return new X(null,2,5,Y,[zh.u?zh.u(g,k,l):zh.call(null,g,k,l),ad.u?ad.u(g,k,l):ad.call(null,g,k,l)],null)}function b(g,k){return new X(null,2,5,Y,[zh.m?zh.m(g,k):zh.call(null,g,k),ad.m?ad.m(g,k):ad.call(null,g,k)],null)}function c(g){return new X(null,2,5,Y,[zh.j?zh.j(g):zh.call(null,g),ad.j?ad.j(g):ad.call(null,g)],null)}function d(){return new X(null,2,5,Y,[zh.G?zh.G():zh.call(null),ad.G?ad.G():ad.call(null)],null)}var e=null,f=function(){function g(l,
m,n,p){var q=null;if(3<arguments.length){q=0;for(var r=Array(arguments.length-3);q<r.length;)r[q]=arguments[q+3],++q;q=new K(r,0,null)}return k.call(this,l,m,n,q)}function k(l,m,n,p){return new X(null,2,5,Y,[Me(zh,l,m,n,p),Me(ad,l,m,n,p)],null)}g.M=3;g.N=function(l){var m=M(l);l=N(l);var n=M(l);l=N(l);var p=M(l);l=xc(l);return k(m,n,p,l)};g.C=k;return g}();e=function(g,k,l,m){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,g);case 2:return b.call(this,g,k);case 3:return a.call(this,
g,k,l);default:var n=null;if(3<arguments.length){n=0;for(var p=Array(arguments.length-3);n<p.length;)p[n]=arguments[n+3],++n;n=new K(p,0,null)}return f.C(g,k,l,n)}throw Error("Invalid arity: "+arguments.length);};e.M=3;e.N=f.N;e.G=d;e.j=c;e.m=b;e.u=a;e.C=f.C;return e}()}function Kh(a){for(;;)if(a=H(a))a=N(a);else break}
function Lh(a,b,c,d,e,f,g){var k=sa;sa=null==sa?null:sa-1;try{if(null!=sa&&0>sa)return Jb(a,"#");Jb(a,c);if(0===ya.j(f))H(g)&&Jb(a,function(){var r=Mh.j(f);return x(r)?r:"..."}());else{if(H(g)){var l=M(g);b.u?b.u(l,a,f):b.call(null,l,a,f)}for(var m=N(g),n=ya.j(f)-1;;)if(!m||null!=n&&0===n){H(m)&&0===n&&(Jb(a,d),Jb(a,function(){var r=Mh.j(f);return x(r)?r:"..."}()));break}else{Jb(a,d);var p=M(m);c=a;g=f;b.u?b.u(p,c,g):b.call(null,p,c,g);var q=N(m);c=n-1;m=q;n=c}}return Jb(a,e)}finally{sa=k}}
function Nh(a,b){b=H(b);for(var c=null,d=0,e=0;;)if(e<d){var f=c.W(null,e);Jb(a,f);e+=1}else if(b=H(b))c=b,ud(c)?(b=Tb(c),d=Ub(c),c=b,f=R(b),b=d,d=f):(f=M(c),Jb(a,f),b=N(c),c=null,d=0),e=0;else return null}var Oh={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function Ph(a){return['"',B.j(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(b){return Oh[b]})),'"'].join("")}
function Qh(a,b){return(a=xd(F(a,wa)))?(a=null!=b?b.A&131072||v===b.wc?!0:!1:!1)?null!=md(b):a:a}
function Rh(a,b,c){if(null==a)return Jb(b,"nil");if(Qh(c,a)){Jb(b,"^");var d=md(a);Sh.u?Sh.u(d,b,c):Sh.call(null,d,b,c);Jb(b," ")}if(a.kd)return a.Od(a,b,c);if(null!=a?a.A&2147483648||v===a.ea||(a.A?0:y(Kb,a)):y(Kb,a))return Lb(a,b,c);if(!0===a||!1===a)return Jb(b,B.j(a));if("number"===typeof a)return Jb(b,isNaN(a)?"##NaN":a===Number.POSITIVE_INFINITY?"##Inf":a===Number.NEGATIVE_INFINITY?"##-Inf":B.j(a));if(null!=a&&a.constructor===Object)return Jb(b,"#js "),d=ff.m(function(f){var g=/[A-Za-z_\*\+\?!\-'][\w\*\+\?!\-']*/;
if("string"===typeof f)g=g.exec(f),g=null!=g&&O.m(g[0],f)?1===g.length?g[0]:Pf(g):null;else throw new TypeError("re-matches must match against a string.");return new If(null!=g?be.j(f):f,a[f])},ka(a)),Th.H?Th.H(d,Sh,b,c):Th.call(null,d,Sh,b,c);if(za(a))return Lh(b,Sh,"#js ["," ","]",c,a);if("string"===typeof a)return x(va.j(c))?Jb(b,Ph(a)):Jb(b,a);if("function"===typeof a){var e=a.name;c=x(function(){var f=null==e;return f?f:ja(e)}())?"Function":e;return Nh(b,Zc(["#object[",c,x(!1)?[' "',B.j(a),'"'].join(""):
"","]"]))}if(a instanceof Date)return c=function(f,g){for(f=B.j(f);;)if(f.length<g)f=["0",f].join("");else return f},Nh(b,Zc(['#inst "',c(a.getUTCFullYear(),4),"-",c(a.getUTCMonth()+1,2),"-",c(a.getUTCDate(),2),"T",c(a.getUTCHours(),2),":",c(a.getUTCMinutes(),2),":",c(a.getUTCSeconds(),2),".",c(a.getUTCMilliseconds(),3),"-",'00:00"']));if(a instanceof RegExp)return Nh(b,Zc(['#"',a.source,'"']));if("symbol"===u(a)||"undefined"!==typeof Symbol&&a instanceof Symbol)return Nh(b,Zc(["#object[",a.toString(),
"]"]));if(x(function(){var f=null==a?null:a.constructor;return null==f?null:f.Ac}()))return Nh(b,Zc(["#object[",a.constructor.Ac.replace(RegExp("/","g"),"."),"]"]));e=function(){var f=null==a?null:a.constructor;return null==f?null:f.name}();c=x(function(){var f=null==e;return f?f:ja(e)}())?"Object":e;return null==a.constructor?Nh(b,Zc(["#object[",c,"]"])):Nh(b,Zc(["#object[",c," ",B.j(a),"]"]))}
function Sh(a,b,c){var d=Uh.j(c);return x(d)?(c=V.u(c,Vh,Rh),d.u?d.u(a,b,c):d.call(null,a,b,c)):Rh(a,b,c)}function Wh(a){var b=ta();if(od(a))b="";else{var c=B,d=c.j,e=new ra,f=new fc(e);Sh(M(a),f,b);a=H(N(a));for(var g=null,k=0,l=0;;)if(l<k){var m=g.W(null,l);Jb(f," ");Sh(m,f,b);l+=1}else if(a=H(a))g=a,ud(g)?(a=Tb(g),k=Ub(g),g=a,m=R(a),a=k,k=m):(m=M(g),Jb(f," "),Sh(m,f,b),a=N(g),g=null,k=0),l=0;else break;b=d.call(c,e)}return b}
function Xh(a){return a instanceof E?uc.m(null,ce(a)):be.m(null,ce(a))}
function Yh(a){if(x(!1)){var b=H(a),c=H(b),d=M(c);N(c);U(d,0,null);U(d,1,null);c=null==a?null:null!=a&&(a.A&4||v===a.Uc)?a.fa(null):(null!=a?a.A&4||v===a.Uc||(a.A?0:y(Na,a)):y(Na,a))?Oa(a):null;for(a=null;;){d=a;b=H(b);a=M(b);var e=N(b),f=a;a=U(f,0,null);b=U(f,1,null);if(x(f))if(a instanceof G||a instanceof E)if(x(d))if(O.m(d,$d(a)))c=V.u(c,Xh(a),b),a=d,b=e;else return null;else if(d=$d(a),x(d))c=V.u(c,Xh(a),b),a=d,b=e;else return null;else return null;else return new X(null,2,5,Y,[d,c],null)}}else return null}
function Zh(a,b,c,d,e){return Lh(d,function(f,g,k){var l=jb(f);c.u?c.u(l,g,k):c.call(null,l,g,k);Jb(g," ");f=kb(f);return c.u?c.u(f,g,k):c.call(null,f,g,k)},[B.j(a),"{"].join(""),", ","}",e,H(b))}function Th(a,b,c,d){var e=rd(a)?Yh(a):null,f=U(e,0,null);e=U(e,1,null);return x(f)?Zh(["#:",B.j(f)].join(""),e,b,c,d):Zh(null,a,b,c,d)}ef.prototype.ea=v;ef.prototype.V=function(a,b,c){Jb(b,"#object[cljs.core.Volatile ");Sh(new w(null,1,[$h,this.state],null),b,c);return Jb(b,"]")};K.prototype.ea=v;
K.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};de.prototype.ea=v;de.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};If.prototype.ea=v;If.prototype.V=function(a,b,c){return Lh(b,Sh,"["," ","]",c,this)};Wg.prototype.ea=v;Wg.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Ng.prototype.ea=v;Ng.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Yg.prototype.ea=v;Yg.prototype.V=function(a,b,c){return Lh(b,Sh,"["," ","]",c,this)};
ig.prototype.ea=v;ig.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Bc.prototype.ea=v;Bc.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Yf.prototype.ea=v;Yf.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Xd.prototype.ea=v;Xd.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Fh.prototype.ea=v;Fh.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Sg.prototype.ea=v;Sg.prototype.V=function(a,b,c){return Th(this,Sh,b,c)};
Pg.prototype.ea=v;Pg.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};gh.prototype.ea=v;gh.prototype.V=function(a,b,c){return Th(this,Sh,b,c)};sh.prototype.ea=v;sh.prototype.V=function(a,b,c){return Lh(b,Sh,"#{"," ","}",c,this)};xe.prototype.ea=v;xe.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Ye.prototype.ea=v;Ye.prototype.V=function(a,b,c){Jb(b,"#object[cljs.core.Atom ");Sh(new w(null,1,[$h,this.state],null),b,c);return Jb(b,"]")};lh.prototype.ea=v;
lh.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};Z.prototype.ea=v;Z.prototype.V=function(a,b,c){return Lh(b,Sh,"["," ","]",c,this)};jf.prototype.ea=v;jf.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};X.prototype.ea=v;X.prototype.V=function(a,b,c){return Lh(b,Sh,"["," ","]",c,this)};Wd.prototype.ea=v;Wd.prototype.V=function(a,b){return Jb(b,"()")};w.prototype.ea=v;w.prototype.V=function(a,b,c){return Th(this,Sh,b,c)};Gh.prototype.ea=v;
Gh.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};kh.prototype.ea=v;kh.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};ed.prototype.ea=v;ed.prototype.V=function(a,b,c){return Lh(b,Sh,"("," ",")",c,this)};E.prototype.qb=v;E.prototype.$a=function(a,b){if(b instanceof E)return rc(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};G.prototype.qb=v;
G.prototype.$a=function(a,b){if(b instanceof G)return Yd(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};X.prototype.qb=v;X.prototype.$a=function(a,b){if(td(b))return Bd(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};If.prototype.qb=v;If.prototype.$a=function(a,b){if(td(b))return Bd(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};Yg.prototype.qb=v;
Yg.prototype.$a=function(a,b){if(td(b))return Bd(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};Z.prototype.qb=v;Z.prototype.$a=function(a,b){if(td(b))return Bd(this,b);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};function ai(a){this.f=a;this.value=null;this.A=2147516416;this.I=1}ai.prototype.kb=function(){x(this.f)&&(this.value=this.f.G?this.f.G():this.f.call(null),this.f=null);return this.value};
ai.prototype.V=function(a,b,c){Jb(b,"#object[cljs.core.Delay ");Sh(new w(null,2,[bi,null==this.f?ci:di,$h,this.value],null),b,c);return Jb(b,"]")};function ei(){}function fi(a){if(null!=a&&null!=a.Wc)a=a.Wc(a);else{var b=fi[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=fi._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("IEncodeJS.-clj-\x3ejs",a);}return a}
function gi(a,b){return(null!=a?v===a.Vc||(a.Nc?0:y(ei,a)):y(ei,a))?fi(a):"string"===typeof a||"number"===typeof a||a instanceof G||a instanceof E?b.j?b.j(a):b.call(null,a):Wh(Zc([a]))}var hi=function hi(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return hi.C(arguments[0],1<c.length?new K(c.slice(1),0,null):null)};
hi.C=function(a,b){b=Oe(b);var c=tc(b,ii,ce),d=function g(f){if(null==f)return null;if(null!=f?v===f.Vc||(f.Nc?0:y(ei,f)):y(ei,f))return fi(f);if(f instanceof G)return c.j?c.j(f):c.call(null,f);if(f instanceof E)return B.j(f);if(rd(f)){var k={};f=H(f);for(var l=null,m=0,n=0;;)if(n<m){var p=l.W(null,n),q=U(p,0,null),r=U(p,1,null);p=k;q=gi(q,d);r=g(r);p[q]=r;n+=1}else if(f=H(f))ud(f)?(m=Tb(f),f=Ub(f),l=m,m=R(m)):(l=M(f),m=U(l,0,null),n=U(l,1,null),l=k,m=gi(m,d),n=g(n),l[m]=n,f=N(f),l=null,m=0),n=0;
else break;return k}if(null==f?0:null!=f?f.A&8||v===f.Fd||(f.A?0:y(Pa,f)):y(Pa,f)){k=[];f=H(ff.m(g,f));l=null;for(n=m=0;;)if(n<m)p=l.W(null,n),k.push(p),n+=1;else if(f=H(f))l=f,ud(l)?(f=Tb(l),n=Ub(l),l=f,m=R(f),f=n):(f=M(l),k.push(f),f=N(l),l=null,m=0),n=0;else break;return k}return f};return d(a)};hi.M=1;hi.N=function(a){var b=M(a);a=N(a);return this.C(b,a)};
var ji=function ji(a){switch(arguments.length){case 0:return ji.G();case 1:return ji.j(arguments[0]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};ji.G=function(){return ji.j(1)};ji.j=function(a){return Math.random()*a};ji.M=1;function ki(a){return Math.floor(Math.random()*a)}var li=null;function mi(){null==li&&(li=Ze(new w(null,3,[ni,Pe,oi,Pe,pi,Pe],null)));return li}
function qi(a,b,c){var d=O.m(b,c);if(d)return d;d=pi.j(a);d=d.j?d.j(b):d.call(null,b);if(!(d=zd(d,c))&&(d=td(c)))if(d=td(b))if(d=R(c)===R(b)){d=!0;for(var e=0;;)if(d&&e!==R(c))d=qi(a,b.j?b.j(e):b.call(null,e),c.j?c.j(e):c.call(null,e)),e+=1;else return d}else return d;else return d;else return d}function ri(a){var b=C(mi());return Qe(F(ni.j(b),a))}function si(a,b,c,d){df.m(a,function(){return C(b)});df.m(c,function(){return C(d)})}
var ti=function ti(a,b,c){var e=function(){var f=C(c);return f.j?f.j(a):f.call(null,a)}();e=x(x(e)?e.j?e.j(b):e.call(null,b):e)?!0:null;if(x(e))return e;e=function(){for(var f=ri(b);;)if(0<R(f)){var g=M(f);ti.u?ti.u(a,g,c):ti.call(null,a,g,c);f=xc(f)}else return null}();if(x(e))return e;e=function(){for(var f=ri(a);;)if(0<R(f)){var g=M(f);ti.u?ti.u(g,b,c):ti.call(null,g,b,c);f=xc(f)}else return null}();return x(e)?e:!1};function ui(a,b,c,d){c=ti(a,b,c);return x(c)?c:qi(d,a,b)}
var vi=function vi(a,b,c,d,e,f,g,k){var m=Gd(function(p,q){var r=U(q,0,null);U(q,1,null);if(qi(C(c),b,r)){p=null==p||ui(r,M(p),e,C(c))?q:p;if(!ui(M(p),r,e,C(c)))throw Error(["Multiple methods in multimethod '",B.j(a),"' match dispatch value: ",B.j(b)," -\x3e ",B.j(r)," and ",B.j(M(p)),", and neither is preferred"].join(""));return p}return p},null,C(d)),n=function(){var p;if(p=null==m)p=C(d),p=p.j?p.j(k):p.call(null,k);return x(p)?new X(null,2,5,Y,[k,p],null):m}();if(x(n)){if(O.m(C(g),C(c)))return df.H(f,
V,b,$c(n)),$c(n);si(f,d,g,c);return vi.wa?vi.wa(a,b,c,d,e,f,g,k):vi.call(null,a,b,c,d,e,f,g,k)}return null};function wi(a,b){throw Error(["No method in multimethod '",B.j(a),"' for dispatch value: ",B.j(b)].join(""));}function xi(a,b,c,d,e,f,g){var k=yi;this.name=a;this.K=b;this.nd=k;this.nc=c;this.pc=d;this.Ad=e;this.oc=f;this.dc=g;this.A=4194305;this.I=4352}h=xi.prototype;
h.call=function(a){switch(arguments.length-1){case 0:return this.G();case 1:return this.j(arguments[1]);case 2:return this.m(arguments[1],arguments[2]);case 3:return this.u(arguments[1],arguments[2],arguments[3]);case 4:return this.H(arguments[1],arguments[2],arguments[3],arguments[4]);case 5:return this.U(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);case 6:return this.oa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);case 7:return this.Ka(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);case 8:return this.wa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);case 9:return this.La(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);case 10:return this.za(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10]);
case 11:return this.Aa(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]);case 12:return this.Ba(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12]);case 13:return this.Ca(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],
arguments[11],arguments[12],arguments[13]);case 14:return this.Da(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14]);case 15:return this.Ea(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]);case 16:return this.Fa(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16]);case 17:return this.Ga(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17]);case 18:return this.Ha(arguments[1],arguments[2],
arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18]);case 19:return this.Ia(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19]);case 20:return this.Ja(arguments[1],
arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],arguments[18],arguments[19],arguments[20]);case 21:return this.Lb(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15],arguments[16],arguments[17],
arguments[18],arguments[19],arguments[20],arguments[21]);default:throw Error(["Invalid arity: ",B.j(arguments.length-1)].join(""));}};h.apply=function(a,b){return this.call.apply(this,[this].concat(Ia(b)))};h.G=function(){var a=this.K.G?this.K.G():this.K.call(null),b=zi(this,a);x(b)||wi(this.name,a);return b.G?b.G():b.call(null)};h.j=function(a){var b=this.K.j?this.K.j(a):this.K.call(null,a),c=zi(this,b);x(c)||wi(this.name,b);return c.j?c.j(a):c.call(null,a)};
h.m=function(a,b){var c=this.K.m?this.K.m(a,b):this.K.call(null,a,b),d=zi(this,c);x(d)||wi(this.name,c);return d.m?d.m(a,b):d.call(null,a,b)};h.u=function(a,b,c){var d=this.K.u?this.K.u(a,b,c):this.K.call(null,a,b,c),e=zi(this,d);x(e)||wi(this.name,d);return e.u?e.u(a,b,c):e.call(null,a,b,c)};h.H=function(a,b,c,d){var e=this.K.H?this.K.H(a,b,c,d):this.K.call(null,a,b,c,d),f=zi(this,e);x(f)||wi(this.name,e);return f.H?f.H(a,b,c,d):f.call(null,a,b,c,d)};
h.U=function(a,b,c,d,e){var f=this.K.U?this.K.U(a,b,c,d,e):this.K.call(null,a,b,c,d,e),g=zi(this,f);x(g)||wi(this.name,f);return g.U?g.U(a,b,c,d,e):g.call(null,a,b,c,d,e)};h.oa=function(a,b,c,d,e,f){var g=this.K.oa?this.K.oa(a,b,c,d,e,f):this.K.call(null,a,b,c,d,e,f),k=zi(this,g);x(k)||wi(this.name,g);return k.oa?k.oa(a,b,c,d,e,f):k.call(null,a,b,c,d,e,f)};
h.Ka=function(a,b,c,d,e,f,g){var k=this.K.Ka?this.K.Ka(a,b,c,d,e,f,g):this.K.call(null,a,b,c,d,e,f,g),l=zi(this,k);x(l)||wi(this.name,k);return l.Ka?l.Ka(a,b,c,d,e,f,g):l.call(null,a,b,c,d,e,f,g)};h.wa=function(a,b,c,d,e,f,g,k){var l=this.K.wa?this.K.wa(a,b,c,d,e,f,g,k):this.K.call(null,a,b,c,d,e,f,g,k),m=zi(this,l);x(m)||wi(this.name,l);return m.wa?m.wa(a,b,c,d,e,f,g,k):m.call(null,a,b,c,d,e,f,g,k)};
h.La=function(a,b,c,d,e,f,g,k,l){var m=this.K.La?this.K.La(a,b,c,d,e,f,g,k,l):this.K.call(null,a,b,c,d,e,f,g,k,l),n=zi(this,m);x(n)||wi(this.name,m);return n.La?n.La(a,b,c,d,e,f,g,k,l):n.call(null,a,b,c,d,e,f,g,k,l)};h.za=function(a,b,c,d,e,f,g,k,l,m){var n=this.K.za?this.K.za(a,b,c,d,e,f,g,k,l,m):this.K.call(null,a,b,c,d,e,f,g,k,l,m),p=zi(this,n);x(p)||wi(this.name,n);return p.za?p.za(a,b,c,d,e,f,g,k,l,m):p.call(null,a,b,c,d,e,f,g,k,l,m)};
h.Aa=function(a,b,c,d,e,f,g,k,l,m,n){var p=this.K.Aa?this.K.Aa(a,b,c,d,e,f,g,k,l,m,n):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n),q=zi(this,p);x(q)||wi(this.name,p);return q.Aa?q.Aa(a,b,c,d,e,f,g,k,l,m,n):q.call(null,a,b,c,d,e,f,g,k,l,m,n)};h.Ba=function(a,b,c,d,e,f,g,k,l,m,n,p){var q=this.K.Ba?this.K.Ba(a,b,c,d,e,f,g,k,l,m,n,p):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p),r=zi(this,q);x(r)||wi(this.name,q);return r.Ba?r.Ba(a,b,c,d,e,f,g,k,l,m,n,p):r.call(null,a,b,c,d,e,f,g,k,l,m,n,p)};
h.Ca=function(a,b,c,d,e,f,g,k,l,m,n,p,q){var r=this.K.Ca?this.K.Ca(a,b,c,d,e,f,g,k,l,m,n,p,q):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q),t=zi(this,r);x(t)||wi(this.name,r);return t.Ca?t.Ca(a,b,c,d,e,f,g,k,l,m,n,p,q):t.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q)};
h.Da=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r){var t=this.K.Da?this.K.Da(a,b,c,d,e,f,g,k,l,m,n,p,q,r):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r),z=zi(this,t);x(z)||wi(this.name,t);return z.Da?z.Da(a,b,c,d,e,f,g,k,l,m,n,p,q,r):z.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r)};
h.Ea=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t){var z=this.K.Ea?this.K.Ea(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t),D=zi(this,z);x(D)||wi(this.name,z);return D.Ea?D.Ea(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t):D.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t)};
h.Fa=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z){var D=this.K.Fa?this.K.Fa(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z),I=zi(this,D);x(I)||wi(this.name,D);return I.Fa?I.Fa(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z):I.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z)};
h.Ga=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D){var I=this.K.Ga?this.K.Ga(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D),J=zi(this,I);x(J)||wi(this.name,I);return J.Ga?J.Ga(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D):J.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D)};
h.Ha=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I){var J=this.K.Ha?this.K.Ha(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I),Q=zi(this,J);x(Q)||wi(this.name,J);return Q.Ha?Q.Ha(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I):Q.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I)};
h.Ia=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J){var Q=this.K.Ia?this.K.Ia(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J),da=zi(this,Q);x(da)||wi(this.name,Q);return da.Ia?da.Ia(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J):da.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J)};
h.Ja=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q){var da=this.K.Ja?this.K.Ja(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q):this.K.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q),na=zi(this,da);x(na)||wi(this.name,da);return na.Ja?na.Ja(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q):na.call(null,a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q)};
h.Lb=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da){var na=Ne(this.K,a,b,c,d,Zc([e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da])),Sa=zi(this,na);x(Sa)||wi(this.name,na);return Ne(Sa,a,b,c,d,Zc([e,f,g,k,l,m,n,p,q,r,t,z,D,I,J,Q,da]))};function Ai(a,b,c){df.H(a.pc,V,b,c);si(a.oc,a.pc,a.dc,a.nc)}function zi(a,b){O.m(C(a.dc),C(a.nc))||si(a.oc,a.pc,a.dc,a.nc);var c=C(a.oc);c=c.j?c.j(b):c.call(null,b);return x(c)?c:vi(a.name,b,a.nc,a.pc,a.Ad,a.oc,a.dc,a.nd)}h.Nb=function(){return Vb(this.name)};h.Ob=function(){return Wb(this.name)};
h.ba=function(){return ba(this)};function Bi(a){this.uuid=a;this.F=null;this.A=2153775104;this.I=2048}h=Bi.prototype;h.jd=v;h.toString=function(){return this.uuid};h.aa=function(a,b){return(a=null!=b?v===b.jd?!0:!1:!1)?this.uuid===b.uuid:a};h.V=function(a,b){return Jb(b,['#uuid "',B.j(this.uuid),'"'].join(""))};h.ba=function(){null==this.F&&(this.F=pc(this.uuid));return this.F};
h.$a=function(a,b){if(b instanceof Bi)return pa(this.uuid,b.uuid);throw Error(["Cannot compare ",B.j(this)," to ",B.j(b)].join(""));};function Ci(){function a(){var d=ki(65536).toString(16);switch(d.length){case 1:return["000",d].join("");case 2:return["00",d].join("");case 3:return["0",d].join("");default:return d}}var b=(16384|4095&ki(65536)).toString(16),c=(32768|16383&ki(65536)).toString(16);return new Bi([a(),a(),"-",a(),"-",b,"-",c,"-",a(),a(),a()].join("").toLowerCase())}
function Di(){var a=new w(null,1,[Ei,"floor"],null),b=Error("Unexpected Null passed to floor");this.message="Unexpected Null passed to floor";this.data=a;this.cause=null;this.name=b.name;this.description=b.description;this.number=b.number;this.fileName=b.fileName;this.lineNumber=b.lineNumber;this.columnNumber=b.columnNumber;this.stack=b.stack;return this}Di.prototype.__proto__=Error.prototype;Di.prototype.ea=v;
Di.prototype.V=function(a,b,c){Jb(b,"#error {:message ");Sh(this.message,b,c);x(this.data)&&(Jb(b,", :data "),Sh(this.data,b,c));x(this.cause)&&(Jb(b,", :cause "),Sh(this.cause,b,c));return Jb(b,"}")};Di.prototype.toString=function(){return gc(this)};
function Fi(){x(Ha)||(Ha=function(){for(var a=Dd(function(e,f){return f.length-e.length},ka(Ga)),b="";;)if(H(a)){var c=N(a),d=[function(){var e=b;return""!==b?[e,"|"].join(""):e}(),B.j(M(a))].join("");a=c;b=d}else return[b,"|\\$"].join("")}());return Ha}
function Gi(a){var b=B.j(a);if("_DOT__DOT_"===b)var c="..";else a:{c=new RegExp(Fi(),"g");var d=b.length-1;d=0<=d&&b.indexOf("$",d)==d;b=x(d)?b.substring(0,b.length-1):b;d="";for(var e=0;;){var f=c.exec(b);if(x(f))f=U(f,0,null),d=[d,B.j(b.substring(e,c.lastIndex-f.length)),B.j("$"===f?"/":null!==Ga&&f in Ga?Ga[f]:void 0)].join(""),e=c.lastIndex;else{c=[d,B.j(b.substring(e,b.length))].join("");break a}}}a=a instanceof E?uc:B;return a.j?a.j(c):a.call(null,c)};var Hi=new G(null,"left","left",-399115937),Ii=new G(null,"size","size",1098693007),Ji=new G(null,"mousemotion","mousemotion",633012383),Ki=new G(null,"warning-reporting","warning-reporting",-319054391),Li=new G(null,"string","string",-1989541586),Mi=new E(null,"fn*","fn*",-752876845,null),xa=new G(null,"dup","dup",556298533),Ni=new E(null,"p1__25052#","p1__25052#",-1959271766,null),bi=new G(null,"status","status",-1997798413),Oi=new G("cljs.spec.alpha","nil","cljs.spec.alpha/nil",1733813950),Pi=
new G(null,"right","right",-452581833),Qi=new G("cljs.spec.alpha","k","cljs.spec.alpha/k",-1602615178),Ri=new G(null,"keyup","keyup",-794526927),Si=new E("cljs.core","array?","cljs.core/array?",-1655912448,null),Ti=new G(null,"rot","rot",757545242),Ui=new E(null,"p1__25053#","p1__25053#",1552782151,null),va=new G(null,"readably","readably",1129599760),Vi=new G(null,"throw-errors-from-macro-call-sites","throw-errors-from-macro-call-sites",-1338743049),Wi=new E("cljs.core","map","cljs.core/map",-338988913,
null),Xi=new E("cljs.core","fn","cljs.core/fn",-1065745098,null),Yi=new G("cljs.spec.alpha","v","cljs.spec.alpha/v",552625740),Ei=new G(null,"fn","fn",-1175266204),Zi=new G(null,"amp","amp",271690571),$i=new G(null,"priority","priority",1431093715),aj=new G(null,"kind","kind",-717265803),bj=new G(null,"index","index",-1531685915),di=new G(null,"pending","pending",-220036727),yi=new G(null,"default","default",-1987822328),cj=new G(null,"movement","movement",1777030977),dj=new E(null,"get-soft-access",
"get-soft-access",-1996253487,null),ej=new E("cljs.spec.alpha","valid?","cljs.spec.alpha/valid?",-142132235,null),fj=new G(null,"dt","dt",-368444759),gj=new G(null,"unexpected-punching-selector","unexpected-punching-selector",-1934135338),hj=new E("cljs.core","every?","cljs.core/every?",1416822717,null),ij=new G(null,"map","map",1371690461),jj=new G(null,"err","err",-2089457205),kj=new E("cljs.core","and","cljs.core/and",-6692549,null),lj=new G(null,"path","path",-188191168),mj=new E(null,"pairs",
"pairs",-2039825990,null),nj=new E("cljs.core","string?","cljs.core/string?",-2072921719,null),oj=new G(null,"expected-function-value","expected-function-value",-1399123630),pj=new E("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),rj=new G(null,"water","water",-824098213),sj=new G(null,"error","error",-978969032),tj=new G("oops.sdefs","obj-selector","oops.sdefs/obj-selector",655346305),uj=new G(null,"animated-cube","animated-cube",-1828399922),Aj=new G(null,"ps","ps",292358046),
Bj=new G(null,"unexpected-soft-selector","unexpected-soft-selector",-1117708580),Cj=new G(null,"jitter","jitter",1262097060),Dj=new E(null,"get-dot-access","get-dot-access",-1468450704,null),Ej=new G("cljs.spec.alpha","name","cljs.spec.alpha/name",205233570),Fj=new G(null,"sequential","sequential",-1082983960),Gj=new G(null,"object-is-sealed","object-is-sealed",-1791813926),Hj=new G(null,"down","down",1565245570),Ij=new G(null,"p1","p1",-936759954),Jj=new G(null,"p2","p2",905500641),ni=new G(null,
"parents","parents",-2027538891),Kj=new G(null,"heightmap","heightmap",98736499),Lj=new G(null,"ret","ret",-468222814),Mj=new G(null,"ks","ks",1900203942),Nj=new G("cljs.spec.alpha","amp","cljs.spec.alpha/amp",831147508),Oj=new G(null,"soft?","soft?",-1339668477),Pj=new G(null,"keyword","keyword",811389747),Qj=new G("cljs.spec.alpha","alt","cljs.spec.alpha/alt",523685437),Rj=new G(null,"flavor","flavor",-1331636636),Sj=new G(null,"prevent-defaults","prevent-defaults",977810460),Tj=new G(null,"movement-input",
"movement-input",-130525905),Uj=new G(null,"atom","atom",-397043653),Vj=new G(null,"id","id",-1388402092),Wj=new G(null,"set","set",304602554),Xj=new G(null,"rgbe","rgbe",1667899839),ci=new G(null,"ready","ready",1086465795),Yj=new E("cljs.core","partition-all","cljs.core/partition-all",1634835208,null),Zj=new G(null,"input-event-queue","input-event-queue",259007233),wa=new G(null,"meta","meta",1499536964),ak=new E(null,"%","%",-950237169,null),ya=new G(null,"print-length","print-length",1931866356),
bk=new G(null,"object-key-not-writable","object-key-not-writable",206336031),ck=new E(null,"get-punch-access","get-punch-access",1112963648,null),dk=new G(null,"w","w",354169001),ek=new G(null,"s","s",1705939918),pi=new G(null,"ancestors","ancestors",-776045424),fk=new E(null,"arr","arr",2115492975,null),gk=new G(null,"js-obj","js-obj",-1298148277),hk=new G("cljs.spec.alpha","kvs-\x3emap","cljs.spec.alpha/kvs-\x3emap",579713455),ik=new G("oops.sdefs","obj-key","oops.sdefs/obj-key",-2004347356),jk=
new G(null,"frozen?","frozen?",613726824),kk=new G(null,"up","up",-269712113),lk=new E(null,"k","k",-505765866,null),mk=new G(null,"aspect-ratio","aspect-ratio",1674013504),nk=new G(null,"d","d",1972142424),ok=new E(null,"v","v",1661996586,null),pk=new E("cljs.spec.alpha","*","cljs.spec.alpha/*",-1238084288,null),qk=new G(null,"a","a",-2123407586),rk=new E("cljs.spec.alpha","conformer","cljs.spec.alpha/conformer",2140085535,null),sk=new G(null,"error-reporting","error-reporting",1274700782),tk=new G(null,
"object-is-frozen","object-is-frozen",-1391578096),uk=new G(null,"time-offset","time-offset",-887969635),vk=new G(null,"hierarchy","hierarchy",-1053470341),wk=new G(null,"console","console",1228072057),xk=new G("oops.sdefs","obj-path-item","oops.sdefs/obj-path-item",-77633674),Vh=new G(null,"fallback-impl","fallback-impl",-1501286995),yk=new G(null,"global-start-time","global-start-time",688057299),zk=new G(null,"warn","warn",-436710552),Ak=new G(null,"vel","vel",-110770822),Bk=new G(null,"cat-statue",
"cat-statue",1295333163),Ck=new G("cljs.spec.alpha","pcat","cljs.spec.alpha/pcat",26406623),Dk=new G(null,"unexpected-empty-selector","unexpected-empty-selector",-572791900),ii=new G(null,"keyword-fn","keyword-fn",-64566675),Ek=new E("cljs.core","vec","cljs.core/vec",307622519,null),Fk=new G(null,"selector","selector",762528866),Gk=new G(null,"regex","regex",939488856),Hk=new G("cljs.spec.alpha","rep","cljs.spec.alpha/rep",1483217317),Ik=new G("cljs.spec.alpha","op","cljs.spec.alpha/op",-1269055252),
Jk=new G(null,"entities","entities",1940967403),Kk=new E("cljs.core","partial","cljs.core/partial",1483172485,null),Lk=new G(null,"mousedown","mousedown",1391242074),Mk=new G(null,"terrain","terrain",704966005),Nk=new G(null,"texture","texture",-266291651),Ok=new E("cljs.spec.alpha","or","cljs.spec.alpha/or",-831679639,null),oi=new G(null,"descendants","descendants",1824886031),oh=new G("cljs.core","not-found","cljs.core/not-found",-1572889185),Pk=new G(null,"gltf","gltf",-1691489846),Qk=new G(null,
"forms","forms",2045992350),Rk=new E(null,"native-array-aware-*","native-array-aware-*",97903386,null),Sk=new G(null,"skybox-texture","skybox-texture",1273007034),$h=new G(null,"val","val",128701612),Tk=new G("oops.sdefs","obj-path","oops.sdefs/obj-path",692461382),Uk=new G(null,"unexpected-object-value","unexpected-object-value",-1214439301),Vk=new E("cljs.core","let","cljs.core/let",-308701135,null),ua=new G(null,"flush-on-newline","flush-on-newline",-151457939),Wk=new E("cljs.spec.alpha","and",
"cljs.spec.alpha/and",-2060279705,null),Xk=new G("cljs.spec.alpha","accept","cljs.spec.alpha/accept",370988198),Yk=new E("cljs.core","keyword?","cljs.core/keyword?",713156450,null),Zk=new G(null,"keydown","keydown",-629268186),$k=new G(null,"time","time",1385887882),al=new G(null,"use-envelope","use-envelope",-2007197780),bl=new G(null,"render-size","render-size",1170061277),cl=new G(null,"recur","recur",-437573268),dl=new G(null,"throw","throw",-1044625833),el=new G("oops.sdefs","obj-path-mode",
"oops.sdefs/obj-path-mode",1253821198),fl=new G("oops.sdefs","obj-path-key","oops.sdefs/obj-path-key",-1566573562),gl=new G("cljs.spec.alpha","unknown","cljs.spec.alpha/unknown",651034818),hl=new G(null,"camera-id","camera-id",-951302676),il=new G(null,"native-array","native-array",1549686442),jl=new G(null,"child-factory","child-factory",-1019029066),kl=new G(null,"fps-camera","fps-camera",1005589701),Mh=new G(null,"more-marker","more-marker",-14717935),ll=new G(null,"missing-object-key","missing-object-key",
-1300201731),ml=new G(null,"pos","pos",-864607220),nl=new G(null,"invalid-selector","invalid-selector",1262807990),ol=new G(null,"splice","splice",449588165),pl=new G(null,"button","button",1456579943),ql=new G(null,"key","key",-1516042587),rl=new E("cljs.core","zipmap","cljs.core/zipmap",-1902130674,null),Uh=new G(null,"alt-impl","alt-impl",670969595),sl=new G(null,"rep+","rep+",-281382396),tl=new G("cljs.spec.alpha","gfn","cljs.spec.alpha/gfn",-593120375),ul=new G("cljs.spec.alpha","invalid","cljs.spec.alpha/invalid",
-1220295119),vl=new G(null,"water-normals","water-normals",1952975825),wl=new G(null,"sun","sun",-916295498);function xl(a){var b=new ra;for(a=H(a);;)if(null!=a)b.append(B.j(M(a))),a=N(a),null!=a&&b.append(".");else return b.toString()}function yl(a){a="/(?:)/"===B.j("$")?bd.m(Pf(T("",ff.m(B,H(a)))),""):Pf(B.j(a).split("$"));if(1<R(a))a:for(;;)if(""===(null==a?null:nb(a)))a=null==a?null:ob(a);else break a;return a};function zl(a,b){if(null!=a&&null!=a.Db)a=a.Db(a,b);else{var c=zl[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=zl._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("Spec.conform*",a);}return a}function Al(a,b){if(null!=a&&null!=a.Eb)a=a.Eb(a,b);else{var c=Al[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Al._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("Spec.with-gen*",a);}return a}var Bl=Ze(Pe);
function Cl(a){if(ae(a)){var b=C(Bl);a=F(b,a);if(ae(a))a:for(;;)if(ae(a))a=F(b,a);else{b=a;break a}else b=a;return b}return a}function Dl(a){if(ae(a)){var b=Cl(a);if(x(b))return b;throw Error(["Unable to resolve spec: ",B.j(a)].join(""));}return a}function El(a){return null!=a&&v===a.Vb?a:null}function Fl(a){var b=Ik.j(a);return x(b)?a:b}function Gl(a,b){return ae(a)?a:x(Fl(a))?V.u(a,Ej,b):null!=a&&(a.A&131072||v===a.wc)?ld(a,V.u(md(a),Ej,b)):null}
function Hl(a){return ae(a)?a:x(Fl(a))?Ej.j(a):null!=a&&(a.A&131072||v===a.wc)?Ej.j(md(a)):null}function Il(a){var b=function(){var c=(c=ae(a))?Cl(a):c;if(x(c))return c;c=El(a);if(x(c))return c;c=Fl(a);return x(c)?c:null}();return x(Fl(b))?Gl(Jl(b,null),Hl(b)):b}function Kl(a){var b=Il(a);if(x(b))return b;if(ae(a))throw Error(["Unable to resolve spec: ",B.j(a)].join(""));return null}
function Ll(a){if(ja(null==a?"":String(a)))return null;a=ff.m(Gi,yl(a));if(2<=R(a)&&Se(function(c){return!ja(null==c?"":String(c))},a)){var b=Jh()(a);a=U(b,0,null);b=U(b,1,null);return uc.j([xl(a),"/",B.j(b)].join(""))}return null}
var Nl=function(){function a(d,e){var f=Ml[u(null==d?null:d)];if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);f=Ml._;if(null!=f)return f.m?f.m(d,e):f.call(null,d,e);throw A("Specize.specize*",d);}function b(d){var e=Ml[u(null==d?null:d)];if(null!=e)return e.j?e.j(d):e.call(null,d);e=Ml._;if(null!=e)return e.j?e.j(d):e.call(null,d);throw A("Specize.specize*",d);}var c=null;c=function(d,e){switch(arguments.length){case 1:return b.call(this,d);case 2:return a.call(this,d,e)}throw Error("Invalid arity: "+
arguments.length);};c.j=b;c.m=a;return c}(),Ml=function Ml(a){switch(arguments.length){case 1:return Ml.j(arguments[0]);case 2:return Ml.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Ml.j=function(a){return null!=a&&null!=a.bb?a.bb(a):Nl(a)};Ml.m=function(a,b){return null!=a&&null!=a.cb?a.cb(a,b):Nl(a,b)};Ml.M=2;G.prototype.bb=function(){return Ml(Dl(this))};G.prototype.cb=function(){return Ml(Dl(this))};E.prototype.bb=function(){return Ml(Dl(this))};
E.prototype.cb=function(){return Ml(Dl(this))};sh.prototype.bb=function(){return Ol(this,this,null,null,null)};sh.prototype.cb=function(a,b){return Ol(b,this,null,null,null)};
Ml._=function(){function a(c){var d=(d=id(c))?Ll(c.name):d;return x(d)?Ol(d,c,null,null,null):Ol(gl,c,null,null,null)}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return Ol(d,c,null,null,null)}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(c,d){return Ol(d,c,null,null,null)};return b}();
var Pl=function Pl(a){switch(arguments.length){case 1:return Pl.j(arguments[0]);case 2:return Pl.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Pl.j=function(a){var b=El(a);return x(b)?b:Ml(a)};Pl.m=function(a,b){var c=El(a);return x(c)?c:Ml(a,b)};Pl.M=2;function Ql(a){return Zd(ul,a)}function Rl(a,b){a=Cl(a);return x(Fl(a))?V.u(a,tl,b):Al(Pl.j(a),b)}
function Sl(a,b,c){if(null==c)df.u(Bl,hd,a);else{var d=El(c);x(d)||(d=Fl(c),d=x(d)?d:F(C(Bl),c));b=x(d)?c:Ol(b,c,null,null,null);df.H(Bl,V,a,Gl(b,a))}}function Tl(a,b,c){if(x(a)){var d=Kl(a);if(x(d))return zl(Pl.j(d),b);if(id(a)||(null!=a?a.A&1||v===a.Hd||(a.A?0:y(Ka,a)):y(Ka,a)))return x(null)?a.j?a.j(b):a.call(null,b):x(a.j?a.j(b):a.call(null,b))?b:ul;throw Error([Wh(Zc([c]))," is not a fn, expected predicate fn"].join(""));}return b}
var Ul=function Ul(a){switch(arguments.length){case 2:return Ul.m(arguments[0],arguments[1]);case 3:return Ul.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Ul.m=function(a,b){a=Pl.j(a);return!Ql(zl(a,b))};Ul.u=function(a,b,c){a=Pl.m(a,c);return!Ql(zl(a,b))};Ul.M=3;function Vl(a,b,c,d,e,f){this.form=a;this.bc=b;this.fb=c;this.Bc=d;this.Pc=e;this.rd=f;this.A=393216;this.I=0}h=Vl.prototype;
h.R=function(a,b){return new Vl(this.form,this.bc,this.fb,this.Bc,this.Pc,b)};h.P=function(){return this.rd};h.bb=function(){return this};h.cb=function(){return this};h.Vb=v;h.Db=function(a,b){a=this.bc.j?this.bc.j(b):this.bc.call(null,b);return x(this.Bc)?a:x(a)?b:ul};h.Eb=function(a,b){return Ol(this.form,this.bc,b,this.Bc,this.Pc)};function Ol(a,b,c,d,e){return x(El(b))?x(c)?Rl(b,c):b:x(Fl(b))?Jl(b,c):ae(b)?(a=Kl(b),x(c)?Rl(a,c):a):new Vl(a,b,c,d,e,Pe)}
function Wl(a,b,c,d,e,f){this.forms=a;this.Va=b;this.fb=c;this.Hb=d;this.B=e;this.sd=f;this.A=393216;this.I=0}h=Wl.prototype;h.R=function(a,b){return new Wl(this.forms,this.Va,this.fb,this.Hb,this.B,b)};h.P=function(){return this.sd};h.bb=function(){return this};h.cb=function(){return this};h.Vb=v;
h.Db=function(a,b){a=C(this.Hb);if(td(b)&&O.m(R(b),this.B))for(var c=b,d=0;;){if(O.m(d,this.B))return c;var e=b.j?b.j(d):b.call(null,d),f=zl(a.j?a.j(d):a.call(null,d),e);if(Ql(f))return ul;c=f===e?c:V.u(c,d,f);d+=1}else return ul};h.Eb=function(a,b){return Xl(this.forms,this.Va,b)};function Xl(a,b,c){var d=new ai(function(){return of.u(Pl,b,a)}),e=R(b);return new Wl(a,b,c,d,e,Pe)}function Yl(a,b){return new If(a,b)}
function Zl(a,b,c,d,e,f,g,k,l){this.keys=a;this.forms=b;this.Va=c;this.fb=d;this.id=e;this.od=f;this.Hb=g;this.Ya=k;this.td=l;this.A=393216;this.I=0}h=Zl.prototype;h.R=function(a,b){return new Zl(this.keys,this.forms,this.Va,this.fb,this.id,this.od,this.Hb,this.Ya,b)};h.P=function(){return this.td};h.bb=function(){return this};h.cb=function(){return this};h.Vb=v;h.Db=function(a,b){return this.Ya.j?this.Ya.j(b):this.Ya.call(null,b)};
h.Eb=function(a,b){return $l.H?$l.H(this.keys,this.forms,this.Va,b):$l.call(null,this.keys,this.forms,this.Va,b)};
function $l(a,b,c,d){var e=Ci(),f=Ah(a,c),g=new ai(function(){return of.u(Pl,c,b)}),k=function(){switch(R(c)){case 2:return function(l){var m=C(g),n=zl(m.j?m.j(0):m.call(null,0),l);return Ql(n)?(l=zl(m.j?m.j(1):m.call(null,1),l),Ql(l)?ul:Yl(a.j?a.j(1):a.call(null,1),l)):Yl(a.j?a.j(0):a.call(null,0),n)};case 3:return function(l){var m=C(g),n=zl(m.j?m.j(0):m.call(null,0),l);return Ql(n)?(n=zl(m.j?m.j(1):m.call(null,1),l),Ql(n)?(l=zl(m.j?m.j(2):m.call(null,2),l),Ql(l)?ul:Yl(a.j?a.j(2):a.call(null,2),
l)):Yl(a.j?a.j(1):a.call(null,1),n)):Yl(a.j?a.j(0):a.call(null,0),n)};default:return function(l){for(var m=C(g),n=0;;)if(n<R(m)){var p=m.j?m.j(n):m.call(null,n);p=zl(p,l);if(Ql(p))n+=1;else return Yl(a.j?a.j(n):a.call(null,n),p)}else return ul}}}();return new Zl(a,b,c,d,e,f,g,k,Pe)}function am(a,b,c){var d=H(b);M(d);N(d);d=H(c);M(d);N(d);for(d=c;;){c=a;b=H(b);a=M(b);b=N(b);var e=H(d);d=M(e);e=N(e);var f=d;d=e;if(x(a)){c=Tl(a,c,f);if(Ql(c))return ul;a=c}else return c}}
function bm(a,b,c,d,e,f){this.forms=a;this.Va=b;this.fb=c;this.Hb=d;this.Ya=e;this.ud=f;this.A=393216;this.I=0}h=bm.prototype;h.R=function(a,b){return new bm(this.forms,this.Va,this.fb,this.Hb,this.Ya,b)};h.P=function(){return this.ud};h.bb=function(){return this};h.cb=function(){return this};h.Vb=v;h.Db=function(a,b){return this.Ya.j?this.Ya.j(b):this.Ya.call(null,b)};h.Eb=function(a,b){return cm.u?cm.u(this.forms,this.Va,b):cm.call(null,this.forms,this.Va,b)};
function cm(a,b,c){var d=new ai(function(){return of.u(Pl,b,a)}),e=function(){switch(R(b)){case 2:return function(f){var g=C(d);f=zl(g.j?g.j(0):g.call(null,0),f);return Ql(f)?ul:zl(g.j?g.j(1):g.call(null,1),f)};case 3:return function(f){var g=C(d);f=zl(g.j?g.j(0):g.call(null,0),f);if(Ql(f))return ul;f=zl(g.j?g.j(1):g.call(null,1),f);return Ql(f)?ul:zl(g.j?g.j(2):g.call(null,2),f)};default:return function(f){for(var g=C(d),k=0;;)if(k<R(g)){f=zl(g.j?g.j(k):g.call(null,k),f);if(Ql(f))return ul;k+=1}else return f}}}();
return new bm(a,b,c,d,e,Pe)}function dm(a){return new w(null,2,[Ik,Xk,Lj,a],null)}function em(a){a=Oe(a);a=F(a,Ik);return O.m(Xk,a)}var fm=function fm(a){var c=Oe(a),d=F(c,Aj);a=H(d);var e=M(a);a=N(a);var f=F(c,Mj),g=H(f),k=M(g);g=N(g);var l=F(c,Qk),m=H(l);M(m);m=N(m);var n=F(c,Lj);c=F(c,sl);return Se(Pd,d)?em(e)?(d=Lj.j(e),d=bd.m(n,x(f)?gd([k,d]):d),a?(a=new w(null,4,[Aj,a,Mj,g,Qk,m,Lj,d],null),fm.j?fm.j(a):fm.call(null,a)):dm(d)):new w(null,6,[Ik,Ck,Aj,d,Lj,n,Mj,f,Qk,l,sl,c],null):null};
function gm(a,b,c,d,e){return x(a)?(d=new w(null,5,[Ik,Hk,Jj,b,ol,d,Qk,e,Vj,Ci()],null),em(a)?V.C(d,Ij,b,Zc([Lj,bd.m(c,Lj.j(a))])):V.C(d,Ij,a,Zc([Lj,c]))):null}
function hm(a,b,c,d){return x(x(b)?b:c)?(a=lf(function(e){e=M(e);return d.j?d.j(e):d.call(null,e)},ff.H(Xf,a,function(){var e=H(b);return e?e:new jf(null,-1,null,null)}(),function(){var e=H(c);return e?e:new jf(null,-1,null,null)}())),new X(null,3,5,Y,[H(ff.m(M,a)),x(b)?H(ff.m($c,a)):null,x(c)?H(ff.m(function(e){return Vc(e,2)},a)):null],null)):new X(null,3,5,Y,[H(lf(d,a)),b,c],null)}
function im(a,b,c){var d=hm(a,b,c,Pd);b=U(d,0,null);c=H(b);a=M(c);c=N(c);var e=U(d,1,null),f=U(e,0,null);d=U(d,2,null);return x(b)?(b=new w(null,4,[Ik,Qj,Aj,b,Mj,e,Qk,d],null),null==c?x(f)?em(a)?dm(Yl(f,Lj.j(a))):b:a:b):null}function jm(a,b){return x(x(a)?b:a)?im(Zc([a,b]),null,null):x(a)?a:b}
var km=function km(a){a=Dl(a);var c=Oe(a),d=F(c,Ik),e=F(c,Aj);a=F(c,Ij);var f=F(c,Jj);c=F(c,Qk);if(O.m(Xk,d))return!0;if(O.m(null,d))return null;if(O.m(Nj,d))return d=km.j?km.j(a):km.call(null,a),x(d)?(a=am(lm(a),e,N(c)),!Ql(a)):d;if(O.m(Hk,d))return(e=a===f)?e:km.j?km.j(a):km.call(null,a);if(O.m(Ck,d))return Se(km,e);if(O.m(Qj,d))return Te(km,e);throw Error(["No matching clause: ",B.j(d)].join(""));},lm=function lm(a){a=Dl(a);var c=Oe(a);a=F(c,Aj);var d=H(a),e=M(d);N(d);var f=F(c,Mj),g=U(f,0,null),
k=F(c,Ik);d=F(c,Ij);var l=F(c,Lj);c=F(c,Qk);if(O.m(Xk,k))return l;if(O.m(null,k))return null;if(O.m(Nj,k))return e=lm.j?lm.j(d):lm.call(null,d),(f=O.m(e,Oi))?d=f:(d=Ik.j(Dl(d)),f=new sh(null,new w(null,2,[Hk,null,Ck,null],null),null),d=f.j?f.j(d):f.call(null,d),d=x(d)?od(e):d,d=x(d)?d:null),x(d)?Oi:am(e,a,c);if(O.m(Hk,k))return mm(d,l,g);if(O.m(Ck,k))return mm(e,l,g);if(O.m(Qj,k))return c=hm(a,f,c,km),a=U(c,0,null),a=U(a,0,null),c=U(c,1,null),c=U(c,0,null),a=null==a?Oi:lm.j?lm.j(a):lm.call(null,a),
x(c)?Yl(c,a):a;throw Error(["No matching clause: ",B.j(k)].join(""));};function mm(a,b,c){a=Dl(a);var d=Oe(a),e=F(d,Ik);F(d,Aj);a=F(d,ol);if(O.m(null,e))return b;if(O.m(Qj,e)||O.m(Xk,e)||O.m(Nj,e))return a=lm(d),O.m(a,Oi)?b:bd.m(b,x(c)?gd([c,a]):a);if(O.m(Hk,e)||O.m(Ck,e))return d=lm(d),od(d)||(c=x(c)?gd([c,d]):d,a=x(a)?nf:bd,b=a.m?a.m(b,c):a.call(null,b,c)),b;throw Error(["No matching clause: ",B.j(e)].join(""));}
var nm=function nm(a,b){a=Dl(a);var d=Oe(a),e=F(d,Qk),f=F(d,Jj);a=F(d,Aj);var g=H(a),k=M(g),l=N(g),m=F(d,Lj);g=F(d,Ik);var n=F(d,ol),p=F(d,Mj),q=H(p),r=M(q),t=N(q);q=F(d,Zi);var z=F(d,Ij);if(x(d)){if(O.m(Xk,g))return null;if(O.m(null,g))return a=Tl(d,b,d),Ql(a)?null:dm(a);if(O.m(Nj,g))return d=nm.m?nm.m(z,b):nm.call(null,z,b),x(d)?O.m(Xk,Ik.j(d))?(a=am(lm(d),a,N(e)),Ql(a)?null:dm(a)):new w(null,5,[Ik,Nj,Ij,d,Zi,q,Aj,a,Qk,e],null):null;if(O.m(Ck,g))return jm(fm(new w(null,4,[Aj,T(nm.m?nm.m(k,b):nm.call(null,
k,b),l),Mj,p,Qk,e,Lj,m],null)),x(km(k))?function(){var D=fm(new w(null,4,[Aj,l,Mj,t,Qk,N(e),Lj,mm(k,m,r)],null));return nm.m?nm.m(D,b):nm.call(null,D,b)}():null);if(O.m(Qj,g))return im(ff.m(function(D){return nm.m?nm.m(D,b):nm.call(null,D,b)},a),p,e);if(O.m(Hk,g))return jm(gm(nm.m?nm.m(z,b):nm.call(null,z,b),f,m,n,e),x(km(z))?function(){var D=gm(f,f,mm(z,m,null),n,e);return nm.m?nm.m(D,b):nm.call(null,D,b)}():null);throw Error(["No matching clause: ",B.j(g)].join(""));}return null};
function om(a,b){for(;;){var c=H(b),d=M(c);c=N(c);if(od(b))return x(km(a))?(a=lm(a),O.m(a,Oi)?null:a):ul;a=nm(a,d);if(x(a))b=c;else return ul}}function pm(a,b,c){this.qc=a;this.fb=b;this.vd=c;this.A=393216;this.I=0}h=pm.prototype;h.R=function(a,b){return new pm(this.qc,this.fb,b)};h.P=function(){return this.vd};h.bb=function(){return this};h.cb=function(){return this};h.Vb=v;h.Db=function(a,b){return null==b||qd(b)?om(this.qc,H(b)):ul};
h.Eb=function(a,b){return Jl.m?Jl.m(this.qc,b):Jl.call(null,this.qc,b)};function Jl(a,b){return new pm(a,b,Pe)}
Sl(hk,W(rk,W(Mi,new X(null,1,5,Y,[Ni],null),W(rl,W(Wi,Qi,Ni),W(Wi,Yi,Ni))),W(Mi,new X(null,1,5,Y,[Ui],null),W(Wi,W(Xi,new X(null,1,5,Y,[new X(null,2,5,Y,[lk,ok],null)],null),new w(null,2,[Qi,lk,Yi,ok],null)),Ui))),Ol(W(rk,W(Xi,new X(null,1,5,Y,[ak],null),W(rl,W(Wi,Qi,ak),W(Wi,Yi,ak))),W(Xi,new X(null,1,5,Y,[ak],null),W(Wi,W(Xi,new X(null,1,5,Y,[new X(null,2,5,Y,[lk,ok],null)],null),new w(null,2,[Qi,lk,Yi,ok],null)),ak))),function(a){return Ah(ff.m(Qi,a),ff.m(Yi,a))},null,!0,function(a){return ff.m(function(b){var c=
U(b,0,null);b=U(b,1,null);return new w(null,2,[Qi,c,Yi,b],null)},a)}));Sl(ik,W(Ok,Li,nj,Pj,Yk),$l(new X(null,2,5,Y,[Li,Pj],null),new X(null,2,5,Y,[nj,Yk],null),new X(null,2,5,Y,[Da,function(a){return a instanceof G}],null),null));
Sl(tj,W(Ok,ql,ik,Fk,W(Rk,tj)),$l(new X(null,2,5,Y,[ql,Fk],null),new X(null,2,5,Y,[ik,W(Rk,tj)],null),new X(null,2,5,Y,[ik,$l(new X(null,2,5,Y,[Gk,il],null),new X(null,2,5,Y,[W(pk,tj),W(Xi,new X(null,1,5,Y,[ak],null),W(kj,W(Si,ak),W(hj,W(Kk,ej,tj),ak)))],null),new X(null,2,5,Y,[gm(tj,tj,dd,!1,tj),function(a){return za(a)&&Se(We(Ul,tj),a)}],null),null)],null),null));
Sl(el,new sh(null,new w(null,3,[W(dj),"null",W(ck),"null",W(Dj),"null"],null),null),new sh(null,new w(null,3,[1,null,2,null,0,null],null),null));Sl(fl,nj,Da);var qm=W(pj,el,fl),rm;rm=Xl(new X(null,2,5,Y,[el,fl],null),new X(null,2,5,Y,[el,fl],null),null);Sl(xk,qm,rm);
Sl(Tk,W(Wk,Si,W(Xi,new X(null,1,5,Y,[fk],null),W(Vk,new X(null,2,5,Y,[mj,W(Wi,Ek,W(Yj,2,fk))],null),W(ej,W(pk,xk),mj)))),cm(new X(null,2,5,Y,[Si,W(Xi,new X(null,1,5,Y,[fk],null),W(Vk,new X(null,2,5,Y,[mj,W(Wi,Ek,W(Yj,2,fk))],null),W(ej,W(pk,xk),mj)))],null),new X(null,2,5,Y,[za,function(a){a=ff.m(Pf,Ch(2,2,a));return Ul.m(gm(xk,xk,dd,!1,xk),a)}],null),null));a:for(var sm=[Dk,Ki,al,sk,tk,oj,jl,nl,gj,Vi,Gj,Uk,Bj,ll,bk],tm=[zk,wk,!0,dl,sj,sj,gk,sj,zk,!0,sj,sj,zk,sj,sj],um=sm.length,vm=0,wm=Mb(og);;)if(vm<um){if(tm.length<=vm)throw Error(["No value supplied for key: ",B.j(sm[vm])].join(""));var xm=vm+1,ym=Pb(wm,sm[vm],tm[vm]);vm=xm;wm=ym}else{Ob(wm);break a};function zm(a){return["Oops, ",B.j(a)].join("")}var Am=function(){var a=Ze(Pe),b=Ze(Pe),c=Ze(Pe),d=Ze(Pe),e=tc(Pe,vk,mi.G?mi.G():mi.call(null));return new xi(uc.m("oops.messages","runtime-message"),function(){function f(g,k){if(1<arguments.length)for(var l=0,m=Array(arguments.length-1);l<m.length;)m[l]=arguments[l+1],++l;return g}f.M=1;f.N=function(g){var k=M(g);xc(g);return k};f.C=function(g){return g};return f}(),e,a,b,c,d)}();
Ai(Am,Uk,function(a,b){b=Oe(b);a=F(b,Rj);b=F(b,lj);return zm.call(null,["Unexpected object value (",B.j(a),")",od(b)?null:[" on key path '",B.j(b),"'"].join("")].join(""))});Ai(Am,oj,function(a,b){var c=Oe(b);a=F(c,Oj);b=F(c,lj);c=F(c,Ei);return zm.call(null,["Expected a function",x(a)?" or nil":null,od(b)?null:[" on key path '",B.j(b),"'"].join(""),", got \x3c",B.j(u(c)),"\x3e instead"].join(""))});
Ai(Am,ll,function(a,b){b=Oe(b);a=F(b,ql);b=F(b,lj);return zm.call(null,["Missing expected object key '",B.j(a),"'",od(b)||O.m(b,a)?null:[" on key path '",B.j(b),"'"].join("")].join(""))});Ai(Am,bk,function(a,b){var c=Oe(b);a=F(c,ql);b=F(c,lj);c=F(c,jk);return zm.call(null,["Object key '",B.j(a),"' is not writable",od(b)||O.m(b,a)?null:[" on key path '",B.j(b),"'"].join(""),x(c)?" because the object is frozen":null].join(""))});
Ai(Am,Gj,function(a,b){b=Oe(b);a=F(b,ql);b=F(b,lj);return zm.call(null,["Cannot create object key '",B.j(a),"'",od(b)||O.m(b,a)?null:[" on key path '",B.j(b),"'"].join("")," because the object is sealed"].join(""))});Ai(Am,tk,function(a,b){b=Oe(b);a=F(b,ql);b=F(b,lj);return zm.call(null,["Cannot create object key '",B.j(a),"'",od(b)||O.m(b,a)?null:[" on key path '",B.j(b),"'"].join("")," because the object is frozen"].join(""))});Ai(Am,nl,function(){return zm.call(null,"Invalid selector")});
Ai(Am,Dk,function(){return zm.call(null,"Unexpected empty selector")});Ai(Am,gj,function(){return zm.call(null,'Unexpected punching selector ("!" makes sense only with oset!)')});Ai(Am,Bj,function(){return zm.call(null,'Unexpected soft selector ("?" does not make sense with oset!)')});var Bm=function Bm(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Bm.C(0<c.length?new K(c.slice(0),0,null):null)};Bm.C=function(a){return Je(console.debug,ff.m(hi,a))};Bm.M=0;Bm.N=function(a){return this.C(H(a))};var Cm=new X(null,2,5,Y,[.1,400],null),Dm=new w(null,3,[Sk,new w(null,2,[aj,Xj,lj,"img/belfast_sunset_puresky_1k.hdr"],null),Bk,new w(null,2,[aj,Pk,lj,"glb/concrete_cat_statue.glb"],null),vl,new w(null,2,[aj,Nk,lj,"img/waternormals.jpg"],null)],null);var Em={},Fm={},Gm=[];function Hm(a,b){var c=Fm[a];if(void 0!==c)return c;try{Gm.push(a);var d=Em[a],e=shadow$provide[a];if(void 0===d){if(void 0===e)throw"Module not provided: "+a;d={exports:{}};Em[a]=d}if(e){delete shadow$provide[a];try{e.call(d,aa,Hm,d,d.exports)}catch(g){throw console.warn("shadow-cljs - failed to load",a),console.error(g),g;}if(b){var f=b.globals;if(f)for(a=0;a<f.length;a++)window[f[a]]=d.exports}}}finally{Gm.pop()}return d.exports}Hm.cache={};Hm.resolve=function(a){return a};
Hm.exportCopy=function(a,b){let c={};a=a.exports;for(let d in b)"default"==d||d in a||d in c||(c[d]={enumerable:!0,get:function(){return b[d]}});Object.defineProperties(a,c)};Hm.esmDefault=function(a){return a&&a.__esModule?a:{"default":a}};Hm.dynamic=function(a){return Promise.resolve().then(function(){return Hm(a)})};var Im=Hm(0,{});function Jm(a,b){if(null!=a&&null!=a.zc)a=a.zc(a,b);else{var c=Jm[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Jm._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("ReadPort.take!",a);}return a}function Km(a,b,c){if(null!=a&&null!=a.kc)a=a.kc(a,b,c);else{var d=Km[u(null==a?null:a)];if(null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else if(d=Km._,null!=d)a=d.u?d.u(a,b,c):d.call(null,a,b,c);else throw A("WritePort.put!",a);}return a}
function Lm(a){if(null!=a&&null!=a.Tb)a=a.Tb(a);else{var b=Lm[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Lm._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("Channel.close!",a);}return a}function Mm(a){if(null!=a&&null!=a.xa)a=a.xa(a);else{var b=Mm[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Mm._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("Handler.active?",a);}return a}
function Pm(a){if(null!=a&&null!=a.va)a=a.va(a);else{var b=Pm[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Pm._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("Handler.commit",a);}return a}function Qm(a,b){if(null!=a&&null!=a.yc)a=a.yc(a,b);else{var c=Qm[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Qm._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("Buffer.add!*",a);}return a}
var Rm=function Rm(a){switch(arguments.length){case 1:return Rm.j(arguments[0]);case 2:return Rm.m(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Rm.j=function(a){return a};Rm.m=function(a,b){return Qm(a,b)};Rm.M=2;function Sm(a,b,c,d,e){for(var f=0;;)if(f<e)c[d+f]=a[b+f],f+=1;else break}function Tm(a){this.length=this.Z=this.head=0;this.o=a}h=Tm.prototype;h.pop=function(){if(0===this.length)return null;var a=this.o[this.Z];this.o[this.Z]=null;this.Z=(this.Z+1)%this.o.length;--this.length;return a};h.unshift=function(a){this.o[this.head]=a;this.head=(this.head+1)%this.o.length;this.length+=1;return null};h.unbounded_unshift=function(a){this.length+1===this.o.length&&this.resize();return this.unshift(a)};
h.resize=function(){var a=Array(2*this.o.length);return this.Z<this.head?(Sm(this.o,this.Z,a,0,this.length),this.Z=0,this.head=this.length,this.o=a):this.Z>this.head?(Sm(this.o,this.Z,a,0,this.o.length-this.Z),Sm(this.o,0,a,this.o.length-this.Z,this.head),this.Z=0,this.head=this.length,this.o=a):this.Z===this.head?(this.head=this.Z=0,this.o=a):null};h.cleanup=function(a){for(var b=this.length,c=0;;)if(c<b){var d=this.pop();(a.j?a.j(d):a.call(null,d))&&this.unshift(d);c+=1}else return null};
function Um(a,b){this.T=a;this.n=b;this.A=2;this.I=0}h=Um.prototype;h.jc=function(){return this.T.length>=this.n};h.Sb=function(){return this.T.pop()};h.yc=function(a,b){this.T.unbounded_unshift(b);return this};h.Mc=function(){};h.$=function(){return this.T.length};var Vm={};function Wm(){this.v=Vm;this.A=2;this.I=0}h=Wm.prototype;h.jc=function(){return!1};h.Sb=function(){return this.v};h.yc=function(a,b){Vm===this.v&&(this.v=b);return this};h.Mc=function(){Vm===this.v&&(this.v=null)};
h.$=function(){return Vm===this.v?0:1};function Xm(){return ma("iPhone")&&!ma("iPod")&&!ma("iPad")};ma("Opera");ma("Trident")||ma("MSIE");ma("Edge");!ma("Gecko")||-1!=la().toLowerCase().indexOf("webkit")&&!ma("Edge")||ma("Trident")||ma("MSIE")||ma("Edge");-1!=la().toLowerCase().indexOf("webkit")&&!ma("Edge")&&ma("Mobile");ma("Macintosh");ma("Windows");ma("Linux")||ma("CrOS");var Ym=aa.navigator||null;Ym&&(Ym.appVersion||"").indexOf("X11");ma("Android");Xm();ma("iPad");ma("iPod");Xm()||ma("iPad")||ma("iPod");la().toLowerCase().indexOf("kaios");try{(new self.OffscreenCanvas(0,0)).getContext("2d")}catch(a){};function Zm(){var a=document;var b="IFRAME";"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)};var $m;
function an(){var a=aa.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ma("Presto")&&(a=function(){var e=Zm();e.style.display="none";document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ia(function(l){if(("*"==k||l.origin==k)&&l.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,
!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!ma("Trident")&&!ma("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Jb;c.Jb=null;e()}};return function(e){d.next={Jb:e};d=d.next;b.port2.postMessage(0)}}return function(e){aa.setTimeout(e,0)}};var bn=new Tm(Array(32)),cn=!1,dn=!1;function en(){cn=!0;dn=!1;for(var a=0;;){var b=bn.pop();if(null!=b&&(b.G?b.G():b.call(null),1024>a)){a+=1;continue}break}cn=!1;return 0<bn.length?fn.G?fn.G():fn.call(null):null}function fn(){if(dn&&cn)return null;dn=!0;"function"!==typeof aa.setImmediate||aa.Window&&aa.Window.prototype&&!ma("Edge")&&aa.Window.prototype.setImmediate==aa.setImmediate?($m||($m=an()),$m(en)):aa.setImmediate(en)}function gn(a){bn.unbounded_unshift(a);fn()};function hn(a,b){this.v=a;this.qd=b;this.A=425984;this.I=0}hn.prototype.R=function(a,b){return new hn(this.v,b)};hn.prototype.P=function(){return this.qd};hn.prototype.kb=function(){return this.v};function jn(a){return new hn(a,Pe)}function kn(a,b){this.Xb=a;this.v=b}function ln(a){return Mm(a.Xb)}function mn(a,b,c,d){this.Ib=a;this.mc=0;this.hb=b;this.lc=0;this.T=c;this.closed=!1;this.Na=d}
function nn(a){for(;;){var b=a.hb.pop();if(null!=b){var c=b.Xb,d=b.v;if(c.xa(null)){var e=c.va(null);gn(function(f){return function(){return f.j?f.j(!0):f.call(null,!0)}}(e,c,d,b,a))}else continue}break}a.hb.cleanup(Ve(!1));a.Tb(null)}
mn.prototype.kc=function(a,b,c){var d=this,e=this,f=d.closed;if(c.xa(null)){if(f)return c.va(null),jn(!1);if(x(function(){var p=d.T;return x(p)?Aa(d.T.jc()):p}())){c.va(null);var g=Lc(d.Na.m?d.Na.m(d.T,b):d.Na.call(null,d.T,b));c=function(){for(var p=dd;;)if(0<d.Ib.length&&0<R(d.T)){var q=d.Ib.pop();if(q.xa(null)){var r=q.va(null),t=d.T.Sb();p=bd.m(p,function(z,D,I){return function(){return D.j?D.j(I):D.call(null,I)}}(p,r,t,q,g,f,e))}}else return p}();g&&nn(e);if(H(c)){c=H(c);a=null;for(var k=0,l=
0;;)if(l<k){var m=a.W(null,l);gn(m);l+=1}else if(c=H(c))a=c,ud(a)?(c=Tb(a),l=Ub(a),a=c,k=R(c),c=l):(c=M(a),gn(c),c=N(a),a=null,k=0),l=0;else break}return jn(!0)}a=function(){for(;;){var p=d.Ib.pop();if(x(p)){if(x(p.xa(null)))return p}else return null}}();if(x(a)){var n=a.va(null);c.va(null);gn(function(){return n.j?n.j(b):n.call(null,b)});return jn(!0)}64<d.lc?(d.lc=0,d.hb.cleanup(ln)):d.lc+=1;x(c.Ub())&&d.hb.unbounded_unshift(new kn(c,b));return null}return jn(!f)};
mn.prototype.zc=function(a,b){var c=this;if(b.xa(null)){if(null!=c.T&&0<R(c.T)){a=b.va(null);if(x(a)){var d=c.T.Sb(),e=Aa(c.T.jc())&&0<c.hb.length?function(){for(var z=dd;;){var D=c.hb.pop(),I=D.Xb;D=D.v;var J=I.xa(null);I=J?I.va(null):J;z=x(I)?bd.m(z,I):z;D=x(I)?Lc(c.Na.m?c.Na.m(c.T,D):c.Na.call(null,c.T,D)):null;if(!(Aa(D)&&Aa(c.T.jc())&&0<c.hb.length))return new X(null,2,5,Y,[D,z],null)}}():null,f=U(e,0,null),g=U(e,1,null);x(f)&&nn(this);for(var k=H(g),l=null,m=0,n=0;;)if(n<m){var p=l.W(null,n);
gn(function(z,D,I,J,Q){return function(){return Q.j?Q.j(!0):Q.call(null,!0)}}(k,l,m,n,p,d,e,f,g,a,a,this));n+=1}else{var q=H(k);if(q){p=q;if(ud(p))k=Tb(p),n=Ub(p),l=k,m=R(k),k=n;else{var r=M(p);gn(function(z,D,I,J,Q){return function(){return Q.j?Q.j(!0):Q.call(null,!0)}}(k,l,m,n,r,p,q,d,e,f,g,a,a,this));k=N(p);l=null;m=0}n=0}else break}return jn(d)}return null}a=function(){for(;;){var z=c.hb.pop();if(x(z)){if(Mm(z.Xb))return z}else return null}}();if(x(a)){var t=Pm(a.Xb);b.va(null);gn(function(){return t.j?
t.j(!0):t.call(null,!0)});return jn(a.v)}if(x(c.closed))return x(c.T)&&(c.Na.j?c.Na.j(c.T):c.Na.call(null,c.T)),x(function(){var z=b.xa(null);return x(z)?b.va(null):z}())?(a=function(){var z=c.T;return x(z)?0<R(c.T):z}(),d=x(a)?c.T.Sb():null,jn(d)):null;64<c.mc?(c.mc=0,c.Ib.cleanup(Mm)):c.mc+=1;x(b.Ub())&&c.Ib.unbounded_unshift(b)}return null};
mn.prototype.Tb=function(){var a=this;if(!a.closed){a.closed=!0;for(x(function(){var e=a.T;return x(e)?0===a.hb.length:e}())&&(a.Na.j?a.Na.j(a.T):a.Na.call(null,a.T));;){var b=a.Ib.pop();if(null!=b){if(b.xa(null)){var c=b.va(null),d=x(function(){var e=a.T;return x(e)?0<R(a.T):e}())?a.T.Sb():null;gn(function(e,f){return function(){return e.j?e.j(f):e.call(null,f)}}(c,d,b,this))}}else break}x(a.T)&&a.T.Mc()}return null};function on(a){console.log(a);return null}
function pn(a,b){var c=x(null)?null:on;b=c.j?c.j(b):c.call(null,b);return null==b?a:Rm.m(a,b)}
function qn(a){return new mn(new Tm(Array(32)),new Tm(Array(32)),a,function(){var b=x(null)?null.j?null.j(Rm):null.call(null,Rm):Rm;return function(){function c(f,g){try{return b.m?b.m(f,g):b.call(null,f,g)}catch(k){return pn(f,k)}}function d(f){try{return b.j?b.j(f):b.call(null,f)}catch(g){return pn(f,g)}}var e=null;e=function(f,g){switch(arguments.length){case 1:return d.call(this,f);case 2:return c.call(this,f,g)}throw Error("Invalid arity: "+arguments.length);};e.j=d;e.m=c;return e}()}())};function rn(a,b,c){this.key=a;this.v=b;this.forward=c;this.A=2155872256;this.I=0}rn.prototype.Y=function(){return new ed(null,this.key,new ed(null,this.v,null,1,null),2,null)};rn.prototype.V=function(a,b,c){return Lh(b,Sh,"["," ","]",c,this)};function sn(a,b,c){c=Array(c+1);for(var d=0;;)if(d<c.length)c[d]=null,d+=1;else break;return new rn(a,b,c)}
function tn(a,b,c,d){for(;;){if(0>c)return a;a:for(;;){var e=c<a.forward.length?a.forward[c]:null;if(x(e))if(e.key<b)a=e;else break a;else break a}null!=d&&(d[c]=a);--c}}function un(){this.header=sn(null,null,0);this.level=0;this.A=2155872256;this.I=0}h=un.prototype;
h.put=function(a,b){var c=Array(15),d=tn(this.header,a,this.level,c).forward[0];if(null!=d&&d.key===a)return d.v=b;a:for(d=0;;)if(.5>Math.random()&&15>d)d+=1;else break a;if(d>this.level){for(var e=this.level+1;;)if(e<=d+1)c[e]=this.header,e+=1;else break;this.level=d}a=sn(a,b,Array(d));for(b=0;;)if(b<=this.level)d=c[b].forward,b<a.forward.length?a.forward[b]=d[b]:a.forward.push(b<d.length?d[b]:null),b<d.length?d[b]=a:d.push(a),b+=1;else return null};
h.remove=function(a){var b=Array(15),c=tn(this.header,a,this.level,b);c=0===c.forward.length?null:c.forward[0];if(null!=c&&c.key===a){for(a=0;;)if(a<=this.level){var d=b[a].forward;c===(a<d.length?d[a]:null)&&(d[a]=c.forward[a]);a+=1}else break;for(;;)if(0<this.level&&this.level<this.header.forward.length&&null==this.header.forward[this.level])--this.level;else return null}else return null};
h.ceilingEntry=function(a){for(var b=this.header,c=this.level;;){if(0>c)return O.m(b.key,a)?b:b.forward[0];var d;a:for(d=b;;){var e=c<d.forward.length?d.forward[c]:null;if(null!=e){if(e.key>a)break a;d=e}else{d=0===c?d:null;break a}}x(d)?(--c,b=d):--c}};h.floorEntry=function(a){for(var b=this.header,c=this.level;;){if(0>c)return b===this.header?null:b;var d;a:for(d=b;;){var e=c<d.forward.length?d.forward[c]:null;if(null!=e){if(e.key>a)break a;d=e}else{d=0===c?d:null;break a}}x(d)?(--c,b=d):--c}};
h.Y=function(){return function c(b){return new de(null,function(){return null==b?null:T(new X(null,2,5,Y,[b.key,b.v],null),c(b.forward[0]))},null)}(this.header.forward[0])};h.V=function(a,b,c){return Lh(b,function(d){return Lh(b,Sh,""," ","",c,d)},"{",", ","}",c,this)};new un;function vn(a,b){this.f=a;this.wd=b;this.A=393216;this.I=0}h=vn.prototype;h.R=function(a,b){return new vn(this.f,b)};h.P=function(){return this.wd};h.xa=function(){return!0};h.Ub=function(){return!0};h.va=function(){return this.f};function wn(a){try{var b=a[0];return b.j?b.j(a):b.call(null,a)}catch(c){if(c instanceof Object)throw b=c,a[6].Tb(null),b;throw c;}}function xn(a,b,c){c=c.zc(null,new vn(function(d){a[2]=d;a[1]=b;return wn(a)},Pe));return x(c)?(a[2]=C(c),a[1]=b,cl):null}
function yn(a,b,c,d){c=c.kc(null,d,new vn(function(e){a[2]=e;a[1]=b;return wn(a)},Pe));return x(c)?(a[2]=C(c),a[1]=b,cl):null}function zn(a,b){a=a[6];null!=b&&a.kc(null,b,new vn(function(){return null},Pe));a.Tb(null);return a};function An(a,b,c){this.f=a;this.Hc=b;this.xd=c;this.A=393216;this.I=0}h=An.prototype;h.R=function(a,b){return new An(this.f,this.Hc,b)};h.P=function(){return this.xd};h.xa=function(){return!0};h.Ub=function(){return this.Hc};h.va=function(){return this.f};function Bn(a){a=O.m(a,0)?null:a;return qn("number"===typeof a?new Um(new Tm(Array(a)),a):a)}var Cn=new An(function(){return null},!0,Pe);function Dn(a,b){a=Km(a,b,Cn);return x(a)?C(a):!0}
function En(a){for(var b=Array(a),c=0;;)if(c<a)b[c]=c,c+=1;else break;a=Math.random;for(c=b.length-1;0<c;c--){const d=Math.floor(a()*(c+1)),e=b[c];b[c]=b[d];b[d]=e}return b}function Fn(a,b){this.vb=a;this.yd=b;this.A=393216;this.I=0}h=Fn.prototype;h.R=function(a,b){return new Fn(this.vb,b)};h.P=function(){return this.yd};h.xa=function(){return C(this.vb)};h.Ub=function(){return!0};h.va=function(){af(this.vb,null);return!0};function Gn(a,b,c){this.vb=a;this.Jb=b;this.zd=c;this.A=393216;this.I=0}
h=Gn.prototype;h.R=function(a,b){return new Gn(this.vb,this.Jb,b)};h.P=function(){return this.zd};h.xa=function(){return Mm(this.vb)};h.Ub=function(){return!0};h.va=function(){Pm(this.vb);return this.Jb};function Hn(a,b){return new Gn(a,b,Pe)}
function In(a,b,c){var d=new Fn(Ze(!0),Pe),e=R(b),f=En(e),g=$i.j(c),k=function(){for(var l=0;;)if(l<e){var m=x(g)?l:f[l],n=Vc(b,m),p=td(n)?n.j?n.j(0):n.call(null,0):null,q=x(p)?function(){var r=n.j?n.j(1):n.call(null,1);return Km(p,r,Hn(d,function(t,z,D,I,J){return function(Q){Q=new X(null,2,5,Y,[Q,J],null);return a.j?a.j(Q):a.call(null,Q)}}(l,r,m,n,p,d,e,f,g)))}():Jm(n,Hn(d,function(r,t,z){return function(D){D=new X(null,2,5,Y,[D,z],null);return a.j?a.j(D):a.call(null,D)}}(l,m,n,p,d,e,f,g)));if(x(q))return jn(new X(null,
2,5,Y,[C(q),function(){var r=p;return x(r)?r:n}()],null));l+=1}else return null}();return x(k)?k:zd(c,yi)?(k=function(){var l=d.xa(null);return x(l)?d.va(null):l}(),x(k)?jn(new X(null,2,5,Y,[yi.j(c),yi],null)):null):null}function Jn(a){for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;return Kn(arguments[0],arguments[1],arguments[2],3<b.length?new K(b.slice(3),0,null):null)}
function Kn(a,b,c,d){d=Oe(d);a[1]=b;b=In(function(e){a[2]=e;return wn(a)},c,d);return x(b)?(a[2]=C(b),cl):null}
function Ln(a){var b=Bn(null),c=Bn(1);gn(function(){var d=function(){function f(g){var k=g[1];if(7===k){k=g[7];k=g[2];var l=U(k,0,null),m=U(k,1,null);g[7]=l;g[8]=k;g[9]=m;g[1]=x(null==l)?8:9;return cl}return 1===k?(k=Pf(a),g[10]=k,g[2]=null,g[1]=2,cl):4===k?(k=g[10],Jn(g,7,k)):6===k?(g[2]=g[2],g[1]=3,cl):3===k?zn(g,g[2]):2===k?(k=g[10],k=0<R(k),g[1]=x(k)?4:5,cl):11===k?(k=g[10],l=g[2],g[10]=k,g[11]=l,g[2]=null,g[1]=2,cl):9===k?(k=g[7],yn(g,11,b,k)):5===k?(k=Lm(b),g[2]=k,g[1]=6,cl):10===k?(g[2]=g[2],
g[1]=6,cl):8===k?(k=g[7],k=g[10],m=g[9],k=pf(function(){var n=m;return function(p){return!O.m(n,p)}}(),k),g[10]=k,g[2]=null,g[1]=2,cl):null}return function(){function g(m){for(;;){a:try{for(;;){var n=f(m);if(!Zd(n,cl)){var p=n;break a}}}catch(q){p=q;m[2]=p;if(H(m[4]))m[1]=M(m[4]);else throw p;p=cl}if(!Zd(p,cl))return p}}function k(){var m=[null,null,null,null,null,null,null,null,null,null,null,null];m[0]=l;m[1]=1;return m}var l=null;l=function(m){switch(arguments.length){case 0:return k.call(this);
case 1:return g.call(this,m)}throw Error("Invalid arity: "+arguments.length);};l.G=k;l.j=g;return l}()}(),e=function(){var f=d();f[6]=c;return f}();return wn(e)});return b};function Mn(a,b){var c=Ke(Bh,a,b);return T(c,mf(function(d){return c===d},b))}var Nn=function Nn(a){switch(arguments.length){case 1:return Nn.j(arguments[0]);case 2:return Nn.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Nn.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};Nn.j=function(a){return a};
Nn.m=function(a,b){for(;;)if(R(b)<R(a)){var c=a;a=b;b=c}else return Gd(function(d,e){return function(f,g){return zd(e,g)?f:nd.m(f,g)}}(a,b),a,a)};Nn.C=function(a,b,c){a=Mn(function(d){return-R(d)},bd.C(c,b,Zc([a])));return Gd(Nn,M(a),xc(a))};Nn.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};Nn.M=2;
var On=function On(a){switch(arguments.length){case 1:return On.j(arguments[0]);case 2:return On.m(arguments[0],arguments[1]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return On.C(arguments[0],arguments[1],2<c.length?new K(c.slice(2),0,null):null)}};On.j=function(a){return a};On.m=function(a,b){return R(a)<R(b)?Gd(function(c,d){return zd(b,d)?nd.m(c,d):c},a,a):Gd(nd,a,b)};On.C=function(a,b,c){return Gd(On,a,bd.m(c,b))};
On.N=function(a){var b=M(a),c=N(a);a=M(c);c=N(c);return this.C(b,a,c)};On.M=2;function Pn(a,b){return O.m(a,b)?new X(null,3,5,Y,[null,null,a],null):new X(null,3,5,Y,[a,b,null],null)}function Qn(a){return H(a)?Gd(function(b,c){var d=U(c,0,null);c=U(c,1,null);return V.u(b,d,c)},Pf(kf(Je(Td,kg(a)))),a):null}function Rn(a,b,c){var d=F(a,c),e=F(b,c),f=Sn(d,e),g=U(f,0,null),k=U(f,1,null);f=U(f,2,null);a=zd(a,c);b=zd(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new X(null,3,5,Y,[!a||null==g&&d?null:gd([c,g]),!b||null==k&&d?null:gd([c,k]),d?gd([c,f]):null],null)}
var Tn=function Tn(a){switch(arguments.length){case 2:return Tn.m(arguments[0],arguments[1]);case 3:return Tn.u(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Tn.m=function(a,b){var c=Tn.u;var d=kg(a);var e=kg(b);d=R(d)<R(e)?Gd(bd,e,d):Gd(bd,d,e);return c.call(Tn,a,b,d)};Tn.u=function(a,b,c){return Gd(function(d,e){d=ff.u(mh,d,e);Kh(d);return d},new X(null,3,5,Y,[null,null,null],null),ff.m(Xe(Rn,a,b),c))};Tn.M=3;
function Un(a,b){var c=ff.m,d=Tn.u,e=td(a)?a:Pf(a),f=td(b)?b:Pf(b);a=R(a);b=R(b);return Pf(c.call(ff,Qn,d.call(Tn,e,f,Ih(0,a>b?a:b))))}function Vn(a,b){return new X(null,3,5,Y,[Qe(On.m(a,b)),Qe(On.m(b,a)),Qe(Nn.m(a,b))],null)}function Wn(a){if(null!=a&&null!=a.md)a=a.md(a);else{var b=Wn[u(null==a?null:a)];if(null!=b)a=b.j?b.j(a):b.call(null,a);else if(b=Wn._,null!=b)a=b.j?b.j(a):b.call(null,a);else throw A("EqualityPartition.equality-partition",a);}return a}
function Xn(a,b){if(null!=a&&null!=a.ld)a=a.ld(a,b);else{var c=Xn[u(null==a?null:a)];if(null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else if(c=Xn._,null!=c)a=c.m?c.m(a,b):c.call(null,a,b);else throw A("Diff.diff-similar",a);}return a}Wn["null"]=function(){return Uj};Wn.string=function(){return Uj};Wn.number=function(){return Uj};Wn.array=function(){return Fj};Wn["function"]=function(){return Uj};Wn["boolean"]=function(){return Uj};
Wn._=function(a){return(null!=a?a.A&1024||v===a.Zc||(a.A?0:y(hb,a)):y(hb,a))?ij:(null!=a?a.A&4096||v===a.dd||(a.A?0:y(lb,a)):y(lb,a))?Wj:(null!=a?a.A&16777216||v===a.xc||(a.A?0:y(Gb,a)):y(Gb,a))?Fj:Uj};Xn["null"]=function(a,b){return Pn(a,b)};Xn.string=function(a,b){return Pn(a,b)};Xn.number=function(a,b){return Pn(a,b)};Xn.array=function(a,b){return Un(a,b)};Xn["function"]=function(a,b){return Pn(a,b)};Xn["boolean"]=function(a,b){return Pn(a,b)};
Xn._=function(a,b){var c=function(){var d=Wn(a);d=d instanceof G?d.ya:null;switch(d){case "atom":return Pn;case "set":return Vn;case "sequential":return Un;case "map":return Tn;default:throw Error(["No matching clause: ",B.j(d)].join(""));}}();return c.m?c.m(a,b):c.call(null,a,b)};function Sn(a,b){return O.m(a,b)?new X(null,3,5,Y,[null,null,a],null):O.m(Wn(a),Wn(b))?Xn(a,b):Pn(a,b)};var Yn=function(){var a=Ze(Pe),b=Ze(Pe),c=Ze(Pe),d=Ze(Pe),e=tc(Pe,vk,mi.G?mi.G():mi.call(null));return new xi(uc.m("pragma64.assets","load-asset-async!"),function(f,g){return aj.j(g)},e,a,b,c,d)}(),Zn=new ef(Pe);
function $n(){var a=Bn(new Wm),b=Ln(Pf(function(){return function f(e){return new de(null,function(){for(var g=e;;)if(g=H(g)){if(ud(g)){var k=Tb(g),l=R(k),m=we(l);a:for(var n=0;;)if(n<l){var p=Ua(k,n),q=U(p,0,null),r=U(p,1,null);zd(C(Zn),q)||(p=m,q=Yn.m(q,r),p.add(q));n+=1}else{k=!0;break a}return k?ye(m.O(),f(Ub(g))):ye(m.O(),null)}k=M(g);m=U(k,0,null);k=U(k,1,null);if(zd(C(Zn),m))g=xc(g);else return T(Yn.m(m,k),f(xc(g)))}else return null},null)}(Dm)}())),c=Bn(1);gn(function(){var d=function(){function f(g){var k=
g[1];if(1===k)return g[2]=null,g[1]=2,cl;if(2===k)return k=O.m(R(C(Zn)),R(Dm)),g[1]=k?4:5,cl;if(3===k)return zn(g,g[2]);if(4===k)return k=C(Zn),yn(g,7,a,k);if(5===k)return xn(g,8,b);if(6===k)return g[2]=g[2],g[1]=3,cl;if(7===k)return g[2]=g[2],g[1]=6,cl;if(8===k){var l=g[2];k=U(l,0,null);l=U(l,1,null);var m=Zn.kb(null);k=V.u(m,k,l);k=Zn.ic(null,k);g[7]=null;g[8]=k;g[2]=null;g[1]=2;return cl}return null}return function(){function g(m){for(;;){a:try{for(;;){var n=f(m);if(!Zd(n,cl)){var p=n;break a}}}catch(q){p=
q;m[2]=p;if(H(m[4]))m[1]=M(m[4]);else throw p;p=cl}if(!Zd(p,cl))return p}}function k(){var m=[null,null,null,null,null,null,null,null,null];m[0]=l;m[1]=1;return m}var l=null;l=function(m){switch(arguments.length){case 0:return k.call(this);case 1:return g.call(this,m)}throw Error("Invalid arity: "+arguments.length);};l.G=k;l.j=g;return l}()}(),e=function(){var f=d();f[6]=c;return f}();return wn(e)});return a}function ao(a){return F(C(Zn),a)};var bo=Hm(5,{});var co=Hm(7,{});var eo=Hm(8,{});var fo=Hm(10,{});Hm(11,{});function go(a,b,c){b=new eo.RenderPass(b,c);c=new co.OutputPass;a=new bo.EffectComposer(a);a.addPass(b);x(!0)&&a.addPass(new fo.FilmPass(.25));a.addPass(c);return a};var ho=Math.PI,io,jo=new ArrayBuffer(4),ko=new Uint32Array(jo),lo=new Uint8Array(jo);ko[0]=857870592;var mo=(io=0===lo[0])?1:0,no=1-mo,oo=new ArrayBuffer(16),po=new Float64Array(oo),qo=new Uint8Array(oo);po[0]=0;po[1]=0;qo[io?15:8]=-128;function ro(a){a=a+1023<<20&2146435072;var b=new ArrayBuffer(8);new Float64Array(b);b=new Uint32Array(b);b[no]=0;b[mo]=a}ro(512);ro(-512);function so(a,b){Kh(ff.m(a,b))};var to=Ze(0);function uo(){return df.m(to,Jc)}var vo=function(){var a=Ze(Pe),b=Ze(Pe),c=Ze(Pe),d=Ze(Pe),e=tc(Pe,vk,mi.G?mi.G():mi.call(null));return new xi(uc.m("pragma64.webgame.entity","update-state"),function(f,g){return rf(f,new X(null,3,5,Y,[Jk,g,aj],null))},e,a,b,c,d)}();Ai(vo,yi,function(a){return a});
var wo=function(){var a=Ze(Pe),b=Ze(Pe),c=Ze(Pe),d=Ze(Pe),e=tc(Pe,vk,mi.G?mi.G():mi.call(null));return new xi(uc.m("pragma64.webgame.entity","create-or-update-obj3d!"),function(){function f(l){return F(l,aj)}function g(l){return F(l,aj)}var k=null;k=function(l,m){switch(arguments.length){case 1:return g.call(this,l);case 2:return f.call(this,l,m)}throw Error("Invalid arity: "+arguments.length);};k.j=g;k.m=f;return k}(),e,a,b,c,d)}();var xo=Hm(12,{});var yo=xo.createNoise2D(ji);xo.createNoise3D(ji);xo.createNoise4D(ji);function zo(a){return yo.m?yo.m(a,.5):yo.call(null,a,.5)}function Ao(a,b){return yo.m?yo.m(a,b):yo.call(null,a,b)};var Bo=Hm(14,{});function Co(a){a.castShadow=!0;return a}function Do(a){a.receiveShadow=!0}function Eo(a,b){var c=U(b,0,null),d=U(b,1,null);b=U(b,2,null);a.position.set(c,d,b);return a}function Fo(a,b){var c=U(b,0,null),d=U(b,1,null);b=U(b,2,null);a.rotation.set(c,d,b);return a}var Go=function Go(a){var c=bd.m;var d=Je(Ce,Ke(ff,Go,Zc([a.children])));return c.call(bd,d,a)},Ho=new (Hm(15,{}).RGBELoader),Io=new Bo.GLTFLoader,Jo=new Im.TextureLoader;
function Ko(a,b){function c(g){console.error("error loading asset",a,":",g);return Dn(e,new X(null,2,5,Y,[a,jj],null))}function d(g){return Dn(e,new X(null,2,5,Y,[a,g],null))}var e=Bn(null),f=Oe(b);b=F(f,aj);f=F(f,lj);b=b instanceof G?b.ya:null;switch(b){case "rgbe":Ho.load(f,d,null,c);break;case "gltf":Io.load(f,d,null,c);break;case "texture":Jo.load(f,d,null,c);break;default:throw Error(["No matching clause: ",B.j(b)].join(""));}return e}Ai(Yn,Xj,function(a,b){return Ko(a,b)});
Ai(Yn,Pk,function(a,b){return Ko(a,b)});Ai(Yn,Nk,function(a,b){return Ko(a,b)});Ai(vo,kl,function(a,b){return tf.u(a,new X(null,2,5,Y,[Jk,b],null),function(c){var d=Tj.j(a),e=(x(d.j?d.j(dk):d.call(null,dk))?-1:0)+(x(d.j?d.j(ek):d.call(null,ek))?1:0),f=(x(d.j?d.j(kk):d.call(null,kk))?1:0)+(x(d.j?d.j(Hj):d.call(null,Hj))?-1:0);d=(x(d.j?d.j(nk):d.call(null,nk))?1:0)+(x(d.j?d.j(qk):d.call(null,qk))?-1:0);f=new X(null,3,5,Y,[e,f,d],null);d=U(f,0,null);e=U(f,1,null);var g=U(f,2,null);f=Math.atan2(d,g);d=0===d&&0===g;g=$c(c.j?c.j(Ti):c.call(null,Ti));f-=g;f=of.m(Xe(Sd,16,a.j?a.j(fj):
a.call(null,fj)),new X(null,3,5,Y,[d?0:Math.cos(f),e,d?0:Math.sin(f)],null));e=V.C;f=x(f)?of.u(Rd,c.j?c.j(ml):c.call(null,ml),f):c.j?c.j(ml):c.call(null,ml);d=of.m;g=We(Sd,.2);var k=a.j?a.j($k):a.call(null,$k);k=new X(null,3,5,Y,[zo(.172*k),zo(.191*k),zo(.134*k)],null);d=d.call(of,g,k);k=F(a,bl);g=U(k,0,null);k=U(k,1,null);return e.call(V,c,ml,f,Zc([Cj,d,mk,g/k]))})});
function Lo(a,b){var c=of.m(We(Sd,.002),b);b=U(c,0,null);c=U(c,1,null);return uf.u(a,Ti,Xe(of,Rd,new X(null,3,5,Y,[-c,-b,0],null)))}
Ai(wo,kl,function(){function a(d,e){var f=Oe(d);d=F(f,ml);var g=F(f,Cj),k=F(f,Ti);f=F(f,mk);Fo(e,k);Eo(e,of.u(Rd,d,g));if(O.m(e.aspect,f))return null;e.aspect=f;return e.updateProjectionMatrix()}function b(d){d=new Im.PerspectiveCamera(90,F(d,mk),M(Cm),$c(Cm));d.rotation.order="YXZ";return d}var c=null;c=function(d,e){switch(arguments.length){case 1:return b.call(this,d);case 2:return a.call(this,d,e)}throw Error("Invalid arity: "+arguments.length);};c.j=b;c.m=a;return c}());var Mo=new w(null,5,["keydown",function(a){return new w(null,2,[ql,a.key,aj,Zk],null)},"keyup",function(a){return new w(null,2,[ql,a.key,aj,Ri],null)},"mousedown",function(a){x(document.pointerLockElement)||document.body.requestPointerLock();return new w(null,3,[aj,Lk,pl,function(){switch(a.buttons){case 1:return Hi;case 2:return Pi;default:return null}}(),ml,new X(null,2,5,Y,[a.clientX,a.clientY],null)],null)},"mousemove",function(a){return x(document.pointerLockElement)?new w(null,2,[aj,Ji,cj,new X(null,
2,5,Y,[a.movementX,a.movementY],null)],null):null},"contextmenu",Ve(null)],null);
function No(a){var b=window,c=Zc([Sj]),d=U(c,0,null),e=O.m(d,Sj),f=Pf(function(){return function l(k){return new de(null,function(){for(;;){var m=H(k);if(m){var n=m;if(ud(n)){var p=Tb(n),q=R(p),r=we(q);return function(){for(var I=0;;)if(I<q){var J=Ua(p,I),Q=U(J,0,null),da=U(J,1,null);ze(r,function(){var na=function(Sa,Cc,Bb,cd,$e,fe,ph,qj,qh,Hd){return function(Dc){Hd&&Dc.preventDefault();Dc=cd.j?cd.j(Dc):cd.call(null,Dc);x(Dc)&&(a.j?a.j(Dc):a.call(null,Dc));return null}}(I,J,Q,da,p,q,r,n,m,e,c,d);
b.addEventListener(Q,na);return new X(null,2,5,Y,[Q,na],null)}());I+=1}else return!0}()?ye(r.O(),l(Ub(n))):ye(r.O(),null)}var t=M(n),z=U(t,0,null),D=U(t,1,null);return T(function(){var I=function(J,Q,da,na,Sa,Cc){return function(Bb){Cc&&Bb.preventDefault();Bb=da.j?da.j(Bb):da.call(null,Bb);x(Bb)&&(a.j?a.j(Bb):a.call(null,Bb));return null}}(t,z,D,n,m,e,c,d);b.addEventListener(z,I);return new X(null,2,5,Y,[z,I],null)}(),l(xc(n)))}return null}},null)}(Mo)}());return function(){for(var g=H(f),k=null,
l=0,m=0;;)if(m<l){var n=k.W(null,m),p=U(n,0,null);n=U(n,1,null);b.removeEventListener(p,n);m+=1}else if(g=H(g))ud(g)?(k=Tb(g),g=Ub(g),p=k,l=R(k),k=p):(k=M(g),p=U(k,0,null),n=U(k,1,null),b.removeEventListener(p,n),g=N(g),k=null,l=0),m=0;else return null}}
function Oo(a,b){var c=F(a,hl),d=b.j?b.j(aj):b.call(null,aj);switch(d instanceof G?d.ya:null){case "keydown":switch(b.j?b.j(ql):b.call(null,ql)){case "w":case "W":return sf(a,new X(null,2,5,Y,[Tj,dk],null),!0);case "a":case "A":return sf(a,new X(null,2,5,Y,[Tj,qk],null),!0);case "s":case "S":return sf(a,new X(null,2,5,Y,[Tj,ek],null),!0);case "d":case "D":return sf(a,new X(null,2,5,Y,[Tj,nk],null),!0);case " ":return sf(a,new X(null,2,5,Y,[Tj,kk],null),!0);case "c":case "C":return sf(a,new X(null,
2,5,Y,[Tj,Hj],null),!0);case "f":case "F":return x(document.fullscreenElement)?document.exitFullscreen():document.body.requestFullscreen(),a;default:return a}case "keyup":switch(b.j?b.j(ql):b.call(null,ql)){case "w":case "W":return sf(a,new X(null,2,5,Y,[Tj,dk],null),!1);case "a":case "A":return sf(a,new X(null,2,5,Y,[Tj,qk],null),!1);case "s":case "S":return sf(a,new X(null,2,5,Y,[Tj,ek],null),!1);case "d":case "D":return sf(a,new X(null,2,5,Y,[Tj,nk],null),!1);case " ":return sf(a,new X(null,2,
5,Y,[Tj,kk],null),!1);case "c":case "C":return sf(a,new X(null,2,5,Y,[Tj,Hj],null),!1);default:return a}case "mousemotion":return tf.H(a,new X(null,2,5,Y,[Jk,c],null),Lo,b.j?b.j(cj):b.call(null,cj));default:return a}};function Po(a){return new X(null,3,5,Y,[255&a>>16,255&a>>8,255&a],null)}var Qo=function Qo(a){switch(arguments.length){case 3:return Qo.u(arguments[0],arguments[1],arguments[2]);case 4:return Qo.H(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw Error(["Invalid arity: ",B.j(arguments.length)].join(""));}};Qo.u=function(a,b,c){return["rgb(",B.j(a),",",B.j(b),",",B.j(c),")"].join("")};Qo.H=function(a,b,c,d){return["rgba(",B.j(a),",",B.j(b),",",B.j(c),",",B.j(d),")"].join("")};
Qo.M=4;var Ro=Of([1515576,2439774,3956363,5214138,7585491,10804699,5057330,8013889,11368279,12620915,14136724,15193523,1651501,2446894,4620850,7710531,11061848,13687441,1973561,4204369,8009339,10632844,12997015,14648485,3415079,6302764,8932139,12482347,14589505,15253872,2364711,4267313,7676984,10825776,13588284,14321214,592404,1053727,1383720,2108983,3754576,5730935,8492950,11056562,13094860,15461865],!0);
Of([1515576,2439774,3956363,5214138,7585491,10804699,1651501,2446894,4620850,7710531,11061848,13687441,5057330,8013889,11368279,12620915,14136724,15193523,3415079,6302764,8932139,12482347,14589505,15253872,2364711,4267313,7676984,10825776,13588284,14321214,1973561,4204369,8009339,10632844,12997015,14648485,592404,1053727,1383720,2108983,3754576,5730935,8492950,11056562,13094860,15461865],!0);var So=of.m(Po,Ro);of.m(function(a){return Je(Qo,Po(a))},Ro);
var Uo=Pf(function To(a){return new de(null,function(){for(;;){var c=H(a);if(c){if(ud(c)){var d=Tb(c),e=R(d),f=we(e);a:for(var g=0;;)if(g<e){var k=Ua(d,g),l=f;k=new Im.Color(k);l.add(k);g+=1}else{d=!0;break a}return d?ye(f.O(),To(Ub(c))):ye(f.O(),null)}f=M(c);return T(new Im.Color(f),To(xc(c)))}return null}},null)}(Ro)),Wo=Pf(function Vo(a){return new de(null,function(){for(;;){var c=H(a);if(c){if(ud(c)){var d=Tb(c),e=R(d),f=we(e);a:for(var g=0;;)if(g<e){var k=Ua(d,g),l=f;k=new Im.MeshPhongMaterial({color:k});
l.add(k);g+=1}else{d=!0;break a}return d?ye(f.O(),Vo(Ub(c))):ye(f.O(),null)}f=M(c);return T(new Im.MeshPhongMaterial({color:f}),Vo(xc(c)))}return null}},null)}(Uo));var Xo=So.j?So.j(40):So.call(null,40),Yo=U(Xo,0,null),Zo=U(Xo,1,null),$o=U(Xo,2,null),ap=function(a,b,c){return function(){function d(m,n,p){return Qo.oa?Qo.oa(a,b,c,m,n,p):Qo.call(null,a,b,c,m,n,p)}function e(m,n){return Qo.U?Qo.U(a,b,c,m,n):Qo.call(null,a,b,c,m,n)}function f(m){return Qo.H?Qo.H(a,b,c,m):Qo.call(null,a,b,c,m)}function g(){return Qo.u?Qo.u(a,b,c):Qo.call(null,a,b,c)}var k=null,l=function(){function m(p,q,r,t){var z=null;if(3<arguments.length){z=0;for(var D=Array(arguments.length-
3);z<D.length;)D[z]=arguments[z+3],++z;z=new K(D,0,null)}return n.call(this,p,q,r,z)}function n(p,q,r,t){return Ne(Qo,a,b,c,p,Zc([q,r,t]))}m.M=3;m.N=function(p){var q=M(p);p=N(p);var r=M(p);p=N(p);var t=M(p);p=xc(p);return n(q,r,t,p)};m.C=n;return m}();k=function(m,n,p,q){switch(arguments.length){case 0:return g.call(this);case 1:return f.call(this,m);case 2:return e.call(this,m,n);case 3:return d.call(this,m,n,p);default:var r=null;if(3<arguments.length){r=0;for(var t=Array(arguments.length-3);r<
t.length;)t[r]=arguments[r+3],++r;r=new K(t,0,null)}return l.C(m,n,p,r)}throw Error("Invalid arity: "+arguments.length);};k.M=3;k.N=l.N;k.G=g;k.j=f;k.m=e;k.u=d;k.C=l.C;return k}()}(Yo,Zo,$o);B.j(ap(1));B.j(ap(.6));function bp(a,b){return of.u(Rd,new X(null,3,5,Y,[0,4,0],null),ff.m(function(c){return Math.sin(3*c*b+a)},new X(null,3,5,Y,[.2,.1,.15],null)))}Ai(vo,uj,function(a,b){var c=rf(a,new X(null,3,5,Y,[Jk,b,bj],null)),d=tf.C;b=new X(null,2,5,Y,[Jk,b],null);var e=$k.j(a);return d.call(tf,a,b,V,Ti,new X(null,3,5,Y,[e+.3*c,e+.4*c,0],null),ml,Zc([bp($k.j(a),c)]))});
Ai(wo,uj,function(){function a(d,e){var f=Oe(d);d=F(f,ml);f=F(f,Ti);Eo(e,d);return Fo(e,f)}function b(){var d=new Im.BoxGeometry(.3,.3,.3),e=Im.Mesh;var f=Vc(Wo,ki(R(Wo)));d=new e(d,f);Co(d);return d}var c=null;c=function(d,e){switch(arguments.length){case 1:return b.call(this,d);case 2:return a.call(this,d,e)}throw Error("Invalid arity: "+arguments.length);};c.j=b;c.m=a;return c}());Ai(vo,Bk,function(a,b){return tf.U(a,new X(null,2,5,Y,[Jk,b],null),V,Ti,new X(null,3,5,Y,[0,.3*(a.j?a.j($k):a.call(null,$k)),0],null))});
Ai(wo,Bk,function(){function a(d,e){var f=Oe(d);d=F(f,ml);f=F(f,Ti);Fo(e,f);return Eo(e,d)}function b(){var d=ao(Bk).scene,e=new X(null,3,5,Y,[5,5,5],null),f=U(e,0,null),g=U(e,1,null);e=U(e,2,null);d.scale.set(f,g,e);so(Co,Go(d));return d}var c=null;c=function(d,e){switch(arguments.length){case 1:return b.call(this,d);case 2:return a.call(this,d,e)}throw Error("Invalid arity: "+arguments.length);};c.j=b;c.m=a;return c}());Ai(wo,wl,function(){function a(){var c=new Im.PointLight(Uo.j?Uo.j(45):Uo.call(null,45),2E4,256);Eo(c,new X(null,3,5,Y,[30,64,8],null));c.castShadow=!0;return c}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return null}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(){return null};return b}());function cp(a){var b=new X(null,7,5,Y,[new X(null,2,5,Y,[0,1],null),new X(null,2,5,Y,[.4,6],null),new X(null,2,5,Y,[.44,.8],null),new X(null,2,5,Y,[.64,8],null),new X(null,2,5,Y,[.67,4.5],null),new X(null,2,5,Y,[.9,1],null),new X(null,2,5,Y,[1.67,320],null)],null);return Ke(Rd,0,function(){return function e(d){return new de(null,function(){for(;;){var f=H(d);if(f){if(ud(f)){var g=Tb(f),k=R(g),l=we(k);return function(){for(var r=0;;)if(r<k){var t=Ua(g,r),z=U(t,0,null),D=U(z,0,null);z=U(z,1,null);t=
U(t,1,null);t=null==t?null:M(t);t=Math.abs(null==t||a<t?a-D:t-D);if(a>D)l.add(t*z),r+=1;else return null}else return!0}()?ye(l.O(),e(Ub(f))):ye(l.O(),null)}var m=M(f),n=U(m,0,null),p=U(n,0,null);n=U(n,1,null);var q=U(m,1,null);m=function(){var r=q;return null==r?null:M(r)}();m=Math.abs(null==m||a<m?a-p:m-p);return a>p?T(m*n,e(xc(f))):null}return null}},null)}(qf(2,1,new X(null,1,5,Y,[null],null),b))}())};function dp(a){a*=2;if(null!=a)a=Math.floor(a);else throw new Di;a+=8;a=0<a?a:0;var b=R(Wo)-1;a=a<b?a:b;return Wo.j?Wo.j(a):Wo.call(null,a)}var ep=new X(null,4,5,Y,[new X(null,2,5,Y,[0,0],null),new X(null,2,5,Y,[0,1],null),new X(null,2,5,Y,[1,1],null),new X(null,2,5,Y,[1,0],null)],null);function fp(a,b,c,d){a=new Float32Array(hi(Je(Ce,new X(null,6,5,Y,[c,d,a,a,b,c],null))));b=new Im.BufferGeometry;b.setAttribute("position",new Im.BufferAttribute(a,3));b.computeVertexNormals();return b}
function gp(a){return nf.m(Pe,function(){return function d(c){return new de(null,function(){for(var e=c;;){var f=H(e);if(f){var g=f,k=M(g);if(f=H(function(l,m,n,p){return function t(r){return new de(null,function(z,D){return function(){for(;;){var I=H(r);if(I){if(ud(I)){var J=Tb(I),Q=R(J),da=we(Q);a:for(var na=0;;)if(na<Q){var Sa=Ua(J,na),Cc=da;Sa=gd([new X(null,2,5,Y,[D,Sa],null),3*cp(Ao(.036*D,.036*Sa)+.8)+-3]);Cc.add(Sa);na+=1}else{J=!0;break a}return J?ye(da.O(),t(Ub(I))):ye(da.O(),null)}da=M(I);
return T(gd([new X(null,2,5,Y,[D,da],null),3*cp(Ao(.036*D,.036*da)+.8)+-3]),t(xc(I)))}return null}}}(l,m,n,p),null)}}(e,k,g,f)(Ih(-a,a+1))))return Ce.m(f,d(xc(e)));e=xc(e)}else return null}},null)}(Ih(-a,a+1))}())}
function hp(a,b){for(var c=new Im.Group,d=H(Ih(-b,b)),e=null,f=0,g=0;;)if(g<f){for(var k=e.W(null,g),l=H(Ih(-b,b)),m=null,n=0,p=0;;)if(p<n){var q=m.W(null,p),r=F(a,new X(null,2,5,Y,[k,q],null)),t=function(){return function(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re){return function uh(se){return new de(null,function(bf,cf,vh,Sf,vj,wj,xj,yj,zj,Tf,Uf){return function(){for(;;){var Xb=H(se);if(Xb){if(ud(Xb)){var tb=Tb(Xb),Yb=R(tb),Ra=we(Yb);a:for(var Cb=0;;)if(Cb<Yb){var Ba=Ua(tb,Cb),ab=U(Ba,0,null),Ca=U(Ba,
1,null);Ba=Ra;ab=new X(null,3,5,Y,[2.6*ab,F(a,new X(null,2,5,Y,[Uf+ab,Tf+Ca],null)),2.6*Ca],null);Ba.add(ab);Cb+=1}else{tb=!0;break a}return tb?ye(Ra.O(),uh(Ub(Xb))):ye(Ra.O(),null)}tb=M(Xb);Ra=U(tb,0,null);tb=U(tb,1,null);return T(new X(null,3,5,Y,[2.6*Ra,F(a,new X(null,2,5,Y,[Uf+Ra,Tf+tb],null)),2.6*tb],null),uh(xc(Xb)))}return null}}}(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re),null)}}(l,m,n,p,d,e,f,g,r,q,k,c)(ep)}();t=Je(fp,t);var z=dp(r);t=new Im.Mesh(t,z);Do(t);Eo(t,new X(null,3,5,Y,[2.6*k,0,2.6*q],
null));c.add(t);p+=1}else{var D=H(l);if(D){var I=D;if(ud(I)){var J=Tb(I);t=Ub(I);z=J;J=R(J);l=t;m=z;n=J}else{var Q=M(I),da=F(a,new X(null,2,5,Y,[k,Q],null));t=function(){return function(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se){return function cf(bf){return new de(null,function(vh,Sf,vj,wj,xj,yj,zj,Tf,Uf,Xb,tb,Yb,Ra){return function(){for(;;){var Cb=H(bf);if(Cb){if(ud(Cb)){var Ba=Tb(Cb),ab=R(Ba),Ca=we(ab);a:for(var Ec=0;;)if(Ec<ab){var Db=Ua(Ba,Ec),Id=U(Db,0,null),te=U(Db,1,null);Db=Ca;Id=new X(null,
3,5,Y,[2.6*Id,F(a,new X(null,2,5,Y,[Ra+Id,Xb+te],null)),2.6*te],null);Db.add(Id);Ec+=1}else{Ba=!0;break a}return Ba?ye(Ca.O(),cf(Ub(Cb))):ye(Ca.O(),null)}Ba=M(Cb);Ca=U(Ba,0,null);Ba=U(Ba,1,null);return T(new X(null,3,5,Y,[2.6*Ca,F(a,new X(null,2,5,Y,[Ra+Ca,Xb+Ba],null)),2.6*Ba],null),cf(xc(Cb)))}return null}}}(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se),null)}}(l,m,n,p,d,e,f,g,da,Q,I,D,k,c)(ep)}();t=Je(fp,t);z=dp(da);t=new Im.Mesh(t,z);Do(t);Eo(t,new X(null,3,5,Y,[2.6*k,0,2.6*Q],null));c.add(t);l=
N(I);m=null;n=0}p=0}else break}g+=1}else{var na=H(d);if(na){var Sa=na;if(ud(Sa))J=Tb(Sa),t=Ub(Sa),z=J,J=R(J),d=t,e=z,f=J;else{for(var Cc=M(Sa),Bb=H(Ih(-b,b)),cd=null,$e=0,fe=0;;)if(fe<$e){var ph=cd.W(null,fe),qj=F(a,new X(null,2,5,Y,[Cc,ph],null));t=function(){return function(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se){return function cf(bf){return new de(null,function(vh,Sf,vj,wj,xj,yj,zj,Tf,Uf,Xb,tb){return function(){for(;;){var Yb=H(bf);if(Yb){if(ud(Yb)){var Ra=Tb(Yb),Cb=R(Ra),Ba=we(Cb);a:for(var ab=
0;;)if(ab<Cb){var Ca=Ua(Ra,ab),Ec=U(Ca,0,null),Db=U(Ca,1,null);Ca=Ba;Ec=new X(null,3,5,Y,[2.6*Ec,F(a,new X(null,2,5,Y,[tb+Ec,Xb+Db],null)),2.6*Db],null);Ca.add(Ec);ab+=1}else{Ra=!0;break a}return Ra?ye(Ba.O(),cf(Ub(Yb))):ye(Ba.O(),null)}Ra=M(Yb);Ba=U(Ra,0,null);Ra=U(Ra,1,null);return T(new X(null,3,5,Y,[2.6*Ba,F(a,new X(null,2,5,Y,[tb+Ba,Xb+Ra],null)),2.6*Ra],null),cf(xc(Yb)))}return null}}}(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se),null)}}(Bb,cd,$e,fe,d,e,f,g,qj,ph,Cc,Sa,na,c)(ep)}();t=Je(fp,t);
z=dp(qj);t=new Im.Mesh(t,z);Do(t);Eo(t,new X(null,3,5,Y,[2.6*Cc,0,2.6*ph],null));c.add(t);fe+=1}else{var qh=H(Bb);if(qh){var Hd=qh;if(ud(Hd))J=Tb(Hd),t=Ub(Hd),z=J,J=R(J),Bb=t,cd=z,$e=J;else{var Dc=M(Hd),Nm=F(a,new X(null,2,5,Y,[Cc,Dc],null));t=function(){return function(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se,uh,bf){return function Sf(vh){return new de(null,function(vj,wj,xj,yj,zj,Tf,Uf,Xb,tb,Yb,Ra,Cb,Ba){return function(){for(;;){var ab=H(vh);if(ab){if(ud(ab)){var Ca=Tb(ab),Ec=R(Ca),Db=we(Ec);
a:for(var Id=0;;)if(Id<Ec){var te=Ua(Ca,Id),wh=U(te,0,null),Om=U(te,1,null);te=Db;wh=new X(null,3,5,Y,[2.6*wh,F(a,new X(null,2,5,Y,[Ba+wh,Yb+Om],null)),2.6*Om],null);te.add(wh);Id+=1}else{Ca=!0;break a}return Ca?ye(Db.O(),Sf(Ub(ab))):ye(Db.O(),null)}Ca=M(ab);Db=U(Ca,0,null);Ca=U(Ca,1,null);return T(new X(null,3,5,Y,[2.6*Db,F(a,new X(null,2,5,Y,[Ba+Db,Yb+Ca],null)),2.6*Ca],null),Sf(xc(ab)))}return null}}}(ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,Vf,se,uh,bf),null)}}(Bb,cd,$e,fe,d,e,f,g,Nm,Dc,Hd,qh,Cc,Sa,
na,c)(ep)}();t=Je(fp,t);z=dp(Nm);t=new Im.Mesh(t,z);Do(t);Eo(t,new X(null,3,5,Y,[2.6*Cc,0,2.6*Dc],null));c.add(t);Bb=N(Hd);cd=null;$e=0}fe=0}else break}d=N(Sa);e=null;f=0}g=0}else break}return Eo(c,new X(null,3,5,Y,[0,-3,0],null))}Ai(wo,Mk,function(){function a(c){return hp(F(c,Kj),F(c,Ii))}var b=null;b=function(c,d){switch(arguments.length){case 1:return a.call(this,c);case 2:return null}throw Error("Invalid arity: "+arguments.length);};b.j=a;b.m=function(){return null};return b}());var ip=Hm(16,{});Ai(vo,rj,function(a,b){return sf(a,new X(null,3,5,Y,[Jk,b,uk],null),a.j?a.j($k):a.call(null,$k))});
Ai(wo,rj,function(){function a(d,e){e.material.uniforms.time.value=.3*(d.j?d.j(uk):d.call(null,uk));return e}function b(){var d=new Im.PlaneGeometry(1E3,1E3),e=ao(vl);d=new ip.Water(d,hi(new w(null,7,["textureWidth",64,"textureHeight",64,"sunColor",Uo.j?Uo.j(45):Uo.call(null,45),"waterColor",Uo.j?Uo.j(1):Uo.call(null,1),"distortionScale",4,"fog",!1,"waterNormals",e],null)));e.wrapS=Im.RepeatWrapping;e.wrapT=Im.RepeatWrapping;Fo(d,new X(null,3,5,Y,[-.5*ho,0,0],null));Eo(d,new X(null,3,5,Y,[0,-3,0],
null));return d}var c=null;c=function(d,e){switch(arguments.length){case 1:return b.call(this,d);case 2:return a.call(this,d,e)}throw Error("Invalid arity: "+arguments.length);};c.j=b;c.m=a;return c}());function jp(a,b){var c=F(a,$k),d=F(a,yk);x(d)?(b-=F(a,yk),a=V.C(a,$k,b,Zc([fj,b-c]))):a=V.C(a,yk,b,Zc([fj,.001,$k,0]));a=Gd(Oo,V.u(a,Zj,dd),F(a,Zj));return Gd(vo,a,Dd(Ad,kg(F(a,Jk))))};var kp=Ze(function(){var a=uo(),b=function(){return function e(d){return new de(null,function(){for(;;){var f=H(d);if(f){if(ud(f)){var g=Tb(f),k=R(g),l=we(k);a:for(var m=0;;)if(m<k){var n=Ua(g,m),p=l;n=new X(null,2,5,Y,[uo(),new w(null,2,[aj,uj,bj,n],null)],null);p.add(n);m+=1}else{g=!0;break a}return g?ye(l.O(),e(Ub(f))):ye(l.O(),null)}l=M(f);return T(new X(null,2,5,Y,[uo(),new w(null,2,[aj,uj,bj,l],null)],null),e(xc(f)))}return null}},null)}(Ih(0,14))}();b=V.u(V.u(V.u(V.u(V.u(mh.C(Zc([jh(),b])),
a,new w(null,5,[aj,kl,ml,new X(null,3,5,Y,[2,4,7],null),Ak,new X(null,3,5,Y,[0,0,0],null),Ti,new X(null,3,5,Y,[0,0,0],null),mk,640/480],null)),uo(),new w(null,3,[aj,Mk,Ii,32,Kj,gp.j?gp.j(32):gp.call(null,32)],null)),uo(),new w(null,1,[aj,wl],null)),uo(),new w(null,2,[aj,rj,uk,0],null)),uo(),new w(null,2,[aj,Bk,ml,new X(null,3,5,Y,[2.5,2,1.5],null)],null));return new w(null,8,[hl,a,Jk,b,yk,null,$k,0,fj,0,bl,new X(null,2,5,Y,[640,480],null),Zj,dd,Tj,new w(null,6,[dk,!1,qk,!1,ek,!1,nk,!1,kk,!1,Hj,!1],
null)],null)}());function lp(a,b,c){function d(k){var l=U(k,0,null);k=U(k,1,null);return wo.m(k,F(C(b),l))}var e=Sn(yh(kg(c)),yh(kg(C(b)))),f=U(e,0,null),g=U(e,1,null);e=U(e,2,null);f=nh(c,f);so(function(k){var l=U(k,0,null);k=U(k,1,null);k=wo.j(k);bc(b,V.u(C(b),l,k));return a.add(k)},f);so(d,f);so(d,nh(c,e));so(function(k){var l=U(k,0,null);k=U(k,1,null);a.remove(k);return bc(b,hd.m(C(b),l))},nh(C(b),g))}
function mp(a){for(var b=[],c=arguments.length,d=0;;)if(d<c)b.push(arguments[d]),d+=1;else break;np(arguments[0],1<b.length?new K(b.slice(1),0,null):null)}function np(a,b){b=U(b,0,null);var c=window.innerWidth,d=1*window.innerHeight;var e=200/d;e=1<e?1:e;df.H(kp,V,bl,new X(null,2,5,Y,[c,d],null));a.setPixelRatio(e);a.setSize(c,d);x(b)&&(b.setSize(c,d),b.setPixelRatio(e))}var op=Ze(yc);
function pp(a){df.u(op,bd,function(){a.setAnimationLoop(null);a.dispose();return a});df.u(op,bd,No(function(b){return df.C(kp,uf,Zj,bd,Zc([b]))}));a.shadowMap.enabled=!0;a.domElement.style.imageRendering="pixelated";mp(a)}function qp(a,b){b.mapping=Im.EquirectangularReflectionMapping;b.magFilter=Im.NearestFilter;a.background=b}
function rp(a){var b=ao(Sk),c=new Im.Scene,d=new ef(jh());qp(c,b);c.fog=new Im.Fog(Uo.j?Uo.j(1):Uo.call(null,1),1,128);lp(c,d,function(){var f=C(kp);return f.j?f.j(Jk):f.call(null,Jk)}());var e=go(a,c,F(C(d),function(){var f=C(kp);return f.j?f.j(hl):f.call(null,hl)}()));return a.setAnimationLoop(function(f){f=df.u(kp,jp,f/1E3);var g=F(f,Jk);F(f,hl);np(a,Zc([e]));lp(c,d,g);e.render(f.j?f.j(fj):f.call(null,fj));return null})}
function sp(){var a=new Im.WebGLRenderer;pp(a);a.setAnimationLoop(function(){return null});var b=Bn(1);gn(function(){var c=function(){return function(){function e(k){for(;;){a:try{for(;;){var l=k,m=l[1];if(1===m){var n=$n();var p=xn(l,2,n)}else if(2===m){var q=l[2],r=rp(a);l[7]=q;p=zn(l,r)}else p=null;if(!Zd(p,cl)){var t=p;break a}}}catch(z){t=z;k[2]=t;if(H(k[4]))k[1]=M(k[4]);else throw t;t=cl}if(!Zd(t,cl))return t}}function f(){var k=[null,null,null,null,null,null,null,null];k[0]=g;k[1]=1;return k}
var g=null;g=function(k){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,k)}throw Error("Invalid arity: "+arguments.length);};g.G=f;g.j=e;return g}()}(),d=function(){var e=c();e[6]=b;return e}();return wn(d)});return a};var tp=Ze(null);function up(){Je(Bm,Zc(["pragma64 production build","4d7515701b77dd6277da2e0ed86699aada97060c\n"]));document.title="Pragma64";document.body.style="margin:0;background-color:black;";var a=document.createElement("div"),b=document.createElement("div");a.style="display:flex;height:100vh;justify-content:center;";b.style="margin:auto;";a.appendChild(b);document.body.appendChild(a);af(tp,b);a=sp();return C(tp).appendChild(a.domElement)}
var vp=["pragma64","webgame","web_attach","init"],wp=aa;vp[0]in wp||"undefined"==typeof wp.execScript||wp.execScript("var "+vp[0]);for(var xp;vp.length&&(xp=vp.shift());)vp.length||void 0===up?wp=wp[xp]&&wp[xp]!==Object.prototype[xp]?wp[xp]:wp[xp]={}:wp[xp]=up;up();
}).call(this);